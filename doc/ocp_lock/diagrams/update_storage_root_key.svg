<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1147px" preserveAspectRatio="none" style="width:1456px;height:1147px;background:#FFFFFF;" version="1.1" viewBox="0 0 1456 1147" width="1456px" zoomAndPan="magnify"><defs><filter height="300%" id="f1mk54wdd7rwdk" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1069.0938" style="stroke:#A80036;stroke-width:1.0;" width="778.5" x="431" y="55.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="795.25" y="68.7139">Caliptra</text><rect fill="#DDDDDD" height="1069.0938" style="stroke:#A80036;stroke-width:1.0;" width="214" x="1211.5" y="55.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39" x="1299" y="68.7139">Media</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="44" x="1402.5" y="15.3809">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="254" x="598.75" y="43.2637">Create a new Storage Root Key</text><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="129.4063" style="stroke:#000000;stroke-width:2.0;" width="1209.5" x="228" y="437.8594"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="99.0547" style="stroke:#000000;stroke-width:2.0;" width="777.5" x="444" y="615.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28" x2="28" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="28" x2="28" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28" x2="28" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="28" x2="28" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28" x2="28" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="28" x2="28" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28" x2="28" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="28" x2="28" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="28" x2="28" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="244" x2="244" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="244" x2="244" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="244" x2="244" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="244" x2="244" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="244" x2="244" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="244" x2="244" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="244" x2="244" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="244" x2="244" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="244" x2="244" y1="1036.4844" y2="1046.4844"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="68.7031" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="239" y="234.4531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239" x2="239" y1="234.4531" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="249" x2="249" y1="234.4531" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239" x2="249" y1="234.4531" y2="234.4531"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="30.3516" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="239" y="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239" x2="239" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="249" x2="249" y1="331.1563" y2="361.5078"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="489.9219" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="239" y="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239" x2="239" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="249" x2="249" y1="389.5078" y2="879.4297"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="101.0547" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="239" y="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239" x2="239" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="249" x2="249" y1="907.4297" y2="1008.4844"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="10" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="239" y="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239" x2="239" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="249" x2="249" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="239" x2="249" y1="1046.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="460" x2="460" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="460" x2="460" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="460" x2="460" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="460" x2="460" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="460" x2="460" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="460" x2="460" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="460" x2="460" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="460" x2="460" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="460" x2="460" y1="1036.4844" y2="1046.4844"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="8" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="455" y="353.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="455" y1="353.5078" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="465" x2="465" y1="353.5078" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="465" y1="353.5078" y2="353.5078"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="494.9219" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="455" y="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="455" y1="389.5078" y2="884.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="465" x2="465" y1="389.5078" y2="884.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="455" x2="465" y1="884.4297" y2="884.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="723" x2="723" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="723" x2="723" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="723" x2="723" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="723" x2="723" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="723" x2="723" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="723" x2="723" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="723" x2="723" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="723" x2="723" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="723" x2="723" y1="1036.4844" y2="1046.4844"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="78.7031" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="718" y="929.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="718" x2="718" y1="929.7813" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="728" x2="728" y1="929.7813" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="718" x2="728" y1="929.7813" y2="929.7813"/><rect fill="#FFFFFF" filter="url(#f1mk54wdd7rwdk)" height="10" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="718" y="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="718" x2="718" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="728" x2="728" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="718" x2="728" y1="1046.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="859" x2="859" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="859" x2="859" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="859" x2="859" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="859" x2="859" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="859" x2="859" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="859" x2="859" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="859" x2="859" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="859" x2="859" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="859" x2="859" y1="1036.4844" y2="1046.4844"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="8" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="854" y="871.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="854" x2="854" y1="871.4297" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="864" x2="864" y1="871.4297" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="854" x2="864" y1="871.4297" y2="871.4297"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="101.0547" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="854" y="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="854" x2="854" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="864" x2="864" y1="907.4297" y2="1008.4844"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="10" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="854" y="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="854" x2="854" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="864" x2="864" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="854" x2="864" y1="1046.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="948.5" x2="948.5" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="948.5" x2="948.5" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="948.5" x2="948.5" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="948.5" x2="948.5" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="948.5" x2="948.5" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="948.5" x2="948.5" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="948.5" x2="948.5" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="948.5" x2="948.5" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="948.5" x2="948.5" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1026.5" x2="1026.5" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1026.5" x2="1026.5" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1026.5" x2="1026.5" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1026.5" x2="1026.5" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1026.5" x2="1026.5" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1026.5" x2="1026.5" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1026.5" x2="1026.5" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1026.5" x2="1026.5" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1026.5" x2="1026.5" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1140.5" x2="1140.5" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1140.5" x2="1140.5" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1140.5" x2="1140.5" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1140.5" x2="1140.5" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1140.5" x2="1140.5" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1140.5" x2="1140.5" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1140.5" x2="1140.5" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1140.5" x2="1140.5" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1140.5" x2="1140.5" y1="1036.4844" y2="1046.4844"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="91.0547" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1135.5" y="212.1016"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1135.5" y1="212.1016" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1145.5" x2="1145.5" y1="212.1016" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1145.5" y1="212.1016" y2="212.1016"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="30.3516" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1135.5" y="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1135.5" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1145.5" x2="1145.5" y1="331.1563" y2="361.5078"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="289.8125" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1135.5" y="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1135.5" y1="389.5078" y2="679.3203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1145.5" x2="1145.5" y1="389.5078" y2="679.3203"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1145.5" y1="679.3203" y2="679.3203"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="46.7031" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1135.5" y="832.7266"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1135.5" y1="832.7266" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1145.5" x2="1145.5" y1="832.7266" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1145.5" y1="832.7266" y2="832.7266"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="101.0547" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1135.5" y="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1135.5" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1145.5" x2="1145.5" y1="907.4297" y2="1008.4844"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="10" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1135.5" y="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1135.5" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1145.5" x2="1145.5" y1="1036.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1135.5" x2="1145.5" y1="1046.4844" y2="1046.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1318.5" x2="1318.5" y1="147.3984" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1318.5" x2="1318.5" y1="303.1563" y2="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1318.5" x2="1318.5" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1318.5" x2="1318.5" y1="361.5078" y2="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1318.5" x2="1318.5" y1="389.5078" y2="879.4297"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1318.5" x2="1318.5" y1="879.4297" y2="907.4297"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1318.5" x2="1318.5" y1="907.4297" y2="1008.4844"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1318.5" x2="1318.5" y1="1008.4844" y2="1036.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1318.5" x2="1318.5" y1="1036.4844" y2="1046.4844"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="38.3516" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1313.5" y="264.8047"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1313.5" x2="1313.5" y1="264.8047" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1323.5" x2="1323.5" y1="264.8047" y2="303.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1313.5" x2="1323.5" y1="264.8047" y2="264.8047"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="30.3516" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1313.5" y="331.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1313.5" x2="1313.5" y1="331.1563" y2="361.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1323.5" x2="1323.5" y1="331.1563" y2="361.5078"/><rect fill="#ADD8E6" filter="url(#f1mk54wdd7rwdk)" height="99.0547" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1313.5" y="389.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1313.5" x2="1313.5" y1="389.5078" y2="488.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1323.5" x2="1323.5" y1="389.5078" y2="488.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1313.5" x2="1323.5" y1="488.5625" y2="488.5625"/><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="42" x="5" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="12" y="132.3223">Host</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="64" x="210" y="75.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="217" y="97.1035">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="220.5" y="114.7129">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="231" y="132.3223">FW</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="46" x="435" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="442" y="132.3223">ROM</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="36" x="703" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="710" y="132.3223">FW</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="97" x="808.5" y="93.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="820" y="114.7129">ROM to FW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="815.5" y="132.3223">Handoff Data</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="54" x="919.5" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="926.5" y="132.3223">DRBG</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="74" x="987.5" y="93.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="994.5" y="114.7129">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1005" y="132.3223">Fuses</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="126" x="1075.5" y="93.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1108.5" y="114.7129">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1082.5" y="132.3223">Storage Root Key</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="202" x="1215.5" y="93.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188" x="1222.5" y="114.7129">Create new\Storage Root Key</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="1238.5" y="132.3223">on NVM subsystem reset</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="42" x="5" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="12" y="1068.0176">Host</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="64" x="210" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="217" y="1068.0176">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="220.5" y="1085.627">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="231" y="1103.2363">FW</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="46" x="435" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="442" y="1068.0176">ROM</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="36" x="703" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="710" y="1068.0176">FW</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="97" x="808.5" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74" x="820" y="1068.0176">ROM to FW</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="83" x="815.5" y="1085.627">Handoff Data</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="54" x="919.5" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="926.5" y="1068.0176">DRBG</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="74" x="987.5" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="994.5" y="1068.0176">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1005" y="1085.627">Fuses</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="126" x="1075.5" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1108.5" y="1068.0176">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="1082.5" y="1085.627">Storage Root Key</text><rect fill="#FEFECE" filter="url(#f1mk54wdd7rwdk)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="202" x="1215.5" y="1046.4844"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="188" x="1222.5" y="1068.0176">Create new\Storage Root Key</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="1238.5" y="1085.627">on NVM subsystem reset</text><path d="M-30,160.3984 L-30,202.3984 L1376,202.3984 L1376,170.3984 L1366,160.3984 L-30,160.3984 " fill="#FBFB77" filter="url(#f1mk54wdd7rwdk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1366,160.3984 L1366,170.3984 L1376,170.3984 L1366,160.3984 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="91" x="379.25" y="178.8936">Preconditions:</text><ellipse cx="384.75" cy="190.6016" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="562" x="392.25" y="195.2451">A single Storage Root Key may or may not exist in the fuses, this sequence assumes one exists</text><line style="stroke:#008000;stroke-width:1.0;" x1="237" x2="227" y1="234.4531" y2="230.4531"/><line style="stroke:#008000;stroke-width:1.0;" x1="237" x2="227" y1="234.4531" y2="238.4531"/><line style="stroke:#008000;stroke-width:1.0;" x1="28" x2="238" y1="234.4531" y2="234.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="35" y="229.5967">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="68" y="229.5967">Create_Storage_Root_Key</text><polygon fill="#FF0000" points="1301.5,260.8047,1311.5,264.8047,1301.5,268.8047,1305.5,264.8047" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="249" x2="1307.5" y1="264.8047" y2="264.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="256" y="259.9482">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203" x="289" y="259.9482">Create Storage Root Key next boot</text><line style="stroke:#008000;stroke-width:1.0;" x1="28" x2="38" y1="295.1563" y2="291.1563"/><line style="stroke:#008000;stroke-width:1.0;" x1="28" x2="38" y1="295.1563" y2="299.1563"/><line style="stroke:#008000;stroke-width:1.0;" x1="28" x2="238" y1="295.1563" y2="295.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="45" y="290.2998">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51" x="78" y="290.2998">Success</text><line style="stroke:#A80036;stroke-width:1.0;" x1="453" x2="443" y1="353.5078" y2="349.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="453" x2="443" y1="353.5078" y2="357.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="5" x2="454" y1="353.5078" y2="353.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="12" y="348.6514">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="45" y="348.6514">NVM subsystem Reset</text><line style="stroke:#A80036;stroke-width:1.0;" x1="237" x2="227" y1="353.5078" y2="349.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="237" x2="227" y1="353.5078" y2="357.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="5" x2="238" y1="353.5078" y2="353.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="12" y="348.6514">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="21" x="45" y="348.6514">hhh</text><rect fill="#EEEEEE" filter="url(#f1mk54wdd7rwdk)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1441.5" x="5" y="410.6836"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1446.5" y1="410.6836" y2="410.6836"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1446.5" y1="413.6836" y2="413.6836"/><rect fill="#EEEEEE" filter="url(#f1mk54wdd7rwdk)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="455" x="498.25" y="399.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="437" x="504.25" y="417.0029">Showing the ROM portion dealing with the fuses updates by the ROM</text><path d="M228,437.8594 L301,437.8594 L301,445.8594 L291,455.8594 L228,455.8594 L228,437.8594 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="129.4063" style="stroke:#000000;stroke-width:2.0;" width="1209.5" x="228" y="437.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="243" y="452.3545">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="214" x="316" y="451.2783">[Caliptra ROM waits for fuse operation]</text><polygon fill="#FF0000" points="1301.5,484.5625,1311.5,488.5625,1301.5,492.5625,1305.5,488.5625" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="249" x2="1307.5" y1="488.5625" y2="488.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="256" y="483.7061">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="289" y="483.7061">Determine if create fuse operation requested</text><path d="M254,501.5625 L254,527.5625 L569,527.5625 L569,511.5625 L559,501.5625 L254,501.5625 " fill="#FBFB77" filter="url(#f1mk54wdd7rwdk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M559,501.5625 L559,511.5625 L569,511.5625 L559,501.5625 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294" x="260" y="520.0576">Would need to remove the operation state in media</text><line style="stroke:#008000;stroke-width:1.0;" x1="453" x2="443" y1="559.2656" y2="555.2656"/><line style="stroke:#008000;stroke-width:1.0;" x1="453" x2="443" y1="559.2656" y2="563.2656"/><line style="stroke:#008000;stroke-width:1.0;" x1="249" x2="454" y1="559.2656" y2="559.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="256" y="554.4092">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154" x="289" y="554.4092">Create_Storage_Root_Key</text><polygon fill="#FF0000" points="1014.5,599.6172,1024.5,603.6172,1014.5,607.6172,1018.5,603.6172" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="465" x2="1020.5" y1="603.6172" y2="603.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="472" y="598.7607">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273" x="505" y="598.7607">Determine how many entries are programmable</text><path d="M444,615.6172 L505,615.6172 L505,623.6172 L495,633.6172 L444,633.6172 L444,615.6172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="99.0547" style="stroke:#000000;stroke-width:2.0;" width="777.5" x="444" y="615.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="459" y="630.1123">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="284" x="520" y="629.0361">[previously programmed fuses entries not purged]</text><polygon fill="#FF0000" points="1014.5,662.3203,1024.5,666.3203,1014.5,670.3203,1018.5,666.3203" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="465" x2="1020.5" y1="666.3203" y2="666.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="472" y="661.4639">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="312" x="505" y="661.4639">purge previously programmed fuses entries not purged</text><path d="M470,679.3203 L470,705.3203 L658,705.3203 L658,689.3203 L648,679.3203 L470,679.3203 " fill="#FBFB77" filter="url(#f1mk54wdd7rwdk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M648,679.3203 L648,689.3203 L658,689.3203 L648,679.3203 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#0000FF" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="476" y="697.8154">Not showing how at this time</text><line style="stroke:#FF0000;stroke-width:1.0;" x1="465" x2="507" y1="751.0234" y2="751.0234"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="507" x2="507" y1="751.0234" y2="764.0234"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="466" x2="507" y1="764.0234" y2="764.0234"/><polygon fill="#FF0000" points="476,760.0234,466,764.0234,476,768.0234,472,764.0234" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="472" y="746.167">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211" x="505" y="746.167">Pick an unprogrammed entry to burn</text><polygon fill="#FF0000" points="936.5,790.375,946.5,794.375,936.5,798.375,940.5,794.375" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="465" x2="942.5" y1="794.375" y2="794.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="472" y="789.5186">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212" x="505" y="789.5186">Read a new Storage Root Key Value</text><polygon fill="#FF0000" points="1014.5,820.7266,1024.5,824.7266,1014.5,828.7266,1018.5,824.7266" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="465" x2="1020.5" y1="824.7266" y2="824.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="472" y="819.8701">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247" x="505" y="819.8701">Burn that entry with new Storage Root Key</text><polygon fill="#FF0000" points="842,867.4297,852,871.4297,842,875.4297,846,871.4297" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="465" x2="848" y1="871.4297" y2="871.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="472" y="858.3975">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163" x="505" y="850.2217">System Root Key existance</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="267" x="505" y="866.5732">Numberof entries remaining to be programmed</text><line style="stroke:#008000;stroke-width:1.0;" x1="716" x2="706" y1="929.7813" y2="925.7813"/><line style="stroke:#008000;stroke-width:1.0;" x1="716" x2="706" y1="929.7813" y2="933.7813"/><line style="stroke:#008000;stroke-width:1.0;" x1="249" x2="717" y1="929.7813" y2="929.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="256" y="924.9248">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="25" x="289" y="924.9248">boot</text><polygon fill="#FF0000" points="842,956.1328,852,960.1328,842,964.1328,846,960.1328" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="728" x2="848" y1="960.1328" y2="960.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="735" y="955.2764">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74" x="768" y="955.2764">Get hoff data</text><path d="M733,973.1328 L733,999.1328 L1266,999.1328 L1266,983.1328 L1256,973.1328 L733,973.1328 " fill="#FBFB77" filter="url(#f1mk54wdd7rwdk)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1256,973.1328 L1256,983.1328 L1266,983.1328 L1256,973.1328 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="512" x="739" y="991.6279">Calitra FW can report the existance of a Storage Root Key and how many entries remain</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="190" x="630.75" y="1138.6934">Filename: update_storage_root_key.uml</text><!--MD5=[0d0f5ddbf676be4ded71a6fefd43f6e1]
@startuml

!$show_sometime_later = %false()

!include ocp_lock_utils.inc

!if ($show_title)
    Title "Create a new Storage Root Key"
!endif

!if ($show_precond)
    note across
        <b>Preconditions:</b>
        * A single Storage Root Key may or may not exist in the fuses, this sequence assumes one exists
    end note
!endif

gsrk++ $BUFFER_ACTIVATION

host $async fw++ : Create_Storage_Root_Key

fw $sync csrk : Create Storage Root Key next boot
csrk++ $BUFFER_ACTIVATION

fw $async host : Success

$sometimelater()

[->> crom++ : NVM subsystem Reset
& [->> fw : hhh

$sometimelater()

== Showing the ROM portion dealing with the fuses updates by the ROM ==

loop Caliptra ROM waits for fuse operation

    fw $sync csrk : Determine if create fuse operation requested
    csrk- -
    note right fw
        <font color=blue>Would need to remove the operation state in media
    end note
    fw $async crom : Create_Storage_Root_Key
end

crom $sync fuses : Determine how many entries are programmable

alt previously programmed fuses entries not purged
    crom $sync fuses : purge previously programmed fuses entries not purged
    gsrk- -
    note right crom
        <font color=blue>Not showing how at this time
    end note
end

crom $sync crom : Pick an unprogrammed entry to burn
crom $sync rand : Read a new Storage Root Key Value
crom $sync fuses : Burn that entry with new Storage Root Key
gsrk++ $BUFFER_ACTIVATION

crom $sync hoff++ $BUFFER_ACTIVATION: System Root Key existance\nNumberof entries remaining to be programmed
crom - -
$sometimelater()

fw $async cfw++ : boot

cfw $sync hoff : Get hoff data
note right cfw
    Calitra FW can report the existance of a Storage Root Key and how many entries remain
end note

$sometimelater()


@enduml

@startuml










	autonumber 1 1  "<b>[000]"

	!pragma teoz true

    participant "Remote Key\nManagement Service" as rkms


    participant "Host" as host


    participant "Storage\nDevice\nFW" as fw

    box "Caliptra"
    	participant "Mail Box" as mb
    	participant "ROM" as crom
    	participant "FW" as cfw
    	participant "ROM to FW\nHandoff Data" as hoff
        participant "DRBG" as rand
        participant "DMA Engine" as dma
        participant "Key Vault" as kv
        participant "Key Vault\nFuses" as fuses
        participant "Key Vault\nStorage Root Key" as gsrk
        participant "Key Vault\nSlot A\n(Storage Root Key)" as srk
        participant "Key Vault\nSlot B\n(PMEK Secret)" as pmeks
        participant "Key Vault\nSlot F\n(DICE Alias Key)\necdsa_secp384r1_sha384" as dice
        participant "Key Vault\nSlot G\n(KEM Keypair)" as kemg
        participant "Key Vault\nSlot W\n(Temporary)" as tempw
        participant "Key Vault\nSlot X\n(MEK Seed)" as meks
        participant "Key Vault\nSlot Y\n(Temporary)" as tempy
        participant "Key Vault\nSlot Z\n(Temporary)" as tempz
        participant "Key Vault\nTemp Memory" as tempmem
    end box

    box "Encryption Engine"
        participant "SFR\nInterface" as sfr
        participant "Control" as ee
        participant "Key Cache" as kc
    end box

    box "Media"
        participant "Create new\Storage Root Key\non NVM subsystem reset" as csrk
        participant "Destroy all\Storage Root Keys\non NVM subsystem reset" as dsrk
    end box

    hide unlinked
	footer Filename: update_storage_root_key.uml

	header Version 1


    Title "Create a new Storage Root Key"

    note across
        <b>Preconditions:</b>
        * A single Storage Root Key may or may not exist in the fuses, this sequence assumes one exists
    end note

gsrk++ #lightblue

host -[#green]>> fw++ : Create_Storage_Root_Key

fw -[#red]> csrk : Create Storage Root Key next boot
csrk++ #lightblue

fw -[#green]>> host : Success

           ...
	       ||0||

[->> crom++ : NVM subsystem Reset
& [->> fw : hhh

           ...
	       ||0||

== Showing the ROM portion dealing with the fuses updates by the ROM ==

loop Caliptra ROM waits for fuse operation

    fw -[#red]> csrk : Determine if create fuse operation requested
    csrk- -
    note right fw
        <font color=blue>Would need to remove the operation state in media
    end note
    fw -[#green]>> crom : Create_Storage_Root_Key
end

crom -[#red]> fuses : Determine how many entries are programmable

alt previously programmed fuses entries not purged
    crom -[#red]> fuses : purge previously programmed fuses entries not purged
    gsrk- -
    note right crom
        <font color=blue>Not showing how at this time
    end note
end

crom -[#red]> crom : Pick an unprogrammed entry to burn
crom -[#red]> rand : Read a new Storage Root Key Value
crom -[#red]> fuses : Burn that entry with new Storage Root Key
gsrk++ #lightblue

crom -[#red]> hoff++ #lightblue: System Root Key existance\nNumberof entries remaining to be programmed
crom - -
           ...
	       ||0||

fw -[#green]>> cfw++ : boot

cfw -[#red]> hoff : Get hoff data
note right cfw
    Calitra FW can report the existance of a Storage Root Key and how many entries remain
end note

           ...
	       ||0||


@enduml

PlantUML version 1.2021.7(Sun May 23 06:40:07 MDT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>