<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="778px" preserveAspectRatio="none" style="width:882px;height:778px;background:#FFFFFF;" version="1.1" viewBox="0 0 882 778" width="882px" zoomAndPan="magnify"><title>GET_CAPABILITIES command sequence</title><defs/><g><rect fill="#DDDDDD" height="698.7852" style="stroke:#181818;stroke-width:0.5;" width="221.8394" x="295.9202" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="380.4431" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="828.3936" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="278.749" x="358.5646" y="41.3125">GET_CAPABILITIES command sequence</text><g><title>Storage</title><rect fill="transparent" height="544.5449" width="8" x="150.6418" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="154.1418" x2="154.1418" y1="140.041" y2="684.5859"/></g><g><title/><rect fill="#FFFFFF" height="123.5527" style="stroke:#181818;stroke-width:1;" width="10" x="149.1418" y="561.0332"/></g><g><title>Mail Box</title><rect fill="transparent" height="544.5449" width="8" x="332.196" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="335.696" x2="335.696" y1="140.041" y2="684.5859"/></g><g><title/><rect fill="#FFFFFF" height="113.2422" style="stroke:#181818;stroke-width:1;" width="10" x="330.696" y="169.3516"/></g><g><title>FW</title><rect fill="transparent" height="544.5449" width="8" x="493.5183" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="497.0183" x2="497.0183" y1="140.041" y2="684.5859"/></g><g><title/><rect fill="#FFFFFF" height="307.75" style="stroke:#181818;stroke-width:1;" width="10" x="492.0183" y="253.2832"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="121.4592" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="128.4592" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="131.8669" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="144.4006" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="299.9202" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="306.9202" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="480.2771" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="487.2771" y="129.0879">FW</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="121.4592" y="684.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="128.4592" y="705.1211">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="131.8669" y="721.6094">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="144.4006" y="738.0977">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="299.9202" y="684.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="306.9202" y="705.1211">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="480.2771" y="684.5859"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="487.2771" y="705.1211">FW</text><line style="stroke:#008000;stroke-width:1;" x1="328.696" x2="318.696" y1="169.3516" y2="165.3516"/><line style="stroke:#008000;stroke-width:1;" x1="328.696" x2="318.696" y1="169.3516" y2="173.3516"/><line style="stroke:#008000;stroke-width:1;" x1="154.1418" x2="329.696" y1="169.3516" y2="169.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="161.1418" y="164.6094">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.1914" x="200.5046" y="164.6094">GET_CAPABILITIES</text><path d="M20.4546,182.3516 L20.4546,226.3516 L650.4546,226.3516 L650.4546,192.3516 L640.4546,182.3516 L20.4546,182.3516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M640.4546,182.3516 L640.4546,192.3516 L650.4546,192.3516 L640.4546,182.3516 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="26.4546" y="201.9199">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="30.5679" y="201.9199">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="92.064" y="201.9199">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="96.1772" y="201.9199">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="141.252" y="201.9199">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="145.3652" y="201.9199">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="30.5679" y="217.2305">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="96.1772" y="217.2305">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.459" x="145.3652" y="217.2305">Checksum over other input arguments, computed by the caller. Little endian.</text><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="635.9375" y1="189.3516" y2="189.3516"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="635.9375" y1="204.6621" y2="204.6621"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="635.9375" y1="219.9727" y2="219.9727"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="26.4546" y1="189.3516" y2="219.9727"/><line style="stroke:#000000;stroke-width:0.5;" x1="92.064" x2="92.064" y1="189.3516" y2="219.9727"/><line style="stroke:#000000;stroke-width:0.5;" x1="141.252" x2="141.252" y1="189.3516" y2="219.9727"/><line style="stroke:#000000;stroke-width:0.5;" x1="635.9375" x2="635.9375" y1="189.3516" y2="219.9727"/><line style="stroke:#008000;stroke-width:1;" x1="490.0183" x2="480.0183" y1="253.2832" y2="249.2832"/><line style="stroke:#008000;stroke-width:1;" x1="490.0183" x2="480.0183" y1="253.2832" y2="257.2832"/><line style="stroke:#008000;stroke-width:1;" x1="340.696" x2="491.0183" y1="253.2832" y2="253.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="347.696" y="248.541">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="387.0588" y="248.541">Command</text><polygon fill="#FF0000" points="351.696,278.5938,341.696,282.5938,351.696,286.5938,347.696,282.5938" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="345.696" x2="491.0183" y1="282.5938" y2="282.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="357.696" y="277.8516">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="397.0588" y="277.8516">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.0183" x2="544.0183" y1="311.9043" y2="311.9043"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.0183" x2="544.0183" y1="311.9043" y2="324.9043"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.0183" x2="544.0183" y1="324.9043" y2="324.9043"/><polygon fill="#FF0000" points="513.0183,320.9043,503.0183,324.9043,513.0183,328.9043,509.0183,324.9043" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="509.0183" y="307.1621">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="548.3811" y="307.1621">Determine command</text><path d="M105.4592,336.9043 L167.5979,336.9043 L167.5979,344.2148 L157.5979,354.2148 L105.4592,354.2148 L105.4592,336.9043 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="173.5078" style="stroke:#000000;stroke-width:1.5;" width="644.5005" x="105.4592" y="336.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="120.4592" y="350.4727">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="141.8022" x="182.5979" y="349.5391">[OCP LOCK is supported]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="105.4592" x2="749.9597" y1="432.8359" y2="432.8359"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="164.1353" x="110.4592" y="445.4707">[OCP LOCK is not supported]</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.0183" x2="544.0183" y1="400.8359" y2="400.8359"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.0183" x2="544.0183" y1="400.8359" y2="413.8359"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.0183" x2="544.0183" y1="413.8359" y2="413.8359"/><polygon fill="#FF0000" points="513.0183,409.8359,503.0183,413.8359,513.0183,417.8359,509.0183,413.8359" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="509.0183" y="388.4385">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.7354" x="548.3811" y="380.7832">Set Byte 0 to 01h in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5786" x="548.3811" y="396.0938">capabitilty field on response</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.0183" x2="544.0183" y1="489.4121" y2="489.4121"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.0183" x2="544.0183" y1="489.4121" y2="502.4121"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.0183" x2="544.0183" y1="502.4121" y2="502.4121"/><polygon fill="#FF0000" points="513.0183,498.4121,503.0183,502.4121,513.0183,506.4121,509.0183,502.4121" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="509.0183" y="477.0146">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.54" x="548.3811" y="469.3594">Clear Byte 0 in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5786" x="548.3811" y="484.6699">capabitilty field on response</text><polygon fill="#FF0000" points="346.696,557.0332,336.696,561.0332,346.696,565.0332,342.696,561.0332" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="340.696" x2="491.0183" y1="561.0332" y2="561.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="352.696" y="548.6357">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="392.0588" y="540.9805">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.1948" x="392.0588" y="556.291">Response</text><line style="stroke:#008000;stroke-width:1;" x1="160.1418" x2="170.1418" y1="561.0332" y2="557.0332"/><line style="stroke:#008000;stroke-width:1;" x1="160.1418" x2="170.1418" y1="561.0332" y2="565.0332"/><line style="stroke:#008000;stroke-width:1;" x1="159.1418" x2="334.696" y1="561.0332" y2="561.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="176.1418" y="548.6357">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="215.5046" y="540.9805">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.4043" x="215.5046" y="556.291">Complete</text><path d="M10,579.0332 L10,669.0332 L661,669.0332 L661,589.0332 L651,579.0332 L10,579.0332 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M651,579.0332 L651,589.0332 L661,589.0332 L651,579.0332 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="16" y="598.6016">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="20.1133" y="598.6016">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="98.0625" y="598.6016">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="102.1758" y="598.6016">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="151.5859" y="598.6016">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="155.6992" y="598.6016">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="20.1133" y="613.9121">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="102.1758" y="613.9121">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.5796" x="155.6992" y="613.9121">Checksum over other output arguments, computed by Caliptra. Little endian.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.1445" x="20.1133" y="629.2227">capabilities</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="102.1758" y="629.2227">u8[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.5938" x="155.6992" y="629.2227">Capabilities:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.6763" x="159.8125" y="644.5332">* Byte 0 bit 0: base LOCK capabilities</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.0176" x="151.5859" y="659.8438">Should this be moved to Caliptra scope?</text><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="586.0332" y2="586.0332"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="601.3438" y2="601.3438"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="616.6543" y2="616.6543"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="662.5859" y2="662.5859"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="16" y1="586.0332" y2="662.5859"/><line style="stroke:#000000;stroke-width:0.5;" x1="98.0625" x2="98.0625" y1="586.0332" y2="662.5859"/><line style="stroke:#000000;stroke-width:0.5;" x1="151.5859" x2="151.5859" y1="586.0332" y2="662.5859"/><line style="stroke:#000000;stroke-width:0.5;" x1="646.3921" x2="646.3921" y1="586.0332" y2="662.5859"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="146.5479" x="424.6652" y="768.7188">Filename: get_capabilities.uml</text><!--SRC=[ZPDHJzim4CVVyockKJN1WAeCRPegnWI1JTKgWTQ-hLFbE9V6mh6zsA7gb0_FsKsWHO3gX-XyFlj_zxjBJoWkwmn1SxEGcjylQYUa7P0xYdeYXuE-BVHguOIJU1W1hPat8VvvCriabtUNL-F9U3Q-cGBNPSbK1XR_rQWunb4FLIRoACfNq6TshJYKwT4HZE3btHqfPiH6I6b7UJrWHTU2mwy6pjEB7m9bjZ6duZzkh6lCXH9EQ0NDLZWlxcrT1hC- -zGwam9vS8VdjIleAvIf7R1gMPUed3ts1P47CqZNG170cPHO3M0Yd2VWYsDgq8hHBYJyL7IPTaNpV1MgJZQ0TeejxN9XM6M5McwAvXvMoygJGjU13STbUd8IZBv5cH_451uVGtoD3gjIAEo2uqDAH5fyljJbnQI3s-GE9hV9Bn0MR6sChgZCLvwTalhLchem1ATXU5eG98zYhZWpB2NOqgqX3zqWx1LQevL54lVQEpB4vbsfH2AhEh6zLJpD5yHQodFrkusBFi1pBtPRCLTa64dm_2iUqYjZs3IVcsQlWNpQxZ-KiCTWwjgzCva9ayAuYhqnbwrU02af4RHUx-kVqoz_WzxMmMYk03vsFI3kC1n1ogYHeOdRRypLUQwL7qsfgsyLPXVJGjU4m1NKwnIXfFmpFpHTUc2vDlZzZR_b4G00]--></g></svg>