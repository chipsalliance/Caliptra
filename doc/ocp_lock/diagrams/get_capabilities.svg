<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="748px" preserveAspectRatio="none" style="width:756px;height:748px;background:#FFFFFF;" version="1.1" viewBox="0 0 756 748" width="756px" zoomAndPan="magnify"><title>GET_CAPABILITIES command sequence</title><defs/><g><rect fill="#DDDDDD" height="698.7852" style="stroke:#181818;stroke-width:0.5;" width="221.8394" x="295.9202" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="380.4431" y="56.0566">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="278.749" x="358.5646" y="28.5352">GET_CAPABILITIES command sequence</text><g><title>Storage</title><rect fill="transparent" height="544.5449" width="8" x="150.6418" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="154.1418" x2="154.1418" y1="127.2637" y2="671.8086"/></g><g><title/><rect fill="#FFFFFF" height="123.5527" style="stroke:#181818;stroke-width:1;" width="10" x="149.1418" y="548.2559"/></g><g><title>Mail Box</title><rect fill="transparent" height="544.5449" width="8" x="332.196" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="335.696" x2="335.696" y1="127.2637" y2="671.8086"/></g><g><title/><rect fill="#FFFFFF" height="113.2422" style="stroke:#181818;stroke-width:1;" width="10" x="330.696" y="156.5742"/></g><g><title>FW</title><rect fill="transparent" height="544.5449" width="8" x="493.5183" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="497.0183" x2="497.0183" y1="127.2637" y2="671.8086"/></g><g><title/><rect fill="#FFFFFF" height="307.75" style="stroke:#181818;stroke-width:1;" width="10" x="492.0183" y="240.5059"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="121.4592" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="128.4592" y="83.334">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="131.8669" y="99.8223">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="144.4006" y="116.3105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="299.9202" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="306.9202" y="116.3105">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="480.2771" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="487.2771" y="116.3105">FW</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="121.4592" y="671.8086"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="128.4592" y="692.3438">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="131.8669" y="708.832">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="144.4006" y="725.3203">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="299.9202" y="671.8086"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="306.9202" y="692.3438">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="480.2771" y="671.8086"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="487.2771" y="692.3438">FW</text><line style="stroke:#008000;stroke-width:1;" x1="328.696" x2="318.696" y1="156.5742" y2="152.5742"/><line style="stroke:#008000;stroke-width:1;" x1="328.696" x2="318.696" y1="156.5742" y2="160.5742"/><line style="stroke:#008000;stroke-width:1;" x1="154.1418" x2="329.696" y1="156.5742" y2="156.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="161.1418" y="151.832">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.1914" x="200.5046" y="151.832">GET_CAPABILITIES</text><path d="M20.4546,169.5742 L20.4546,213.5742 L650.4546,213.5742 L650.4546,179.5742 L640.4546,169.5742 L20.4546,169.5742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M640.4546,169.5742 L640.4546,179.5742 L650.4546,179.5742 L640.4546,169.5742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="26.4546" y="189.1426">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="30.5679" y="189.1426">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="92.064" y="189.1426">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="96.1772" y="189.1426">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="141.252" y="189.1426">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="145.3652" y="189.1426">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="30.5679" y="204.4531">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="96.1772" y="204.4531">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.459" x="145.3652" y="204.4531">Checksum over other input arguments, computed by the caller. Little endian.</text><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="635.9375" y1="176.5742" y2="176.5742"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="635.9375" y1="191.8848" y2="191.8848"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="635.9375" y1="207.1953" y2="207.1953"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.4546" x2="26.4546" y1="176.5742" y2="207.1953"/><line style="stroke:#000000;stroke-width:0.5;" x1="92.064" x2="92.064" y1="176.5742" y2="207.1953"/><line style="stroke:#000000;stroke-width:0.5;" x1="141.252" x2="141.252" y1="176.5742" y2="207.1953"/><line style="stroke:#000000;stroke-width:0.5;" x1="635.9375" x2="635.9375" y1="176.5742" y2="207.1953"/><line style="stroke:#008000;stroke-width:1;" x1="490.0183" x2="480.0183" y1="240.5059" y2="236.5059"/><line style="stroke:#008000;stroke-width:1;" x1="490.0183" x2="480.0183" y1="240.5059" y2="244.5059"/><line style="stroke:#008000;stroke-width:1;" x1="340.696" x2="491.0183" y1="240.5059" y2="240.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="347.696" y="235.7637">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="387.0588" y="235.7637">Command</text><polygon fill="#FF0000" points="351.696,265.8164,341.696,269.8164,351.696,273.8164,347.696,269.8164" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="345.696" x2="491.0183" y1="269.8164" y2="269.8164"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="357.696" y="265.0742">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="397.0588" y="265.0742">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.0183" x2="544.0183" y1="299.127" y2="299.127"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.0183" x2="544.0183" y1="299.127" y2="312.127"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.0183" x2="544.0183" y1="312.127" y2="312.127"/><polygon fill="#FF0000" points="513.0183,308.127,503.0183,312.127,513.0183,316.127,509.0183,312.127" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="509.0183" y="294.3848">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="548.3811" y="294.3848">Determine command</text><path d="M105.4592,324.127 L167.5979,324.127 L167.5979,331.4375 L157.5979,341.4375 L105.4592,341.4375 L105.4592,324.127 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="173.5078" style="stroke:#000000;stroke-width:1.5;" width="644.5005" x="105.4592" y="324.127"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="120.4592" y="337.6953">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="141.8022" x="182.5979" y="336.7617">[OCP LOCK is supported]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="105.4592" x2="749.9597" y1="420.0586" y2="420.0586"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="164.1353" x="110.4592" y="432.6934">[OCP LOCK is not supported]</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.0183" x2="544.0183" y1="388.0586" y2="388.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.0183" x2="544.0183" y1="388.0586" y2="401.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.0183" x2="544.0183" y1="401.0586" y2="401.0586"/><polygon fill="#FF0000" points="513.0183,397.0586,503.0183,401.0586,513.0183,405.0586,509.0183,401.0586" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="509.0183" y="375.6611">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.7354" x="548.3811" y="368.0059">Set Byte 0 to 01h in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5786" x="548.3811" y="383.3164">capabitilty field on response</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.0183" x2="544.0183" y1="476.6348" y2="476.6348"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.0183" x2="544.0183" y1="476.6348" y2="489.6348"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.0183" x2="544.0183" y1="489.6348" y2="489.6348"/><polygon fill="#FF0000" points="513.0183,485.6348,503.0183,489.6348,513.0183,493.6348,509.0183,489.6348" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="509.0183" y="464.2373">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.54" x="548.3811" y="456.582">Clear Byte 0 in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.5786" x="548.3811" y="471.8926">capabitilty field on response</text><polygon fill="#FF0000" points="346.696,544.2559,336.696,548.2559,346.696,552.2559,342.696,548.2559" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="340.696" x2="491.0183" y1="548.2559" y2="548.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="352.696" y="535.8584">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="392.0588" y="528.2031">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.1948" x="392.0588" y="543.5137">Response</text><line style="stroke:#008000;stroke-width:1;" x1="160.1418" x2="170.1418" y1="548.2559" y2="544.2559"/><line style="stroke:#008000;stroke-width:1;" x1="160.1418" x2="170.1418" y1="548.2559" y2="552.2559"/><line style="stroke:#008000;stroke-width:1;" x1="159.1418" x2="334.696" y1="548.2559" y2="548.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="176.1418" y="535.8584">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="215.5046" y="528.2031">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.4043" x="215.5046" y="543.5137">Complete</text><path d="M10,566.2559 L10,656.2559 L661,656.2559 L661,576.2559 L651,566.2559 L10,566.2559 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M651,566.2559 L651,576.2559 L661,576.2559 L651,566.2559 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="16" y="585.8242">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="20.1133" y="585.8242">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="98.0625" y="585.8242">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="102.1758" y="585.8242">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="151.5859" y="585.8242">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="155.6992" y="585.8242">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="20.1133" y="601.1348">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="102.1758" y="601.1348">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.5796" x="155.6992" y="601.1348">Checksum over other output arguments, computed by Caliptra. Little endian.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.1445" x="20.1133" y="616.4453">capabilities</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="102.1758" y="616.4453">u8[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.5938" x="155.6992" y="616.4453">Capabilities:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.6763" x="159.8125" y="631.7559">* Byte 0 bit 0: base LOCK capabilities</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.0176" x="151.5859" y="647.0664">Should this be moved to Caliptra scope?</text><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="573.2559" y2="573.2559"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="588.5664" y2="588.5664"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="603.877" y2="603.877"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="646.3921" y1="649.8086" y2="649.8086"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="16" y1="573.2559" y2="649.8086"/><line style="stroke:#000000;stroke-width:0.5;" x1="98.0625" x2="98.0625" y1="573.2559" y2="649.8086"/><line style="stroke:#000000;stroke-width:0.5;" x1="151.5859" x2="151.5859" y1="573.2559" y2="649.8086"/><line style="stroke:#000000;stroke-width:0.5;" x1="646.3921" x2="646.3921" y1="573.2559" y2="649.8086"/><!--SRC=[ZPDHJzim4CVVyockKJN1WAeCRPegnWI1JTKgWTQ-hLFbE9V6mh6zsA7gb0_FsKsWHO3gX-XyFlj_zxjBJoWkwmn1SxEGcjylQYUa7P0xYdeYXuE-BVHguOIJU1W1hPat8VvvCriabtUNL-F9U3Q-cGBNPSbK1XR_rQWunb4FLIRoACfNq6TshJYKwT4HZE3btHqfPiH6I6b7UJrWHTU2mwy6pjEB7m9bjZ6duZzkh6lCXH9EQ0NDLZWlxcrT1hC- -zGwam9vS8VdjIleAvIf7R1gMPUed3ts1P47CqZNG170cPHO3M0Yd2VWYsDgq8hHBYJyL7IPTaNpV1MgJZQ0TeejxN9XM6M5McwAvXvMoygJGjU13STbUd8IZBv5cH_451uVGtoD3gjIAEo2uqDAH5fyljJbnQI3s-GE9hV9Bn0MR6sChgZCLvwTalhLchem1ATXU5eG98zYhZWpB2NOqgqX3zqWx1LQevL54lVQEpB4vbsfH2AhEh6zLJpD5yHQodFrkusBFi1pBtPRCLTa64dm_2iUqYjZs3IVcsQlWNpQxZ-KiCTWwjgzCva9ayAuYhqnbwrU02af4RHUx-kVqoz_WzxMmMYk03vsFI3kC1n1ogYHeOdRRypLUQwL7qsfgsyLPXVJGjU4m1NKwnIXfFmpFpHTUc2vDlZzZR_b4G00]--></g></svg>