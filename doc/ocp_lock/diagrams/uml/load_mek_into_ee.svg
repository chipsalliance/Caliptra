<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="805px" preserveAspectRatio="none" style="width:691px;height:805px;background:#FFFFFF;" version="1.1" viewBox="0 0 691 805" width="691px" zoomAndPan="magnify"><title>Load MEK into the key cache of the encryption engine</title><defs/><g><rect fill="#DDDDDD" height="756.375" style="stroke:#181818;stroke-width:0.5;" width="437.7368" x="240.3076" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.3198" x="392.5161" y="55.3638">Encryption engine</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="427.3828" x="130.3308" y="27.9951">Load MEK into the key cache of the encryption engine</text><g><title>SFR</title><rect fill="#000000" fill-opacity="0.00000" height="636.0547" width="8" x="279.147" y="110.0234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="282.647" x2="282.647" y1="110.0234" y2="746.0781"/></g><g><title/><rect fill="#FFFFFF" height="382.9922" style="stroke:#181818;stroke-width:1;" width="10" x="277.647" y="345.0859"/></g><g><title>Control</title><rect fill="#000000" fill-opacity="0.00000" height="636.0547" width="8" x="497.5366" y="110.0234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="501.0366" x2="501.0366" y1="110.0234" y2="746.0781"/></g><g><title/><rect fill="#FFFFFF" height="59.3984" style="stroke:#181818;stroke-width:1;" width="10" x="496.0366" y="182.2891"/></g><g><title/><rect fill="#FFFFFF" height="236.1953" style="stroke:#181818;stroke-width:1;" width="10" x="496.0366" y="491.8828"/></g><g><title>Key cache</title><rect fill="#000000" fill-opacity="0.00000" height="636.0547" width="8" x="627.5498" y="110.0234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="631.0498" x2="631.0498" y1="110.0234" y2="746.0781"/></g><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76.6787" x="244.3076" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.667" x="269.3135" y="82.4248">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.6787" x="251.3076" y="98.7217">Interface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.9141" x="468.5796" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.9141" x="475.5796" y="98.7217">Control</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.9893" x="588.0552" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.9893" x="595.0552" y="98.7217">Key cache</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76.6787" x="244.3076" y="746.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.667" x="269.3135" y="766.0732">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.6787" x="251.3076" y="782.3701">Interface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.9141" x="468.5796" y="746.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.9141" x="475.5796" y="766.0732">Control</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.9893" x="588.0552" y="746.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.9893" x="595.0552" y="766.0732">Key cache</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="679.0444" x="5" y="138.5898"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="684.0444" y1="138.5898" y2="138.5898"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="684.0444" y1="141.5898" y2="141.5898"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="225.6055" x="231.7195" y="128.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="207.0796" x="237.7195" y="144.0903">Prepare for a new command</text><polygon fill="#FF0000" points="270.647,178.2891,280.647,182.2891,270.647,186.2891,274.647,182.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="276.647" y1="182.2891" y2="182.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="12" y="177.2231">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.6279" x="55.019" y="177.2231">Write Control Reg(DONE == 1b)</text><line style="stroke:#008000;stroke-width:1;" x1="494.0366" x2="484.0366" y1="182.2891" y2="178.2891"/><line style="stroke:#008000;stroke-width:1;" x1="494.0366" x2="484.0366" y1="182.2891" y2="186.2891"/><line style="stroke:#008000;stroke-width:1;" x1="282.647" x2="495.0366" y1="182.2891" y2="182.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="289.647" y="177.2231">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="332.666" y="177.2231">&#160;</text><polygon fill="#FF0000" points="293.647,237.6875,283.647,241.6875,293.647,245.6875,289.647,241.6875" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="287.647" x2="495.0366" y1="241.6875" y2="241.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="299.647" y="221.4888">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.7305" x="342.666" y="206.356">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.7617" x="346.7983" y="221.4888">Done = 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.2383" x="346.7983" y="236.6216">EXE = 0, ERROR = 0h</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="679.0444" x="5" y="270.2539"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="684.0444" y1="270.2539" y2="270.2539"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="684.0444" y1="273.2539" y2="273.2539"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="165.4868" x="261.7788" y="259.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="146.9609" x="267.7788" y="275.7544">Execute a command</text><path d="M99.0303,296.8203 L233.1704,296.8203 L233.1704,303.9531 L223.1704,313.9531 L99.0303,313.9531 L99.0303,296.8203" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="114.5313" style="stroke:#000000;stroke-width:1.5;" width="204.6167" x="99.0303" y="296.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="89.1401" x="114.0303" y="309.8872">in any order</text><polygon fill="#FF0000" points="265.647,341.0859,275.647,345.0859,265.647,349.0859,269.647,345.0859" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="271.647" y1="345.0859" y2="345.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="194.6729" y="340.02">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.9551" x="237.6919" y="340.02">MEK</text><polygon fill="#FF0000" points="265.647,370.2188,275.647,374.2188,265.647,378.2188,269.647,374.2188" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="271.647" y1="374.2188" y2="374.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="158.7642" y="369.1528">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.8638" x="201.7832" y="369.1528">Write Aux</text><polygon fill="#FF0000" points="265.647,399.3516,275.647,403.3516,265.647,407.3516,269.647,403.3516" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="271.647" y1="403.3516" y2="403.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="122.0303" y="398.2856">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.5977" x="165.0493" y="398.2856">Write Metadata</text><polygon fill="#FF0000" points="265.647,487.8828,275.647,491.8828,265.647,495.8828,269.647,491.8828" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="271.647" y1="491.8828" y2="491.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="103.0635" y="464.1177">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.7305" x="146.0825" y="441.4185">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.5645" x="146.0825" y="456.5513">(EXE = Load_MEK,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.7417" x="150.2148" y="471.6841">DONE = 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.8335" x="150.2148" y="486.8169">EXE = 1)</text><line style="stroke:#008000;stroke-width:1;" x1="494.0366" x2="484.0366" y1="491.8828" y2="487.8828"/><line style="stroke:#008000;stroke-width:1;" x1="494.0366" x2="484.0366" y1="491.8828" y2="495.8828"/><line style="stroke:#008000;stroke-width:1;" x1="287.647" x2="495.0366" y1="491.8828" y2="491.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="294.647" y="486.8169">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="337.666" y="486.8169">&#160;</text><path d="M266.647,503.8828 L394.376,503.8828 L394.376,511.0156 L384.376,521.0156 L266.647,521.0156 L266.647,503.8828" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="114.5313" style="stroke:#000000;stroke-width:1.5;" width="250.3896" x="266.647" y="503.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="82.729" x="281.647" y="516.9497">in any oder</text><polygon fill="#FF0000" points="298.647,548.1484,288.647,552.1484,298.647,556.1484,294.647,552.1484" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="292.647" x2="495.0366" y1="552.1484" y2="552.1484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="304.647" y="547.0825">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65.3364" x="347.666" y="547.0825">Read MEK</text><polygon fill="#FF0000" points="298.647,577.2813,288.647,581.2813,298.647,585.2813,294.647,581.2813" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="292.647" x2="495.0366" y1="581.2813" y2="581.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="304.647" y="576.2153">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6953" x="347.666" y="576.2153">Read AUX</text><polygon fill="#FF0000" points="298.647,606.4141,288.647,610.4141,298.647,614.4141,294.647,610.4141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="292.647" x2="495.0366" y1="610.4141" y2="610.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="304.647" y="605.3481">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9409" x="347.666" y="605.3481">Read Metadata</text><polygon fill="#FF0000" points="619.0498,649.5469,629.0498,653.5469,619.0498,657.5469,623.0498,653.5469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="506.0366" x2="625.0498" y1="653.5469" y2="653.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="513.0366" y="648.481">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.9941" x="556.0557" y="648.481">Store Key</text><polygon fill="#FF0000" points="298.647,724.0781,288.647,728.0781,298.647,732.0781,294.647,728.0781" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="292.647" x2="495.0366" y1="728.0781" y2="728.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="304.647" y="700.313">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.7305" x="347.666" y="677.6138">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.0854" x="347.666" y="692.7466">(Done = 1b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.7622" x="351.7983" y="707.8794">Error = 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.8335" x="351.7983" y="723.0122">EXE = 0)</text><!--SRC=[ZLBTQy8m47_FNt6AZ4hdcA-3FiZiatEERcF2X1BJgmPhhgGfslz-Pzpy6CgMfn-Nkzpl8orjL55d2AJAj22rIckdY-gEoqAqT0v1frhI9dNQ5TWLmETj1w7zH3A3SJm2RHo1MoAii04b5IFAVG6DiatfD1c62ssmBLfeCfqB4KNmOh6K5Y4d2n8CRa3HUYrD1b4an6UdQeo2AhVm01zMEuH7CivI0GakWk7aEUO-wC-xuiPtTQGVG0n38H3XCD_hNNfXPc181Y62-rl6yJJs4E8acIGxkFGauosgcYVb6Rc5fRfauI1D0sGpjDwP8-Smv9ripg_oWSYWtbwx6gEJcNHIi5D_k30pmPxtBekKr-sKx9qvLTM_QD6vXXy9fyRnoWJt8L-z6xnFhy-TAZb6ibBSyEg8enzXyx-iWk-i-dClorh-C-V9TOKV5ry0]--></g></svg>