<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="675px" preserveAspectRatio="none" style="width:920px;height:675px;background:#FFFFFF;" version="1.1" viewBox="0 0 920 675" width="920px" zoomAndPan="magnify"><title>Enumerate KEM Handles</title><defs/><g><rect fill="#DDDDDD" height="626.1719" style="stroke:#181818;stroke-width:0.5;" width="264.9175" x="254.7671" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="358.2615" y="55.3638">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="193.9902" x="364.2947" y="27.9951">Enumerate KEM Handles</text><g><title>Storage</title><rect fill="#000000" fill-opacity="0.00000" height="473.2578" width="8" x="35.8882" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="39.3882" x2="39.3882" y1="126.3203" y2="599.5781"/></g><g><title/><rect fill="#FFFFFF" height="117.6641" style="stroke:#181818;stroke-width:1;" width="10" x="34.3882" y="481.9141"/></g><g><title>Mail Box</title><rect fill="#000000" fill-opacity="0.00000" height="473.2578" width="8" x="291.9385" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="295.4385" x2="295.4385" y1="126.3203" y2="599.5781"/></g><g><title/><rect fill="#FFFFFF" height="112.5313" style="stroke:#181818;stroke-width:1;" width="10" x="290.4385" y="205.7188"/></g><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="473.2578" width="8" x="494.2368" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="497.7368" x2="497.7368" y1="126.3203" y2="599.5781"/></g><g><title/><rect fill="#FFFFFF" height="192.7969" style="stroke:#181818;stroke-width:1;" width="10" x="492.7368" y="289.1172"/></g><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="5" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="12" y="82.4248">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="15.4487" y="98.7217">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="28.4404" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="258.7671" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="265.7671" y="115.0186">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="479.7891" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="486.7891" y="115.0186">FW</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="5" y="599.5781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="12" y="619.5732">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="15.4487" y="635.8701">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="28.4404" y="652.167">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="258.7671" y="599.5781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="265.7671" y="619.5732">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="479.7891" y="599.5781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="486.7891" y="619.5732">FW</text><path d="M18.2202,139.3203 L18.2202,179.3203 L518.2202,179.3203 L518.2202,149.3203 L508.2202,139.3203 L18.2202,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M508.2202,139.3203 L508.2202,149.3203 L518.2202,149.3203 L508.2202,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.2026" x="69.2085" y="156.3872">Preconditions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="381.4434" x="77.4731" y="171.52">* Caliptra FW manages which keys are in which slots in KV</text><line style="stroke:#008000;stroke-width:1;" x1="288.4385" x2="278.4385" y1="205.7188" y2="201.7188"/><line style="stroke:#008000;stroke-width:1;" x1="288.4385" x2="278.4385" y1="205.7188" y2="209.7188"/><line style="stroke:#008000;stroke-width:1;" x1="39.3882" x2="289.4385" y1="205.7188" y2="205.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="46.3882" y="200.6528">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.0313" x="89.4072" y="200.6528">ENUMERATE_KEM_HANDLES</text><path d="M181.9097,218.7188 L181.9097,262.7188 L408.9097,262.7188 L408.9097,228.7188 L398.9097,218.7188 L181.9097,218.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M398.9097,218.7188 L398.9097,228.7188 L408.9097,228.7188 L398.9097,218.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="187.9097" y="237.7856">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="192.042" y="237.7856">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="255.0298" y="237.7856">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="259.1621" y="237.7856">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="304.605" y="237.7856">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="308.7373" y="237.7856">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="192.042" y="252.9185">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="259.1621" y="252.9185">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="308.7373" y="252.9185">Little endian</text><line style="stroke:#000000;stroke-width:0.5;" x1="187.9097" x2="393.9673" y1="225.7188" y2="225.7188"/><line style="stroke:#000000;stroke-width:0.5;" x1="187.9097" x2="393.9673" y1="240.8516" y2="240.8516"/><line style="stroke:#000000;stroke-width:0.5;" x1="187.9097" x2="393.9673" y1="255.9844" y2="255.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="187.9097" x2="187.9097" y1="225.7188" y2="255.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="255.0298" x2="255.0298" y1="225.7188" y2="255.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="304.605" x2="304.605" y1="225.7188" y2="255.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="393.9673" x2="393.9673" y1="225.7188" y2="255.9844"/><line style="stroke:#008000;stroke-width:1;" x1="490.7368" x2="480.7368" y1="289.1172" y2="285.1172"/><line style="stroke:#008000;stroke-width:1;" x1="490.7368" x2="480.7368" y1="289.1172" y2="293.1172"/><line style="stroke:#008000;stroke-width:1;" x1="300.4385" x2="491.7368" y1="289.1172" y2="289.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="307.4385" y="284.0513">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.9766" x="350.4575" y="284.0513">Message</text><polygon fill="#FF0000" points="311.4385,314.25,301.4385,318.25,311.4385,322.25,307.4385,318.25" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="305.4385" x2="491.7368" y1="318.25" y2="318.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="317.4385" y="313.1841">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.7251" x="360.4575" y="313.1841">Get message</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.7368" x2="544.7368" y1="347.3828" y2="347.3828"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.7368" x2="544.7368" y1="347.3828" y2="360.3828"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.7368" x2="544.7368" y1="360.3828" y2="360.3828"/><polygon fill="#FF0000" points="513.7368,356.3828,503.7368,360.3828,513.7368,364.3828,509.7368,360.3828" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="509.7368" y="342.3169">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.5171" x="552.7559" y="342.3169">Determine message</text><line style="stroke:#FF0000;stroke-width:1;" x1="502.7368" x2="544.7368" y1="389.5156" y2="389.5156"/><line style="stroke:#FF0000;stroke-width:1;" x1="544.7368" x2="544.7368" y1="389.5156" y2="402.5156"/><line style="stroke:#FF0000;stroke-width:1;" x1="503.7368" x2="544.7368" y1="402.5156" y2="402.5156"/><polygon fill="#FF0000" points="513.7368,398.5156,503.7368,402.5156,513.7368,406.5156,509.7368,402.5156" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="509.7368" y="384.4497">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.937" x="552.7559" y="384.4497">Create list of valid KEM handles</text><path d="M507.7368,415.5156 L507.7368,440.5156 L829.7368,440.5156 L829.7368,425.5156 L819.7368,415.5156 L507.7368,415.5156" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M819.7368,415.5156 L819.7368,425.5156 L829.7368,425.5156 L819.7368,415.5156" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="301.6533" x="513.7368" y="432.5825">One handle for each KEM algorithm supported</text><polygon fill="#FF0000" points="306.4385,477.9141,296.4385,481.9141,306.4385,485.9141,302.4385,481.9141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="300.4385" x2="491.7368" y1="481.9141" y2="481.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="312.4385" y="469.2817">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2793" x="355.4575" y="461.7153">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.7695" x="355.4575" y="476.8481">kem_handles</text><line style="stroke:#008000;stroke-width:1;" x1="45.3882" x2="55.3882" y1="481.9141" y2="477.9141"/><line style="stroke:#008000;stroke-width:1;" x1="45.3882" x2="55.3882" y1="481.9141" y2="485.9141"/><line style="stroke:#008000;stroke-width:1;" x1="44.3882" x2="294.4385" y1="481.9141" y2="481.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="61.3882" y="469.2817">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="104.4072" y="461.7153">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.7217" x="104.4072" y="476.8481">complete</text><path d="M300.4385,494.9141 L300.4385,583.9141 L913.4385,583.9141 L913.4385,504.9141 L903.4385,494.9141 L300.4385,494.9141" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M903.4385,494.9141 L903.4385,504.9141 L913.4385,504.9141 L903.4385,494.9141" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="306.4385" y="513.981">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="310.5708" y="513.981">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="436.8765" y="513.981">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="441.0088" y="513.981">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="538.8071" y="513.981">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="542.9395" y="513.981">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="310.5708" y="529.1138">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="441.0088" y="529.1138">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="542.9395" y="529.1138">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6592" x="310.5708" y="544.2466">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="441.0088" y="544.2466">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.5078" x="542.9395" y="544.2466">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.1733" x="310.5708" y="559.3794">kem_handle_count</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="441.0088" y="559.3794">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.1846" x="542.9395" y="559.3794">Number of KEM handles (N)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.7695" x="310.5708" y="574.5122">kem_handles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.666" x="441.0088" y="574.5122">KEMHandle[N]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.894" x="542.9395" y="574.5122">List of (KEM handle value, KEM algorithm) tuples</text><line style="stroke:#000000;stroke-width:0.5;" x1="306.4385" x2="898.5796" y1="501.9141" y2="501.9141"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.4385" x2="898.5796" y1="517.0469" y2="517.0469"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.4385" x2="898.5796" y1="532.1797" y2="532.1797"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.4385" x2="898.5796" y1="547.3125" y2="547.3125"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.4385" x2="898.5796" y1="562.4453" y2="562.4453"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.4385" x2="898.5796" y1="577.5781" y2="577.5781"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.4385" x2="306.4385" y1="501.9141" y2="577.5781"/><line style="stroke:#000000;stroke-width:0.5;" x1="436.8765" x2="436.8765" y1="501.9141" y2="577.5781"/><line style="stroke:#000000;stroke-width:0.5;" x1="538.8071" x2="538.8071" y1="501.9141" y2="577.5781"/><line style="stroke:#000000;stroke-width:0.5;" x1="898.5796" x2="898.5796" y1="501.9141" y2="577.5781"/><!--SRC=[XLJRJXj137tVhp1HL2K5MgbzYn0I8g4W8A12suTIhIQptkmeSzDubeYAZwzdTtChqCwJr-DZ7zjdTazPgUi2mKcVQoSNUHsLfW_iph8zLSAWJvLRvb55ZSCC-Dmd4teJMniC8Y9SJgxXNDX28_MoFRI5AdUmFg1qjcZHrZ52oE28ckzqZcR7jssCYifP6Xrzd1slRm7UmwdGoiSWuEm7667570cMbP8LBF29G0G4PJiFQHSfVLv-Rt8meQRgcbgvXBwW9ol1pFRtOGIJwRVhoTUJ-qdEhUJd9zFnrUHkfmNXrHPzzuY1iMk6pwc3CuMwQCqxzHjRQuobiarJyBmLBgi5rQOnwy-VEkULYccmYQHOXR_WRcOhxh9SDkIlaOZdaMKxX0tDSoy2AJjlYSlKTTSqexvW1DCXqxMP7HusHfzGbuCUX_SEe3V6YC4eYwlWtf2fQDe2hPXbcmfiZU0qO1A7LXJ1bV386omQgLIjLB9cb47DgvW0JS8RBjHUG-a2eE1r9eZGSnTKh0nGxRqB4OjiFPhihzPEdM69512GF8i97-m2JRwg-Wus8-mcs04Uh7J6QqmftzvzI_ZrvU-u6X5iFl-dX8rhfOX_oAAzAPMddAA8DRs1lM2Gv2tmSoWXLWYocuqYEBkulGFXVM0r5y3JvkmO0XlRDJQZowMhRNnPOrgR6Jy7Nl7MSc4m7RwHPysLmzk_ni_fhwRFLYY3JPeacXeFTYKmX5ZxbERr5y9YO56cymS0]--></g></svg>