<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="680px" preserveAspectRatio="none" style="width:882px;height:680px;background:#FFFFFF;" version="1.1" viewBox="0 0 882 680" width="882px" zoomAndPan="magnify"><title>Enumerate KEM Handles</title><defs/><g><rect fill="#DDDDDD" height="630.5195" style="stroke:#181818;stroke-width:0.5;" width="254.9697" x="241.1982" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="342.2864" y="56.0566">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="175.6289" x="355.1697" y="28.5352">Enumerate KEM Handles</text><g><title>Storage</title><rect fill="transparent" height="476.2793" width="8" x="34.1826" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37.6826" x2="37.6826" y1="127.2637" y2="603.543"/></g><g><title/><rect fill="#FFFFFF" height="118.5527" style="stroke:#181818;stroke-width:1;" width="10" x="32.6826" y="484.9902"/></g><g><title>Mail Box</title><rect fill="transparent" height="476.2793" width="8" x="277.4741" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="280.9741" x2="280.9741" y1="127.2637" y2="603.543"/></g><g><title/><rect fill="#FFFFFF" height="113.2422" style="stroke:#181818;stroke-width:1;" width="10" x="275.9741" y="207.1953"/></g><g><title>FW</title><rect fill="transparent" height="476.2793" width="8" x="471.9268" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="475.4268" x2="475.4268" y1="127.2637" y2="603.543"/></g><g><title/><rect fill="#FFFFFF" height="193.8633" style="stroke:#181818;stroke-width:1;" width="10" x="470.4268" y="291.127"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="83.334">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="99.8223">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="116.3105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="245.1982" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="252.1982" y="116.3105">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="458.6855" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="465.6855" y="116.3105">FW</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="603.543"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="624.0781">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="640.5664">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="657.0547">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="245.1982" y="603.543"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="252.1982" y="624.0781">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="458.6855" y="603.543"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="465.6855" y="624.0781">FW</text><path d="M17.9707,140.2637 L17.9707,180.2637 L494.9707,180.2637 L494.9707,150.2637 L484.9707,140.2637 L17.9707,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M484.9707,140.2637 L484.9707,150.2637 L494.9707,150.2637 L484.9707,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="64.437" y="157.832">Preconditions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.0088" x="72.6636" y="173.1426">* Caliptra FW manages which keys are in which slots in KV</text><line style="stroke:#008000;stroke-width:1;" x1="273.9741" x2="263.9741" y1="207.1953" y2="203.1953"/><line style="stroke:#008000;stroke-width:1;" x1="273.9741" x2="263.9741" y1="207.1953" y2="211.1953"/><line style="stroke:#008000;stroke-width:1;" x1="37.6826" x2="274.9741" y1="207.1953" y2="207.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="44.6826" y="202.4531">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.9287" x="84.0454" y="202.4531">ENUMERATE_KEM_HANDLES</text><path d="M169.9495,220.1953 L169.9495,264.1953 L391.9495,264.1953 L391.9495,230.1953 L381.9495,220.1953 L169.9495,220.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M381.9495,220.1953 L381.9495,230.1953 L391.9495,230.1953 L381.9495,220.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="175.9495" y="239.7637">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="180.0627" y="239.7637">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="241.5588" y="239.7637">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="245.6721" y="239.7637">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="290.7468" y="239.7637">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="294.8601" y="239.7637">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="180.0627" y="255.0742">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="245.6721" y="255.0742">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="294.8601" y="255.0742">Little endian</text><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="376.9988" y1="227.1953" y2="227.1953"/><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="376.9988" y1="242.5059" y2="242.5059"/><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="376.9988" y1="257.8164" y2="257.8164"/><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="175.9495" y1="227.1953" y2="257.8164"/><line style="stroke:#000000;stroke-width:0.5;" x1="241.5588" x2="241.5588" y1="227.1953" y2="257.8164"/><line style="stroke:#000000;stroke-width:0.5;" x1="290.7468" x2="290.7468" y1="227.1953" y2="257.8164"/><line style="stroke:#000000;stroke-width:0.5;" x1="376.9988" x2="376.9988" y1="227.1953" y2="257.8164"/><line style="stroke:#008000;stroke-width:1;" x1="468.4268" x2="458.4268" y1="291.127" y2="287.127"/><line style="stroke:#008000;stroke-width:1;" x1="468.4268" x2="458.4268" y1="291.127" y2="295.127"/><line style="stroke:#008000;stroke-width:1;" x1="285.9741" x2="469.4268" y1="291.127" y2="291.127"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="292.9741" y="286.3848">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.2217" x="332.3369" y="286.3848">Message</text><polygon fill="#FF0000" points="296.9741,316.4375,286.9741,320.4375,296.9741,324.4375,292.9741,320.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="290.9741" x2="469.4268" y1="320.4375" y2="320.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="302.9741" y="315.6953">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.7739" x="342.3369" y="315.6953">Get message</text><line style="stroke:#FF0000;stroke-width:1;" x1="480.4268" x2="522.4268" y1="349.748" y2="349.748"/><line style="stroke:#FF0000;stroke-width:1;" x1="522.4268" x2="522.4268" y1="349.748" y2="362.748"/><line style="stroke:#FF0000;stroke-width:1;" x1="481.4268" x2="522.4268" y1="362.748" y2="362.748"/><polygon fill="#FF0000" points="491.4268,358.748,481.4268,362.748,491.4268,366.748,487.4268,362.748" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="487.4268" y="345.0059">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.8838" x="526.7896" y="345.0059">Determine message</text><line style="stroke:#FF0000;stroke-width:1;" x1="480.4268" x2="522.4268" y1="392.0586" y2="392.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="522.4268" x2="522.4268" y1="392.0586" y2="405.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="481.4268" x2="522.4268" y1="405.0586" y2="405.0586"/><polygon fill="#FF0000" points="491.4268,401.0586,481.4268,405.0586,491.4268,409.0586,487.4268,405.0586" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="487.4268" y="387.3164">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.6372" x="526.7896" y="387.3164">Create list of valid KEM handles</text><path d="M485.4268,418.0586 L485.4268,443.0586 L798.4268,443.0586 L798.4268,428.0586 L788.4268,418.0586 L485.4268,418.0586 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M788.4268,418.0586 L788.4268,428.0586 L798.4268,428.0586 L788.4268,418.0586 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.373" x="491.4268" y="435.627">One handle for each KEM algorithm supported</text><polygon fill="#FF0000" points="291.9741,480.9902,281.9741,484.9902,291.9741,488.9902,287.9741,484.9902" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="285.9741" x2="469.4268" y1="484.9902" y2="484.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="297.9741" y="472.5928">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="337.3369" y="464.9375">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6021" x="337.3369" y="480.248">kem_handles</text><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="484.9902" y2="480.9902"/><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="484.9902" y2="488.9902"/><line style="stroke:#008000;stroke-width:1;" x1="42.6826" x2="279.9741" y1="484.9902" y2="484.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="59.6826" y="472.5928">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="99.0454" y="464.9375">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="99.0454" y="480.248">complete</text><path d="M285.9741,497.9902 L285.9741,587.9902 L875.9741,587.9902 L875.9741,507.9902 L865.9741,497.9902 L285.9741,497.9902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M865.9741,497.9902 L865.9741,507.9902 L875.9741,507.9902 L865.9741,497.9902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="291.9741" y="517.5586">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="296.0874" y="517.5586">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="418.3179" y="517.5586">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="422.4312" y="517.5586">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="515.3164" y="517.5586">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="519.4297" y="517.5586">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="296.0874" y="532.8691">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="422.4312" y="532.8691">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="519.4297" y="532.8691">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="296.0874" y="548.1797">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="422.4312" y="548.1797">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="519.4297" y="548.1797">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.1172" x="296.0874" y="563.4902">kem_handle_count</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="422.4312" y="563.4902">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.6846" x="519.4297" y="563.4902">Number of KEM handles (N)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6021" x="296.0874" y="578.8008">kem_handles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.772" x="422.4312" y="578.8008">KEMHandle[N]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.1509" x="519.4297" y="578.8008">List of (KEM handle value, KEM algorithm) tuples</text><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="504.9902" y2="504.9902"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="520.3008" y2="520.3008"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="535.6113" y2="535.6113"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="550.9219" y2="550.9219"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="566.2324" y2="566.2324"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="581.543" y2="581.543"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="291.9741" y1="504.9902" y2="581.543"/><line style="stroke:#000000;stroke-width:0.5;" x1="418.3179" x2="418.3179" y1="504.9902" y2="581.543"/><line style="stroke:#000000;stroke-width:0.5;" x1="515.3164" x2="515.3164" y1="504.9902" y2="581.543"/><line style="stroke:#000000;stroke-width:0.5;" x1="861.9683" x2="861.9683" y1="504.9902" y2="581.543"/><!--SRC=[XLJRJXj137tVhp1HL2K5MgbzYn0I8g4W8A12suTIhIQptkmeSzDubeYAZwzdTtChqCwJr-DZ7zjdTazPgUi2mKcVQoSNUHsLfW_iph8zLSAWJvLRvb55ZSCC-Dmd4teJMniC8Y9SJgxXNDX28_MoFRI5AdUmFg1qjcZHrZ52oE28ckzqZcR7jssCYifP6Xrzd1slRm7UmwdGoiSWuEm7667570cMbP8LBF29G0G4PJiFQHSfVLv-Rt8meQRgcbgvXBwW9ol1pFRtOGIJwRVhoTUJ-qdEhUJd9zFnrUHkfmNXrHPzzuY1iMk6pwc3CuMwQCqxzHjRQuobiarJyBmLBgi5rQOnwy-VEkULYccmYQHOXR_WRcOhxh9SDkIlaOZdaMKxX0tDSoy2AJjlYSlKTTSqexvW1DCXqxMP7HusHfzGbuCUX_SEe3V6YC4eYwlWtf2fQDe2hPXbcmfiZU0qO1A7LXJ1bV386omQgLIjLB9cb47DgvW0JS8RBjHUG-a2eE1r9eZGSnTKh0nGxRqB4OjiFPhihzPEdM69512GF8i97-m2JRwg-Wus8-mcs04Uh7J6QqmftzvzI_ZrvU-u6X5iFl-dX8rhfOX_oAAzAPMddAA8DRs1lM2Gv2tmSoWXLWYocuqYEBkulGFXVM0r5y3JvkmO0XlRDJQZowMhRNnPOrgR6Jy7Nl7MSc4m7RwHPysLmzk_ni_fhwRFLYY3JPeacXeFTYKmX5ZxbERr5y9YO56cymS0]--></g></svg>