<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1385px" preserveAspectRatio="none" style="width:1635px;height:1385px;background:#FFFFFF;" version="1.1" viewBox="0 0 1635 1385" width="1635px" zoomAndPan="magnify"><title>OCP L.O.C.K. Power On</title><defs/><g><rect fill="#DDDDDD" height="1336.3672" style="stroke:#181818;stroke-width:0.5;" width="1517.3281" x="104.6992" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="834.3989" y="55.3638">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="181.3574" x="725.335" y="27.9951">OCP L.O.C.K. Power On</text><g><title>ROM</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="128.6123" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="132.1123" x2="132.1123" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="132.1123" x2="132.1123" y1="1099.8438" y2="1127.8438"/><g><title>ROM</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="128.6123" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="132.1123" x2="132.1123" y1="1127.8438" y2="1309.7734"/></g><g><title/><rect fill="#FFFFFF" height="924.3906" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="127.1123" y="175.4531"/><line style="stroke:#181818;stroke-width:1;" x1="127.1123" x2="127.1123" y1="175.4531" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="137.1123" x2="137.1123" y1="175.4531" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="127.1123" x2="137.1123" y1="175.4531" y2="175.4531"/></g><g><title/><rect fill="#FFFFFF" height="21.1328" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="127.1123" y="1127.8438"/><line style="stroke:#181818;stroke-width:1;" x1="127.1123" x2="127.1123" y1="1127.8438" y2="1148.9766"/><line style="stroke:#181818;stroke-width:1;" x1="137.1123" x2="137.1123" y1="1127.8438" y2="1148.9766"/><line style="stroke:#181818;stroke-width:1;" x1="127.1123" x2="137.1123" y1="1148.9766" y2="1148.9766"/></g><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="336.0522" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="339.5522" x2="339.5522" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="339.5522" x2="339.5522" y1="1099.8438" y2="1127.8438"/><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="336.0522" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="339.5522" x2="339.5522" y1="1127.8438" y2="1309.7734"/></g><g><title/><rect fill="#FFFFFF" height="155.7969" style="stroke:#181818;stroke-width:1;" width="10" x="334.5522" y="1148.9766"/></g><g><title>DRBG</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="657.6206" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="661.1206" x2="661.1206" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="661.1206" x2="661.1206" y1="1099.8438" y2="1127.8438"/><g><title>DRBG</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="657.6206" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="661.1206" x2="661.1206" y1="1127.8438" y2="1309.7734"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="953.9277" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="957.4277" x2="957.4277" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="957.4277" x2="957.4277" y1="1099.8438" y2="1127.8438"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="953.9277" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="957.4277" x2="957.4277" y1="1127.8438" y2="1309.7734"/></g><g><title/><rect fill="#FFFFFF" height="292.7344" style="stroke:#181818;stroke-width:1;" width="10" x="952.4277" y="247.7188"/></g><g><title/><rect fill="#FFFFFF" height="108.5313" style="stroke:#181818;stroke-width:1;" width="10" x="952.4277" y="685.9844"/></g><g><title/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1;" width="10" x="952.4277" y="1004.4453"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="1137.1426" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1140.6426" x2="1140.6426" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1140.6426" x2="1140.6426" y1="1099.8438" y2="1127.8438"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="1137.1426" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1140.6426" x2="1140.6426" y1="1127.8438" y2="1309.7734"/></g><g><title/><rect fill="#ADD8E6" height="945.5234" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1135.6426" y="154.3203"/><line style="stroke:#181818;stroke-width:1;" x1="1135.6426" x2="1135.6426" y1="154.3203" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1145.6426" x2="1145.6426" y1="154.3203" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1135.6426" x2="1145.6426" y1="154.3203" y2="154.3203"/></g><g><title/><rect fill="#ADD8E6" height="181.9297" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1135.6426" y="1127.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1135.6426" x2="1135.6426" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1145.6426" x2="1145.6426" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1135.6426" x2="1145.6426" y1="1309.7734" y2="1309.7734"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="1228.0801" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1231.5801" x2="1231.5801" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1231.5801" x2="1231.5801" y1="1099.8438" y2="1127.8438"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="1228.0801" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1231.5801" x2="1231.5801" y1="1127.8438" y2="1309.7734"/></g><g><title/><rect fill="#ADD8E6" height="717.5938" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1226.5801" y="382.25"/><line style="stroke:#181818;stroke-width:1;" x1="1226.5801" x2="1226.5801" y1="382.25" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1236.5801" x2="1236.5801" y1="382.25" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1226.5801" x2="1236.5801" y1="382.25" y2="382.25"/></g><g><title/><rect fill="#ADD8E6" height="181.9297" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1226.5801" y="1127.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1226.5801" x2="1226.5801" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1236.5801" x2="1236.5801" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1226.5801" x2="1236.5801" y1="1309.7734" y2="1309.7734"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="1385.2031" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1388.7031" x2="1388.7031" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1388.7031" x2="1388.7031" y1="1099.8438" y2="1127.8438"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="1385.2031" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1388.7031" x2="1388.7031" y1="1127.8438" y2="1309.7734"/></g><g><title/><rect fill="#ADD8E6" height="37.1328" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1383.7031" y="1062.7109"/><line style="stroke:#181818;stroke-width:1;" x1="1383.7031" x2="1383.7031" y1="1062.7109" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1393.7031" x2="1393.7031" y1="1062.7109" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1383.7031" x2="1393.7031" y1="1062.7109" y2="1062.7109"/></g><g><title/><rect fill="#ADD8E6" height="181.9297" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1383.7031" y="1127.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1383.7031" x2="1383.7031" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1393.7031" x2="1393.7031" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1383.7031" x2="1393.7031" y1="1309.7734" y2="1309.7734"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="973.5234" width="8" x="1558.1924" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1561.6924" x2="1561.6924" y1="126.3203" y2="1099.8438"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1561.6924" x2="1561.6924" y1="1099.8438" y2="1127.8438"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="181.9297" width="8" x="1558.1924" y="1127.8438"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1561.6924" x2="1561.6924" y1="1127.8438" y2="1309.7734"/></g><g><title/><rect fill="#ADD8E6" height="334.4609" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1556.6924" y="765.3828"/><line style="stroke:#181818;stroke-width:1;" x1="1556.6924" x2="1556.6924" y1="765.3828" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1566.6924" x2="1566.6924" y1="765.3828" y2="1099.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1556.6924" x2="1566.6924" y1="765.3828" y2="765.3828"/></g><g><title/><rect fill="#ADD8E6" height="181.9297" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1556.6924" y="1127.8438"/><line style="stroke:#181818;stroke-width:1;" x1="1556.6924" x2="1556.6924" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1566.6924" x2="1566.6924" y1="1127.8438" y2="1309.7734"/><line style="stroke:#181818;stroke-width:1;" x1="1556.6924" x2="1566.6924" y1="1309.7734" y2="1309.7734"/></g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.8262" x="108.6992" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.8262" x="115.6992" y="115.0186">ROM</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="321.6045" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="328.6045" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.9609" x="633.6401" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.9609" x="640.6401" y="115.0186">DRBG</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="916.959" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="923.959" y="115.0186">Key Vault</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1100.1738" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1107.1738" y="98.7217">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.127" x="1120.5791" y="115.0186">Fuses</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1191.1113" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1198.1113" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1211.1509" y="98.7217">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1211.8413" y="115.0186">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213.3086" x="1282.0488" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1355.2344" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8857" x="1368.2603" y="98.7217">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199.3086" x="1289.0488" y="115.0186">(Ready MPK Encryption Key)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1505.3574" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1528.2236" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1540.6274" y="98.7217">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1512.3574" y="115.0186">(KEM Keypair)</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="46.8262" x="108.6992" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.8262" x="115.6992" y="1329.7686">ROM</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="321.6045" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="328.6045" y="1329.7686">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.9609" x="633.6401" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.9609" x="640.6401" y="1329.7686">DRBG</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="916.959" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="923.959" y="1329.7686">Key Vault</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1100.1738" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1107.1738" y="1329.7686">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.127" x="1120.5791" y="1346.0654">Fuses</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1191.1113" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1198.1113" y="1329.7686">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1211.1509" y="1346.0654">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1211.8413" y="1362.3623">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213.3086" x="1282.0488" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1355.2344" y="1329.7686">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8857" x="1368.2603" y="1346.0654">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199.3086" x="1289.0488" y="1362.3623">(Ready MPK Encryption Key)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1505.3574" y="1309.7734"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1528.2236" y="1329.7686">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1540.6274" y="1346.0654">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1512.3574" y="1362.3623">(KEM Keypair)</text><path d="M97.2383,139.3203 L97.2383,149.3203 L1596.2383,149.3203 L1596.2383,149.3203 L1586.2383,139.3203 L97.2383,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1586.2383,139.3203 L1586.2383,149.3203 L1596.2383,149.3203 L1586.2383,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#008000;stroke-width:1;" x1="125.1123" x2="115.1123" y1="175.4531" y2="171.4531"/><line style="stroke:#008000;stroke-width:1;" x1="125.1123" x2="115.1123" y1="175.4531" y2="179.4531"/><line style="stroke:#008000;stroke-width:1;" x1="5" x2="126.1123" y1="175.4531" y2="175.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="12" y="170.3872">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.0933" x="55.019" y="170.3872">Power on</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1623.0273" x="5" y="204.0195"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="204.0195" y2="204.0195"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="207.0195" y2="207.0195"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="198.9897" x="717.0188" y="193.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="175.938" x="723.0188" y="209.52">Load a KV slot with HEK</text><polygon fill="#FF0000" points="940.4277,243.7188,950.4277,247.7188,940.4277,251.7188,944.4277,247.7188" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="137.1123" x2="946.4277" y1="247.7188" y2="247.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="144.1123" y="242.6528">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.8613" x="187.1313" y="242.6528">load_hek(Key: Slot A)</text><path d="M941.4277,259.7188 L1018.0518,259.7188 L1018.0518,266.8516 L1008.0518,276.8516 L941.4277,276.8516 L941.4277,259.7188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="56.2656" style="stroke:#000000;stroke-width:1.5;" width="425.1362" x="941.4277" y="259.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="956.4277" y="272.7856">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="317.5122" x="1033.0518" y="271.9292">[through fuses entries until valid fuse entry found]</text><polygon fill="#FF0000" points="1123.6426,303.9844,1133.6426,307.9844,1123.6426,311.9844,1127.6426,307.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="962.4277" x2="1129.6426" y1="307.9844" y2="307.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="969.4277" y="302.9185">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.0122" x="1012.4468" y="302.9185">get next entry</text><path d="M941.4277,333.9844 L1005.8706,333.9844 L1005.8706,341.1172 L995.8706,351.1172 L941.4277,351.1172 L941.4277,333.9844" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="171.3359" style="stroke:#000000;stroke-width:1.5;" width="311.1523" x="941.4277" y="333.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="956.4277" y="347.0513">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="100.6758" x="1020.8706" y="346.1948">[if a valid entry]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="941.4277" x2="1252.5801" y1="443.3828" y2="443.3828"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="97.6304" x="946.4277" y="455.5933">[No valid entry]</text><polygon fill="#FF0000" points="1214.5801,378.25,1224.5801,382.25,1214.5801,386.25,1218.5801,382.25" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="962.4277" x2="1220.5801" y1="382.25" y2="382.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="969.4277" y="377.1841">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.8223" x="1012.4468" y="377.1841">Put HEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="962.4277" x2="1004.4277" y1="411.3828" y2="411.3828"/><line style="stroke:#FF0000;stroke-width:1;" x1="1004.4277" x2="1004.4277" y1="411.3828" y2="424.3828"/><line style="stroke:#FF0000;stroke-width:1;" x1="963.4277" x2="1004.4277" y1="424.3828" y2="424.3828"/><polygon fill="#FF0000" points="973.4277,420.3828,963.4277,424.3828,973.4277,428.3828,969.4277,424.3828" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="969.4277" y="406.3169">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.8921" x="1012.4468" y="406.3169">hek_exists = True</text><line style="stroke:#FF0000;stroke-width:1;" x1="962.4277" x2="1004.4277" y1="484.3203" y2="484.3203"/><line style="stroke:#FF0000;stroke-width:1;" x1="1004.4277" x2="1004.4277" y1="484.3203" y2="497.3203"/><line style="stroke:#FF0000;stroke-width:1;" x1="963.4277" x2="1004.4277" y1="497.3203" y2="497.3203"/><polygon fill="#FF0000" points="973.4277,493.3203,963.4277,497.3203,973.4277,501.3203,969.4277,497.3203" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="969.4277" y="479.2544">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.1958" x="1012.4468" y="479.2544">hek_exists = False</text><polygon fill="#FF0000" points="148.1123,536.4531,138.1123,540.4531,148.1123,544.4531,144.1123,540.4531" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="142.1123" x2="951.4277" y1="540.4531" y2="540.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="154.1123" y="535.3872">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.2119" x="197.1313" y="535.3872">hek_exists</text><line style="stroke:#FF0000;stroke-width:1;" x1="137.1123" x2="179.1123" y1="569.5859" y2="569.5859"/><line style="stroke:#FF0000;stroke-width:1;" x1="179.1123" x2="179.1123" y1="569.5859" y2="582.5859"/><line style="stroke:#FF0000;stroke-width:1;" x1="138.1123" x2="179.1123" y1="582.5859" y2="582.5859"/><polygon fill="#FF0000" points="148.1123,578.5859,138.1123,582.5859,148.1123,586.5859,144.1123,582.5859" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="144.1123" y="564.52">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.2896" x="187.1313" y="564.52">Retain hek_exists</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1623.0273" x="5" y="611.1523"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="611.1523" y2="611.1523"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="614.1523" y2="614.1523"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="457.7456" x="587.6409" y="600.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="434.6938" x="593.6409" y="616.6528">Load a KV slot with KEM for each KEM algorithm supported</text><path d="M116.1123,637.7188 L180.5552,637.7188 L180.5552,644.8516 L170.5552,654.8516 L116.1123,654.8516 L116.1123,637.7188" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="164.7969" style="stroke:#000000;stroke-width:1.5;" width="1466.5801" x="116.1123" y="637.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="131.1123" y="650.7856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="273.1523" x="195.5552" y="649.9292">[kem_algorithm ecdh_secp384r1 supported]</text><polygon fill="#FF0000" points="940.4277,681.9844,950.4277,685.9844,940.4277,689.9844,944.4277,685.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="137.1123" x2="946.4277" y1="685.9844" y2="685.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="144.1123" y="680.9185">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="254.1221" x="187.1313" y="680.9185">generate_ecdh_secp384r1(Key: Slot G)</text><polygon fill="#FF0000" points="672.1206,711.1172,662.1206,715.1172,672.1206,719.1172,668.1206,715.1172" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="666.1206" x2="951.4277" y1="715.1172" y2="715.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="678.1206" y="710.0513">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.2881" x="721.1396" y="710.0513">Get random bytes for KEM keypair</text><path d="M967.4277,698.9844 L967.4277,738.9844 L1256.4277,738.9844 L1256.4277,708.9844 L1246.4277,698.9844 L967.4277,698.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1246.4277,698.9844 L1246.4277,708.9844 L1256.4277,708.9844 L1246.4277,698.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.9556" x="973.4277" y="716.0513">move to FW</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.2075" x="973.4277" y="731.1841">add note to indiacte would be nice in HW</text><polygon fill="#FF0000" points="1544.6924,761.3828,1554.6924,765.3828,1544.6924,769.3828,1548.6924,765.3828" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="962.4277" x2="1550.6924" y1="765.3828" y2="765.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="969.4277" y="760.3169">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.79" x="1012.4468" y="760.3169">Put KEM keypair</text><polygon fill="#FF0000" points="148.1123,790.5156,138.1123,794.5156,148.1123,798.5156,144.1123,794.5156" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="142.1123" x2="951.4277" y1="794.5156" y2="794.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="154.1123" y="789.4497">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="197.1313" y="789.4497">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1623.0273" x="5" y="837.082"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="837.082" y2="837.082"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="840.082" y2="840.082"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="490.3662" x="571.3306" y="826.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="467.3145" x="577.3306" y="842.5825">Load a KV slot with DICE key for each KEM algorithm supported</text><path d="M142.1123,864.6484 L142.1123,919.6484 L850.1123,919.6484 L850.1123,874.6484 L840.1123,864.6484 L142.1123,864.6484" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M840.1123,864.6484 L840.1123,874.6484 L850.1123,874.6484 L840.1123,864.6484" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="148.1123" y="881.7153">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="687.4575" x="148.1123" y="896.8481">ROM/FMC code already created DICE keys and loaded them. Caliptra FW knows the key so no work to do.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="148.1123" y="911.981">&#160;</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1623.0273" x="5" y="945.6133"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="945.6133" y2="945.6133"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1628.0273" y1="948.6133" y2="948.6133"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="380.2026" x="626.4124" y="935.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="357.1509" x="632.4124" y="951.1138">Load a KV slot with a Ready MPK Encryption Key</text><polygon fill="#FF0000" points="940.4277,1000.4453,950.4277,1004.4453,940.4277,1008.4453,944.4277,1004.4453" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="137.1123" x2="946.4277" y1="1004.4453" y2="1004.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="144.1123" y="991.813">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.9678" x="187.1313" y="984.2466">new_key(len: 256,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.147" x="244.9839" y="999.3794">Destination: Slot B)</text><polygon fill="#FF0000" points="672.1206,1029.5781,662.1206,1033.5781,672.1206,1037.5781,668.1206,1033.5781" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="666.1206" x2="951.4277" y1="1033.5781" y2="1033.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="678.1206" y="1028.5122">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.5488" x="721.1396" y="1028.5122">Get new random key of 256 bits</text><polygon fill="#FF0000" points="1371.7031,1058.7109,1381.7031,1062.7109,1371.7031,1066.7109,1375.7031,1062.7109" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="962.4277" x2="1377.7031" y1="1062.7109" y2="1062.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="969.4277" y="1057.645">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200.2368" x="1012.4468" y="1057.645">Put Ready MPK Encryption Key</text><polygon fill="#FF0000" points="148.1123,1087.8438,138.1123,1091.8438,148.1123,1095.8438,144.1123,1091.8438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="142.1123" x2="951.4277" y1="1091.8438" y2="1091.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="154.1123" y="1086.7778">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="197.1313" y="1086.7778">done</text><polygon fill="#FF0000" points="322.5522,1144.9766,332.5522,1148.9766,322.5522,1152.9766,326.5522,1148.9766" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="137.1123" x2="328.5522" y1="1148.9766" y2="1148.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="144.1123" y="1143.9106">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.4209" x="187.1313" y="1143.9106">Hand-off information</text><path d="M349.5522,1161.9766 L349.5522,1246.9766 L756.5522,1246.9766 L756.5522,1171.9766 L746.5522,1161.9766 L349.5522,1161.9766" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M746.5522,1161.9766 L746.5522,1171.9766 L756.5522,1171.9766 L746.5522,1161.9766" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.3955" x="355.5522" y="1179.0435">Currently, there is already handoff information</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.8486" x="355.5522" y="1194.1763">from ROM to run-time FW. Need to include:</text><ellipse cx="361.0522" cy="1204.875" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="374.626" x="367.5522" y="1209.3091">If the HEK exists and if so the KV slot containing that HEK</text><ellipse cx="361.0522" cy="1220.0078" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.3467" x="367.5522" y="1224.4419">The KV Slot containing the KEM keypair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="355.5522" y="1239.5747">&#160;</text><line style="stroke:#FF0000;stroke-width:1;" x1="344.5522" x2="386.5522" y1="1273.7734" y2="1273.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="386.5522" x2="386.5522" y1="1273.7734" y2="1286.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="345.5522" x2="386.5522" y1="1286.7734" y2="1286.7734"/><polygon fill="#FF0000" points="355.5522,1282.7734,345.5522,1286.7734,355.5522,1290.7734,351.5522,1286.7734" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="351.5522" y="1268.7075">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.5493" x="394.5713" y="1268.7075">Mark that no MEK sequence has started</text><!--SRC=[ZLPjRzis4FxENt4f32nfAdVTsc8GuW2kOYU6upX8iWH5DmYqTB89IwH7KdO4vCVlIFazSL5_iSIxvtYyU-wXZeHCyZ95KCaipbKoZKihSjEaPSQE6lTNmwVuUjY-YFkTxz22tncjYWoE6sQY5h4LDiSJ1lHxS8_mRXZTmdLps8oQ_IRSgWLg6Cftx0XbAh8Tx4nZecHQewMo23pHoXZ6VeFbxsnqVaC64vvz79rlbj_3MQQaXKJbIhSqfkStY2bO1QamIMaCF75Tm1qQ92Tkq6om0C5hzEC0J3aobR6uWWN0ZIaB1ErVLGRj-ru4NAPmDnmGE7Mc09ynAIscFz_WDkhXTau1N2mJ3M5mspTGy6haul6qsev4lqjUYDmTJSWv6Yl6tEBFDuleLQiyfyhlxUOhJOtmrLwt92kfGAUdqFZsTxVRkOlRqKFliVtG6zumzYFuqMZVVx-9ucXuFRpxz_mSg4S5UOVBvYh9MAi5rugdmA7_22PN5XR2Jk2gqmTejHXp46YOIYOmdP-UXf2JTpp1wN4Vgn3k7Q9zmdAbPc0dMfNZ2VYiA5ch1VsNaaW9SvwBr5kyeO9CbJBrfvhEbnlKk136T729pxRsP7HMndXkWVZ7bu5gomwQSd8dAwrBtfjevUtQxE2cyz1vnlWiZ3Kq9m-wH8OvPNgZ3c_t2jRb1F79RWrAgkHonjP0Lz4WW6qqzTDXQxSWMBTtg_Z-CIHMM2xaDlHW2_kT0HLP0_AaVk7vM6co53GmivdIHFswnwwsKopYZGCcwIGscCp-_Ekp_hJnzoc-eiGO9MhYThmBssB8vLuDDCrY29VKP_T4uKOLIOLFrsKwnMh6XTweYnRZYMLhQTcRcaBDqOrPz-cW2q_hoQcdCHKyeUU5AlCKQ7YbI92MuUffTyns6ux5U4cm_HoTwJ3JtgJ3svHmzXgp9iIQ5FMo9uQVY0Djl-X57PVSB_P-KrwV1MEaa1-xWwXMIPvxNICJSWTP1JTUJ9qKEEsUOD64Y0PbPZMdBi1KgeLnwpuHewYQL6mzzJAlceojAtpe59oOxZOcXOMEJ7Griq9984OTa2M9YvWsEyvHXl37bwyV_f4xMWmNJe4bTs6MfFnsmjuW90LQaT8bJvS7HOEHe55RUnUpgQcPS2XBvbpUfiGlgeEdmW5TQ1XLe1K5vjGLVNoognJPmcly5HqYK5b6n2Og5FxaBAKgQ5NLlTxkVRRmsqIbrYHsUVN1jK_JL9Wr2IQkAdln72PpUxkBbRghIncun8W5JLZTxClFb93L7m2zp5F3NJ5ByNHaegeGKPnXHGJwmd1Y9-IOblb6rj_3G-rr_yeBTqPpYsPqlarvwEBcZemkA35pG8aO_Az4IIemuGQCvLxiNbw-lBmuA9MU_Gy0]--></g></svg>