<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2887px" preserveAspectRatio="none" style="width:1664px;height:2887px;background:#FFFFFF;" version="1.1" viewBox="0 0 1664 2887" width="1664px" zoomAndPan="magnify"><title>Rewrap PMEK</title><defs/><g><rect fill="#DDDDDD" height="2838.2266" style="stroke:#181818;stroke-width:0.5;" width="1475.3335" x="176.4473" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="887.7173" y="56.0566">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98.0684" x="800.8562" y="28.5352">Rewrap PMEK</text><g><title>Storage</title><rect fill="transparent" height="2683.9863" width="8" x="53.1826" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="56.6826" x2="56.6826" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="51.6826" y="2708.0078"/></g><g><title>Mail Box</title><rect fill="transparent" height="2683.9863" width="8" x="212.7231" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="216.2231" x2="216.2231" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#FFFFFF" height="251.0371" style="stroke:#181818;stroke-width:1;" width="10" x="211.2231" y="207.1953"/></g><g><title>FW</title><rect fill="transparent" height="2683.9863" width="8" x="417.1226" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="420.6226" x2="420.6226" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#FFFFFF" height="2279.0859" style="stroke:#181818;stroke-width:1;" width="10" x="415.6226" y="428.9219"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="790.8711" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="794.3711" x2="794.3711" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="650.4063"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="855.8906"/></g><g><title/><rect fill="#FFFFFF" height="160.8633" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1119.9961"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1340.791"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1603.5859"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1823.0703"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2085.8652"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2319.3496"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2524.834"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1046.8555" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1050.3555" x2="1050.3555" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#ADD8E6" height="2625.3652" style="stroke:#181818;stroke-width:1;" width="10" x="1045.3555" y="185.8848"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1149.0723" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1152.5723" x2="1152.5723" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#ADD8E6" height="2625.3652" style="stroke:#181818;stroke-width:1;" width="10" x="1147.5723" y="185.8848"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1260.8901" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1264.3901" x2="1264.3901" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#ADD8E6" height="820.3164" style="stroke:#181818;stroke-width:1;" width="10" x="1259.3901" y="1733.8281"/></g><line style="stroke:#181818;stroke-width:2;" x1="1255.3901" x2="1273.3901" y1="2545.1445" y2="2563.1445"/><line style="stroke:#181818;stroke-width:2;" x1="1255.3901" x2="1273.3901" y1="2563.1445" y2="2545.1445"/><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1367.6323" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1371.1323" x2="1371.1323" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#ADD8E6" height="1787.4961" style="stroke:#181818;stroke-width:1;" width="10" x="1366.1323" y="766.6484"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1474.3745" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1477.8745" x2="1477.8745" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#ADD8E6" height="1582.0117" style="stroke:#181818;stroke-width:1;" width="10" x="1472.8745" y="972.1328"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1588.5132" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1592.0132" x2="1592.0132" y1="127.2637" y2="2811.25"/></g><g><title/><rect fill="#ADD8E6" height="1559.7012" style="stroke:#181818;stroke-width:1;" width="10" x="1587.0132" y="1251.5488"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="83.334">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="99.8223">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="116.3105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="116.3105">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="116.3105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="755.6011" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="762.6011" y="116.3105">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1011.5854" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1018.5854" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1030.5996" y="99.8223">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1033.686" y="116.3105">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1099.1255" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1120.8022" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1132.5874" y="99.8223">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1106.1255" y="116.3105">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1216.019" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1232.6201" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1243.4756" y="99.8223">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1223.019" y="116.3105">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1322.7612" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1339.3623" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1351.8447" y="99.8223">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1329.7612" y="116.3105">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1429.5034" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1446.1045" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1458.7168" y="99.8223">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1436.5034" y="116.3105">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1536.2456" y="79.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1560.2432" y="99.8223">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1543.2456" y="116.3105">Temp Memory</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="2831.7852">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="2848.2734">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="2864.7617">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="2831.7852">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="2831.7852">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="755.6011" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="762.6011" y="2831.7852">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1011.5854" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1018.5854" y="2831.7852">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1030.5996" y="2848.2734">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1033.686" y="2864.7617">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1099.1255" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1120.8022" y="2831.7852">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1132.5874" y="2848.2734">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1106.1255" y="2864.7617">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1216.019" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1232.6201" y="2831.7852">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1243.4756" y="2848.2734">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1223.019" y="2864.7617">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1322.7612" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1339.3623" y="2831.7852">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1351.8447" y="2848.2734">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1329.7612" y="2864.7617">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1429.5034" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1446.1045" y="2831.7852">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1458.7168" y="2848.2734">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1436.5034" y="2864.7617">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1536.2456" y="2811.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1560.2432" y="2831.7852">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1543.2456" y="2848.2734">Temp Memory</text><path d="M17.4575,140.2637 L17.4575,180.2637 L1630.4575,180.2637 L1630.4575,150.2637 L1620.4575,140.2637 L17.4575,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1620.4575,140.2637 L1620.4575,150.2637 L1630.4575,150.2637 L1620.4575,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="702.0181" y="157.832">Preconditions:</text><ellipse cx="707.5181" cy="168.3848" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.6597" x="714.0181" y="173.1426">FEK in a firmware-managed KV slot</text><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="207.1953" y2="203.1953"/><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="207.1953" y2="211.1953"/><line style="stroke:#008000;stroke-width:1;" x1="56.6826" x2="210.2231" y1="207.1953" y2="207.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="63.6826" y="202.4531">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.1777" x="103.0454" y="202.4531">REWRAP_PMEK</text><path d="M226.2231,220.1953 L226.2231,402.1953 L962.2231,402.1953 L962.2231,230.1953 L952.2231,220.1953 L226.2231,220.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M952.2231,220.1953 L952.2231,230.1953 L962.2231,230.1953 L952.2231,220.1953 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="232.2231" y="239.7637">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="236.3364" y="239.7637">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="413.5693" y="239.7637">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="417.6826" y="239.7637">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="587.4824" y="239.7637">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="591.5957" y="239.7637">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="236.3364" y="255.0742">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="417.6826" y="255.0742">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="591.5957" y="255.0742">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="236.3364" y="270.3848">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="417.6826" y="270.3848">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="591.5957" y="270.3848">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1768" x="599.8223" y="285.6953">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0596" x="599.8223" y="301.0059">* kem_handle (X)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.0283" x="599.8223" y="316.3164">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0244" x="599.8223" y="331.627">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="599.8223" y="346.9375">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.1196" x="236.3364" y="362.248">wrapped_enc_access_key_2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.6865" x="417.6826" y="362.248">DoubleWrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.5542" x="591.5957" y="362.248">KEM-wrapped (access_key_2 encrypted to access_key_1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4722" x="599.8223" y="377.5586">* double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5098" x="236.3364" y="392.8691">old_locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="417.6826" y="392.8691">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="591.5957" y="392.8691">PMEK encrypted to access_key_1</text><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="227.1953" y2="227.1953"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="242.5059" y2="242.5059"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="257.8164" y2="257.8164"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="349.6797" y2="349.6797"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="380.3008" y2="380.3008"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="395.6113" y2="395.6113"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="232.2231" y1="227.1953" y2="395.6113"/><line style="stroke:#000000;stroke-width:0.5;" x1="413.5693" x2="413.5693" y1="227.1953" y2="395.6113"/><line style="stroke:#000000;stroke-width:0.5;" x1="587.4824" x2="587.4824" y1="227.1953" y2="395.6113"/><line style="stroke:#000000;stroke-width:0.5;" x1="948.1499" x2="948.1499" y1="227.1953" y2="395.6113"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="428.9219" y2="424.9219"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="428.9219" y2="432.9219"/><line style="stroke:#008000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="428.9219" y2="428.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="228.2231" y="424.1797">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="267.5859" y="424.1797">Command</text><polygon fill="#FF0000" points="232.2231,454.2324,222.2231,458.2324,232.2231,462.2324,228.2231,458.2324" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="226.2231" x2="414.6226" y1="458.2324" y2="458.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="238.2231" y="453.4902">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="277.5859" y="453.4902">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="467.6226" y1="487.543" y2="487.543"/><line style="stroke:#FF0000;stroke-width:1;" x1="467.6226" x2="467.6226" y1="487.543" y2="500.543"/><line style="stroke:#FF0000;stroke-width:1;" x1="426.6226" x2="467.6226" y1="500.543" y2="500.543"/><polygon fill="#FF0000" points="436.6226,496.543,426.6226,500.543,436.6226,504.543,432.6226,500.543" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="482.8008">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="471.9854" y="482.8008">Determine command</text><path d="M8,512.543 L70.1387,512.543 L70.1387,519.8535 L60.1387,529.8535 L8,529.8535 L8,512.543 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="2078.9121" style="stroke:#000000;stroke-width:1.5;" width="1605.0132" x="8" y="512.543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="526.1113">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65.9302" x="85.1387" y="525.1777">[FEK exists]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="560.5088"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="560.5088" y2="560.5088"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="563.5088" y2="563.5088"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="765.1667" y="549.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="771.1667" y="566.4219">Get Access Key 1</text><polygon fill="#FF0000" points="777.3711,646.4063,787.3711,650.4063,777.3711,654.4063,781.3711,650.4063" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="650.4063" y2="650.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="622.6982">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.2422" x="471.9854" y="599.7324">Decaps(KEM Pair : kem_handle (g),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.332" x="521.3447" y="615.043">KEM ciphertext : kem_ciphertext from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="628.29" y="630.3535">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="645.6641">Destination : Slot Y)</text><polygon fill="#FF0000" points="1135.5723,675.7168,1145.5723,679.7168,1135.5723,683.7168,1139.5723,679.7168" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1141.5723" y1="679.7168" y2="679.7168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="674.9746">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="845.7339" y="674.9746">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="724.3379" y2="724.3379"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="724.3379" y2="737.3379"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="737.3379" y2="737.3379"/><polygon fill="#FF0000" points="810.3711,733.3379,800.3711,737.3379,810.3711,741.3379,806.3711,737.3379" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="711.9404">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.4609" x="845.7339" y="704.2852">Decap KEM Ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.7778" x="845.7339" y="719.5957">with Keypair</text><polygon fill="#FF0000" points="1354.1323,762.6484,1364.1323,766.6484,1354.1323,770.6484,1358.1323,766.6484" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="766.6484" y2="766.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="761.9063">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.6621" x="845.7339" y="761.9063">Put Shared Secret</text><polygon fill="#FF0000" points="436.6226,791.959,426.6226,795.959,436.6226,799.959,432.6226,795.959" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="795.959" y2="795.959"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="791.2168">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="791.2168">done</text><polygon fill="#FF0000" points="777.3711,851.8906,787.3711,855.8906,777.3711,859.8906,781.3711,855.8906" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="855.8906" y2="855.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="835.8379">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6812" x="471.9854" y="820.5273">Unwrap(Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.6963" x="521.3447" y="835.8379">Key Data : wrapped_access_key_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="521.3447" y="851.1484">Destination : Slot Z)</text><polygon fill="#FF0000" points="1354.1323,881.2012,1364.1323,885.2012,1354.1323,889.2012,1358.1323,885.2012" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="885.2012" y2="885.2012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="880.459">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="845.7339" y="880.459">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="929.8223" y2="929.8223"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="929.8223" y2="942.8223"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="942.8223" y2="942.8223"/><polygon fill="#FF0000" points="810.3711,938.8223,800.3711,942.8223,810.3711,946.8223,806.3711,942.8223" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="917.4248">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7725" x="845.7339" y="909.7695">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="845.7339" y="925.0801">wrapped_access_key_1</text><polygon fill="#FF0000" points="1460.8745,968.1328,1470.8745,972.1328,1460.8745,976.1328,1464.8745,972.1328" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="972.1328" y2="972.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="967.3906">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="845.7339" y="967.3906">Put Access Key 1</text><polygon fill="#FF0000" points="436.6226,997.4434,426.6226,1001.4434,436.6226,1005.4434,432.6226,1001.4434" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1001.4434" y2="1001.4434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="996.7012">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="996.7012">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="1030.0986"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1030.0986" y2="1030.0986"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1033.0986" y2="1033.0986"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="765.1667" y="1019.4434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="771.1667" y="1036.0117">Get Access Key 2</text><polygon fill="#FF0000" points="777.3711,1115.9961,787.3711,1119.9961,777.3711,1123.9961,781.3711,1119.9961" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1119.9961" y2="1119.9961"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1092.2881">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.7944" x="471.9854" y="1069.3223">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.0264" x="521.3447" y="1084.6328">Key Data: double_encrypted_access_key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.0474" x="521.3447" y="1099.9434">Destination Memory:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7808" x="656.5054" y="1099.9434">Put in memory</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.8711" x="471.9854" y="1115.2539">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.1011" x="648.8564" y="1115.2539">as not a key)</text><polygon fill="#FF0000" points="1354.1323,1145.3066,1364.1323,1149.3066,1354.1323,1153.3066,1358.1323,1149.3066" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="1149.3066" y2="1149.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1144.5645">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="845.7339" y="1144.5645">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1209.2383" y2="1209.2383"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1209.2383" y2="1222.2383"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1222.2383" y2="1222.2383"/><polygon fill="#FF0000" points="810.3711,1218.2383,800.3711,1222.2383,810.3711,1226.2383,806.3711,1222.2383" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1189.1855">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7725" x="845.7339" y="1173.875">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.0938" x="845.7339" y="1189.1855">double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.6377" x="845.7339" y="1204.4961">with Slot Y</text><polygon fill="#FF0000" points="1575.0132,1247.5488,1585.0132,1251.5488,1575.0132,1255.5488,1579.0132,1251.5488" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1581.0132" y1="1251.5488" y2="1251.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1246.8066">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.2178" x="845.7339" y="1246.8066">Encrypted Access Key 2</text><polygon fill="#FF0000" points="436.6226,1276.8594,426.6226,1280.8594,436.6226,1284.8594,432.6226,1280.8594" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1280.8594" y2="1280.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1276.1172">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1276.1172">done</text><polygon fill="#FF0000" points="777.3711,1336.791,787.3711,1340.791,777.3711,1344.791,781.3711,1340.791" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1340.791" y2="1340.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1320.7383">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.4399" x="471.9854" y="1305.4277">Unwrap(Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6143" x="521.3447" y="1320.7383">Key Data : Temp Memory,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="1336.0488">Destination : Slot Y)</text><polygon fill="#FF0000" points="1460.8745,1366.1016,1470.8745,1370.1016,1460.8745,1374.1016,1464.8745,1370.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="1370.1016" y2="1370.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1365.3594">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1365.3594">Get Access Key 1</text><polygon fill="#FF0000" points="1575.0132,1395.4121,1585.0132,1399.4121,1575.0132,1403.4121,1579.0132,1399.4121" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1581.0132" y1="1399.4121" y2="1399.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1394.6699">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.7886" x="845.7339" y="1394.6699">Get encrypted_access_key</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1428.7227" y2="1428.7227"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1428.7227" y2="1441.7227"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1441.7227" y2="1441.7227"/><polygon fill="#FF0000" points="810.3711,1437.7227,800.3711,1441.7227,810.3711,1445.7227,806.3711,1441.7227" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1423.9805">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.6216" x="845.7339" y="1423.9805">Unwrap encrypted access key 2</text><polygon fill="#FF0000" points="1354.1323,1467.0332,1364.1323,1471.0332,1354.1323,1475.0332,1358.1323,1471.0332" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="1471.0332" y2="1471.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1466.291">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="845.7339" y="1466.291">Put Access Key 2</text><polygon fill="#FF0000" points="436.6226,1496.3438,426.6226,1500.3438,436.6226,1504.3438,432.6226,1500.3438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1500.3438" y2="1500.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1495.6016">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1495.6016">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="1528.999"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1528.999" y2="1528.999"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1531.999" y2="1531.999"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="294.1411" x="684.3198" y="1518.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="275.8564" x="690.3198" y="1534.9121">Create PMEK wrapping/unwrapping Keys</text><polygon fill="#FF0000" points="777.3711,1599.5859,787.3711,1603.5859,777.3711,1607.5859,781.3711,1603.5859" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1603.5859" y2="1603.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1583.5332">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1568.2227">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="574.8174" y="1583.5332">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.5562" x="574.8174" y="1598.8438">Destination : Slot W)</text><polygon fill="#FF0000" points="1033.3555,1628.8965,1043.3555,1632.8965,1033.3555,1636.8965,1037.3555,1632.8965" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1039.3555" y1="1632.8965" y2="1632.8965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1628.1543">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1152" x="845.7339" y="1628.1543">Get FEK</text><polygon fill="#FF0000" points="1460.8745,1658.207,1470.8745,1662.207,1460.8745,1666.207,1464.8745,1662.207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="1662.207" y2="1662.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1657.4648">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1657.4648">Get Access Key 1</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1691.5176" y2="1691.5176"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1691.5176" y2="1704.5176"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1704.5176" y2="1704.5176"/><polygon fill="#FF0000" points="810.3711,1700.5176,800.3711,1704.5176,810.3711,1708.5176,806.3711,1704.5176" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1686.7754">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.0376" x="845.7339" y="1686.7754">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1247.3901,1729.8281,1257.3901,1733.8281,1247.3901,1737.8281,1251.3901,1733.8281" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1253.3901" y1="1733.8281" y2="1733.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1729.0859">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.0776" x="845.7339" y="1729.0859">HMAC512 result Old encryption key for locked PMEK</text><polygon fill="#FF0000" points="436.6226,1759.1387,426.6226,1763.1387,436.6226,1767.1387,432.6226,1763.1387" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1763.1387" y2="1763.1387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1758.3965">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1758.3965">done</text><polygon fill="#FF0000" points="777.3711,1819.0703,787.3711,1823.0703,777.3711,1827.0703,781.3711,1823.0703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1823.0703" y2="1823.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1803.0176">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1787.707">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="574.8174" y="1803.0176">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="574.8174" y="1818.3281">Destination : Slot Z)</text><polygon fill="#FF0000" points="1033.3555,1848.3809,1043.3555,1852.3809,1033.3555,1856.3809,1037.3555,1852.3809" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1039.3555" y1="1852.3809" y2="1852.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1847.6387">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1152" x="845.7339" y="1847.6387">Get FEK</text><polygon fill="#FF0000" points="1354.1323,1877.6914,1364.1323,1881.6914,1354.1323,1885.6914,1358.1323,1881.6914" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="1881.6914" y2="1881.6914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1876.9492">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1876.9492">Get Access Key 2</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1911.002" y2="1911.002"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1911.002" y2="1924.002"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1924.002" y2="1924.002"/><polygon fill="#FF0000" points="810.3711,1920.002,800.3711,1924.002,810.3711,1928.002,806.3711,1924.002" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1906.2598">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2788" x="845.7339" y="1906.2598">HMAC512 slot A and Slot Y</text><polygon fill="#FF0000" points="1460.8745,1949.3125,1470.8745,1953.3125,1460.8745,1957.3125,1464.8745,1953.3125" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="1953.3125" y2="1953.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1948.5703">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336.9019" x="845.7339" y="1948.5703">HMAC512 result New encryption key for locked PMEK</text><polygon fill="#FF0000" points="436.6226,1978.623,426.6226,1982.623,436.6226,1986.623,432.6226,1982.623" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1982.623" y2="1982.623"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1977.8809">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1977.8809">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="2011.2783"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2011.2783" y2="2011.2783"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2014.2783" y2="2014.2783"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="81.958" x="790.4114" y="2000.623"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.6733" x="796.4114" y="2017.1914">Get PMEK</text><polygon fill="#FF0000" points="777.3711,2081.8652,787.3711,2085.8652,777.3711,2089.8652,781.3711,2085.8652" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2085.8652" y2="2085.8652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2065.8125">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.8159" x="471.9854" y="2050.502">Unwrap(Key : Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.9038" x="521.3447" y="2065.8125">Key Data: locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="2081.123">Destination : Slot Y)</text><polygon fill="#FF0000" points="1247.3901,2111.1758,1257.3901,2115.1758,1247.3901,2119.1758,1251.3901,2115.1758" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1253.3901" y1="2115.1758" y2="2115.1758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2110.4336">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.5991" x="845.7339" y="2110.4336">Old encryption key for locked PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="2144.4863" y2="2144.4863"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="2144.4863" y2="2157.4863"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="2157.4863" y2="2157.4863"/><polygon fill="#FF0000" points="810.3711,2153.4863,800.3711,2157.4863,810.3711,2161.4863,806.3711,2157.4863" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2139.7441">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.9702" x="845.7339" y="2139.7441">Unwrap locked_pmek</text><polygon fill="#FF0000" points="1354.1323,2182.7969,1364.1323,2186.7969,1354.1323,2190.7969,1358.1323,2186.7969" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="2186.7969" y2="2186.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2182.0547">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.9155" x="845.7339" y="2182.0547">PMEK</text><polygon fill="#FF0000" points="436.6226,2212.1074,426.6226,2216.1074,436.6226,2220.1074,432.6226,2216.1074" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2216.1074" y2="2216.1074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2211.3652">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2211.3652">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="2244.7627"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2244.7627" y2="2244.7627"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2247.7627" y2="2247.7627"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="176.5952" x="743.0928" y="2234.1074"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.3105" x="749.0928" y="2250.6758">Create the locked PMEK</text><polygon fill="#FF0000" points="777.3711,2315.3496,787.3711,2319.3496,777.3711,2323.3496,781.3711,2319.3496" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2319.3496" y2="2319.3496"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2299.2969">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.4692" x="471.9854" y="2283.9863">Wrap(Key: Slot Z,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="525.458" y="2299.2969">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.6265" x="525.458" y="2314.6074">Destination : new_locked_pmek)</text><polygon fill="#FF0000" points="1460.8745,2344.6602,1470.8745,2348.6602,1460.8745,2352.6602,1464.8745,2348.6602" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="2348.6602" y2="2348.6602"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2343.918">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0361" x="845.7339" y="2343.918">Get New encryption key for locked PMEK</text><polygon fill="#FF0000" points="1354.1323,2373.9707,1364.1323,2377.9707,1354.1323,2381.9707,1358.1323,2377.9707" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="2377.9707" y2="2377.9707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2373.2285">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.5283" x="845.7339" y="2373.2285">Get PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="2422.5918" y2="2422.5918"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="2422.5918" y2="2435.5918"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="2435.5918" y2="2435.5918"/><polygon fill="#FF0000" points="810.3711,2431.5918,800.3711,2435.5918,810.3711,2439.5918,806.3711,2435.5918" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2410.1943">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="845.7339" y="2402.5391">Wrap slot Y with Slot Z to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.4126" x="845.7339" y="2417.8496">generate new_encrypted_pmek</text><polygon fill="#FF0000" points="436.6226,2460.9023,426.6226,2464.9023,436.6226,2468.9023,432.6226,2464.9023" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2464.9023" y2="2464.9023"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2460.1602">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="481.9854" y="2460.1602">new_encrypted_pmek</text><polygon fill="#FF0000" points="777.3711,2520.834,787.3711,2524.834,777.3711,2528.834,781.3711,2524.834" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2524.834" y2="2524.834"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2504.7813">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.9844" x="471.9854" y="2489.4707">Purge_key(Key: Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.7944" x="537.7979" y="2504.7813">Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="537.7979" y="2520.0918">Key : Slot Z)</text><polygon fill="#FF0000" points="1247.3901,2550.1445,1257.3901,2554.1445,1247.3901,2558.1445,1251.3901,2554.1445" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1253.3901" y1="2554.1445" y2="2554.1445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2549.4023">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="845.7339" y="2549.4023">Purge</text><polygon fill="#FF0000" points="1354.1323,2550.1445,1364.1323,2554.1445,1354.1323,2558.1445,1358.1323,2554.1445" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="2554.1445" y2="2554.1445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2549.4023">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="845.7339" y="2549.4023">&#160;</text><polygon fill="#FF0000" points="1460.8745,2550.1445,1470.8745,2554.1445,1460.8745,2558.1445,1464.8745,2554.1445" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="2554.1445" y2="2554.1445"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2549.4023">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="845.7339" y="2549.4023">&#160;</text><polygon fill="#FF0000" points="436.6226,2579.4551,426.6226,2583.4551,436.6226,2587.4551,432.6226,2583.4551" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2583.4551" y2="2583.4551"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2578.7129">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2578.7129">done</text><path d="M1372.4922,2610.4551 L1372.4922,2665.4551 L1586.4922,2665.4551 L1586.4922,2620.4551 L1576.4922,2610.4551 L1372.4922,2610.4551 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1576.4922,2610.4551 L1576.4922,2620.4551 L1586.4922,2620.4551 L1576.4922,2610.4551 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="1378.4922" y="2628.0234">Did not purge temp memory</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.521" x="1378.4922" y="2643.334">as it contains encrypted object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36.918" x="1378.4922" y="2658.6445">purge</text><polygon fill="#FF0000" points="227.2231,2704.0078,217.2231,2708.0078,227.2231,2712.0078,223.2231,2708.0078" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="2708.0078" y2="2708.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="233.2231" y="2695.6104">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="272.5859" y="2687.9551">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="272.5859" y="2703.2656">new_encrypted_pmek</text><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2708.0078" y2="2704.0078"/><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2708.0078" y2="2712.0078"/><line style="stroke:#008000;stroke-width:1;" x1="61.6826" x2="215.2231" y1="2708.0078" y2="2708.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="78.6826" y="2695.6104">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="118.0454" y="2687.9551">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="118.0454" y="2703.2656">complete</text><path d="M221.2231,2721.0078 L221.2231,2796.0078 L837.2231,2796.0078 L837.2231,2731.0078 L827.2231,2721.0078 L221.2231,2721.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M827.2231,2721.0078 L827.2231,2731.0078 L837.2231,2731.0078 L827.2231,2721.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="227.2231" y="2740.5762">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="231.3364" y="2740.5762">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="371.4863" y="2740.5762">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="375.5996" y="2740.5762">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="476.229" y="2740.5762">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="480.3423" y="2740.5762">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="231.3364" y="2755.8867">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2755.8867">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="480.3423" y="2755.8867">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="231.3364" y="2771.1973">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2771.1973">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="480.3423" y="2771.1973">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="231.3364" y="2786.5078">new_encrypted_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="375.5996" y="2786.5078">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="480.3423" y="2786.5078">PMEK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2728.0078" y2="2728.0078"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2743.3184" y2="2743.3184"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2758.6289" y2="2758.6289"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2773.9395" y2="2773.9395"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2789.25" y2="2789.25"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="227.2231" y1="2728.0078" y2="2789.25"/><line style="stroke:#000000;stroke-width:0.5;" x1="371.4863" x2="371.4863" y1="2728.0078" y2="2789.25"/><line style="stroke:#000000;stroke-width:0.5;" x1="476.229" x2="476.229" y1="2728.0078" y2="2789.25"/><line style="stroke:#000000;stroke-width:0.5;" x1="822.8809" x2="822.8809" y1="2728.0078" y2="2789.25"/><!--SRC=[nLXjJzj84FwUNp4Wr8CZQGMd-nArbN8az12bZO0s1qAo77kSxCLUMxiRtA3- -9jTlyHsrX3wTXOVWcTdTkPvPcR7kyEu5ovzXDXBd33s5ivIiL2-fDUTpWuBO7zFpkFKKKo5UD01UgxrJzYzn5Iu2OmlHkUxdHtaFWjg6eb0B-P-fiDZXU1w8fRI_A-VrzEtusmDKopcil_wrVHjAVqTJaVdm3Yu430HfQx0NkHoTuO-d7y66SRAhAMDZVNIXG0NXuUmzzUdqzFHfJCukJxxFBW- -_YXiy1ePfUGKWfxhbnn3w8fhUd3vMXoEHWxEhfQL6x2AX49DfihKYcz_ggZEcKO-j1yZEYAFQ1LCCI0SOC3VArOy-OBkOm0BDQMVno3LV2UAKsGXiEjMzE49UWxhkUXbCu2LyvHBffaee6HdEEgr3aVNVHoFSZqWFJkkA6eOiWDPx5WQXxb8aBRcRlS9q_s_pcelBGjz5WoHw7mYyfV8lV4Ab4rNwsXqC9gECSa6iRBQOWR0TL3sQyfbTk1Ygj17HME-yQcywHRSUYRAg8LIOIBAYsZGdVS4EWSQ_SWDx-Hvj6qo5WlI4tAdiGH5OXVIzT8pfp45PBnMPQsdixqFD59vnqgy78zBOwclPxviISn3FPtQVbk5tQ7g514Z6EnUFU070abhfKAlznGcSh5BqmgsJ4Bthmn6sLSW2RZYDur_5dS7nxsOOYUcyXzeWh6BXFaOZMHPWTTGqZvw7NhvCbNLru48exg6ksFhJhgkaEKYd7NL6aVhgW5mKq6w-A-Y8AQJ0QhTer2JIYAnfBxF4opvAII-YcLXLr7OPIi-Z1UAhYQKolquGezWLaBD49xPzFYIZhuCS-RUCqwaT3hKKHQdAcKt6RhygGeEBOozubh0FSrkmKs3Qv8CdILIs8RrDqdiRuzi8AYmTu4fGPtvjiTj-sxQVCX0xgQhYNE3xyIPtlj7BVLZeM1hfs2_cCDxH4YBZ2A1K7-EeYvRXnXBDuGxcyrN7HKHqQyRRrbGq33aYjrcwD3dnpvRheV2J8ljWobpNqealwwOzVGx_nM7lyX1YhxTpEG2Sqx0ek-JlqNr1mh9oZHg5BcOLUFDxBLZF6oeNa4r0xrImxIp4zGh6gp8ZEyfC7h9Pm5a9BtB68AugMesYxyZNcRhUpydgj8drI3qM3O1Rdqva3C3KPNlNSd5rrjtQFPGs0IkbwhLxJxT4LKwzCfnChMPJnGSvosQ3EbNSz1QI0bwK_67dCrZpxb_ilCHdcW5fLDbF_gsdwwW6zRM-WrkPpNO_VPfrJUvPg7SaiTw6Ms6cehlCemKyttrXEjLbq_ySIYLdeYa18X6xdCOK2fzsh9Yv_Q1zdMNl- -69pyUNJiQ4HbbQH1zv6MP-XgPnIUO6xIO8w-RZ92QCRw1aurINaSvXCA1gPiCiysxQNhrGBbaaQxZ_HbKobKJMmG2yXcNeDhML3f_rrEFuQmc-SHTliimbORX1rlJzYDDG4QX7t0T1l2VkhmOifjww5bqZgqLBwilgdbKJflcR-shbRPtTxAVXwMZVQbJxcAnstGJd9WYyniPlrJcLv7bMDQ_RHjFr6sp3XR7TZnrt5aoNy3wwdjbkQFEpv3Za9ZejrR7r8bITjpqMRW-Nrdl1Gpr0Ta1Vo9fUKyCgWtnBOldnHsTY3Vp4XVD20bkUtzG_7-XwSfwik7SZ0kveUERLuRCZDzGQAzDolpZuTEoqS1q_zpvJ8kA-D5FFqNlUm3m5Zgb5DTfzEuwSXlHtHRJ68kyOvR27y1wskL-gtA7VVYA0bHc_xEwy3cHU0px_-QDt-FNVW5B96ELAvQodRrCzBpg8G8vC2qbloE1vY4qxFn5T1i9E9x3JTzAd108UX7TPjD93VkkvwuvZfkkUOo6TZv3m00]--></g></svg>