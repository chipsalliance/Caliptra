<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1859px" preserveAspectRatio="none" style="width:1620px;height:1859px;background:#FFFFFF;" version="1.1" viewBox="0 0 1620 1859" width="1620px" zoomAndPan="magnify"><title>Generate MPK</title><defs/><g><rect fill="#DDDDDD" height="1809.8125" style="stroke:#181818;stroke-width:0.5;" width="1439.0308" x="175.123" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="865.6741" y="55.3638">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="112.9023" x="755.6257" y="27.9951">Generate MPK</text><g><title>Storage</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="35.8882" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="39.3882" x2="39.3882" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#FFFFFF" height="102.5313" style="stroke:#181818;stroke-width:1;" width="10" x="34.3882" y="1680.6875"/></g><g><title>Mail Box</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="212.2944" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="215.7944" x2="215.7944" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#FFFFFF" height="233.5938" style="stroke:#181818;stroke-width:1;" width="10" x="210.7944" y="281.3828"/></g><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="443.1826" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="446.6826" x2="446.6826" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#FFFFFF" height="1194.8438" style="stroke:#181818;stroke-width:1;" width="10" x="441.6826" y="485.8438"/></g><g><title>DRBG</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="643.1807" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="646.6807" x2="646.6807" y1="126.3203" y2="1783.2188"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="867.48" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="870.98" x2="870.98" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="865.98" y="616.5078"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="865.98" y="805.4375"/></g><g><title/><rect fill="#FFFFFF" height="158.6641" style="stroke:#181818;stroke-width:1;" width="10" x="865.98" y="1025.5"/></g><g><title/><rect fill="#FFFFFF" height="102.5313" style="stroke:#181818;stroke-width:1;" width="10" x="865.98" y="1242.4297"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="865.98" y="1404.3594"/></g><g><title/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1;" width="10" x="865.98" y="1578.1563"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="1220.4058" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1223.9058" x2="1223.9058" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#ADD8E6" height="1522.9688" style="stroke:#181818;stroke-width:1;" width="10" x="1218.9058" y="260.25"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="1327.2095" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1330.7095" x2="1330.7095" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#ADD8E6" height="1522.9688" style="stroke:#181818;stroke-width:1;" width="10" x="1325.7095" y="260.25"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="1444.3218" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1447.8218" x2="1447.8218" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#ADD8E6" height="890.3828" style="stroke:#181818;stroke-width:1;" width="10" x="1442.8218" y="716.9063"/></g><line style="stroke:#181818;stroke-width:2;" x1="1438.8218" x2="1456.8218" y1="1598.2891" y2="1616.2891"/><line style="stroke:#181818;stroke-width:2;" x1="1438.8218" x2="1456.8218" y1="1616.2891" y2="1598.2891"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="1656.8984" width="8" x="1555.8765" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1559.3765" x2="1559.3765" y1="126.3203" y2="1783.2188"/></g><g><title/><rect fill="#ADD8E6" height="701.4531" style="stroke:#181818;stroke-width:1;" width="10" x="1554.3765" y="905.8359"/></g><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="5" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="12" y="82.4248">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="15.4487" y="98.7217">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="28.4404" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="179.123" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="186.123" y="115.0186">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="428.7349" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="435.7349" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.9609" x="619.2002" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.9609" x="626.2002" y="115.0186">DRBG</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="830.5112" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="837.5112" y="115.0186">Key Vault</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1183.437" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1190.437" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1203.4766" y="98.7217">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1204.167" y="115.0186">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1274.3745" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1297.2407" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1309.6445" y="98.7217">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1281.3745" y="115.0186">(KEM Keypair)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1397.0444" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1414.353" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.833" x="1427.9053" y="98.7217">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1404.0444" y="115.0186">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1508.5991" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1525.9077" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8721" x="1538.9404" y="98.7217">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1515.5991" y="115.0186">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="5" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="12" y="1803.2139">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="15.4487" y="1819.5107">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="28.4404" y="1835.8076">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="179.123" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="186.123" y="1803.2139">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="428.7349" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="435.7349" y="1803.2139">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.9609" x="619.2002" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.9609" x="626.2002" y="1803.2139">DRBG</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="830.5112" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="837.5112" y="1803.2139">Key Vault</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1183.437" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1190.437" y="1803.2139">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1203.4766" y="1819.5107">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1204.167" y="1835.8076">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1274.3745" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1297.2407" y="1803.2139">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1309.6445" y="1819.5107">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1281.3745" y="1835.8076">(KEM Keypair)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1397.0444" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1414.353" y="1803.2139">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.833" x="1427.9053" y="1819.5107">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1404.0444" y="1835.8076">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1508.5991" y="1783.2188"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1525.9077" y="1803.2139">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8721" x="1538.9404" y="1819.5107">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1515.5991" y="1835.8076">(Temporary)</text><path d="M1.8054,139.3203 L1.8054,254.3203 L1596.8054,254.3203 L1596.8054,149.3203 L1586.8054,139.3203 L1.8054,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1586.8054,139.3203 L1586.8054,149.3203 L1596.8054,149.3203 L1586.8054,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.2026" x="65.3621" y="156.3872">Preconditions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.6455" x="73.6267" y="171.52">* HEK in a firmware-managed KV slot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.6099" x="73.6267" y="186.6528">* KEM Keypair in a firmware-managed KV slot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="65.3621" y="201.7856">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="47.7788" x="65.3621" y="216.9185">Notes:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1450.7759" x="73.6267" y="232.0513">* The sequence diagram assumes that the KV will not allow an input KV slot to also be used as an out KV slot. Caliptra FW is responsible for managing which KV slots are used and can adapt if this assumption is not correct.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="494.6221" x="73.6267" y="247.1841">* This sequence is focused on successful execution of operations by the KV.</text><line style="stroke:#008000;stroke-width:1;" x1="208.7944" x2="198.7944" y1="281.3828" y2="277.3828"/><line style="stroke:#008000;stroke-width:1;" x1="208.7944" x2="198.7944" y1="281.3828" y2="285.3828"/><line style="stroke:#008000;stroke-width:1;" x1="39.3882" x2="209.7944" y1="281.3828" y2="281.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="46.3882" y="276.3169">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.3872" x="89.4072" y="276.3169">GENERATE_MPK</text><path d="M225.7944,294.3828 L225.7944,459.3828 L906.7944,459.3828 L906.7944,304.3828 L896.7944,294.3828 L225.7944,294.3828" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M896.7944,294.3828 L896.7944,304.3828 L906.7944,304.3828 L896.7944,294.3828" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="231.7944" y="313.4497">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="235.9268" y="313.4497">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="376.7813" y="313.4497">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="380.9136" y="313.4497">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="512.9131" y="313.4497">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="517.0454" y="313.4497">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="235.9268" y="328.5825">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="380.9136" y="328.5825">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="517.0454" y="328.5825">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104.457" x="235.9268" y="343.7153">mpk_algorithms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="380.9136" y="343.7153">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375.5527" x="517.0454" y="343.7153">Indicates the size of MPKs. Only one bit shall be reported.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.4307" x="525.3101" y="358.8481">* Byte 0 bit 0: 256 bits</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.7222" x="235.9268" y="373.981">wrapped_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.8672" x="380.9136" y="373.981">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.6328" x="517.0454" y="373.981">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.3975" x="525.3101" y="389.1138">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.6289" x="525.3101" y="404.2466">* kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0625" x="525.3101" y="419.3794">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.8013" x="525.3101" y="434.5122">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.6792" x="525.3101" y="449.645">* encrypted_access_key</text><line style="stroke:#000000;stroke-width:0.5;" x1="231.7944" x2="892.5981" y1="301.3828" y2="301.3828"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.7944" x2="892.5981" y1="316.5156" y2="316.5156"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.7944" x2="892.5981" y1="331.6484" y2="331.6484"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.7944" x2="892.5981" y1="361.9141" y2="361.9141"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.7944" x2="892.5981" y1="452.7109" y2="452.7109"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.7944" x2="231.7944" y1="301.3828" y2="452.7109"/><line style="stroke:#000000;stroke-width:0.5;" x1="376.7813" x2="376.7813" y1="301.3828" y2="452.7109"/><line style="stroke:#000000;stroke-width:0.5;" x1="512.9131" x2="512.9131" y1="301.3828" y2="452.7109"/><line style="stroke:#000000;stroke-width:0.5;" x1="892.5981" x2="892.5981" y1="301.3828" y2="452.7109"/><line style="stroke:#008000;stroke-width:1;" x1="439.6826" x2="429.6826" y1="485.8438" y2="481.8438"/><line style="stroke:#008000;stroke-width:1;" x1="439.6826" x2="429.6826" y1="485.8438" y2="489.8438"/><line style="stroke:#008000;stroke-width:1;" x1="220.7944" x2="440.6826" y1="485.8438" y2="485.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="227.7944" y="480.7778">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="270.8135" y="480.7778">Command</text><polygon fill="#FF0000" points="231.7944,510.9766,221.7944,514.9766,231.7944,518.9766,227.7944,514.9766" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="225.7944" x2="440.6826" y1="514.9766" y2="514.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="237.7944" y="509.9106">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.187" x="280.8135" y="509.9106">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="451.6826" x2="493.6826" y1="544.1094" y2="544.1094"/><line style="stroke:#FF0000;stroke-width:1;" x1="493.6826" x2="493.6826" y1="544.1094" y2="557.1094"/><line style="stroke:#FF0000;stroke-width:1;" x1="452.6826" x2="493.6826" y1="557.1094" y2="557.1094"/><polygon fill="#FF0000" points="462.6826,553.1094,452.6826,557.1094,462.6826,561.1094,458.6826,557.1094" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="458.6826" y="539.0435">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.979" x="501.7017" y="539.0435">Determine command</text><polygon fill="#FF0000" points="853.98,612.5078,863.98,616.5078,853.98,620.5078,857.98,616.5078" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="451.6826" x2="859.98" y1="616.5078" y2="616.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="458.6826" y="596.3091">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.1914" x="501.7017" y="581.1763">Decaps(KEM Pair : kem_handle (G),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.3799" x="555.4219" y="596.3091">KEM ciphertext : kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.3018" x="555.4219" y="611.4419">Destination : Slot Y)</text><polygon fill="#FF0000" points="1313.7095,641.6406,1323.7095,645.6406,1313.7095,649.6406,1317.7095,645.6406" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1319.7095" y1="645.6406" y2="645.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="640.5747">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.7798" x="925.999" y="640.5747">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="917.98" y1="674.7734" y2="674.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="917.98" x2="917.98" y1="674.7734" y2="687.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="876.98" x2="917.98" y1="687.7734" y2="687.7734"/><polygon fill="#FF0000" points="886.98,683.7734,876.98,687.7734,886.98,691.7734,882.98,687.7734" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="669.7075">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="231.2388" x="925.999" y="669.7075">Decap KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="1430.8218,712.9063,1440.8218,716.9063,1430.8218,720.9063,1434.8218,716.9063" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1436.8218" y1="716.9063" y2="716.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="711.8403">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.3301" x="925.999" y="711.8403">Put Shared Secret</text><polygon fill="#FF0000" points="462.6826,742.0391,452.6826,746.0391,462.6826,750.0391,458.6826,746.0391" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.6826" x2="864.98" y1="746.0391" y2="746.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="468.6826" y="740.9731">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="511.7017" y="740.9731">done</text><polygon fill="#FF0000" points="853.98,801.4375,863.98,805.4375,853.98,809.4375,857.98,805.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="451.6826" x2="859.98" y1="805.4375" y2="805.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="458.6826" y="785.2388">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.7188" x="501.7017" y="770.106">Key_Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.5991" x="580.2158" y="785.2388">Data: encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2666" x="580.2158" y="800.3716">Destination : Slot Z)</text><polygon fill="#FF0000" points="1430.8218,830.5703,1440.8218,834.5703,1430.8218,838.5703,1434.8218,834.5703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1436.8218" y1="834.5703" y2="834.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="829.5044">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.3232" x="925.999" y="829.5044">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="917.98" y1="863.7031" y2="863.7031"/><line style="stroke:#FF0000;stroke-width:1;" x1="917.98" x2="917.98" y1="863.7031" y2="876.7031"/><line style="stroke:#FF0000;stroke-width:1;" x1="876.98" x2="917.98" y1="876.7031" y2="876.7031"/><polygon fill="#FF0000" points="886.98,872.7031,876.98,876.7031,886.98,880.7031,882.98,876.7031" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="858.6372">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="290.9067" x="925.999" y="858.6372">Key_Unwrap encrypted_access_key with Key</text><polygon fill="#FF0000" points="1542.3765,901.8359,1552.3765,905.8359,1542.3765,909.8359,1546.3765,905.8359" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1548.3765" y1="905.8359" y2="905.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="900.77">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.3887" x="925.999" y="900.77">Put Access Key</text><polygon fill="#FF0000" points="462.6826,930.9688,452.6826,934.9688,462.6826,938.9688,458.6826,934.9688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.6826" x2="864.98" y1="934.9688" y2="934.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="468.6826" y="929.9028">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="511.7017" y="929.9028">done</text><path d="M430.6826,946.9688 L495.1255,946.9688 L495.1255,954.1016 L485.1255,964.1016 L430.6826,964.1016 L430.6826,946.9688" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="245.1953" style="stroke:#000000;stroke-width:1.5;" width="1144.6938" x="430.6826" y="946.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="445.6826" y="960.0356">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154.9775" x="510.1255" y="959.1792">[mpk algorithm 256 bits]</text><polygon fill="#FF0000" points="853.98,1021.5,863.98,1025.5,853.98,1029.5,857.98,1025.5" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="451.6826" x2="859.98" y1="1025.5" y2="1025.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="458.6826" y="1005.3013">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.9673" x="501.7017" y="990.1685">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.9858" x="605.0098" y="1005.3013">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.4341" x="605.0098" y="1020.4341">Destination :  Slot Y)</text><polygon fill="#FF0000" points="1206.9058,1050.6328,1216.9058,1054.6328,1206.9058,1058.6328,1210.9058,1054.6328" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1212.9058" y1="1054.6328" y2="1054.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1049.5669">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8154" x="925.999" y="1049.5669">Get HEK</text><polygon fill="#FF0000" points="1542.3765,1079.7656,1552.3765,1083.7656,1542.3765,1087.7656,1546.3765,1083.7656" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1548.3765" y1="1083.7656" y2="1083.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1078.6997">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.3818" x="925.999" y="1078.6997">Get Access Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="917.98" y1="1112.8984" y2="1112.8984"/><line style="stroke:#FF0000;stroke-width:1;" x1="917.98" x2="917.98" y1="1112.8984" y2="1125.8984"/><line style="stroke:#FF0000;stroke-width:1;" x1="876.98" x2="917.98" y1="1125.8984" y2="1125.8984"/><polygon fill="#FF0000" points="886.98,1121.8984,876.98,1125.8984,886.98,1129.8984,882.98,1125.8984" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1107.8325">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.043" x="925.999" y="1107.8325">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1430.8218,1151.0313,1440.8218,1155.0313,1430.8218,1159.0313,1434.8218,1155.0313" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1436.8218" y1="1155.0313" y2="1155.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1149.9653">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.5527" x="925.999" y="1149.9653">Put HMAC512 result Encryption Key</text><polygon fill="#FF0000" points="462.6826,1180.1641,452.6826,1184.1641,462.6826,1188.1641,458.6826,1184.1641" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.6826" x2="864.98" y1="1184.1641" y2="1184.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="468.6826" y="1179.0981">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="511.7017" y="1179.0981">done</text><polygon fill="#FF0000" points="853.98,1238.4297,863.98,1242.4297,853.98,1246.4297,857.98,1242.4297" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="451.6826" x2="859.98" y1="1242.4297" y2="1242.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="458.6826" y="1229.7974">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.3623" x="501.7017" y="1222.231">new_key(len: mpk_alogorithm length,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.1343" x="559.5542" y="1237.3638">Destination Slot: Z)</text><polygon fill="#FF0000" points="657.6807,1282.6953,647.6807,1286.6953,657.6807,1290.6953,653.6807,1286.6953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="651.6807" x2="864.98" y1="1286.6953" y2="1286.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="663.6807" y="1274.063">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.6992" x="706.6997" y="1266.4966">Get random limited</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.2803" x="706.6997" y="1281.6294">to len of MPK algorithm</text><polygon fill="#FF0000" points="1542.3765,1311.8281,1552.3765,1315.8281,1542.3765,1319.8281,1546.3765,1315.8281" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1548.3765" y1="1315.8281" y2="1315.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1310.7622">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.8906" x="925.999" y="1310.7622">Put new MPK</text><polygon fill="#FF0000" points="462.6826,1340.9609,452.6826,1344.9609,462.6826,1348.9609,458.6826,1344.9609" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.6826" x2="864.98" y1="1344.9609" y2="1344.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="468.6826" y="1339.895">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="511.7017" y="1339.895">done</text><polygon fill="#FF0000" points="853.98,1400.3594,863.98,1404.3594,853.98,1408.3594,857.98,1404.3594" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="451.6826" x2="859.98" y1="1404.3594" y2="1404.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="458.6826" y="1384.1606">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.3374" x="501.7017" y="1369.0278">Wrap(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.9858" x="543.0249" y="1384.1606">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169.749" x="543.0249" y="1399.2935">Destination : locked_mpk)</text><polygon fill="#FF0000" points="1430.8218,1429.4922,1440.8218,1433.4922,1430.8218,1437.4922,1434.8218,1433.4922" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1436.8218" y1="1433.4922" y2="1433.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1428.4263">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.4424" x="925.999" y="1428.4263">Get Encryption Key</text><polygon fill="#FF0000" points="1542.3765,1458.625,1552.3765,1462.625,1542.3765,1466.625,1546.3765,1462.625" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1548.3765" y1="1462.625" y2="1462.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1457.5591">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.8838" x="925.999" y="1457.5591">Get new MPK</text><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="917.98" y1="1491.7578" y2="1491.7578"/><line style="stroke:#FF0000;stroke-width:1;" x1="917.98" x2="917.98" y1="1491.7578" y2="1504.7578"/><line style="stroke:#FF0000;stroke-width:1;" x1="876.98" x2="917.98" y1="1504.7578" y2="1504.7578"/><polygon fill="#FF0000" points="886.98,1500.7578,876.98,1504.7578,886.98,1508.7578,882.98,1504.7578" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1486.6919">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.105" x="925.999" y="1486.6919">Encrypt Data Key using Key</text><polygon fill="#FF0000" points="462.6826,1529.8906,452.6826,1533.8906,462.6826,1537.8906,458.6826,1533.8906" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.6826" x2="864.98" y1="1533.8906" y2="1533.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="468.6826" y="1528.8247">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.835" x="511.7017" y="1528.8247">Locked MPK</text><polygon fill="#FF0000" points="853.98,1574.1563,863.98,1578.1563,853.98,1582.1563,857.98,1578.1563" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="451.6826" x2="859.98" y1="1578.1563" y2="1578.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="458.6826" y="1565.5239">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.3135" x="501.7017" y="1557.9575">Purge_key(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.8853" x="567.8188" y="1573.0903">Key : Slot Z)</text><polygon fill="#FF0000" points="1430.8218,1603.2891,1440.8218,1607.2891,1430.8218,1611.2891,1434.8218,1607.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1436.8218" y1="1607.2891" y2="1607.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1602.2231">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.6733" x="925.999" y="1602.2231">Purge</text><polygon fill="#FF0000" points="1542.3765,1603.2891,1552.3765,1607.2891,1542.3765,1611.2891,1546.3765,1607.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="875.98" x2="1548.3765" y1="1607.2891" y2="1607.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="882.98" y="1602.2231">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="925.999" y="1602.2231">&#160;</text><polygon fill="#FF0000" points="462.6826,1632.4219,452.6826,1636.4219,462.6826,1640.4219,458.6826,1636.4219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.6826" x2="864.98" y1="1636.4219" y2="1636.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="468.6826" y="1631.356">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="511.7017" y="1631.356">done</text><polygon fill="#FF0000" points="226.7944,1676.6875,216.7944,1680.6875,226.7944,1684.6875,222.7944,1680.6875" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="220.7944" x2="440.6826" y1="1680.6875" y2="1680.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="232.7944" y="1668.0552">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8691" x="275.8135" y="1660.4888">Command response and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.835" x="275.8135" y="1675.6216">Locked MPK</text><line style="stroke:#008000;stroke-width:1;" x1="45.3882" x2="55.3882" y1="1680.6875" y2="1676.6875"/><line style="stroke:#008000;stroke-width:1;" x1="45.3882" x2="55.3882" y1="1680.6875" y2="1684.6875"/><line style="stroke:#008000;stroke-width:1;" x1="44.3882" x2="214.7944" y1="1680.6875" y2="1680.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="61.3882" y="1668.0552">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="104.4072" y="1660.4888">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.7217" x="104.4072" y="1675.6216">complete</text><path d="M220.7944,1693.6875 L220.7944,1767.6875 L853.7944,1767.6875 L853.7944,1703.6875 L843.7944,1693.6875 L220.7944,1693.6875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M843.7944,1693.6875 L843.7944,1703.6875 L853.7944,1703.6875 L843.7944,1693.6875" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="226.7944" y="1712.7544">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="230.9268" y="1712.7544">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="373.5269" y="1712.7544">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="377.6592" y="1712.7544">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="479.1582" y="1712.7544">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="483.2905" y="1712.7544">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="230.9268" y="1727.8872">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="377.6592" y="1727.8872">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="483.2905" y="1727.8872">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6592" x="230.9268" y="1743.02">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="377.6592" y="1743.02">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.5078" x="483.2905" y="1743.02">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3354" x="230.9268" y="1758.1528">new_encrypted_mpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.2344" x="377.6592" y="1758.1528">EncryptedMpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.3462" x="483.2905" y="1758.1528">MPK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="226.7944" x2="838.9307" y1="1700.6875" y2="1700.6875"/><line style="stroke:#000000;stroke-width:0.5;" x1="226.7944" x2="838.9307" y1="1715.8203" y2="1715.8203"/><line style="stroke:#000000;stroke-width:0.5;" x1="226.7944" x2="838.9307" y1="1730.9531" y2="1730.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="226.7944" x2="838.9307" y1="1746.0859" y2="1746.0859"/><line style="stroke:#000000;stroke-width:0.5;" x1="226.7944" x2="838.9307" y1="1761.2188" y2="1761.2188"/><line style="stroke:#000000;stroke-width:0.5;" x1="226.7944" x2="226.7944" y1="1700.6875" y2="1761.2188"/><line style="stroke:#000000;stroke-width:0.5;" x1="373.5269" x2="373.5269" y1="1700.6875" y2="1761.2188"/><line style="stroke:#000000;stroke-width:0.5;" x1="479.1582" x2="479.1582" y1="1700.6875" y2="1761.2188"/><line style="stroke:#000000;stroke-width:0.5;" x1="838.9307" x2="838.9307" y1="1700.6875" y2="1761.2188"/><!--SRC=[jLTjRnit3FxkNy4OGUSiTTPbw3uOHG4tSTB0JMeqQOCL0Gxo7Syd-DucwUAuw8yVgNi_dxC1Q-z385CKHJvyA387CdR3p4D8tDG94tVjP4Q6-eJ4Wy61z65qg8DaunXfGZmQ07rtl8JX9SQeX46uNio7WmECFUctZgGAtIJsyaDnGfh2LOdMzZT_RvPl5xcED3A9zUJDRyktrIx0h_1-DWSPWm1VgcWZ58uZ4OiLUZ3_0ZfCJ4jxFhk6EMvJ8TM_d6gwS4EUzLnz5o1e_3l3s4Nmf5Wf4O7GEejGWmc4eJ_81ZSo33ay466OR434T7UQcV8kC0djw0IM29ac7uHcdQJME84p4ShKA04Nzo0rADGfmI6N1BEVAB3UotW5cq2wGNcCpAZIPEo1IqQ59r83b04Ja1dhRCh8ib7sq4qKuMrEEe7IRXKfhVt4jLRfdCvS5xNsin3m2TtC6ajyI59EFUSCbji2YDmgqS3ckYB4Bq0v7kEJr8P3q8OeCmXmVNmCX-y-NrpCFZdJixkhBzExguytWpL6g_wTWR-1Gw6tiGlHabGcS3cxcNsQtiqS8c2BU2AL3T8fkGeCdQc2_ivPlv0OUZKCkV1MViEEw1nz6LjwmlU61JTO4xW0BGlP7wVG4NsGXek5iH1j2r6wTaIuIfGqGQJtMxYYeovXfYtCcZsa1538-WG-nk6MqeImb0PqG0HabYbC4sNGEtc8ROBVRGc5LrRdrGHEN__9IzroPgD4cgBd29jkPurR4jxdmgcLpQs8AcnSw4Ak2wHRt5CVhWChjYYjJa0i3R4Xw5DoPHeWEVza2Y6HKcrJq_6jdshHicI8wsyiHSwIY8h7Qx4ZqYid5KeJ6tEMkCoiWbXCA-H2oS_nThGSZ-tYK6FeZuQaFdm9mtCqg299u1VAmoDo9DHO7ohzgYzOFnuVJ-0SNP7g4JzN2twh9WryO7HvzDB6Nd-iM0DJg7UGghzpv4gprKcgj_m4_NKqM3-MBb25vK4sdil6zcFXdzq-gs_TKAPsrGr6wNO22thDRWDwZpouHLUX6TYD_afkvC8ZykP9g2mIMECnESvR3K3NZmr0Tn0blvpFCJDpn4Gjm-u2MG0aZ9Zq4gjVVHVFhqSx232WRGHQaDOEzZEwHBTjzrkER5w1TjjAVngi8ZJyBa5LcTLhqIcK7FNtrzEprx-VEeo9RW8_xGU-XXyQob-VqsrXNv6v5HdraXn-6XRQEmM4lDU0iAN2kId2oBlrr3RJtB5TQmNLonFKg3E2R9Pdb9qiB-XDnlw4s2DLKgh4v6AR7EHNh9k063VCdb68yQHeA4cPEPAjJB2JY2QY7EM4oTnoJ140EMYyIiYIZ2JHzI6cIOQi5ksd9aalw0mJkSUQFmUG7J3kY-hlBVvdITTc6G_1L9m4Pt-LTxBTnxOoy1RDYdErAnct86lZlvNk1-kODRodWBkGB3ArGikGVRWK3QO1J3TeE3Y0mjBWHIVDjFTZNtFRW8kcNOx1o1Nv43UYVm5rfsyt-eUOcd4QKcl-uGFX_vm6dni5VPbgXmVZJEy_Ni-1ThwlnWwUs2-k5hT0KvbA7dbkL_mF1Yf5Y-Or_5hKpOVVUHBEIi5r_fihkrAo_xlKKztfdi7B9dbWS_eF]--></g></svg>