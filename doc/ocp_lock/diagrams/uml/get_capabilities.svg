<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="743px" preserveAspectRatio="none" style="width:784px;height:743px;background:#FFFFFF;" version="1.1" viewBox="0 0 784 743" width="784px" zoomAndPan="magnify"><title>GET_CAPABILITIES command sequence</title><defs/><g><rect fill="#DDDDDD" height="694.1094" style="stroke:#181818;stroke-width:0.5;" width="231.8252" x="305.4666" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="392.4148" y="55.3638">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="305.5732" x="357.764" y="27.9951">GET_CAPABILITIES command sequence</text><g><title>Storage</title><rect fill="#000000" fill-opacity="0.00000" height="541.1953" width="8" x="151.1179" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="154.6179" x2="154.6179" y1="126.3203" y2="667.5156"/></g><g><title/><rect fill="#FFFFFF" height="122.6641" style="stroke:#181818;stroke-width:1;" width="10" x="149.6179" y="544.8516"/></g><g><title>Mail Box</title><rect fill="#000000" fill-opacity="0.00000" height="541.1953" width="8" x="342.6379" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="346.1379" x2="346.1379" y1="126.3203" y2="667.5156"/></g><g><title/><rect fill="#FFFFFF" height="112.5313" style="stroke:#181818;stroke-width:1;" width="10" x="341.1379" y="155.4531"/></g><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="541.1953" width="8" x="511.844" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="515.344" x2="515.344" y1="126.3203" y2="667.5156"/></g><g><title/><rect fill="#FFFFFF" height="306" style="stroke:#181818;stroke-width:1;" width="10" x="510.344" y="238.8516"/></g><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="120.2297" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="127.2297" y="82.4248">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="130.6785" y="98.7217">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="143.6702" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="309.4666" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="316.4666" y="115.0186">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="497.3962" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="504.3962" y="115.0186">FW</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="120.2297" y="667.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="127.2297" y="687.5107">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="130.6785" y="703.8076">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="143.6702" y="720.1045">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="309.4666" y="667.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="316.4666" y="687.5107">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="497.3962" y="667.5156"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="504.3962" y="687.5107">FW</text><line style="stroke:#008000;stroke-width:1;" x1="339.1379" x2="329.1379" y1="155.4531" y2="151.4531"/><line style="stroke:#008000;stroke-width:1;" x1="339.1379" x2="329.1379" y1="155.4531" y2="159.4531"/><line style="stroke:#008000;stroke-width:1;" x1="154.6179" x2="340.1379" y1="155.4531" y2="155.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="161.6179" y="150.3872">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.501" x="204.637" y="150.3872">GET_CAPABILITIES</text><path d="M20.8831,168.4531 L20.8831,212.4531 L670.8831,212.4531 L670.8831,178.4531 L660.8831,168.4531 L20.8831,168.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M660.8831,168.4531 L660.8831,178.4531 L670.8831,178.4531 L660.8831,168.4531" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="26.8831" y="187.52">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="31.0154" y="187.52">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="94.0032" y="187.52">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="98.1355" y="187.52">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="143.5784" y="187.52">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="147.7107" y="187.52">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="31.0154" y="202.6528">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="98.1355" y="202.6528">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="504.5498" x="147.7107" y="202.6528">Checksum over other input arguments, computed by the caller. Little endian.</text><line style="stroke:#000000;stroke-width:0.5;" x1="26.8831" x2="656.3928" y1="175.4531" y2="175.4531"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.8831" x2="656.3928" y1="190.5859" y2="190.5859"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.8831" x2="656.3928" y1="205.7188" y2="205.7188"/><line style="stroke:#000000;stroke-width:0.5;" x1="26.8831" x2="26.8831" y1="175.4531" y2="205.7188"/><line style="stroke:#000000;stroke-width:0.5;" x1="94.0032" x2="94.0032" y1="175.4531" y2="205.7188"/><line style="stroke:#000000;stroke-width:0.5;" x1="143.5784" x2="143.5784" y1="175.4531" y2="205.7188"/><line style="stroke:#000000;stroke-width:0.5;" x1="656.3928" x2="656.3928" y1="175.4531" y2="205.7188"/><line style="stroke:#008000;stroke-width:1;" x1="508.344" x2="498.344" y1="238.8516" y2="234.8516"/><line style="stroke:#008000;stroke-width:1;" x1="508.344" x2="498.344" y1="238.8516" y2="242.8516"/><line style="stroke:#008000;stroke-width:1;" x1="351.1379" x2="509.344" y1="238.8516" y2="238.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="358.1379" y="233.7856">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="401.157" y="233.7856">Command</text><polygon fill="#FF0000" points="362.1379,263.9844,352.1379,267.9844,362.1379,271.9844,358.1379,267.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="356.1379" x2="509.344" y1="267.9844" y2="267.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="368.1379" y="262.9185">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.187" x="411.157" y="262.9185">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="520.344" x2="562.344" y1="297.1172" y2="297.1172"/><line style="stroke:#FF0000;stroke-width:1;" x1="562.344" x2="562.344" y1="297.1172" y2="310.1172"/><line style="stroke:#FF0000;stroke-width:1;" x1="521.344" x2="562.344" y1="310.1172" y2="310.1172"/><polygon fill="#FF0000" points="531.344,306.1172,521.344,310.1172,531.344,314.1172,527.344,310.1172" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="527.344" y="292.0513">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.979" x="570.363" y="292.0513">Determine command</text><path d="M104.2297,322.1172 L168.6726,322.1172 L168.6726,329.25 L158.6726,339.25 L104.2297,339.25 L104.2297,322.1172" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="172.4688" style="stroke:#000000;stroke-width:1.5;" width="673.4121" x="104.2297" y="322.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="119.2297" y="335.1841">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="154.0054" x="183.6726" y="334.3276">[OCP LOCK is supported]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="104.2297" x2="777.6418" y1="417.5156" y2="417.5156"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="178.4814" x="109.2297" y="429.7261">[OCP LOCK is not supported]</text><line style="stroke:#FF0000;stroke-width:1;" x1="520.344" x2="562.344" y1="385.5156" y2="385.5156"/><line style="stroke:#FF0000;stroke-width:1;" x1="562.344" x2="562.344" y1="385.5156" y2="398.5156"/><line style="stroke:#FF0000;stroke-width:1;" x1="521.344" x2="562.344" y1="398.5156" y2="398.5156"/><polygon fill="#FF0000" points="531.344,394.5156,521.344,398.5156,531.344,402.5156,527.344,398.5156" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="527.344" y="372.8833">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.1367" x="570.363" y="365.3169">Set Byte 0 to 01h in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.2788" x="570.363" y="380.4497">capabitilty field on response</text><line style="stroke:#FF0000;stroke-width:1;" x1="520.344" x2="562.344" y1="473.5859" y2="473.5859"/><line style="stroke:#FF0000;stroke-width:1;" x1="562.344" x2="562.344" y1="473.5859" y2="486.5859"/><line style="stroke:#FF0000;stroke-width:1;" x1="521.344" x2="562.344" y1="486.5859" y2="486.5859"/><polygon fill="#FF0000" points="531.344,482.5859,521.344,486.5859,531.344,490.5859,527.344,486.5859" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="527.344" y="460.9536">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.6909" x="570.363" y="453.3872">Clear Byte 0 in the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.2788" x="570.363" y="468.52">capabitilty field on response</text><polygon fill="#FF0000" points="357.1379,540.8516,347.1379,544.8516,357.1379,548.8516,353.1379,544.8516" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="351.1379" x2="509.344" y1="544.8516" y2="544.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="363.1379" y="532.2192">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="406.157" y="524.6528">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.0195" x="406.157" y="539.7856">Response</text><line style="stroke:#008000;stroke-width:1;" x1="160.6179" x2="170.6179" y1="544.8516" y2="540.8516"/><line style="stroke:#008000;stroke-width:1;" x1="160.6179" x2="170.6179" y1="544.8516" y2="548.8516"/><line style="stroke:#008000;stroke-width:1;" x1="159.6179" x2="345.1379" y1="544.8516" y2="544.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="176.6179" y="532.2192">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="219.637" y="524.6528">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.6514" x="219.637" y="539.7856">Complete</text><path d="M10,562.8516 L10,651.8516 L682,651.8516 L682,572.8516 L672,562.8516 L10,562.8516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M672,562.8516 L672,572.8516 L682,572.8516 L672,562.8516" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="16" y="581.9185">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="20.1323" y="581.9185">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="99.6494" y="581.9185">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="103.7817" y="581.9185">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="155.2422" y="581.9185">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="159.3745" y="581.9185">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="20.1323" y="597.0513">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="103.7817" y="597.0513">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="503.769" x="159.3745" y="597.0513">Checksum over other output arguments, computed by Caliptra. Little endian.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.8994" x="20.1323" y="612.1841">capabilities</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43.1958" x="103.7817" y="612.1841">u8[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.209" x="159.3745" y="612.1841">Capabilities:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.9819" x="163.5068" y="627.3169">* Byte 0 bit 0: base LOCK capabilities</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262.8755" x="155.2422" y="642.4497">Should this be moved to Caliptra scope?</text><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="667.2759" y1="569.8516" y2="569.8516"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="667.2759" y1="584.9844" y2="584.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="667.2759" y1="600.1172" y2="600.1172"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="667.2759" y1="645.5156" y2="645.5156"/><line style="stroke:#000000;stroke-width:0.5;" x1="16" x2="16" y1="569.8516" y2="645.5156"/><line style="stroke:#000000;stroke-width:0.5;" x1="99.6494" x2="99.6494" y1="569.8516" y2="645.5156"/><line style="stroke:#000000;stroke-width:0.5;" x1="155.2422" x2="155.2422" y1="569.8516" y2="645.5156"/><line style="stroke:#000000;stroke-width:0.5;" x1="667.2759" x2="667.2759" y1="569.8516" y2="645.5156"/><!--SRC=[ZPDHJzim4CVVyockKJN1WAeCRPegnWI1JTKgWTQ-hLFbE9V6mh6zsA7gb0_FsKsWHO3gX-XyFlj_zxjBJoWkwmn1SxEGcjylQYUa7P0xYdeYXuE-BVHguOIJU1W1hPat8VvvCriabtUNL-F9U3Q-cGBNPSbK1XR_rQWunb4FLIRoACfNq6TshJYKwT4HZE3btHqfPiH6I6b7UJrWHTU2mwy6pjEB7m9bjZ6duZzkh6lCXH9EQ0NDLZWlxcrT1hC- -zGwam9vS8VdjIleAvIf7R1gMPUed3ts1P47CqZNG170cPHO3M0Yd2VWYsDgq8hHBYJyL7IPTaNpV1MgJZQ0TeejxN9XM6M5McwAvXvMoygJGjU13STbUd8IZBv5cH_451uVGtoD3gjIAEo2uqDAH5fyljJbnQI3s-GE9hV9Bn0MR6sChgZCLvwTalhLchem1ATXU5eG98zYhZWpB2NOqgqX3zqWx1LQevL54lVQEpB4vbsfH2AhEh6zLJpD5yHQodFrkusBFi1pBtPRCLTa64dm_2iUqYjZs3IVcsQlWNpQxZ-KiCTWwjgzCva9ayAuYhqnbwrU02af4RHUx-kVqoz_WzxMmMYk03vsFI3kC1n1ogYHeOdRRypLUQwL7qsfgsyLPXVJGjU4m1NKwnIXfFmpFpHTUc2vDlZzZR_b4G00]--></g></svg>