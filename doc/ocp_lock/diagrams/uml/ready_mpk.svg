<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4251px" preserveAspectRatio="none" style="width:2030px;height:4251px;background:#FFFFFF;" version="1.1" viewBox="0 0 2030 4251" width="2030px" zoomAndPan="magnify"><title>Ready MPK</title><defs/><g><rect fill="#DDDDDD" height="4202.4375" style="stroke:#181818;stroke-width:0.5;" width="1792.1528" x="205.9072" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="1073.0193" y="55.3638">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="88.7852" x="1026.2488" y="27.9951">Ready MPK</text><g><title>Storage</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="92.8882" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="96.3882" x2="96.3882" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#FFFFFF" height="130.5313" style="stroke:#181818;stroke-width:1;" width="10" x="91.3882" y="4045.3125"/></g><g><title>Mail Box</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="243.0786" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="246.5786" x2="246.5786" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#FFFFFF" height="203.3281" style="stroke:#181818;stroke-width:1;" width="10" x="241.5786" y="235.9844"/></g><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="445.377" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="448.877" x2="448.877" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#FFFFFF" height="3760.6641" style="stroke:#181818;stroke-width:1;" width="10" x="443.877" y="410.1797"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="1092.043" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1095.543" x2="1095.543" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="719.5078"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="878.1719"/></g><g><title/><rect fill="#FFFFFF" height="100.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="1160.5"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="1393.6953"/></g><g><title/><rect fill="#FFFFFF" height="100.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="1721.1563"/></g><g><title/><rect fill="#FFFFFF" height="100.3984" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="1939.2188"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="2157.2813"/></g><g><title/><rect fill="#FFFFFF" height="164.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="2419.6094"/></g><g><title/><rect fill="#FFFFFF" height="164.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="2717.0703"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="3029.6641"/></g><g><title/><rect fill="#FFFFFF" height="158.6641" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="3275.7266"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="3536.9219"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="3768.9844"/></g><g><title/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1;" width="10" x="1090.543" y="3942.7813"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="1381.0034" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1384.5034" x2="1384.5034" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#ADD8E6" height="3960.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1379.5034" y="214.8516"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="1538.1265" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1541.6265" x2="1541.6265" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#ADD8E6" height="3960.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1536.6265" y="214.8516"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="1711.1157" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1714.6157" x2="1714.6157" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#ADD8E6" height="3960.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1709.6157" y="214.8516"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="1828.228" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1831.728" x2="1831.728" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#ADD8E6" height="2740.1484" style="stroke:#181818;stroke-width:1;" width="10" x="1826.728" y="1231.7656"/></g><line style="stroke:#181818;stroke-width:2;" x1="1822.728" x2="1840.728" y1="3962.9141" y2="3980.9141"/><line style="stroke:#181818;stroke-width:2;" x1="1822.728" x2="1840.728" y1="3980.9141" y2="3962.9141"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="4049.5234" width="8" x="1939.7827" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1943.2827" x2="1943.2827" y1="126.3203" y2="4175.8438"/></g><g><title/><rect fill="#ADD8E6" height="841.8516" style="stroke:#181818;stroke-width:1;" width="10" x="1938.2827" y="3130.0625"/></g><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="62" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="69" y="82.4248">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="72.4487" y="98.7217">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="85.4404" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="209.9072" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="216.9072" y="115.0186">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="430.9292" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="437.9292" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1055.0742" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1062.0742" y="115.0186">Key Vault</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1344.0347" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1351.0347" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1364.0742" y="98.7217">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1364.7646" y="115.0186">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213.3086" x="1434.9722" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1508.1577" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8857" x="1521.1836" y="98.7217">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199.3086" x="1441.9722" y="115.0186">(Ready MPK Encryption Key)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1658.2808" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1681.147" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1693.5508" y="98.7217">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1665.2808" y="115.0186">(KEM Keypair)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1780.9507" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1798.2593" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.833" x="1811.8115" y="98.7217">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1787.9507" y="115.0186">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1892.5054" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1909.814" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8721" x="1922.8467" y="98.7217">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1899.5054" y="115.0186">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="62" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="69" y="4195.8389">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="72.4487" y="4212.1357">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="85.4404" y="4228.4326">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="209.9072" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="216.9072" y="4195.8389">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="430.9292" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="437.9292" y="4195.8389">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1055.0742" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1062.0742" y="4195.8389">Key Vault</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1344.0347" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1351.0347" y="4195.8389">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1364.0742" y="4212.1357">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1364.7646" y="4228.4326">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="213.3086" x="1434.9722" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1508.1577" y="4195.8389">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8857" x="1521.1836" y="4212.1357">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="199.3086" x="1441.9722" y="4228.4326">(Ready MPK Encryption Key)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1658.2808" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1681.147" y="4195.8389">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1693.5508" y="4212.1357">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1665.2808" y="4228.4326">(KEM Keypair)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1780.9507" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1798.2593" y="4195.8389">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.833" x="1811.8115" y="4212.1357">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1787.9507" y="4228.4326">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1892.5054" y="4175.8438"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1909.814" y="4195.8389">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8721" x="1922.8467" y="4212.1357">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1899.5054" y="4228.4326">(Temporary)</text><path d="M58.8054,139.3203 L58.8054,209.3203 L1980.8054,209.3203 L1980.8054,149.3203 L1970.8054,139.3203 L58.8054,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1970.8054,139.3203 L1970.8054,149.3203 L1980.8054,149.3203 L1970.8054,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.2026" x="771.054" y="156.3872">Preconditions:</text><ellipse cx="776.554" cy="167.0859" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="341.8784" x="783.054" y="171.52">Access Shared Secret already availble in a slot in KV</text><ellipse cx="776.554" cy="182.2188" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="476.563" x="783.054" y="186.6528">Ready MPK Encryption Key already in a slot and generated on each reset</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="331.3794" x="771.054" y="201.7856">Is there a separate Shared Secret per Admin User?</text><line style="stroke:#008000;stroke-width:1;" x1="239.5786" x2="229.5786" y1="235.9844" y2="231.9844"/><line style="stroke:#008000;stroke-width:1;" x1="239.5786" x2="229.5786" y1="235.9844" y2="239.9844"/><line style="stroke:#008000;stroke-width:1;" x1="96.3882" x2="240.5786" y1="235.9844" y2="235.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="103.3882" y="230.9185">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.1714" x="146.4072" y="230.9185">READY_MPK</text><path d="M256.5786,248.9844 L256.5786,383.9844 L870.5786,383.9844 L870.5786,258.9844 L860.5786,248.9844 L256.5786,248.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M860.5786,248.9844 L860.5786,258.9844 L870.5786,258.9844 L860.5786,248.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="262.5786" y="268.0513">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="266.7109" y="268.0513">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="411.6978" y="268.0513">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="415.8301" y="268.0513">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="547.8296" y="268.0513">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="551.9619" y="268.0513">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="266.7109" y="283.1841">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="415.8301" y="283.1841">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="551.9619" y="283.1841">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.7222" x="266.7109" y="298.3169">wrapped_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.8672" x="415.8301" y="298.3169">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.6328" x="551.9619" y="298.3169">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.6289" x="547.8296" y="313.4497">* kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.9302" x="547.8296" y="328.5825">*kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.6689" x="547.8296" y="343.7153">*kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.6792" x="547.8296" y="358.8481">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.4351" x="266.7109" y="373.981">locked_mpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.2344" x="415.8301" y="373.981">EncryptedMpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300.3774" x="551.9619" y="373.981">MPK encrypted to the HEK and the access key</text><line style="stroke:#000000;stroke-width:0.5;" x1="262.5786" x2="856.4717" y1="255.9844" y2="255.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="262.5786" x2="856.4717" y1="271.1172" y2="271.1172"/><line style="stroke:#000000;stroke-width:0.5;" x1="262.5786" x2="856.4717" y1="286.25" y2="286.25"/><line style="stroke:#000000;stroke-width:0.5;" x1="262.5786" x2="856.4717" y1="361.9141" y2="361.9141"/><line style="stroke:#000000;stroke-width:0.5;" x1="262.5786" x2="856.4717" y1="377.0469" y2="377.0469"/><line style="stroke:#000000;stroke-width:0.5;" x1="262.5786" x2="262.5786" y1="255.9844" y2="377.0469"/><line style="stroke:#000000;stroke-width:0.5;" x1="411.6978" x2="411.6978" y1="255.9844" y2="377.0469"/><line style="stroke:#000000;stroke-width:0.5;" x1="547.8296" x2="547.8296" y1="255.9844" y2="377.0469"/><line style="stroke:#000000;stroke-width:0.5;" x1="856.4717" x2="856.4717" y1="255.9844" y2="377.0469"/><line style="stroke:#008000;stroke-width:1;" x1="441.877" x2="431.877" y1="410.1797" y2="406.1797"/><line style="stroke:#008000;stroke-width:1;" x1="441.877" x2="431.877" y1="410.1797" y2="414.1797"/><line style="stroke:#008000;stroke-width:1;" x1="251.5786" x2="442.877" y1="410.1797" y2="410.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="258.5786" y="405.1138">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="301.5977" y="405.1138">Command</text><polygon fill="#FF0000" points="262.5786,435.3125,252.5786,439.3125,262.5786,443.3125,258.5786,439.3125" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="256.5786" x2="442.877" y1="439.3125" y2="439.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="268.5786" y="434.2466">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.187" x="311.5977" y="434.2466">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="495.877" y1="468.4453" y2="468.4453"/><line style="stroke:#FF0000;stroke-width:1;" x1="495.877" x2="495.877" y1="468.4453" y2="481.4453"/><line style="stroke:#FF0000;stroke-width:1;" x1="454.877" x2="495.877" y1="481.4453" y2="481.4453"/><polygon fill="#FF0000" points="464.877,477.4453,454.877,481.4453,464.877,485.4453,460.877,481.4453" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="463.3794">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.979" x="503.896" y="463.3794">Determine command</text><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="495.877" y1="510.5781" y2="510.5781"/><line style="stroke:#FF0000;stroke-width:1;" x1="495.877" x2="495.877" y1="510.5781" y2="523.5781"/><line style="stroke:#FF0000;stroke-width:1;" x1="454.877" x2="495.877" y1="523.5781" y2="523.5781"/><polygon fill="#FF0000" points="464.877,519.5781,454.877,523.5781,464.877,527.5781,460.877,523.5781" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="505.5122">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="233.3398" x="503.896" y="505.5122">Determine rate of ready commands</text><path d="M8,535.5781 L72.4429,535.5781 L72.4429,542.7109 L62.4429,552.7109 L8,552.7109 L8,535.5781" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="3531.7344" style="stroke:#000000;stroke-width:1.5;" width="2006.2827" x="8" y="535.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="23" y="548.645">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="75.8076" x="87.4429" y="547.7886">[HEK exists]</text><path d="M27,566.7109 L91.4429,566.7109 L91.4429,573.8438 L81.4429,583.8438 L27,583.8438 L27,566.7109" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="3486.6016" style="stroke:#000000;stroke-width:1.5;" width="1962.2827" x="27" y="566.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="42" y="579.7778">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="245.8457" x="106.4429" y="578.9214">[Ready command rate below threshold]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="614.4102"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="614.4102" y2="614.4102"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="617.4102" y2="617.4102"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="394.1738" x="817.0544" y="603.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="375.6479" x="823.0544" y="619.9106">Decapsulate ciphertext and decrypt the access key</text><path d="M46,640.9766 L110.4429,640.9766 L110.4429,648.1094 L100.4429,658.1094 L46,658.1094 L46,640.9766" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="890.25" style="stroke:#000000;stroke-width:1.5;" width="1806.728" x="46" y="640.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="61" y="654.0435">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="316.0781" x="125.4429" y="653.187">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384))]</text><polygon fill="#FF0000" points="1078.543,715.5078,1088.543,719.5078,1078.543,723.5078,1082.543,719.5078" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="719.5078" y2="719.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="699.3091">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.1211" x="503.896" y="684.1763">ECDH(KEM Pair : kem_handle (G),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="212.3799" x="553.4839" y="699.3091">KEM ciphertext : kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.6309" x="553.4839" y="714.4419">Destination : memory)</text><polygon fill="#FF0000" points="1697.6157,744.6406,1707.6157,748.6406,1697.6157,752.6406,1701.6157,748.6406" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1703.6157" y1="748.6406" y2="748.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="743.5747">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.7798" x="1150.562" y="743.5747">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="777.7734" y2="777.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="777.7734" y2="790.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="790.7734" y2="790.7734"/><polygon fill="#FF0000" points="1111.543,786.7734,1101.543,790.7734,1111.543,794.7734,1107.543,790.7734" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="772.7075">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="226.9414" x="1150.562" y="772.7075">ECDH KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="464.877,815.9063,454.877,819.9063,464.877,823.9063,460.877,819.9063" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="819.9063" y2="819.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="814.8403">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.5811" x="513.896" y="814.8403">Put ECDH shared secret</text><polygon fill="#FF0000" points="464.877,845.0391,454.877,849.0391,464.877,853.0391,460.877,849.0391" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="849.0391" y2="849.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="843.9731">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="843.9731">done</text><polygon fill="#FF0000" points="1078.543,874.1719,1088.543,878.1719,1078.543,882.1719,1082.543,878.1719" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="878.1719" y2="878.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="873.106">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.5679" x="503.896" y="873.106">ECC_GetPubKey(KEM Pair : kem_handle (G))</text><polygon fill="#FF0000" points="1697.6157,903.3047,1707.6157,907.3047,1697.6157,911.3047,1701.6157,907.3047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1703.6157" y1="907.3047" y2="907.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="902.2388">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.7798" x="1150.562" y="902.2388">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="936.4375" y2="936.4375"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="936.4375" y2="949.4375"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="949.4375" y2="949.4375"/><polygon fill="#FF0000" points="1111.543,945.4375,1101.543,949.4375,1111.543,953.4375,1107.543,949.4375" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="931.3716">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152.7056" x="1150.562" y="931.3716">derive ECDH public key</text><polygon fill="#FF0000" points="464.877,974.5703,454.877,978.5703,464.877,982.5703,460.877,978.5703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="978.5703" y2="978.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="973.5044">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.7412" x="513.896" y="973.5044">Put kem_pub</text><polygon fill="#FF0000" points="464.877,1003.7031,454.877,1007.7031,464.877,1011.7031,460.877,1007.7031" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="1007.7031" y2="1007.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="1002.6372">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="1002.6372">done</text><path d="M458.877,1020.7031 L458.877,1045.7031 L903.877,1045.7031 L903.877,1030.7031 L893.877,1020.7031 L458.877,1020.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M893.877,1020.7031 L893.877,1030.7031 L903.877,1030.7031 L893.877,1020.7031" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="424.6328" x="464.877" y="1037.77">The next steps come from RFC 9180, section 4.1, Decap function</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="1071.4023"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1071.4023" y2="1071.4023"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1074.4023" y2="1074.4023"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="372.1284" x="828.0771" y="1060.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="353.6025" x="834.0771" y="1076.9028">Derive HPKE pseudo-random key material (PRK)</text><polygon fill="#FF0000" points="1078.543,1156.5,1088.543,1160.5,1078.543,1164.5,1082.543,1160.5" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="1160.5" y2="1160.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="1132.7349">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.5439" x="503.896" y="1110.0356">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="322.5942" x="607.2041" y="1125.1685">Key Data : "HPKE-v1" | "KEM" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375.8892" x="503.896" y="1140.3013">"                                         eae_prk" | ECDH shared secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.1694" x="607.2041" y="1155.4341">Destination Slot: Y)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="1189.6328" y2="1189.6328"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="1189.6328" y2="1202.6328"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="1202.6328" y2="1202.6328"/><polygon fill="#FF0000" points="1111.543,1198.6328,1101.543,1202.6328,1111.543,1206.6328,1107.543,1202.6328" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="1184.5669">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.3237" x="1150.562" y="1184.5669">HMAC384 operation</text><polygon fill="#FF0000" points="1814.728,1227.7656,1824.728,1231.7656,1814.728,1235.7656,1818.728,1231.7656" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="1231.7656" y2="1231.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="1226.6997">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.5005" x="1150.562" y="1226.6997">HMAC384 result PRK</text><polygon fill="#FF0000" points="464.877,1256.8984,454.877,1260.8984,464.877,1264.8984,460.877,1260.8984" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="1260.8984" y2="1260.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="1255.8325">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="1255.8325">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="1289.4648"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1289.4648" y2="1289.4648"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1292.4648" y2="1292.4648"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="215.2334" x="906.5247" y="1278.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="196.7075" x="912.5247" y="1294.9653">Derive HPKE shared secret</text><polygon fill="#FF0000" points="1078.543,1389.6953,1088.543,1393.6953,1078.543,1397.6953,1082.543,1393.6953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="1393.6953" y2="1393.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="1358.3638">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8276" x="503.896" y="1328.0981">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="328.9673" x="607.2041" y="1343.231">Data : 0x0030 (big-endian 48) | "HPKE-v1" | "KEM"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="348.2388" x="648.5273" y="1358.3638">0x0011 (kem_id) | "shared_secret" | kem_ciphertext |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.1426" x="648.5273" y="1373.4966">kem_pub | 0x01 (HKDF block number)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.1694" x="607.2041" y="1388.6294">Destination Slot: Y)</text><polygon fill="#FF0000" points="1814.728,1418.8281,1824.728,1422.8281,1814.728,1426.8281,1818.728,1422.8281" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="1422.8281" y2="1422.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="1417.7622">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.1841" x="1150.562" y="1417.7622">Get HPKE PRK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="1451.9609" y2="1451.9609"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="1451.9609" y2="1464.9609"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="1464.9609" y2="1464.9609"/><polygon fill="#FF0000" points="1111.543,1460.9609,1101.543,1464.9609,1111.543,1468.9609,1107.543,1464.9609" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="1446.895">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.543" x="1150.562" y="1446.895">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1814.728,1490.0938,1824.728,1494.0938,1814.728,1498.0938,1818.728,1494.0938" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="1494.0938" y2="1494.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="1489.0278">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.1675" x="1150.562" y="1489.0278">HMAC384 result shared secret</text><polygon fill="#FF0000" points="464.877,1519.2266,454.877,1523.2266,464.877,1527.2266,460.877,1523.2266" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="1523.2266" y2="1523.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="1518.1606">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="1518.1606">done</text><path d="M46,1549.2266 L110.4429,1549.2266 L110.4429,1556.3594 L100.4429,1566.3594 L46,1566.3594 L46,1549.2266" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1617.9688" style="stroke:#000000;stroke-width:1.5;" width="1918.2827" x="46" y="1549.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="61" y="1562.2935">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="740.4214" x="125.4429" y="1561.437">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384)), kdf_id = 0x0002 (HKDF-SHA384), aead_id = 0x0002 (AES-256-GCM)]</text><path d="M458.877,1581.3594 L458.877,1606.3594 L1259.877,1606.3594 L1259.877,1591.3594 L1249.877,1581.3594 L458.877,1581.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1249.877,1581.3594 L1249.877,1591.3594 L1259.877,1591.3594 L1249.877,1581.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="780.9268" x="464.877" y="1598.4263">The next steps come from RFC 9180, sections 5.1 and 5.2, KeyScheduleBase and ContextR.Open functions respectively</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="1632.0586"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1632.0586" y2="1632.0586"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1635.0586" y2="1635.0586"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="359.1602" x="834.5613" y="1621.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="340.6343" x="840.5613" y="1637.5591">Derive HPKE psk_id_hash and store in memory</text><polygon fill="#FF0000" points="1078.543,1717.1563,1088.543,1721.1563,1078.543,1725.1563,1082.543,1721.1563" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="1721.1563" y2="1721.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="1693.3911">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.5439" x="503.896" y="1670.6919">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.3335" x="607.2041" y="1685.8247">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="318.9063" x="648.5273" y="1700.9575">0x0002 (aead_id) | "psk_id_hash" | "" (no PSK ID)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.6309" x="607.2041" y="1716.0903">Destination : memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="1750.2891" y2="1750.2891"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="1750.2891" y2="1763.2891"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="1763.2891" y2="1763.2891"/><polygon fill="#FF0000" points="1111.543,1759.2891,1101.543,1763.2891,1111.543,1767.2891,1107.543,1763.2891" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="1745.2231">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.3237" x="1150.562" y="1745.2231">HMAC384 operation</text><polygon fill="#FF0000" points="464.877,1788.4219,454.877,1792.4219,464.877,1796.4219,460.877,1792.4219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="1792.4219" y2="1792.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="1787.356">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.7383" x="513.896" y="1787.356">HMAC384 result psk_id_hash</text><polygon fill="#FF0000" points="464.877,1817.5547,454.877,1821.5547,464.877,1825.5547,460.877,1821.5547" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="1821.5547" y2="1821.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="1816.4888">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="1816.4888">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="1850.1211"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1850.1211" y2="1850.1211"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="1853.1211" y2="1853.1211"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="341.5073" x="843.3877" y="1839.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="322.9814" x="849.3877" y="1855.6216">Derive HPKE info_hash and store in memory</text><polygon fill="#FF0000" points="1078.543,1935.2188,1088.543,1939.2188,1078.543,1943.2188,1082.543,1939.2188" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="1939.2188" y2="1939.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="1911.4536">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.5439" x="503.896" y="1888.7544">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.3335" x="607.2041" y="1903.8872">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319.5474" x="648.5273" y="1919.02">0x0002 (aead_id) | "info_hash" | "enable_access"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.4985" x="607.2041" y="1934.1528">Destination: memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="1968.3516" y2="1968.3516"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="1968.3516" y2="1981.3516"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="1981.3516" y2="1981.3516"/><polygon fill="#FF0000" points="1111.543,1977.3516,1101.543,1981.3516,1111.543,1985.3516,1107.543,1981.3516" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="1963.2856">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.3237" x="1150.562" y="1963.2856">HMAC384 operation</text><polygon fill="#FF0000" points="464.877,2006.4844,454.877,2010.4844,464.877,2014.4844,460.877,2010.4844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="2010.4844" y2="2010.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="2005.4185">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2026" x="513.896" y="2005.4185">HMAC384 result info_hash</text><polygon fill="#FF0000" points="464.877,2035.6172,454.877,2039.6172,464.877,2043.6172,460.877,2039.6172" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="2039.6172" y2="2039.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="2034.5513">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="2034.5513">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="2068.1836"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2068.1836" y2="2068.1836"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2071.1836" y2="2071.1836"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="309.6675" x="859.3076" y="2057.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="291.1416" x="865.3076" y="2073.6841">Derive HPKE secret and store in KV slot</text><polygon fill="#FF0000" points="1078.543,2153.2813,1088.543,2157.2813,1078.543,2161.2813,1082.543,2157.2813" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="2157.2813" y2="2157.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="2129.5161">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8276" x="503.896" y="2106.8169">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="415.3335" x="607.2041" y="2121.9497">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262.6533" x="648.5273" y="2137.0825">0x0002 (aead_id) | "secret" | "" (no PSK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.1694" x="607.2041" y="2152.2153">Destination Slot: Y)</text><polygon fill="#FF0000" points="1814.728,2182.4141,1824.728,2186.4141,1814.728,2190.4141,1818.728,2186.4141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="2186.4141" y2="2186.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2181.3481">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="154.8511" x="1150.562" y="2181.3481">Get HPKE shared secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="2215.5469" y2="2215.5469"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="2215.5469" y2="2228.5469"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="2228.5469" y2="2228.5469"/><polygon fill="#FF0000" points="1111.543,2224.5469,1101.543,2228.5469,1111.543,2232.5469,1107.543,2228.5469" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2210.481">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.543" x="1150.562" y="2210.481">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1814.728,2253.6797,1824.728,2257.6797,1814.728,2261.6797,1818.728,2257.6797" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="2257.6797" y2="2257.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2252.6138">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.4619" x="1150.562" y="2252.6138">HMAC384 result secret</text><polygon fill="#FF0000" points="464.877,2282.8125,454.877,2286.8125,464.877,2290.8125,460.877,2286.8125" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="2286.8125" y2="2286.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="2281.7466">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="2281.7466">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="2315.3789"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2315.3789" y2="2315.3789"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2318.3789" y2="2318.3789"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="356.7861" x="835.7483" y="2304.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="338.2603" x="841.7483" y="2320.8794">Derive HPKE base_nonce and store in memory</text><polygon fill="#FF0000" points="1078.543,2415.6094,1088.543,2419.6094,1078.543,2423.6094,1082.543,2419.6094" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="2419.6094" y2="2419.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="2384.2778">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8276" x="503.896" y="2354.0122">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="467.2065" x="607.2041" y="2369.145">Data : 0x000C (big-endian 12) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.7427" x="648.5273" y="2384.2778">0x0002 (kdf_id) | 0x0002 (aead_id) | "base_nonce" |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.1582" x="648.5273" y="2399.4106">0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.4985" x="607.2041" y="2414.5435">Destination: memory)</text><polygon fill="#FF0000" points="1814.728,2444.7422,1824.728,2448.7422,1814.728,2452.7422,1818.728,2448.7422" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="2448.7422" y2="2448.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2443.6763">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1455" x="1150.562" y="2443.6763">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="2477.875" y2="2477.875"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="2477.875" y2="2490.875"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="2490.875" y2="2490.875"/><polygon fill="#FF0000" points="1111.543,2486.875,1101.543,2490.875,1111.543,2494.875,1107.543,2490.875" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2472.8091">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.543" x="1150.562" y="2472.8091">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="464.877,2516.0078,454.877,2520.0078,464.877,2524.0078,460.877,2520.0078" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="2520.0078" y2="2520.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="2514.9419">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.1704" x="513.896" y="2514.9419">HMAC384 result base_nonce</text><path d="M1105.543,2533.0078 L1105.543,2558.0078 L1391.543,2558.0078 L1391.543,2543.0078 L1381.543,2533.0078 L1105.543,2533.0078" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1381.543,2533.0078 L1381.543,2543.0078 L1391.543,2543.0078 L1381.543,2533.0078" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="265.2114" x="1111.543" y="2550.0747">The base_nonce is truncated to 12 bytes</text><polygon fill="#FF0000" points="464.877,2580.2734,454.877,2584.2734,464.877,2588.2734,460.877,2584.2734" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="2584.2734" y2="2584.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="2579.2075">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="2579.2075">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="2612.8398"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2612.8398" y2="2612.8398"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2615.8398" y2="2615.8398"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="289.9009" x="869.1909" y="2602.2734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="271.375" x="875.1909" y="2618.3403">Derive HPKE key and store in KV slot</text><polygon fill="#FF0000" points="1078.543,2713.0703,1088.543,2717.0703,1078.543,2721.0703,1082.543,2717.0703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="2717.0703" y2="2717.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="2681.7388">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.8276" x="503.896" y="2651.4731">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="466.4004" x="607.2041" y="2666.606">Data : 0x0020 (big-endian 32) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284.8955" x="648.5273" y="2681.7388">0x0002 (kdf_id) | 0x0002 (aead_id) | "key" |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.1582" x="648.5273" y="2696.8716">0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.1694" x="607.2041" y="2712.0044">Destination Slot: Y)</text><polygon fill="#FF0000" points="1814.728,2742.2031,1824.728,2746.2031,1814.728,2750.2031,1818.728,2746.2031" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="2746.2031" y2="2746.2031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2741.1372">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1455" x="1150.562" y="2741.1372">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="2775.3359" y2="2775.3359"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="2775.3359" y2="2788.3359"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="2788.3359" y2="2788.3359"/><polygon fill="#FF0000" points="1111.543,2784.3359,1101.543,2788.3359,1111.543,2792.3359,1107.543,2788.3359" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2770.27">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.543" x="1150.562" y="2770.27">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1814.728,2813.4688,1824.728,2817.4688,1814.728,2821.4688,1818.728,2817.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="2817.4688" y2="2817.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="2812.4028">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.3232" x="1150.562" y="2812.4028">HMAC384 result key</text><path d="M1105.543,2830.4688 L1105.543,2855.4688 L1547.543,2855.4688 L1547.543,2840.4688 L1537.543,2830.4688 L1105.543,2830.4688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1537.543,2830.4688 L1537.543,2840.4688 L1547.543,2840.4688 L1537.543,2830.4688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="421.1289" x="1111.543" y="2847.5356">The key is truncated to 32 bytes for use as an AES-256-GCM key</text><polygon fill="#FF0000" points="464.877,2877.7344,454.877,2881.7344,464.877,2885.7344,460.877,2881.7344" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="2881.7344" y2="2881.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="2876.6685">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="2876.6685">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="2910.3008"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2910.3008" y2="2910.3008"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="2913.3008" y2="2913.3008"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="310.5942" x="858.8442" y="2899.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="292.0684" x="864.8442" y="2915.8013">Decrypt access key and store in KV Slot</text><polygon fill="#FF0000" points="1078.543,3025.6641,1088.543,3029.6641,1078.543,3033.6641,1082.543,3029.6641" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="3029.6641" y2="3029.6641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="2986.7661">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.9736" x="503.896" y="2948.9341">AES-256-GCM(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.5708" x="553.4839" y="2964.0669">IV : base_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.2114" x="553.4839" y="2979.1997">Ciphertext : encrypted_access_key_ciphertext,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.7983" x="553.4839" y="2994.3325">Tag : encrypted_access_key_tag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="56.5322" x="553.4839" y="3009.4653">AAD : "",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2666" x="553.4839" y="3024.5981">Destination : Slot Z)</text><polygon fill="#FF0000" points="1814.728,3054.7969,1824.728,3058.7969,1814.728,3062.7969,1818.728,3058.7969" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="3058.7969" y2="3058.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3053.731">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.0068" x="1150.562" y="3053.731">Get HPKE key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="3087.9297" y2="3087.9297"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="3087.9297" y2="3100.9297"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="3100.9297" y2="3100.9297"/><polygon fill="#FF0000" points="1111.543,3096.9297,1101.543,3100.9297,1111.543,3104.9297,1107.543,3100.9297" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3082.8638">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="219.1274" x="1150.562" y="3082.8638">AES-256-GCM decrypt access key</text><polygon fill="#FF0000" points="1926.2827,3126.0625,1936.2827,3130.0625,1926.2827,3134.0625,1930.2827,3130.0625" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1932.2827" y1="3130.0625" y2="3130.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3124.9966">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.4653" x="1150.562" y="3124.9966">Put access key</text><polygon fill="#FF0000" points="464.877,3155.1953,454.877,3159.1953,464.877,3163.1953,460.877,3159.1953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="3159.1953" y2="3159.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="3154.1294">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="3154.1294">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="3201.7617"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="3201.7617" y2="3201.7617"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="3204.7617" y2="3204.7617"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="211.2153" x="908.5337" y="3191.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="192.6895" x="914.5337" y="3207.2622">Create the Encryption Key</text><polygon fill="#FF0000" points="1078.543,3271.7266,1088.543,3275.7266,1078.543,3279.7266,1082.543,3275.7266" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="3275.7266" y2="3275.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="3255.5278">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.9673" x="503.896" y="3240.395">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.9858" x="607.2041" y="3255.5278">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.1694" x="607.2041" y="3270.6606">Destination Slot: Y)</text><polygon fill="#FF0000" points="1367.5034,3300.8594,1377.5034,3304.8594,1367.5034,3308.8594,1371.5034,3304.8594" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1373.5034" y1="3304.8594" y2="3304.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3299.7935">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8154" x="1150.562" y="3299.7935">Get HEK</text><polygon fill="#FF0000" points="1926.2827,3329.9922,1936.2827,3333.9922,1926.2827,3337.9922,1930.2827,3333.9922" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1932.2827" y1="3333.9922" y2="3333.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3328.9263">[055]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.3818" x="1150.562" y="3328.9263">Get Access Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="3363.125" y2="3363.125"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="3363.125" y2="3376.125"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="3376.125" y2="3376.125"/><polygon fill="#FF0000" points="1111.543,3372.125,1101.543,3376.125,1111.543,3380.125,1107.543,3376.125" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3358.0591">[056]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.645" x="1150.562" y="3358.0591">HMAC512 Slot A with Slot Z</text><polygon fill="#FF0000" points="1814.728,3401.2578,1824.728,3405.2578,1814.728,3409.2578,1818.728,3405.2578" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="3405.2578" y2="3405.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3400.1919">[057]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="284.3687" x="1150.562" y="3400.1919">HMAC512 result locked MPK encryption key</text><polygon fill="#FF0000" points="464.877,3430.3906,454.877,3434.3906,464.877,3438.3906,460.877,3434.3906" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="3434.3906" y2="3434.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="3429.3247">[058]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="3429.3247">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="3462.957"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="3462.957" y2="3462.957"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="3465.957" y2="3465.957"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="353.0347" x="837.624" y="3452.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="334.5088" x="843.624" y="3468.4575">Decrypt MPK with locked MPK encryption key</text><polygon fill="#FF0000" points="1078.543,3532.9219,1088.543,3536.9219,1078.543,3540.9219,1082.543,3536.9219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="3536.9219" y2="3536.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="3516.7231">[059]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.0024" x="503.896" y="3501.5903">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.9873" x="553.4839" y="3516.7231">Data: locked_mpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3989" x="553.4839" y="3531.856">Destination :  Slot Z)</text><polygon fill="#FF0000" points="1814.728,3562.0547,1824.728,3566.0547,1814.728,3570.0547,1818.728,3566.0547" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="3566.0547" y2="3566.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3560.9888">[060]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.5664" x="1150.562" y="3560.9888">Get locked MPK encryption key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="3595.1875" y2="3595.1875"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="3595.1875" y2="3608.1875"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="3608.1875" y2="3608.1875"/><polygon fill="#FF0000" points="1111.543,3604.1875,1101.543,3608.1875,1111.543,3612.1875,1107.543,3608.1875" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3590.1216">[061]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1104" x="1150.562" y="3590.1216">Decrypt locked_mpk</text><polygon fill="#FF0000" points="1926.2827,3633.3203,1936.2827,3637.3203,1926.2827,3641.3203,1930.2827,3637.3203" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1932.2827" y1="3637.3203" y2="3637.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3632.2544">[062]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.5806" x="1150.562" y="3632.2544">MPK</text><polygon fill="#FF0000" points="464.877,3662.4531,454.877,3666.4531,464.877,3670.4531,460.877,3666.4531" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="3666.4531" y2="3666.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="3661.3872">[063]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="3661.3872">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2018.2827" x="5" y="3695.0195"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="3695.0195" y2="3695.0195"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2023.2827" y1="3698.0195" y2="3698.0195"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="350.5718" x="838.8555" y="3684.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="332.0459" x="844.8555" y="3700.52">Encrypt MPK with Ready MPK Encryption Key</text><polygon fill="#FF0000" points="1078.543,3764.9844,1088.543,3768.9844,1078.543,3772.9844,1082.543,3768.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="3768.9844" y2="3768.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="3748.7856">[064]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.3149" x="503.896" y="3733.6528">Wrap(Key: Slot B,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.9858" x="541.0869" y="3748.7856">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.5122" x="541.0869" y="3763.9185">Destination : ready_mpk)</text><polygon fill="#FF0000" points="1524.6265,3794.1172,1534.6265,3798.1172,1524.6265,3802.1172,1528.6265,3798.1172" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1530.6265" y1="3798.1172" y2="3798.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3793.0513">[065]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.23" x="1150.562" y="3793.0513">Get Ready MPK Encryption Key</text><polygon fill="#FF0000" points="1926.2827,3823.25,1936.2827,3827.25,1926.2827,3831.25,1930.2827,3827.25" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1932.2827" y1="3827.25" y2="3827.25"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3822.1841">[066]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.8818" x="1150.562" y="3822.1841">Get MPK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1142.543" y1="3856.3828" y2="3856.3828"/><line style="stroke:#FF0000;stroke-width:1;" x1="1142.543" x2="1142.543" y1="3856.3828" y2="3869.3828"/><line style="stroke:#FF0000;stroke-width:1;" x1="1101.543" x2="1142.543" y1="3869.3828" y2="3869.3828"/><polygon fill="#FF0000" points="1111.543,3865.3828,1101.543,3869.3828,1111.543,3873.3828,1107.543,3869.3828" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3851.3169">[067]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.939" x="1150.562" y="3851.3169">Encrypt slot Z using Slot B</text><polygon fill="#FF0000" points="464.877,3894.5156,454.877,3898.5156,464.877,3902.5156,460.877,3898.5156" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="3898.5156" y2="3898.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="3893.4497">[068]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.6553" x="513.896" y="3893.4497">Ready MPK</text><polygon fill="#FF0000" points="1078.543,3938.7813,1088.543,3942.7813,1078.543,3946.7813,1082.543,3942.7813" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="453.877" x2="1084.543" y1="3942.7813" y2="3942.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="460.877" y="3930.1489">[069]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.3135" x="503.896" y="3922.5825">Purge_key(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.8853" x="570.0132" y="3937.7153">Key : Slot Z)</text><polygon fill="#FF0000" points="1814.728,3967.9141,1824.728,3971.9141,1814.728,3975.9141,1818.728,3971.9141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1820.728" y1="3971.9141" y2="3971.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3966.8481">[070]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.6733" x="1150.562" y="3966.8481">Purge</text><polygon fill="#FF0000" points="1926.2827,3967.9141,1936.2827,3971.9141,1926.2827,3975.9141,1930.2827,3971.9141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1100.543" x2="1932.2827" y1="3971.9141" y2="3971.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1107.543" y="3966.8481">[071]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="1150.562" y="3966.8481">&#160;</text><polygon fill="#FF0000" points="464.877,3997.0469,454.877,4001.0469,464.877,4005.0469,460.877,4001.0469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="458.877" x2="1089.543" y1="4001.0469" y2="4001.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="470.877" y="3995.981">[072]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="513.896" y="3995.981">done</text><polygon fill="#FF0000" points="257.5786,4041.3125,247.5786,4045.3125,257.5786,4049.3125,253.5786,4045.3125" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="251.5786" x2="442.877" y1="4045.3125" y2="4045.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="263.5786" y="4032.6802">[073]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2793" x="306.5977" y="4025.1138">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.0229" x="306.5977" y="4040.2466">Ready_MPK</text><line style="stroke:#008000;stroke-width:1;" x1="102.3882" x2="112.3882" y1="4045.3125" y2="4041.3125"/><line style="stroke:#008000;stroke-width:1;" x1="102.3882" x2="112.3882" y1="4045.3125" y2="4049.3125"/><line style="stroke:#008000;stroke-width:1;" x1="101.3882" x2="245.5786" y1="4045.3125" y2="4045.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="118.3882" y="4032.6802">[074]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="161.4072" y="4025.1138">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.7217" x="161.4072" y="4040.2466">complete</text><path d="M251.5786,4086.3125 L251.5786,4160.3125 L826.5786,4160.3125 L826.5786,4096.3125 L816.5786,4086.3125 L251.5786,4086.3125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M816.5786,4086.3125 L816.5786,4096.3125 L826.5786,4096.3125 L816.5786,4086.3125" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="257.5786" y="4105.3794">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="261.7109" y="4105.3794">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="346.3062" y="4105.3794">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="350.4385" y="4105.3794">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="451.9375" y="4105.3794">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="456.0698" y="4105.3794">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="261.7109" y="4120.5122">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="350.4385" y="4120.5122">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="456.0698" y="4120.5122">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6592" x="261.7109" y="4135.645">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="350.4385" y="4135.645">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.5078" x="456.0698" y="4135.645">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="72.1982" x="261.7109" y="4150.7778">ready_mpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.2344" x="350.4385" y="4150.7778">EncryptedMpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.9277" x="456.0698" y="4150.7778">MPK encrypted to a key that is rotated on reset</text><line style="stroke:#000000;stroke-width:0.5;" x1="257.5786" x2="811.71" y1="4093.3125" y2="4093.3125"/><line style="stroke:#000000;stroke-width:0.5;" x1="257.5786" x2="811.71" y1="4108.4453" y2="4108.4453"/><line style="stroke:#000000;stroke-width:0.5;" x1="257.5786" x2="811.71" y1="4123.5781" y2="4123.5781"/><line style="stroke:#000000;stroke-width:0.5;" x1="257.5786" x2="811.71" y1="4138.7109" y2="4138.7109"/><line style="stroke:#000000;stroke-width:0.5;" x1="257.5786" x2="811.71" y1="4153.8438" y2="4153.8438"/><line style="stroke:#000000;stroke-width:0.5;" x1="257.5786" x2="257.5786" y1="4093.3125" y2="4153.8438"/><line style="stroke:#000000;stroke-width:0.5;" x1="346.3062" x2="346.3062" y1="4093.3125" y2="4153.8438"/><line style="stroke:#000000;stroke-width:0.5;" x1="451.9375" x2="451.9375" y1="4093.3125" y2="4153.8438"/><line style="stroke:#000000;stroke-width:0.5;" x1="811.71" x2="811.71" y1="4093.3125" y2="4153.8438"/><!--SRC=[tLfjRzf84FxEhvYWwWHNo8MaFVMYfYSAf8cutA6GzjGg4bhi1Ipy9kz2IfKVVpExnbuRcv0eRT7v2yQUcPsNPsR7ktlW-9Qxi3a4LZXo0si-MaZ75OVuk5Af73WJgBqGi-1k91tfyde5yBgXMwXUSsQlu6hGhrOEk6yxamnz674hy6tDuGUI0xEYG0ZrdwwtutS3JUD89_35wTlVnk-Ijxz2sxAu432SiOZRCEHMn2KmDrAZiYLpt35guVZ0GBY1fBl-9uC_KGzwlXMjGXe4-doLo4XPcM_3bFiyOXA7GZBEh1b4N72PgZi9V0bMu0RH6IhqxbA0dF68ammUCcBDwHho2DgsXyDy53pwy-rl945RYEvIFaaSD-Fpbo_XnVkFv-Uzwr6xStFvgNrp-S_VbJdtfiLll70kYjzK9dVmWecLRu4tHf9JkEwrkvz7w8jCY5Ze6E69dEbC8aDYyJs5wDpXhWt6fPuEdMyyzwZB9uwl8WdtXWXhDXSB3o0hOd5od7_qboC9LUGFbXLn5x4mvFQ8AK2CvXX2VFglVgfHGc6zXtxlgXaJWoO69BxrVyKVRpJ3ABiS_z4Vvaw3o94pB_vlEI46K_AlaiYv1an-J4CdoXHyZJ4mRUYj-QxYv_SAVuaua0611YvwVOKvkayLZGVOm8OtNaVJcjofS7O2pqF-J30zCHqX38NZJtLGBK9130Ba-S09lPgFNdlZPbFTl13SdTIgI5vjGBNB9OyGitnDNAsZ8gxWALEiLoeVxquXPLIf44n0PraiHbGgp9NASlxL4LBN0NfqRP9fvZ5tWplq3cRWB73HphMBpyvm78k5Ok4INHervKwRAp_dtNfsbWgW0IdUZWrdSFJrwAZLWbht0f5J6pHFthngm4M_UzuSNhJnJxrUCJ6Q6ZnVldnv2hrEzwA6d31WJeGUJa46jG_rngrlCXETeQwcDb5d4dUva8xFL3ATWiUz85fbTPalrwfWVT31fH4m3q9KfeHqgNLMb9rKbplCW-sSAi23XTJiGbSveQfSXi60entuFAjoNcApYROHMLP4WhKiNmpMb4pdnlRuT4RecC5YZCQL1-fv76lpo5boxQ1mCNOTah1wm9sa21BlaG-DcG35RyYumSpo2JD2yb1GqdAOH847r-ST-AFrvgX1i52uVNNOQkXaXSd2Lyyouf8obtcg4bnvycBGxq4e-C8EcX462mUXPFOmxoE7kL0RNFVhcTmkmi35LRk3cLoZ2U8Kk1VALIunCnUHTPbaI5ib1PhBLXMBU1KXGB_hWg4hI1tkR_qgx7fnnh4fcfESpJJQefDP38ROhPp2vtev3cE38GYfcyaxFI6Lw8fLIes5Te6L4LsQ8LTKnJt6_a0s1vcCMn-93t8lVDu6a1WS18IJ8wYDdMapxbXUlQaJKZPGiqLOUcq02whQZf6sWyHb9mnyi9FakCHeyE88DBt1cDeNy1VUc4VrPu5UZ2SgboeAUIGLObJrtf_r_6EZOny3rJsQX8oAzkH6em5pUv8I7nthIAtVDu1XbvHzt-uDcyUlVsz-w5pLlqyD5_3wiAKwgzU7nmqgZaDhnks5ozypmTMB3dxIeAphmtz2xYU5Nb2KGXAovExgAML_ZhRY72rcQXGXWqXzwkbMwBchVb75f_l2af_uNmUilciYhjdYGAeSD-nKWrQXvWSm6FRXihjhNZxK7-u-9wYs99TcXeRxM_8TVnBy_y6IMAc6v3uRkpp-FgtkXfNl2vL4lptk3U9591Cb_Kzw7lfEdSAFnqdQCQJrvFjCykLpyFDFz_lsiPb3rXWdn94V-1P_XXhqg3Rqg9DfGrl76sreEUeUXR4KcaMeInrGVOnWR7F8VLvWSn9ZJlptQKLvblAsWTvdXMrHHKnzKjQVpPU5xPc19aU0ZB2jOl7oOUiOnYl9HN5JjRVvGP_kFxBi4hQEinze9pyfCz3qdvOIZoteFw2IvrV57iu6mau-3KxYD8194C62FaO4uWkCRwADWVOrIVIQjR5UdS-JuIvvObY-BLSkF-6RjBpatdRC1UgYJH1Z0IB7UiEcPJoIJNF4xNQNMgDgOzkojzB_oux8BLrh9TYQgB0t_5q-m3UzIbj2gYZsS76iS3a2aTQ9EEsPqEP8RaFKn5PH_NtTEXvHD8I9hFQ3LTWW_lBKSfKuPyRdSRXx_KfPjEXzl6tSDwArKSFGeDW8NSEqZfLj5OnOuWgcz_xCdJrItOJ7rfXlZ_Tch3DnpbSHeuAGFigQKlss1lgZJrkdsse71VNKsFdSbhmRsLkKkGyxCXEvjQ6f1gL0e9tkdnACEBFIO9IUGjWMYt_ZICI1U6y6ObjgPMEWzb_9JGLHeCC3EWXb2cvDCjE_sVt5s7xL8Np1cTdnfx4HJmn8ejzJev9txc0HJJbDJ8Q7YrfAqyTbE8Q30uWb9XI_v3o6D3y1YxdT_yvwUvsBCF05l_MLNqUcNt-1zAH1zg31hMy5NkZok7cYcONdZXyywYn9_Wp9hWT8yWT7jfqQcJYX60d9v48Ky5qY0pMJ0j04cXBNvm-mqJo_70o1XM4KBEaqK4ID9OyYl37b9zbLSFAZuDW7KmLOpfYa8Q90heyQgLD69KS_510g_m40]--></g></svg>