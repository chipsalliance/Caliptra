<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1264px" preserveAspectRatio="none" style="width:1337px;height:1264px;background:#FFFFFF;" version="1.1" viewBox="0 0 1337 1264" width="1337px" zoomAndPan="magnify"><title>Unload MEK</title><defs/><g><rect fill="#DDDDDD" height="1214.9609" style="stroke:#181818;stroke-width:0.5;" width="276.9844" x="160.8091" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="270.3369" y="55.3638">Caliptra</text><rect fill="#DDDDDD" height="1214.9609" style="stroke:#181818;stroke-width:0.5;" width="417.9893" x="816.4399" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.3198" x="958.7747" y="55.3638">Encryption engine</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="94.4385" x="622.8445" y="27.9951">Unload MEK</text><g><title>Storage</title><rect fill="#000000" fill-opacity="0.00000" height="1062.0469" width="8" x="35.8882" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="39.3882" x2="39.3882" y1="126.3203" y2="1188.3672"/></g><g><title/><rect fill="#FFFFFF" height="87.3984" style="stroke:#181818;stroke-width:1;" width="10" x="34.3882" y="1100.9688"/></g><g><title>Mail Box</title><rect fill="#000000" fill-opacity="0.00000" height="1062.0469" width="8" x="197.9805" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="201.4805" x2="201.4805" y1="126.3203" y2="1188.3672"/></g><g><title/><rect fill="#FFFFFF" height="157.9297" style="stroke:#181818;stroke-width:1;" width="10" x="196.4805" y="205.7188"/></g><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="1062.0469" width="8" x="412.3457" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="415.8457" x2="415.8457" y1="126.3203" y2="1188.3672"/></g><g><title/><rect fill="#FFFFFF" height="766.4531" style="stroke:#181818;stroke-width:1;" width="10" x="410.8457" y="334.5156"/></g><g><title>SFR</title><rect fill="#000000" fill-opacity="0.00000" height="1062.0469" width="8" x="855.2793" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="858.7793" x2="858.7793" y1="126.3203" y2="1188.3672"/></g><g><title>Control</title><rect fill="#000000" fill-opacity="0.00000" height="1062.0469" width="8" x="1043.0288" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1046.5288" x2="1046.5288" y1="126.3203" y2="1188.3672"/></g><g><title/><rect fill="#FFFFFF" height="235.1953" style="stroke:#181818;stroke-width:1;" width="10" x="1041.5288" y="712.9766"/></g><g><title>Key cache</title><rect fill="#000000" fill-opacity="0.00000" height="1062.0469" width="8" x="1183.9346" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1187.4346" x2="1187.4346" y1="126.3203" y2="1188.3672"/></g><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="5" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="12" y="82.4248">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="15.4487" y="98.7217">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="28.4404" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="164.8091" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="171.8091" y="115.0186">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="397.8979" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="404.8979" y="115.0186">FW</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76.6787" x="820.4399" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.667" x="845.4458" y="98.7217">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.6787" x="827.4399" y="115.0186">Interface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.9141" x="1014.0718" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.9141" x="1021.0718" y="115.0186">Control</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.9893" x="1144.4399" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.9893" x="1151.4399" y="115.0186">Key cache</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="5" y="1188.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="12" y="1208.3623">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="15.4487" y="1224.6592">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="28.4404" y="1240.9561">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="164.8091" y="1188.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="171.8091" y="1208.3623">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="397.8979" y="1188.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="404.8979" y="1208.3623">FW</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76.6787" x="820.4399" y="1188.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.667" x="845.4458" y="1208.3623">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.6787" x="827.4399" y="1224.6592">Interface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.9141" x="1014.0718" y="1188.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.9141" x="1021.0718" y="1208.3623">Control</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.9893" x="1144.4399" y="1188.3672"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.9893" x="1151.4399" y="1208.3623">Key cache</text><path d="M5.6968,139.3203 L5.6968,179.3203 L1220.6968,179.3203 L1220.6968,149.3203 L1210.6968,139.3203 L5.6968,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1210.6968,139.3203 L1210.6968,149.3203 L1220.6968,149.3203 L1210.6968,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.2026" x="443.0933" y="156.3872">Preconditions:</text><ellipse cx="448.5933" cy="167.0859" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="319.6362" x="455.0933" y="171.52">None - a MEK may or may not have been loaded.</text><line style="stroke:#008000;stroke-width:1;" x1="194.4805" x2="184.4805" y1="205.7188" y2="201.7188"/><line style="stroke:#008000;stroke-width:1;" x1="194.4805" x2="184.4805" y1="205.7188" y2="209.7188"/><line style="stroke:#008000;stroke-width:1;" x1="39.3882" x2="195.4805" y1="205.7188" y2="205.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="46.3882" y="200.6528">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.0732" x="89.4072" y="200.6528">UNLOAD_MEK</text><path d="M211.4805,218.7188 L211.4805,307.7188 L895.4805,307.7188 L895.4805,228.7188 L885.4805,218.7188 L211.4805,218.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M885.4805,218.7188 L885.4805,228.7188 L895.4805,228.7188 L885.4805,218.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="30.9512" x="221.6128" y="237.7856">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.6855" x="319.2334" y="237.7856">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.9497" x="370.6938" y="237.7856">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="221.6128" y="252.9185">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="319.2334" y="252.9185">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="370.6938" y="252.9185">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.0068" x="221.6128" y="268.0513">metadata</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="43.1958" x="319.2334" y="268.0513">u8[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="506.6255" x="370.6938" y="268.0513">Metadata for MEK to load into the drive crypto engine (i.e. NSID + LBA range)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.4507" x="221.6128" y="283.1841">rdy_timeout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="319.2334" y="283.1841">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="486.0845" x="370.6938" y="283.1841">Timeout in ms for encryption engine to become ready for a new command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.2236" x="221.6128" y="298.3169">cmd_timeout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="319.2334" y="298.3169">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.3936" x="370.6938" y="298.3169">Timeout in ms for command to crypto engine to complete</text><line style="stroke:#000000;stroke-width:0.5;" x1="217.4805" x2="881.4517" y1="225.7188" y2="225.7188"/><line style="stroke:#000000;stroke-width:0.5;" x1="217.4805" x2="881.4517" y1="240.8516" y2="240.8516"/><line style="stroke:#000000;stroke-width:0.5;" x1="217.4805" x2="881.4517" y1="255.9844" y2="255.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="217.4805" x2="881.4517" y1="271.1172" y2="271.1172"/><line style="stroke:#000000;stroke-width:0.5;" x1="217.4805" x2="881.4517" y1="286.25" y2="286.25"/><line style="stroke:#000000;stroke-width:0.5;" x1="217.4805" x2="881.4517" y1="301.3828" y2="301.3828"/><line style="stroke:#000000;stroke-width:0.5;" x1="217.4805" x2="217.4805" y1="225.7188" y2="301.3828"/><line style="stroke:#000000;stroke-width:0.5;" x1="315.1011" x2="315.1011" y1="225.7188" y2="301.3828"/><line style="stroke:#000000;stroke-width:0.5;" x1="366.5615" x2="366.5615" y1="225.7188" y2="301.3828"/><line style="stroke:#000000;stroke-width:0.5;" x1="881.4517" x2="881.4517" y1="225.7188" y2="301.3828"/><line style="stroke:#008000;stroke-width:1;" x1="408.8457" x2="398.8457" y1="334.5156" y2="330.5156"/><line style="stroke:#008000;stroke-width:1;" x1="408.8457" x2="398.8457" y1="334.5156" y2="338.5156"/><line style="stroke:#008000;stroke-width:1;" x1="206.4805" x2="409.8457" y1="334.5156" y2="334.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="213.4805" y="329.4497">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="256.4995" y="329.4497">Command</text><polygon fill="#FF0000" points="217.4805,359.6484,207.4805,363.6484,217.4805,367.6484,213.4805,363.6484" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="211.4805" x2="409.8457" y1="363.6484" y2="363.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="223.4805" y="358.5825">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.187" x="266.4995" y="358.5825">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="462.8457" y1="392.7813" y2="392.7813"/><line style="stroke:#FF0000;stroke-width:1;" x1="462.8457" x2="462.8457" y1="392.7813" y2="405.7813"/><line style="stroke:#FF0000;stroke-width:1;" x1="421.8457" x2="462.8457" y1="405.7813" y2="405.7813"/><polygon fill="#FF0000" points="431.8457,401.7813,421.8457,405.7813,431.8457,409.7813,427.8457,405.7813" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="387.7153">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.979" x="470.8647" y="387.7153">Determine command</text><polygon fill="#FF0000" points="846.7793,430.9141,856.7793,434.9141,846.7793,438.9141,850.7793,434.9141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="434.9141" y2="434.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="429.8481">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.0737" x="470.8647" y="429.8481">Read Control Reg</text><path d="M380.8457,446.9141 L445.2886,446.9141 L445.2886,454.0469 L435.2886,464.0469 L380.8457,464.0469 L380.8457,446.9141" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="201.7969" style="stroke:#000000;stroke-width:1.5;" width="599.0254" x="380.8457" y="446.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="395.8457" y="459.981">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="242.6606" x="460.2886" y="459.1245">[(DN == 1b || ERR == 1b || EXE == 1b)]</text><polygon fill="#FF0000" points="846.7793,491.1797,856.7793,495.1797,846.7793,499.1797,850.7793,495.1797" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="495.1797" y2="495.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="490.1138">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.4214" x="470.8647" y="490.1138">Write Control Reg (DN = 1b)</text><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="462.8457" y1="524.3125" y2="524.3125"/><line style="stroke:#FF0000;stroke-width:1;" x1="462.8457" x2="462.8457" y1="524.3125" y2="537.3125"/><line style="stroke:#FF0000;stroke-width:1;" x1="421.8457" x2="462.8457" y1="537.3125" y2="537.3125"/><polygon fill="#FF0000" points="431.8457,533.3125,421.8457,537.3125,431.8457,541.3125,427.8457,537.3125" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="519.2466">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.5503" x="470.8647" y="519.2466">Start timeout</text><polygon fill="#FF0000" points="846.7793,562.4453,856.7793,566.4453,846.7793,570.4453,850.7793,566.4453" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="566.4453" y2="566.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="561.3794">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.0737" x="470.8647" y="561.3794">Read Control Reg</text><path d="M399.8457,578.4453 L938.8711,578.4453 L938.8711,585.5781 L928.8711,595.5781 L399.8457,595.5781 L399.8457,578.4453" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="56.2656" style="stroke:#000000;stroke-width:1.5;" width="555.0254" x="399.8457" y="578.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="494.0254" x="414.8457" y="591.5122">loop until (rdy_timeout or (DN == 0b &amp;&amp; ERR == 0b &amp;&amp; EXE == 0b)</text><polygon fill="#FF0000" points="846.7793,622.7109,856.7793,626.7109,846.7793,630.7109,850.7793,626.7109" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="626.7109" y2="626.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="621.645">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.0737" x="470.8647" y="621.645">Read Control Reg</text><polygon fill="#FF0000" points="846.7793,679.8438,856.7793,683.8438,846.7793,687.8438,850.7793,683.8438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="683.8438" y2="683.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="678.7778">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.5977" x="470.8647" y="678.7778">Write Metadata</text><polygon fill="#FF0000" points="846.7793,708.9766,856.7793,712.9766,846.7793,716.9766,850.7793,712.9766" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="712.9766" y2="712.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="707.9106">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="375.9146" x="470.8647" y="707.9106">Write Control Reg (CMD = Unload_MEK, DN = 0, EXE = 1)</text><line style="stroke:#008000;stroke-width:1;" x1="1039.5288" x2="1029.5288" y1="712.9766" y2="708.9766"/><line style="stroke:#008000;stroke-width:1;" x1="1039.5288" x2="1029.5288" y1="712.9766" y2="716.9766"/><line style="stroke:#008000;stroke-width:1;" x1="858.7793" x2="1040.5288" y1="712.9766" y2="712.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="865.7793" y="707.9106">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="908.7983" y="707.9106">&#160;</text><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="462.8457" y1="742.1094" y2="742.1094"/><line style="stroke:#FF0000;stroke-width:1;" x1="462.8457" x2="462.8457" y1="742.1094" y2="755.1094"/><line style="stroke:#FF0000;stroke-width:1;" x1="421.8457" x2="462.8457" y1="755.1094" y2="755.1094"/><polygon fill="#FF0000" points="431.8457,751.1094,421.8457,755.1094,431.8457,759.1094,427.8457,755.1094" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="737.0435">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.5503" x="470.8647" y="737.0435">Start timeout</text><polygon fill="#FF0000" points="846.7793,780.2422,856.7793,784.2422,846.7793,788.2422,850.7793,784.2422" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="784.2422" y2="784.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="779.1763">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.0737" x="470.8647" y="779.1763">Read Control Reg</text><polygon fill="#FF0000" points="869.7793,809.375,859.7793,813.375,869.7793,817.375,865.7793,813.375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="863.7793" x2="1040.5288" y1="813.375" y2="813.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="875.7793" y="808.3091">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9409" x="918.7983" y="808.3091">Read Metadata</text><polygon fill="#FF0000" points="1175.4346,838.5078,1185.4346,842.5078,1175.4346,846.5078,1179.4346,842.5078" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1051.5288" x2="1181.4346" y1="842.5078" y2="842.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="1058.5288" y="837.4419">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.8867" x="1101.5479" y="837.4419">Unload Key</text><path d="M399.8457,854.5078 L709.8921,854.5078 L709.8921,861.6406 L699.8921,871.6406 L399.8457,871.6406 L399.8457,854.5078" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="130.7969" style="stroke:#000000;stroke-width:1.5;" width="662.6831" x="399.8457" y="854.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="265.0464" x="414.8457" y="867.5747">loop until (cmd_timeout or DN = 1b)</text><line style="stroke:#008000;stroke-width:1;" x1="859.7793" x2="869.7793" y1="948.1719" y2="944.1719"/><line style="stroke:#008000;stroke-width:1;" x1="859.7793" x2="869.7793" y1="948.1719" y2="952.1719"/><line style="stroke:#008000;stroke-width:1;" x1="858.7793" x2="1040.5288" y1="948.1719" y2="948.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="875.7793" y="920.4067">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.7305" x="918.7983" y="897.7075">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6191" x="918.7983" y="912.8403">(DN = 1b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.0918" x="922.9307" y="927.9731">ERR = 0b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.0854" x="922.9307" y="943.106">EXE = 0b)</text><polygon fill="#FF0000" points="846.7793,973.3047,856.7793,977.3047,846.7793,981.3047,850.7793,977.3047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="977.3047" y2="977.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="972.2388">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.0737" x="470.8647" y="972.2388">Read Control Reg</text><polygon fill="#FF0000" points="846.7793,1016.4375,856.7793,1020.4375,846.7793,1024.4375,850.7793,1020.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="420.8457" x2="852.7793" y1="1020.4375" y2="1020.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="427.8457" y="1015.3716">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.4214" x="470.8647" y="1015.3716">Write Control Reg (DN = 1b)</text><path d="M863.7793,1004.3047 L863.7793,1029.3047 L1330.7793,1029.3047 L1330.7793,1014.3047 L1320.7793,1004.3047 L863.7793,1004.3047" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1320.7793,1004.3047 L1320.7793,1014.3047 L1330.7793,1014.3047 L1320.7793,1004.3047" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="446.3481" x="869.7793" y="1021.3716">Reset the SFR interface for next operation - not waiting for response</text><polygon fill="#FF0000" points="212.4805,1096.9688,202.4805,1100.9688,212.4805,1104.9688,208.4805,1100.9688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="206.4805" x2="409.8457" y1="1100.9688" y2="1100.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="218.4805" y="1073.2036">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="261.4995" y="1050.5044">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.3315" x="261.4995" y="1065.6372">response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.3462" x="261.4995" y="1080.77">(Status = Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.4561" x="323.4844" y="1095.9028">Error field)</text><line style="stroke:#008000;stroke-width:1;" x1="45.3882" x2="55.3882" y1="1100.9688" y2="1096.9688"/><line style="stroke:#008000;stroke-width:1;" x1="45.3882" x2="55.3882" y1="1100.9688" y2="1104.9688"/><line style="stroke:#008000;stroke-width:1;" x1="44.3882" x2="200.4805" y1="1100.9688" y2="1100.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="61.3882" y="1088.3364">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="104.4072" y="1080.77">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.7217" x="104.4072" y="1095.9028">complete</text><path d="M206.4805,1113.9688 L206.4805,1172.9688 L715.4805,1172.9688 L715.4805,1123.9688 L705.4805,1113.9688 L206.4805,1113.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M705.4805,1113.9688 L705.4805,1123.9688 L715.4805,1123.9688 L705.4805,1113.9688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="212.4805" y="1133.0356">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="216.6128" y="1133.0356">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="291.9976" y="1133.0356">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="296.1299" y="1133.0356">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="341.5728" y="1133.0356">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="345.7051" y="1133.0356">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="216.6128" y="1148.1685">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="296.1299" y="1148.1685">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="345.7051" y="1148.1685">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6592" x="216.6128" y="1163.3013">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="296.1299" y="1163.3013">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.5078" x="345.7051" y="1163.3013">Indicates if the command is FIPS approved or an error</text><line style="stroke:#000000;stroke-width:0.5;" x1="212.4805" x2="701.3452" y1="1120.9688" y2="1120.9688"/><line style="stroke:#000000;stroke-width:0.5;" x1="212.4805" x2="701.3452" y1="1136.1016" y2="1136.1016"/><line style="stroke:#000000;stroke-width:0.5;" x1="212.4805" x2="701.3452" y1="1151.2344" y2="1151.2344"/><line style="stroke:#000000;stroke-width:0.5;" x1="212.4805" x2="701.3452" y1="1166.3672" y2="1166.3672"/><line style="stroke:#000000;stroke-width:0.5;" x1="212.4805" x2="212.4805" y1="1120.9688" y2="1166.3672"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9976" x2="291.9976" y1="1120.9688" y2="1166.3672"/><line style="stroke:#000000;stroke-width:0.5;" x1="341.5728" x2="341.5728" y1="1120.9688" y2="1166.3672"/><line style="stroke:#000000;stroke-width:0.5;" x1="701.3452" x2="701.3452" y1="1120.9688" y2="1166.3672"/><!--SRC=[dLLjJzim4FxkNt5K2BLhwGhxCY50OYjCY9UX5hH9OwgSvD9Q97PaEtIT-F4xEozDQRTrYrJLTkxbkUSkZtU439CyGb1XDabK-3J9hKXCduuPsn4nj7VDJCqdLjW4EmpekNTBQ3t8HF48RiwlMcm7PIJY5OTCOwXaLBX8PH5ug9KnVk-Uu-3qhh0HLYXfZexV1gVrspTmgoJ2Fd2N0LA-0ANz7yM26Nz6210bE0mOzRqVWV2PQZWidiCkDmiPGXfqkt043xVNdy-64mh9l4i3CCz4fqxl0MindLdoh4_Tym8N0fDekHsBd-Z-XnWBwKk1brSUuUp9v6czpTyT-lzhOHsJ3YnVTqhHyeXRNZcz_tOu-4wBc-ey9a8SDrPv5a18MjaPGgG5qHFgHKO7AAU2Y6oBFlRXTdmvX2vSVpW3pUKKEsjPTRIWNgUeSjk4UbyU2GcfyPbH-WIkt3859GkedoaHXpnQU2iE4kT0XocdvgpnaaRR9Qi2K8hLijo1IhC4gLtBwFKW-1QNmv06rIo4yTmFmySYwihOfcOwoRWsGawBQGZT39KZH3wVq5Pe_EiqsD_tYrs3ITnkaNch1wqX0TAfGrWQjpeqbOd1fLE5Qvd0n9eoZ8WyWYQjLWbjfepnn49xU0id9t0GmCiBd8z6ZStNysBp6cyHxeiMn4qZNX7AsxzoSAiZ65kkBPHjsHXo3Q4pccgLPpI8AeDSaeH0kpbArCEoWa40UtjL1UMcg61G8Tew9p78t8-H3J6wkVJgUs5i2se-tWo9cqBQd4hqm9Crw1KWuQ33zhntEKg8tMupy2OAj-Wmuhf1ZRj- -HGw1IjazmeNZArptloYYFDbfmk-iCBj2Tj4mQEingFtA8isKMFysXCm-CsOhTNa-bAqXVtBI2w5ryKqzBKvHHjVZ9oyeOvvY5uH9FwW2ZFKt4lGlhyMvfpqLqwzWKQJqQs2h9dVVyBbP_yeAnEgcJfcSqCOLgY0rUTSQmeSE_btOx0Kb5KzUPIL9BdCZe3_lMdeYgml6x_pTurVRNdRLABwz-ic5fcPc8A6fjSbcOVSeW4gmFMYqc9XuEBoRWmyoxHwniZD6yL5JzAVjVWN]--></g></svg>