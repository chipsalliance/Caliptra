<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2867px" preserveAspectRatio="none" style="width:1726px;height:2867px;background:#FFFFFF;" version="1.1" viewBox="0 0 1726 2867" width="1726px" zoomAndPan="magnify"><title>Rewrap MPK</title><defs/><g><rect fill="#DDDDDD" height="2818.5938" style="stroke:#181818;stroke-width:0.5;" width="1534.2144" x="179.6821" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="917.825" y="55.3638">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="99.4971" x="831.1997" y="27.9951">Rewrap MPK</text><g><title>Storage</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="54.8882" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="58.3882" x2="58.3882" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#FFFFFF" height="102.5313" style="stroke:#181818;stroke-width:1;" width="10" x="53.3882" y="2689.4688"/></g><g><title>Mail Box</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="216.8535" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="220.3535" x2="220.3535" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#FFFFFF" height="248.7266" style="stroke:#181818;stroke-width:1;" width="10" x="215.3535" y="205.7188"/></g><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="423.208" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="426.708" x2="426.708" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#FFFFFF" height="2264.1563" style="stroke:#181818;stroke-width:1;" width="10" x="421.708" y="425.3125"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="813.7017" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="817.2017" x2="817.2017" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#FFFFFF" height="144.6641" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="645.375"/></g><g><title/><rect fill="#FFFFFF" height="144.6641" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="849.4375"/></g><g><title/><rect fill="#FFFFFF" height="159.7969" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="1111.7656"/></g><g><title/><rect fill="#FFFFFF" height="158.6641" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="1330.9609"/></g><g><title/><rect fill="#FFFFFF" height="158.6641" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="1592.1563"/></g><g><title/><rect fill="#FFFFFF" height="158.6641" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="1810.2188"/></g><g><title/><rect fill="#FFFFFF" height="129.5313" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="2071.4141"/></g><g><title/><rect fill="#FFFFFF" height="144.6641" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="2303.4766"/></g><g><title/><rect fill="#FFFFFF" height="58.2656" style="stroke:#181818;stroke-width:1;" width="10" x="812.2017" y="2507.5391"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="1083.5176" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1087.0176" x2="1087.0176" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#ADD8E6" height="2607.4141" style="stroke:#181818;stroke-width:1;" width="10" x="1082.0176" y="184.5859"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="1190.3213" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1193.8213" x2="1193.8213" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#ADD8E6" height="2607.4141" style="stroke:#181818;stroke-width:1;" width="10" x="1188.8213" y="184.5859"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="1307.4336" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1310.9336" x2="1310.9336" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#ADD8E6" height="814.9844" style="stroke:#181818;stroke-width:1;" width="10" x="1305.9336" y="1721.6875"/></g><line style="stroke:#181818;stroke-width:2;" x1="1301.9336" x2="1319.9336" y1="2527.6719" y2="2545.6719"/><line style="stroke:#181818;stroke-width:2;" x1="1301.9336" x2="1319.9336" y1="2545.6719" y2="2527.6719"/><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="1418.9883" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1422.4883" x2="1422.4883" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#ADD8E6" height="1775.7656" style="stroke:#181818;stroke-width:1;" width="10" x="1417.4883" y="760.9063"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="1530.543" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1534.043" x2="1534.043" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#ADD8E6" height="1571.7031" style="stroke:#181818;stroke-width:1;" width="10" x="1529.043" y="964.9688"/></g><g><title>Key Vault</title><rect fill="#000000" fill-opacity="0.00000" height="2665.6797" width="8" x="1648.8584" y="126.3203"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1652.3584" x2="1652.3584" y1="126.3203" y2="2792"/></g><g><title/><rect fill="#ADD8E6" height="1549.5703" style="stroke:#181818;stroke-width:1;" width="10" x="1647.3584" y="1242.4297"/></g><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="24" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="31" y="82.4248">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="34.4487" y="98.7217">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="47.4404" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="183.6821" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="190.6821" y="115.0186">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="408.7603" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="415.7603" y="115.0186">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="776.7329" y="95.0234"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="783.7329" y="115.0186">Key Vault</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1046.5488" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1053.5488" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1066.5884" y="98.7217">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1067.2788" y="115.0186">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1137.4863" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1160.3525" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1172.7563" y="98.7217">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1144.4863" y="115.0186">(KEM Keypair)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1260.1563" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1277.4648" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.124" x="1288.3716" y="98.7217">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1267.1563" y="115.0186">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1371.7109" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1389.0195" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.833" x="1402.5718" y="98.7217">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1378.7109" y="115.0186">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1483.2656" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1500.5742" y="82.4248">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8721" x="1513.6069" y="98.7217">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1490.2656" y="115.0186">(Temporary)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.0762" x="1594.8203" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1618.8896" y="98.7217">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.0762" x="1601.8203" y="115.0186">Temp Memory</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="68.7764" x="24" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54.7764" x="31" y="2811.9951">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="47.8789" x="34.4487" y="2828.292">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="47.4404" y="2844.5889">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3428" x="183.6821" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3428" x="190.6821" y="2811.9951">Mail Box</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="408.7603" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="415.7603" y="2811.9951">FW</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="776.7329" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="783.7329" y="2811.9951">Key Vault</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="80.9375" x="1046.5488" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1053.5488" y="2811.9951">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8584" x="1066.5884" y="2828.292">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.4775" x="1067.2788" y="2844.5889">(HEK)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="112.6699" x="1137.4863" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1160.3525" y="2811.9951">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42.1299" x="1172.7563" y="2828.292">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6699" x="1144.4863" y="2844.5889">(KEM Keypair)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1260.1563" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1277.4648" y="2811.9951">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="45.124" x="1288.3716" y="2828.292">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1267.1563" y="2844.5889">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1371.7109" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1389.0195" y="2811.9951">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.833" x="1402.5718" y="2828.292">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1378.7109" y="2844.5889">(Temporary)</text><rect fill="#E2E2F0" height="62.8906" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101.5547" x="1483.2656" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1500.5742" y="2811.9951">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.8721" x="1513.6069" y="2828.292">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87.5547" x="1490.2656" y="2844.5889">(Temporary)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115.0762" x="1594.8203" y="2792"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="66.9375" x="1618.8896" y="2811.9951">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.0762" x="1601.8203" y="2828.292">Temp Memory</text><path d="M17.425,139.3203 L17.425,179.3203 L1692.425,179.3203 L1692.425,149.3203 L1682.425,139.3203 L17.425,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1682.425,139.3203 L1682.425,149.3203 L1692.425,149.3203 L1682.425,139.3203" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="106.2026" x="728.8667" y="156.3872">Preconditions:</text><ellipse cx="734.3667" cy="167.0859" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="232.0132" x="740.8667" y="171.52">HEK in a firmware-managed KV slot</text><line style="stroke:#008000;stroke-width:1;" x1="213.3535" x2="203.3535" y1="205.7188" y2="201.7188"/><line style="stroke:#008000;stroke-width:1;" x1="213.3535" x2="203.3535" y1="205.7188" y2="209.7188"/><line style="stroke:#008000;stroke-width:1;" x1="58.3882" x2="214.3535" y1="205.7188" y2="205.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="65.3882" y="200.6528">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.9463" x="108.4072" y="200.6528">REWRAP_MPK</text><path d="M230.3535,218.7188 L230.3535,398.7188 L998.3535,398.7188 L998.3535,228.7188 L988.3535,218.7188 L230.3535,218.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M988.3535,218.7188 L988.3535,228.7188 L998.3535,228.7188 L988.3535,218.7188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="236.3535" y="237.7856">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="240.4858" y="237.7856">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="425.9961" y="237.7856">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="430.1284" y="237.7856">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="608.1929" y="237.7856">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="612.3252" y="237.7856">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="240.4858" y="252.9185">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="430.1284" y="252.9185">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="612.3252" y="252.9185">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.4932" x="240.4858" y="268.0513">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.8672" x="430.1284" y="268.0513">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.6328" x="612.3252" y="268.0513">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.3975" x="620.5898" y="283.1841">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.8105" x="620.5898" y="298.3169">* kem_handle (X)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0625" x="620.5898" y="313.4497">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.8013" x="620.5898" y="328.5825">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.6792" x="620.5898" y="343.7153">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.3779" x="240.4858" y="358.8481">wrapped_enc_access_key_2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.9321" x="430.1284" y="358.8481">DoubleWrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="371.6807" x="612.3252" y="358.8481">KEM-wrapped (access_key_2 encrypted to access_key_1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.4858" x="620.5898" y="373.981">* double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="240.4858" y="389.1138">old_locked_mpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.2344" x="430.1284" y="389.1138">EncryptedMpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.3462" x="612.3252" y="389.1138">MPK encrypted to access_key_1</text><line style="stroke:#000000;stroke-width:0.5;" x1="236.3535" x2="984.0059" y1="225.7188" y2="225.7188"/><line style="stroke:#000000;stroke-width:0.5;" x1="236.3535" x2="984.0059" y1="240.8516" y2="240.8516"/><line style="stroke:#000000;stroke-width:0.5;" x1="236.3535" x2="984.0059" y1="255.9844" y2="255.9844"/><line style="stroke:#000000;stroke-width:0.5;" x1="236.3535" x2="984.0059" y1="346.7813" y2="346.7813"/><line style="stroke:#000000;stroke-width:0.5;" x1="236.3535" x2="984.0059" y1="377.0469" y2="377.0469"/><line style="stroke:#000000;stroke-width:0.5;" x1="236.3535" x2="984.0059" y1="392.1797" y2="392.1797"/><line style="stroke:#000000;stroke-width:0.5;" x1="236.3535" x2="236.3535" y1="225.7188" y2="392.1797"/><line style="stroke:#000000;stroke-width:0.5;" x1="425.9961" x2="425.9961" y1="225.7188" y2="392.1797"/><line style="stroke:#000000;stroke-width:0.5;" x1="608.1929" x2="608.1929" y1="225.7188" y2="392.1797"/><line style="stroke:#000000;stroke-width:0.5;" x1="984.0059" x2="984.0059" y1="225.7188" y2="392.1797"/><line style="stroke:#008000;stroke-width:1;" x1="419.708" x2="409.708" y1="425.3125" y2="421.3125"/><line style="stroke:#008000;stroke-width:1;" x1="419.708" x2="409.708" y1="425.3125" y2="429.3125"/><line style="stroke:#008000;stroke-width:1;" x1="225.3535" x2="420.708" y1="425.3125" y2="425.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="232.3535" y="420.2466">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="275.3726" y="420.2466">Command</text><polygon fill="#FF0000" points="236.3535,450.4453,226.3535,454.4453,236.3535,458.4453,232.3535,454.4453" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="230.3535" x2="420.708" y1="454.4453" y2="454.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="242.3535" y="449.3794">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.187" x="285.3726" y="449.3794">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="473.708" y1="483.5781" y2="483.5781"/><line style="stroke:#FF0000;stroke-width:1;" x1="473.708" x2="473.708" y1="483.5781" y2="496.5781"/><line style="stroke:#FF0000;stroke-width:1;" x1="432.708" x2="473.708" y1="496.5781" y2="496.5781"/><polygon fill="#FF0000" points="442.708,492.5781,432.708,496.5781,442.708,500.5781,438.708,496.5781" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="478.5122">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.979" x="481.7271" y="478.5122">Determine command</text><path d="M8,508.5781 L72.4429,508.5781 L72.4429,515.7109 L62.4429,525.7109 L8,525.7109 L8,508.5781" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="2065.2266" style="stroke:#000000;stroke-width:1.5;" width="1665.3584" x="8" y="508.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="23" y="521.645">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="75.8076" x="87.4429" y="520.7886">[HEK exists]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1714.8965" x="5" y="556.2773"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="556.2773" y2="556.2773"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="559.2773" y2="559.2773"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="143.981" x="790.4578" y="545.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125.4551" x="796.4578" y="561.7778">Get Access Key 1</text><polygon fill="#FF0000" points="800.2017,641.375,810.2017,645.375,800.2017,649.375,804.2017,645.375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="645.375" y2="645.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="617.6099">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.3696" x="481.7271" y="594.9106">Decaps(KEM Pair : kem_handle (g),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="247.0508" x="531.3149" y="610.0435">KEM ciphertext : kem_ciphertext from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.4932" x="638.7554" y="625.1763">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.3018" x="531.3149" y="640.3091">Destination : Slot Y)</text><polygon fill="#FF0000" points="1176.8213,670.5078,1186.8213,674.5078,1176.8213,678.5078,1180.8213,674.5078" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1182.8213" y1="674.5078" y2="674.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="669.4419">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.7798" x="872.2207" y="669.4419">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="718.7734" y2="718.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="718.7734" y2="731.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="731.7734" y2="731.7734"/><polygon fill="#FF0000" points="833.2017,727.7734,823.2017,731.7734,833.2017,735.7734,829.2017,731.7734" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="706.1411">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.0024" x="872.2207" y="698.5747">Decap KEM Ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.104" x="872.2207" y="713.7075">with Keypair</text><polygon fill="#FF0000" points="1405.4883,756.9063,1415.4883,760.9063,1405.4883,764.9063,1409.4883,760.9063" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="760.9063" y2="760.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="755.8403">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117.3301" x="872.2207" y="755.8403">Put Shared Secret</text><polygon fill="#FF0000" points="442.708,786.0391,432.708,790.0391,442.708,794.0391,438.708,790.0391" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="790.0391" y2="790.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="784.9731">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="784.9731">done</text><polygon fill="#FF0000" points="800.2017,845.4375,810.2017,849.4375,800.2017,853.4375,804.2017,849.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="849.4375" y2="849.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="829.2388">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.8701" x="481.7271" y="814.106">Unwrap(Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="227.6587" x="531.3149" y="829.2388">Key Data : wrapped_access_key_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2666" x="531.3149" y="844.3716">Destination : Slot Z)</text><polygon fill="#FF0000" points="1405.4883,874.5703,1415.4883,878.5703,1405.4883,882.5703,1409.4883,878.5703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="878.5703" y2="878.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="873.5044">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.3232" x="872.2207" y="873.5044">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="922.8359" y2="922.8359"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="922.8359" y2="935.8359"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="935.8359" y2="935.8359"/><polygon fill="#FF0000" points="833.2017,931.8359,823.2017,935.8359,833.2017,939.8359,829.2017,935.8359" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="910.2036">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.9497" x="872.2207" y="902.6372">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.4932" x="872.2207" y="917.77">wrapped_access_key_1</text><polygon fill="#FF0000" points="1517.043,960.9688,1527.043,964.9688,1517.043,968.9688,1521.043,964.9688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1523.043" y1="964.9688" y2="964.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="959.9028">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.792" x="872.2207" y="959.9028">Put Access Key 1</text><polygon fill="#FF0000" points="442.708,990.1016,432.708,994.1016,442.708,998.1016,438.708,994.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="994.1016" y2="994.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="989.0356">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="989.0356">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1714.8965" x="5" y="1022.668"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="1022.668" y2="1022.668"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="1025.668" y2="1025.668"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="143.981" x="790.4578" y="1012.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="125.4551" x="796.4578" y="1028.1685">Get Access Key 2</text><polygon fill="#FF0000" points="800.2017,1107.7656,810.2017,1111.7656,800.2017,1115.7656,804.2017,1111.7656" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="1111.7656" y2="1111.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="1084.0005">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.0024" x="481.7271" y="1061.3013">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="268.8867" x="531.3149" y="1076.4341">Key Data: double_encrypted_access_key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9795" x="531.3149" y="1091.5669">Destination Memory:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.6084" x="671.4268" y="1091.5669">Put in memory</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.6899" x="481.7271" y="1106.6997">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="84.6841" x="659.417" y="1106.6997">as not a key)</text><polygon fill="#FF0000" points="1405.4883,1136.8984,1415.4883,1140.8984,1405.4883,1144.8984,1409.4883,1140.8984" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="1140.8984" y2="1140.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1135.8325">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.3232" x="872.2207" y="1135.8325">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="1200.2969" y2="1200.2969"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="1200.2969" y2="1213.2969"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="1213.2969" y2="1213.2969"/><polygon fill="#FF0000" points="833.2017,1209.2969,823.2017,1213.2969,833.2017,1217.2969,829.2017,1213.2969" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1180.0981">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.9497" x="872.2207" y="1164.9653">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.8535" x="872.2207" y="1180.0981">double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.7007" x="872.2207" y="1195.231">with Slot Y</text><polygon fill="#FF0000" points="1635.3584,1238.4297,1645.3584,1242.4297,1635.3584,1246.4297,1639.3584,1242.4297" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1641.3584" y1="1242.4297" y2="1242.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1237.3638">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.854" x="872.2207" y="1237.3638">Encrypted Access Key 2</text><polygon fill="#FF0000" points="442.708,1267.5625,432.708,1271.5625,442.708,1275.5625,438.708,1271.5625" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="1271.5625" y2="1271.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="1266.4966">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="1266.4966">done</text><polygon fill="#FF0000" points="800.2017,1326.9609,810.2017,1330.9609,800.2017,1334.9609,804.2017,1330.9609" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="1330.9609" y2="1330.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="1310.7622">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.835" x="481.7271" y="1295.6294">Unwrap(Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170.022" x="531.3149" y="1310.7622">Key Data : Temp Memory,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.3018" x="531.3149" y="1325.895">Destination : Slot Y)</text><polygon fill="#FF0000" points="1517.043,1356.0938,1527.043,1360.0938,1517.043,1364.0938,1521.043,1360.0938" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1523.043" y1="1360.0938" y2="1360.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1355.0278">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.7852" x="872.2207" y="1355.0278">Get Access Key 1</text><polygon fill="#FF0000" points="1635.3584,1385.2266,1645.3584,1389.2266,1635.3584,1393.2266,1639.3584,1389.2266" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1641.3584" y1="1389.2266" y2="1389.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1384.1606">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.3481" x="872.2207" y="1384.1606">Get encrypted_access_key</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="1418.3594" y2="1418.3594"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="1418.3594" y2="1431.3594"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="1431.3594" y2="1431.3594"/><polygon fill="#FF0000" points="833.2017,1427.3594,823.2017,1431.3594,833.2017,1435.3594,829.2017,1431.3594" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1413.2935">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.7969" x="872.2207" y="1413.2935">Unwrap encrypted access key 2</text><polygon fill="#FF0000" points="1405.4883,1456.4922,1415.4883,1460.4922,1405.4883,1464.4922,1409.4883,1460.4922" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="1460.4922" y2="1460.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1455.4263">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.792" x="872.2207" y="1455.4263">Put Access Key 2</text><polygon fill="#FF0000" points="442.708,1485.625,432.708,1489.625,442.708,1493.625,438.708,1489.625" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="1489.625" y2="1489.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="1484.5591">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="1484.5591">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1714.8965" x="5" y="1518.1914"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="1518.1914" y2="1518.1914"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="1521.1914" y2="1521.1914"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="309.2168" x="707.8398" y="1507.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="290.6909" x="713.8398" y="1523.6919">Create MPK wrapping/unwrapping Keys</text><polygon fill="#FF0000" points="800.2017,1588.1563,810.2017,1592.1563,800.2017,1596.1563,804.2017,1592.1563" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="1592.1563" y2="1592.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="1571.9575">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.9673" x="481.7271" y="1556.8247">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.9858" x="585.0352" y="1571.9575">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.2148" x="585.0352" y="1587.0903">Destination : Slot W)</text><polygon fill="#FF0000" points="1070.0176,1617.2891,1080.0176,1621.2891,1070.0176,1625.2891,1074.0176,1621.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1076.0176" y1="1621.2891" y2="1621.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1616.2231">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8154" x="872.2207" y="1616.2231">Get HEK</text><polygon fill="#FF0000" points="1517.043,1646.4219,1527.043,1650.4219,1517.043,1654.4219,1521.043,1650.4219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1523.043" y1="1650.4219" y2="1650.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1645.356">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.7852" x="872.2207" y="1645.356">Get Access Key 1</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="1679.5547" y2="1679.5547"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="1679.5547" y2="1692.5547"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="1692.5547" y2="1692.5547"/><polygon fill="#FF0000" points="833.2017,1688.5547,823.2017,1692.5547,833.2017,1696.5547,829.2017,1692.5547" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1674.4888">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.043" x="872.2207" y="1674.4888">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1293.9336,1717.6875,1303.9336,1721.6875,1293.9336,1725.6875,1297.9336,1721.6875" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1299.9336" y1="1721.6875" y2="1721.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1716.6216">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.6045" x="872.2207" y="1716.6216">HMAC512 result Old encryption key for locked MPK</text><polygon fill="#FF0000" points="442.708,1746.8203,432.708,1750.8203,442.708,1754.8203,438.708,1750.8203" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="1750.8203" y2="1750.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="1745.7544">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="1745.7544">done</text><polygon fill="#FF0000" points="800.2017,1806.2188,810.2017,1810.2188,800.2017,1814.2188,804.2017,1810.2188" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="1810.2188" y2="1810.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="1790.02">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.9673" x="481.7271" y="1774.8872">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.021" x="585.0352" y="1790.02">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2666" x="585.0352" y="1805.1528">Destination : Slot Z)</text><polygon fill="#FF0000" points="1070.0176,1835.3516,1080.0176,1839.3516,1070.0176,1843.3516,1074.0176,1839.3516" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1076.0176" y1="1839.3516" y2="1839.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1834.2856">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8154" x="872.2207" y="1834.2856">Get HEK</text><polygon fill="#FF0000" points="1405.4883,1864.4844,1415.4883,1868.4844,1405.4883,1872.4844,1409.4883,1868.4844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="1868.4844" y2="1868.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1863.4185">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.7852" x="872.2207" y="1863.4185">Get Access Key 2</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="1897.6172" y2="1897.6172"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="1897.6172" y2="1910.6172"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="1910.6172" y2="1910.6172"/><polygon fill="#FF0000" points="833.2017,1906.6172,823.2017,1910.6172,833.2017,1914.6172,829.2017,1910.6172" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1892.5513">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.0781" x="872.2207" y="1892.5513">HMAC512 slot A and Slot Y</text><polygon fill="#FF0000" points="1517.043,1935.75,1527.043,1939.75,1517.043,1943.75,1521.043,1939.75" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1523.043" y1="1939.75" y2="1939.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="1934.6841">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.8633" x="872.2207" y="1934.6841">HMAC512 result New encryption key for locked MPK</text><polygon fill="#FF0000" points="442.708,1964.8828,432.708,1968.8828,442.708,1972.8828,438.708,1968.8828" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="1968.8828" y2="1968.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="1963.8169">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="1963.8169">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1714.8965" x="5" y="1997.4492"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="1997.4492" y2="1997.4492"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="2000.4492" y2="2000.4492"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="81.2915" x="821.8025" y="1986.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="62.7656" x="827.8025" y="2002.9497">Get MPK</text><polygon fill="#FF0000" points="800.2017,2067.4141,810.2017,2071.4141,800.2017,2075.4141,804.2017,2071.4141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="2071.4141" y2="2071.4141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="2051.2153">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.9155" x="481.7271" y="2036.0825">Unwrap(Key : Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.3359" x="531.3149" y="2051.2153">Key Data: locked_mpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.3018" x="531.3149" y="2066.3481">Destination : Slot Y)</text><polygon fill="#FF0000" points="1293.9336,2096.5469,1303.9336,2100.5469,1293.9336,2104.5469,1297.9336,2100.5469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1299.9336" y1="2100.5469" y2="2100.5469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2095.481">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.501" x="872.2207" y="2095.481">Old encryption key for locked MPK</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="2129.6797" y2="2129.6797"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="2129.6797" y2="2142.6797"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="2142.6797" y2="2142.6797"/><polygon fill="#FF0000" points="833.2017,2138.6797,823.2017,2142.6797,833.2017,2146.6797,829.2017,2142.6797" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2124.6138">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.5171" x="872.2207" y="2124.6138">Unwrap locked_mpk</text><polygon fill="#FF0000" points="1405.4883,2167.8125,1415.4883,2171.8125,1405.4883,2175.8125,1409.4883,2171.8125" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="2171.8125" y2="2171.8125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2166.7466">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.5806" x="872.2207" y="2166.7466">MPK</text><polygon fill="#FF0000" points="442.708,2196.9453,432.708,2200.9453,442.708,2204.9453,438.708,2200.9453" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="2200.9453" y2="2200.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="2195.8794">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="2195.8794">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1714.8965" x="5" y="2229.5117"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="2229.5117" y2="2229.5117"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1719.8965" y1="2232.5117" y2="2232.5117"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="185.3613" x="769.7676" y="2218.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="166.8354" x="775.7676" y="2235.0122">Create the locked MPK</text><polygon fill="#FF0000" points="800.2017,2299.4766,810.2017,2303.4766,800.2017,2307.4766,804.2017,2303.4766" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="2303.4766" y2="2303.4766"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="2283.2778">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.3022" x="481.7271" y="2268.145">Wrap(Key: Slot Z,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.021" x="535.4473" y="2283.2778">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.1187" x="535.4473" y="2298.4106">Destination : new_locked_mpk)</text><polygon fill="#FF0000" points="1517.043,2328.6094,1527.043,2332.6094,1517.043,2336.6094,1521.043,2332.6094" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1523.043" y1="2332.6094" y2="2332.6094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2327.5435">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="257.061" x="872.2207" y="2327.5435">Get New encryption key for locked MPK</text><polygon fill="#FF0000" points="1405.4883,2357.7422,1415.4883,2361.7422,1405.4883,2365.7422,1409.4883,2361.7422" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="2361.7422" y2="2361.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2356.6763">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.8818" x="872.2207" y="2356.6763">Get MPK</text><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="864.2017" y1="2406.0078" y2="2406.0078"/><line style="stroke:#FF0000;stroke-width:1;" x1="864.2017" x2="864.2017" y1="2406.0078" y2="2419.0078"/><line style="stroke:#FF0000;stroke-width:1;" x1="823.2017" x2="864.2017" y1="2419.0078" y2="2419.0078"/><polygon fill="#FF0000" points="833.2017,2415.0078,823.2017,2419.0078,833.2017,2423.0078,829.2017,2419.0078" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2393.3755">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.0391" x="872.2207" y="2385.8091">Wrap slot Y with Slot Z to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.3613" x="872.2207" y="2400.9419">generate new_encrypted_mpk</text><polygon fill="#FF0000" points="442.708,2444.1406,432.708,2448.1406,442.708,2452.1406,438.708,2448.1406" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="2448.1406" y2="2448.1406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="2443.0747">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3354" x="491.7271" y="2443.0747">new_encrypted_mpk</text><polygon fill="#FF0000" points="800.2017,2503.5391,810.2017,2507.5391,800.2017,2511.5391,804.2017,2507.5391" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="431.708" x2="806.2017" y1="2507.5391" y2="2507.5391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="438.708" y="2487.3403">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.2266" x="481.7271" y="2472.2075">Purge_key(Key: Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.981" x="547.8442" y="2487.3403">Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="79.8853" x="547.8442" y="2502.4731">Key : Slot Z)</text><polygon fill="#FF0000" points="1293.9336,2532.6719,1303.9336,2536.6719,1293.9336,2540.6719,1297.9336,2536.6719" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1299.9336" y1="2536.6719" y2="2536.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2531.606">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="37.6733" x="872.2207" y="2531.606">Purge</text><polygon fill="#FF0000" points="1405.4883,2532.6719,1415.4883,2536.6719,1405.4883,2540.6719,1409.4883,2536.6719" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1411.4883" y1="2536.6719" y2="2536.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2531.606">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="872.2207" y="2531.606">&#160;</text><polygon fill="#FF0000" points="1517.043,2532.6719,1527.043,2536.6719,1517.043,2540.6719,1521.043,2536.6719" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="822.2017" x2="1523.043" y1="2536.6719" y2="2536.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="829.2017" y="2531.606">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="872.2207" y="2531.606">&#160;</text><polygon fill="#FF0000" points="442.708,2561.8047,432.708,2565.8047,442.708,2569.8047,438.708,2565.8047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="436.708" x2="811.2017" y1="2565.8047" y2="2565.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="448.708" y="2560.7388">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4429" x="491.7271" y="2560.7388">done</text><path d="M1425.271,2592.8047 L1425.271,2647.8047 L1647.271,2647.8047 L1647.271,2602.8047 L1637.271,2592.8047 L1425.271,2592.8047" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1637.271,2592.8047 L1637.271,2602.8047 L1647.271,2602.8047 L1637.271,2592.8047" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="186.1069" x="1431.271" y="2609.8716">Did not purge temp memory</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.0874" x="1431.271" y="2625.0044">as it contains encrypted object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="38.0859" x="1431.271" y="2640.1372">purge</text><polygon fill="#FF0000" points="231.3535,2685.4688,221.3535,2689.4688,231.3535,2693.4688,227.3535,2689.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="225.3535" x2="420.708" y1="2689.4688" y2="2689.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="237.3535" y="2676.8364">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.2793" x="280.3726" y="2669.27">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3354" x="280.3726" y="2684.4028">new_encrypted_mpk</text><line style="stroke:#008000;stroke-width:1;" x1="64.3882" x2="74.3882" y1="2689.4688" y2="2685.4688"/><line style="stroke:#008000;stroke-width:1;" x1="64.3882" x2="74.3882" y1="2689.4688" y2="2693.4688"/><line style="stroke:#008000;stroke-width:1;" x1="63.3882" x2="219.3535" y1="2689.4688" y2="2689.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="80.3882" y="2676.8364">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.8154" x="123.4072" y="2669.27">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60.7217" x="123.4072" y="2684.4028">complete</text><path d="M225.3535,2702.4688 L225.3535,2776.4688 L858.3535,2776.4688 L858.3535,2712.4688 L848.3535,2702.4688 L225.3535,2702.4688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M848.3535,2702.4688 L848.3535,2712.4688 L858.3535,2712.4688 L848.3535,2702.4688" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="231.3535" y="2721.5356">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.915" x="235.4858" y="2721.5356">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="378.0859" y="2721.5356">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.2021" x="382.2183" y="2721.5356">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="483.7173" y="2721.5356">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="72.2871" x="487.8496" y="2721.5356">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="50.5908" x="235.4858" y="2736.6685">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="382.2183" y="2736.6685">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="81.0977" x="487.8496" y="2736.6685">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="69.6592" x="235.4858" y="2751.8013">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.7813" x="382.2183" y="2751.8013">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="351.5078" x="487.8496" y="2751.8013">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.3354" x="235.4858" y="2766.9341">new_encrypted_mpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.2344" x="382.2183" y="2766.9341">EncryptedMpk</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="207.3462" x="487.8496" y="2766.9341">MPK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="231.3535" x2="843.4897" y1="2709.4688" y2="2709.4688"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.3535" x2="843.4897" y1="2724.6016" y2="2724.6016"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.3535" x2="843.4897" y1="2739.7344" y2="2739.7344"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.3535" x2="843.4897" y1="2754.8672" y2="2754.8672"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.3535" x2="843.4897" y1="2770" y2="2770"/><line style="stroke:#000000;stroke-width:0.5;" x1="231.3535" x2="231.3535" y1="2709.4688" y2="2770"/><line style="stroke:#000000;stroke-width:0.5;" x1="378.0859" x2="378.0859" y1="2709.4688" y2="2770"/><line style="stroke:#000000;stroke-width:0.5;" x1="483.7173" x2="483.7173" y1="2709.4688" y2="2770"/><line style="stroke:#000000;stroke-width:0.5;" x1="843.4897" x2="843.4897" y1="2709.4688" y2="2770"/><!--SRC=[nLXjJzj84FxkNp4Wr8CZQGMd-nArI3aIMiJHHa2R0o5PZhrEzcBlMhiRtA3- -9jTlyHsrY6qfMVn8NXsPcUUPsPsl3kK-T4Y8C3zn8suFtSNYaRoDRvsd1qQmlwUdF7KLLH5vC01V6xqJzYz8gdm4hWSNUmwEuG5DAmf98Bud0MP2kEAWESBBgNvNpzl9oUZR0rLb3FPU_jcSb9AVuSFmmkW33m8gOXJJv1kx35lIWAu-08ouiginOsDzTA56PaV7iBUNv_FpePNRl_qvlnB_-RyqqTdJkAfNU8uOGfxdbmo7-89hkd1rN1yrH-v65mjA2-XbO04dSuKQfHEVzD1dL4I1T1yZEYQFXAhO412oWmCyArYpP_DvI86i5XR_74CLi7VL6bwD1fUtPgcAo61w_a-aTATawLxb8l6cQXl91TaMUfS32-xkHvaUe1wzymmL37aHLCkg9h5kGZ1TcSU2z2J_NyEAYzj2tsQp8XGvAlANnBcYsMYQhvQGy65rN2EKJJWYqb4rWAgXx9VKogt0yMhGHqLZWV6flkaMpmAJ0tXYZYPrsWP5hgN3G6cMBi3kVMr98ydHRxwOMeIzfJ7M1v1BLjZENKJJqZAfbdM-ZhFypH7dVT4WP_hQN4ywNRDZpr9ed1_5vVlTc1tG1GHCMMaMBnxW8v4agoK2h-yI9cw9L-fLD8n2zwzCnjbL83cuWZVDVoPFnmUzc10V2-H-yWKZ3mgqCLg7aqFEeQFyj7hLhcJhwwy20MFwnhjZwquwhe38XLbdYdI7bnZ0uBR3DRvGn45jfWCLkqQXffW58qb3tcOPibf9VDJh0gxZY9nikp1QA7WUeQDC81huWkIDK0ZjFSrBQwaGy1Pti5hrf64RXSZqk9CfUGsMvSdHS6nbRdFJ0Euhzaji6bmXPA1fpmKsw3kF8drtO4L50tsEYWrk3FVxfbjttMRZndGrNGjSNxybJZRQ-UuhNOi37Ji5FGszRCDH5oIc0k4_6t8cMuS4HVl4FSJ3HSUrB4HRrjlsGZGiEH9tURmo4T7VfZk3K7cnPQXjBuFHj9RDUmQ-ivlvUaVaL1b_wu7CiPfHv2YhsF_1JKZbGCKQLGfzKb73pUorOpnig5v1DWEzKi6qanFKAngio8plAJ1wpMSXv2YzpIc2lX2L6qN_dBMPYixlcSgrYTLVzWVT40k_1aWS_tXTVVzwML7M_Tnz10aYJo_rIlSVR94glNf597ArcKyK7CSjsWpfLtFGMaW9V5FSfzwciS0S_zrPgCyK8lAHif_TMq_NS1thItq1btEwx7px5CgxtBDGxcb3lGoMmsr5LvbcAdcU-k9Lgkk5poni9MU2eA9O2OkSnPWvhrPiEAdTa6sTTSFb_tJFu-ENGseh7BKxspeU8QjTaBX2UB63UBmqoRZ0qUixw1KSvJ7ORwVe6-g9lDitLwwMYs8NE1azmc_QofrgdaDkO1iujMmbkMK_j_5z7FukdqUNtVFuckvnjVnzdpTMlblyFMHf5lmzQAJYwwrhGUMSUl0ilge-gvkXwcyNUxQ-jbgRok7BmTZestfqstbRXkgunpJ8YMRwVvKYjSHPIIjVD2sdoFRPPej_Qt8wo2obB-5rQHsXpF7FPiIHeJ6G_ksEfWAUhQdeKN_-Rrcj11Jee_42kvZIvlPC9etnBPldHHsTY3Vp4XVDV14kUtzO_7-foSeqTSDvIXSJ0oERK8RK3DlGQAzDolppmMdvJE0wl-PyYYJbO62J_ubVZRo6qjEESSvJkDk8xyFqQqmuKoIUxREzojOtQFKhr7kcS_Z92BQyWzU_pKl_fvvtzUywTjqmHVIHBfIUMeXszNFKS_7-a6CGzDJyaiTe1BEpaVNWDEGu0yQRVmsO424m1_LRTQ0NB_VsdojTTnohMNop_aF]--></g></svg>