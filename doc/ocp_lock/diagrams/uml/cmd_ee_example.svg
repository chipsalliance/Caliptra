<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="601px" preserveAspectRatio="none" style="width:949px;height:601px;background:#FFFFFF;" version="1.1" viewBox="0 0 949 601" width="949px" zoomAndPan="magnify"><title>Example of a command to the encryption engine to load an MEK</title><defs/><g><rect fill="#DDDDDD" height="552.1797" style="stroke:#181818;stroke-width:0.5;" width="81.9287" x="31.9197" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="57.9287" x="43.9197" y="55.3638">Caliptra</text><rect fill="#DDDDDD" height="552.1797" style="stroke:#181818;stroke-width:0.5;" width="520.1465" x="254.9158" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="133.3198" x="448.3291" y="55.3638">Encryption engine</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="507.2949" x="243.9723" y="27.9951">Example of a command to the encryption engine to load an MEK</text><g><title>FW</title><rect fill="#000000" fill-opacity="0.00000" height="431.8594" width="8" x="69.384" y="110.0234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="72.884" x2="72.884" y1="110.0234" y2="541.8828"/></g><g><title/><rect fill="#FFFFFF" height="383.7266" style="stroke:#181818;stroke-width:1;" width="10" x="67.884" y="153.1563"/></g><g><title>SFR</title><rect fill="#000000" fill-opacity="0.00000" height="431.8594" width="8" x="293.7551" y="110.0234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="297.2551" x2="297.2551" y1="110.0234" y2="541.8828"/></g><g><title>Control</title><rect fill="#000000" fill-opacity="0.00000" height="431.8594" width="8" x="532.0129" y="110.0234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="535.5129" x2="535.5129" y1="110.0234" y2="541.8828"/></g><g><title/><rect fill="#FFFFFF" height="423.8594" style="stroke:#181818;stroke-width:1;" width="10" x="530.5129" y="118.0234"/></g><g><title>Key cache</title><rect fill="#000000" fill-opacity="0.00000" height="431.8594" width="8" x="724.5676" y="110.0234"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="728.0676" x2="728.0676" y1="110.0234" y2="541.8828"/></g><g><title/><rect fill="#FFFFFF" height="80.832" style="stroke:#181818;stroke-width:1;" width="10" x="723.0676" y="261.6875"/></g><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="54.9363" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="61.9363" y="98.7217">FW</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76.6787" x="258.9158" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.667" x="283.9216" y="82.4248">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.6787" x="265.9158" y="98.7217">Interface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.9141" x="503.0559" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.9141" x="510.0559" y="98.7217">Control</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.9893" x="685.073" y="78.7266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.9893" x="692.073" y="98.7217">Key cache</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="35.8955" x="54.9363" y="541.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="21.8955" x="61.9363" y="561.8779">FW</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76.6787" x="258.9158" y="541.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="26.667" x="283.9216" y="561.8779">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62.6787" x="265.9158" y="578.1748">Interface</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.9141" x="503.0559" y="541.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.9141" x="510.0559" y="561.8779">Control</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="85.9893" x="685.073" y="541.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="71.9893" x="692.073" y="561.8779">Key cache</text><path d="M469.5725,123.0234 L469.5725,148.0234 L600.5725,148.0234 L600.5725,133.0234 L590.5725,123.0234 L469.5725,123.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M590.5725,123.0234 L590.5725,133.0234 L600.5725,133.0234 L590.5725,123.0234" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.5366" x="475.5725" y="140.0903">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.7837" x="531.2415" y="140.0903">EXE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.2959" x="563.1575" y="140.0903">= 1</text><polygon fill="#FF0000" points="285.2551,170.2891,295.2551,174.2891,285.2551,178.2891,289.2551,174.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="77.884" x2="291.2551" y1="174.2891" y2="174.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="84.884" y="169.2231">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.6841" x="127.9031" y="169.2231">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.4756" x="164.7195" y="169.2231">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="206.1951" y="169.2231">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.6401" x="214.4597" y="169.2231">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="245.0999" y="169.2231">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.8906" x="253.3645" y="169.2231">MEK</text><polygon fill="#FF0000" points="285.2551,199.4219,295.2551,203.4219,285.2551,207.4219,289.2551,203.4219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="77.884" x2="291.2551" y1="203.4219" y2="203.4219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="84.884" y="198.356">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.6841" x="127.9031" y="198.356">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33.2681" x="164.7195" y="198.356">CMD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.4282" x="202.1199" y="198.356">= 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.7837" x="233.6804" y="198.356">EXE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.1636" x="261.4641" y="198.356">=1</text><polygon fill="#FF0000" points="308.2551,228.5547,298.2551,232.5547,308.2551,236.5547,304.2551,232.5547" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="302.2551" x2="529.5129" y1="232.5547" y2="232.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="314.2551" y="227.4888">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29.561" x="357.2742" y="227.4888">read</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.4756" x="390.9675" y="227.4888">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="432.4431" y="227.4888">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.6401" x="440.7078" y="227.4888">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="471.3479" y="227.4888">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.8906" x="475.4802" y="227.4888">MEK</text><path d="M10,249.1211 L10,274.1211 L135,274.1211 L135,259.1211 L125,249.1211 L10,249.1211" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M125,249.1211 L125,259.1211 L135,259.1211 L125,249.1211" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.5366" x="16" y="266.188">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.6709" x="71.6689" y="266.188">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.2959" x="97.4722" y="266.188">= 1</text><line style="stroke:#008000;stroke-width:1;" x1="721.0676" x2="711.0676" y1="261.6875" y2="257.6875"/><line style="stroke:#008000;stroke-width:1;" x1="721.0676" x2="711.0676" y1="261.6875" y2="265.6875"/><line style="stroke:#008000;stroke-width:1;" x1="540.5129" x2="722.0676" y1="261.6875" y2="261.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="547.5129" y="256.6216">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.4756" x="590.532" y="256.6216">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="632.0076" y="256.6216">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.6401" x="640.2722" y="256.6216">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="670.9124" y="256.6216">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.8906" x="679.177" y="256.6216">MEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="733.0676" x2="775.0676" y1="300.3867" y2="300.3867"/><line style="stroke:#FF0000;stroke-width:1;" x1="775.0676" x2="775.0676" y1="300.3867" y2="313.3867"/><line style="stroke:#FF0000;stroke-width:1;" x1="734.0676" x2="775.0676" y1="313.3867" y2="313.3867"/><polygon fill="#FF0000" points="744.0676,309.3867,734.0676,313.3867,744.0676,317.3867,740.0676,313.3867" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="740.0676" y="295.3208">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.6455" x="783.0867" y="295.3208">Store</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.4756" x="821.8645" y="295.3208">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="863.3401" y="295.3208">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30.6401" x="871.6047" y="295.3208">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1323" x="902.2449" y="295.3208">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.8906" x="910.5095" y="295.3208">MEK</text><line style="stroke:#008000;stroke-width:1;" x1="541.5129" x2="551.5129" y1="342.5195" y2="338.5195"/><line style="stroke:#008000;stroke-width:1;" x1="541.5129" x2="551.5129" y1="342.5195" y2="346.5195"/><line style="stroke:#008000;stroke-width:1;" x1="540.5129" x2="722.0676" y1="342.5195" y2="342.5195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="557.5129" y="337.4536">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.7964" x="600.532" y="337.4536">No error</text><line style="stroke:#008000;stroke-width:1;" x1="298.2551" x2="308.2551" y1="371.6523" y2="367.6523"/><line style="stroke:#008000;stroke-width:1;" x1="298.2551" x2="308.2551" y1="371.6523" y2="375.6523"/><line style="stroke:#008000;stroke-width:1;" x1="297.2551" x2="529.5129" y1="371.6523" y2="371.6523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="314.2551" y="366.5864">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.6841" x="357.2742" y="366.5864">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.9009" x="394.0906" y="366.5864">ERR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.4282" x="427.1238" y="366.5864">= 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.6709" x="458.6843" y="366.5864">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="19.1636" x="480.3552" y="366.5864">=1</text><path d="M472.6289,388.2188 L472.6289,413.2188 L597.6289,413.2188 L597.6289,398.2188 L587.6289,388.2188 L472.6289,388.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M587.6289,388.2188 L587.6289,398.2188 L597.6289,398.2188 L587.6289,388.2188" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.5366" x="478.6289" y="405.2856">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.6709" x="534.2979" y="405.2856">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.2959" x="560.1011" y="405.2856">= 1</text><line style="stroke:#008000;stroke-width:1;" x1="295.2551" x2="285.2551" y1="400.7852" y2="396.7852"/><line style="stroke:#008000;stroke-width:1;" x1="295.2551" x2="285.2551" y1="400.7852" y2="404.7852"/><line style="stroke:#008000;stroke-width:1;" x1="77.884" x2="296.2551" y1="400.7852" y2="400.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="84.884" y="395.7192">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29.561" x="127.9031" y="395.7192">read</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.9009" x="161.5964" y="395.7192">ERR</text><line style="stroke:#008000;stroke-width:1;" x1="295.2551" x2="285.2551" y1="439.4844" y2="435.4844"/><line style="stroke:#008000;stroke-width:1;" x1="295.2551" x2="285.2551" y1="439.4844" y2="443.4844"/><line style="stroke:#008000;stroke-width:1;" x1="77.884" x2="296.2551" y1="439.4844" y2="439.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="84.884" y="434.4185">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.6841" x="127.9031" y="434.4185">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.6709" x="164.7195" y="434.4185">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.2959" x="190.5227" y="434.4185">= 1</text><path d="M10,457.4844 L10,482.4844 L135,482.4844 L135,467.4844 L125,457.4844 L10,457.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M125,457.4844 L125,467.4844 L135,467.4844 L125,457.4844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="51.5366" x="16" y="474.5513">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.6709" x="71.6689" y="474.5513">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.2959" x="97.4722" y="474.5513">= 0</text><line style="stroke:#008000;stroke-width:1;" x1="298.2551" x2="308.2551" y1="523.8828" y2="519.8828"/><line style="stroke:#008000;stroke-width:1;" x1="298.2551" x2="308.2551" y1="523.8828" y2="527.8828"/><line style="stroke:#008000;stroke-width:1;" x1="297.2551" x2="529.5129" y1="523.8828" y2="523.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="39.019" x="314.2551" y="511.2505">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.6841" x="357.2742" y="503.6841">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33.2681" x="394.0906" y="503.6841">CMD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.4282" x="431.491" y="503.6841">= 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.9009" x="463.0515" y="503.6841">ERR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.4282" x="496.0847" y="503.6841">= 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.0586" x="357.2742" y="518.8169">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21.6709" x="390.3328" y="518.8169">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.4282" x="416.136" y="518.8169">= 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.7837" x="447.6965" y="518.8169">EXE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.2959" x="479.6125" y="518.8169">= 0</text><!--SRC=[ZLBBRi8m4BpxAnQ4-b2I5Wwz842gIauL72Ye72eXusoAHR2HOqgHyl5TGqf28HK-H9F4i_EmQrA9P1CXQB6U9LeiPniha_I1FZDMap7SDTA5tiwij0dUCw0rTX3guJTVhGde63W8lLfn5O7LO1S8g8JPhQtKYk2dLEX-99f7m1KCmjSwgw6APCmOekSnfhIbGLze076lySwbXLWRwCnxuJJiFCvxq8KM8nQupOo9U4jCUa8ZtIa1QMoW3LiZQHAH1k6uxrY-UtcUJ8-Or1skPhuC-hzoVac-st9cJoW6AL25Lbcg58zKp_BrXnVYtJWjlXTR2iyZjMj2BKLka40RtgmsU3Nl88OO14GTQa1Zj665ZJyrXQDHRhlf5obSI_yUvkMm-yFW5whDLHWxst4qKfgOPKzPTdNTpPA3s-8wEDIkObJtKLoRGn_bVZuKvEl4htzwkvikP12m7m00]--></g></svg>