<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="605px" preserveAspectRatio="none" style="width:895px;height:605px;background:#FFFFFF;" version="1.1" viewBox="0 0 895 605" width="895px" zoomAndPan="magnify"><title>Example of a command to the encryption engine to load an MEK</title><defs/><g><rect fill="#DDDDDD" height="555.6113" style="stroke:#181818;stroke-width:0.5;" width="76.7935" x="32.2593" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="44.2593" y="56.0566">Caliptra</text><rect fill="#DDDDDD" height="555.6113" style="stroke:#181818;stroke-width:0.5;" width="492.3374" x="240.6545" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.1006" x="426.2729" y="56.0566">Encryption engine</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="461.877" x="239.9449" y="28.5352">Example of a command to the encryption engine to load an MEK</text><g><title>FW</title><rect fill="transparent" height="434.3477" width="8" x="67.156" y="110.7754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="70.656" x2="70.656" y1="110.7754" y2="545.123"/></g><g><title/><rect fill="#FFFFFF" height="386.0371" style="stroke:#181818;stroke-width:1;" width="10" x="65.656" y="154.0859"/></g><g><title>SFR</title><rect fill="transparent" height="434.3477" width="8" x="277.8225" y="110.7754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="281.3225" x2="281.3225" y1="110.7754" y2="545.123"/></g><g><title>Control</title><rect fill="transparent" height="434.3477" width="8" x="504.5149" y="110.7754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="508.0149" x2="508.0149" y1="110.7754" y2="545.123"/></g><g><title/><rect fill="#FFFFFF" height="426.3477" style="stroke:#181818;stroke-width:1;" width="10" x="503.0149" y="118.7754"/></g><g><title>Key cache</title><rect fill="transparent" height="434.3477" width="8" x="684.8694" y="110.7754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="688.3694" x2="688.3694" y1="110.7754" y2="545.123"/></g><g><title/><rect fill="#FFFFFF" height="81.2764" style="stroke:#181818;stroke-width:1;" width="10" x="683.3694" y="263.3281"/></g><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="53.9148" y="79.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="60.9148" y="99.8223">FW</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="244.6545" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="269.3733" y="83.334">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="251.6545" y="99.8223">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="475.7219" y="79.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="482.7219" y="99.8223">Control</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81.2451" x="647.7468" y="79.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.2451" x="654.7468" y="99.8223">Key cache</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="53.9148" y="545.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="60.9148" y="565.6582">FW</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="244.6545" y="545.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="269.3733" y="565.6582">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="251.6545" y="582.1465">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="475.7219" y="545.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="482.7219" y="565.6582">Control</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81.2451" x="647.7468" y="545.123"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.2451" x="654.7468" y="565.6582">Key cache</text><path d="M445.3657,123.7754 L445.3657,148.7754 L570.3657,148.7754 L570.3657,133.7754 L560.3657,123.7754 L445.3657,123.7754 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M560.3657,123.7754 L560.3657,133.7754 L570.3657,133.7754 L560.3657,123.7754 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1182" x="451.3657" y="141.3438">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.2861" x="504.5972" y="141.3438">EXE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6675" x="532.9966" y="141.3438">= 1</text><polygon fill="#FF0000" points="269.3225,171.3965,279.3225,175.3965,269.3225,179.3965,273.3225,175.3965" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="75.656" x2="275.3225" y1="175.3965" y2="175.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="82.656" y="170.6543">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.1987" x="122.0188" y="170.6543">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.8857" x="157.3308" y="170.6543">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="196.2166" y="170.6543">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.8154" x="204.4431" y="170.6543">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="232.2585" y="170.6543">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.8374" x="240.4851" y="170.6543">MEK</text><polygon fill="#FF0000" points="269.3225,200.707,279.3225,204.707,269.3225,208.707,273.3225,204.707" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="75.656" x2="275.3225" y1="204.707" y2="204.707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="82.656" y="199.9648">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.1987" x="122.0188" y="199.9648">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.3701" x="157.3308" y="199.9648">CMD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.7808" x="192.8142" y="199.9648">= 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.2861" x="223.7083" y="199.9648">EXE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.5542" x="247.9944" y="199.9648">=1</text><polygon fill="#FF0000" points="292.3225,230.0176,282.3225,234.0176,292.3225,238.0176,288.3225,234.0176" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="286.3225" x2="502.0149" y1="234.0176" y2="234.0176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="298.3225" y="229.2754">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.9233" x="337.6853" y="229.2754">read</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.8857" x="369.7219" y="229.2754">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="408.6077" y="229.2754">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.8154" x="416.8342" y="229.2754">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="444.6497" y="229.2754">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.8374" x="448.7629" y="229.2754">MEK</text><path d="M10,250.6729 L10,275.6729 L131,275.6729 L131,260.6729 L121,250.6729 L10,250.6729 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M121,250.6729 L121,260.6729 L131,260.6729 L121,250.6729 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1182" x="16" y="268.2412">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2998" x="69.2314" y="268.2412">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6675" x="93.6445" y="268.2412">= 1</text><line style="stroke:#008000;stroke-width:1;" x1="681.3694" x2="671.3694" y1="263.3281" y2="259.3281"/><line style="stroke:#008000;stroke-width:1;" x1="681.3694" x2="671.3694" y1="263.3281" y2="267.3281"/><line style="stroke:#008000;stroke-width:1;" x1="513.0149" x2="682.3694" y1="263.3281" y2="263.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="520.0149" y="258.5859">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.8857" x="559.3777" y="258.5859">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="598.2634" y="258.5859">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.8154" x="606.49" y="258.5859">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="634.3054" y="258.5859">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.8374" x="642.532" y="258.5859">MEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="693.3694" x2="735.3694" y1="302.2939" y2="302.2939"/><line style="stroke:#FF0000;stroke-width:1;" x1="735.3694" x2="735.3694" y1="302.2939" y2="315.2939"/><line style="stroke:#FF0000;stroke-width:1;" x1="694.3694" x2="735.3694" y1="315.2939" y2="315.2939"/><polygon fill="#FF0000" points="704.3694,311.2939,694.3694,315.2939,704.3694,319.2939,700.3694,315.2939" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="700.3694" y="297.5518">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.4111" x="739.7322" y="297.5518">Store</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="38.8857" x="776.2566" y="297.5518">METD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="815.1423" y="297.5518">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="27.8154" x="823.3689" y="297.5518">AUX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="851.1843" y="297.5518">,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28.8374" x="859.4109" y="297.5518">MEK</text><line style="stroke:#008000;stroke-width:1;" x1="514.0149" x2="524.0149" y1="344.6045" y2="340.6045"/><line style="stroke:#008000;stroke-width:1;" x1="514.0149" x2="524.0149" y1="344.6045" y2="348.6045"/><line style="stroke:#008000;stroke-width:1;" x1="513.0149" x2="682.3694" y1="344.6045" y2="344.6045"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="530.0149" y="339.8623">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.8887" x="569.3777" y="339.8623">No error</text><line style="stroke:#008000;stroke-width:1;" x1="282.3225" x2="292.3225" y1="373.915" y2="369.915"/><line style="stroke:#008000;stroke-width:1;" x1="282.3225" x2="292.3225" y1="373.915" y2="377.915"/><line style="stroke:#008000;stroke-width:1;" x1="281.3225" x2="502.0149" y1="373.915" y2="373.915"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="298.3225" y="369.1729">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.1987" x="337.6853" y="369.1729">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.7461" x="372.9973" y="369.1729">ERR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.7808" x="402.8567" y="369.1729">= 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2998" x="433.7507" y="369.1729">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="18.5542" x="454.0505" y="369.1729">=1</text><path d="M447.3589,390.5703 L447.3589,415.5703 L568.3589,415.5703 L568.3589,400.5703 L558.3589,390.5703 L447.3589,390.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M558.3589,390.5703 L558.3589,400.5703 L568.3589,400.5703 L558.3589,390.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1182" x="453.3589" y="408.1387">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2998" x="506.5903" y="408.1387">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6675" x="531.0034" y="408.1387">= 1</text><line style="stroke:#008000;stroke-width:1;" x1="279.3225" x2="269.3225" y1="403.2256" y2="399.2256"/><line style="stroke:#008000;stroke-width:1;" x1="279.3225" x2="269.3225" y1="403.2256" y2="407.2256"/><line style="stroke:#008000;stroke-width:1;" x1="75.656" x2="280.3225" y1="403.2256" y2="403.2256"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="82.656" y="398.4834">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="27.9233" x="122.0188" y="398.4834">read</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.7461" x="154.0554" y="398.4834">ERR</text><line style="stroke:#008000;stroke-width:1;" x1="279.3225" x2="269.3225" y1="442.1914" y2="438.1914"/><line style="stroke:#008000;stroke-width:1;" x1="279.3225" x2="269.3225" y1="442.1914" y2="446.1914"/><line style="stroke:#008000;stroke-width:1;" x1="75.656" x2="280.3225" y1="442.1914" y2="442.1914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="82.656" y="437.4492">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.1987" x="122.0188" y="437.4492">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2998" x="157.3308" y="437.4492">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6675" x="181.7439" y="437.4492">= 1</text><path d="M10,460.1914 L10,485.1914 L131,485.1914 L131,470.1914 L121,460.1914 L10,460.1914 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M121,460.1914 L121,470.1914 L131,470.1914 L121,460.1914 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1182" x="16" y="477.7598">Wait for</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2998" x="69.2314" y="477.7598">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6675" x="93.6445" y="477.7598">= 0</text><line style="stroke:#008000;stroke-width:1;" x1="282.3225" x2="292.3225" y1="527.123" y2="523.123"/><line style="stroke:#008000;stroke-width:1;" x1="282.3225" x2="292.3225" y1="527.123" y2="531.123"/><line style="stroke:#008000;stroke-width:1;" x1="281.3225" x2="502.0149" y1="527.123" y2="527.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="298.3225" y="514.7256">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.1987" x="337.6853" y="507.0703">write</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.3701" x="372.9973" y="507.0703">CMD</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.7808" x="408.4807" y="507.0703">= 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="25.7461" x="439.3748" y="507.0703">ERR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.7808" x="469.2341" y="507.0703">= 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="32.9063" x="337.6853" y="522.3809">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="20.2998" x="370.5916" y="522.3809">DN</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.7808" x="395.0046" y="522.3809">= 1,</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.2861" x="425.8987" y="522.3809">EXE</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="22.6675" x="454.2981" y="522.3809">= 0</text><!--SRC=[ZLBBRi8m4BpxAnQ4-b2I5Wwz842gIauL72Ye72eXusoAHR2HOqgHyl5TGqf28HK-H9F4i_EmQrA9P1CXQB6U9LeiPniha_I1FZDMap7SDTA5tiwij0dUCw0rTX3guJTVhGde63W8lLfn5O7LO1S8g8JPhQtKYk2dLEX-99f7m1KCmjSwgw6APCmOekSnfhIbGLze076lySwbXLWRwCnxuJJiFCvxq8KM8nQupOo9U4jCUa8ZtIa1QMoW3LiZQHAH1k6uxrY-UtcUJ8-Or1skPhuC-hzoVac-st9cJoW6AL25Lbcg58zKp_BrXnVYtJWjlXTR2iyZjMj2BKLka40RtgmsU3Nl88OO14GTQa1Zj665ZJyrXQDHRhlf5obSI_yUvkMm-yFW5whDLHWxst4qKfgOPKzPTdNTpPA3s-8wEDIkObJtKLoRGn_bVZuKvEl4htzwkvikP12m7m00]--></g></svg>