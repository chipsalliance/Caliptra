<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1918px" preserveAspectRatio="none" style="width:1600px;height:1918px;background:#FFFFFF;" version="1.1" viewBox="0 0 1600 1918" width="1600px" zoomAndPan="magnify"><title>Generate PMEK</title><defs/><g><rect fill="#DDDDDD" height="1838.3574" style="stroke:#181818;stroke-width:0.5;" width="1415.5005" x="172.231" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="853.5845" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1546.7061" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="108.7666" x="744.4824" y="41.3125">Generate PMEK</text><g><title>Storage</title><rect fill="transparent" height="1684.1172" width="8" x="34.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37.6826" x2="37.6826" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="32.6826" y="1720.916"/></g><g><title>Mail Box</title><rect fill="transparent" height="1684.1172" width="8" x="208.5068" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="212.0068" x2="212.0068" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#FFFFFF" height="235.7266" style="stroke:#181818;stroke-width:1;" width="10" x="207.0068" y="311.8359"/></g><g><title>FW</title><rect fill="transparent" height="1684.1172" width="8" x="430.502" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="434.002" x2="434.002" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#FFFFFF" height="1202.6641" style="stroke:#181818;stroke-width:1;" width="10" x="429.002" y="518.252"/></g><g><title>DRBG</title><rect fill="transparent" height="1684.1172" width="8" x="620.9341" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624.4341" x2="624.4341" y1="140.041" y2="1824.1582"/></g><g><title>Key Vault</title><rect fill="transparent" height="1684.1172" width="8" x="845.519" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="849.019" x2="849.019" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="649.8047"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="839.9785"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1061.4629"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1279.6367"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1442.8105"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1617.6738"/></g><g><title>Key Vault</title><rect fill="transparent" height="1684.1172" width="8" x="1180.4175" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1183.9175" x2="1183.9175" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#ADD8E6" height="1533.6328" style="stroke:#181818;stroke-width:1;" width="10" x="1178.9175" y="290.5254"/></g><g><title>Key Vault</title><rect fill="transparent" height="1684.1172" width="8" x="1313.3003" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1316.8003" x2="1316.8003" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#ADD8E6" height="1533.6328" style="stroke:#181818;stroke-width:1;" width="10" x="1311.8003" y="290.5254"/></g><g><title>Key Vault</title><rect fill="transparent" height="1684.1172" width="8" x="1425.1182" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1428.6182" x2="1428.6182" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#ADD8E6" height="896.248" style="stroke:#181818;stroke-width:1;" width="10" x="1423.6182" y="750.7363"/></g><line style="stroke:#181818;stroke-width:2;" x1="1419.6182" x2="1437.6182" y1="1637.9844" y2="1655.9844"/><line style="stroke:#181818;stroke-width:2;" x1="1419.6182" x2="1437.6182" y1="1655.9844" y2="1637.9844"/><g><title>Key Vault</title><rect fill="transparent" height="1684.1172" width="8" x="1531.8604" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1535.3604" x2="1535.3604" y1="140.041" y2="1824.1582"/></g><g><title/><rect fill="#ADD8E6" height="706.0742" style="stroke:#181818;stroke-width:1;" width="10" x="1530.3604" y="940.9102"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="176.231" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="183.231" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="417.2607" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="424.2607" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="598.6797" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="605.6797" y="129.0879">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="810.249" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="817.249" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1114.4814" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1152.1475" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1164.1616" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1121.4814" y="129.0879">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1263.3535" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1285.0303" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1296.8154" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1270.3535" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1380.2471" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1396.8481" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1409.3306" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1387.2471" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1486.9893" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1503.5903" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1516.2026" y="112.5996">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1493.9893" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="1844.6934">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="1861.1816">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="1877.6699">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="176.231" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="183.231" y="1844.6934">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="417.2607" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="424.2607" y="1844.6934">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="598.6797" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="605.6797" y="1844.6934">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="810.249" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="817.249" y="1844.6934">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1114.4814" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1152.1475" y="1844.6934">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1164.1616" y="1861.1816">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1121.4814" y="1877.6699">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1263.3535" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1285.0303" y="1844.6934">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1296.8154" y="1861.1816">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1270.3535" y="1877.6699">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1380.2471" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1396.8481" y="1844.6934">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1409.3306" y="1861.1816">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1387.2471" y="1877.6699">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1486.9893" y="1824.1582"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1503.5903" y="1844.6934">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1516.2026" y="1861.1816">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1493.9893" y="1877.6699">(Temporary)</text><path d="M2.1558,153.041 L2.1558,285.041 L1570.1558,285.041 L1570.1558,163.041 L1560.1558,153.041 L2.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1560.1558,153.041 L1560.1558,163.041 L1570.1558,163.041 L1560.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="74.2864" y="170.6094">Preconditions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="439.7847" x="82.5129" y="185.9199">* Storage Root Key in a KV slot where Caliptra FW manages which slot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="410.0903" x="82.5129" y="201.2305">* KEM Keypair in a KV slot where Caliptra FW manages which slot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="74.2864" y="216.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.7422" x="74.2864" y="231.8516">Notes:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1407.2437" x="82.5129" y="247.1621">* The sequence diagram assumes that the KV will not allow an input KV slot to also be used as an out KV slot. Calitra FW is responsible for managing which KVC slots are used and can adapt if this assumption is not correct.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="579.395" x="82.5129" y="262.4727">* This sequence is focused on successful execution of operations by the KV. Sill need to do:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.522" x="111.3059" y="277.7832">-</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.7705" x="122.9412" y="277.7832">Define the reported error conditions and handling</text><line style="stroke:#008000;stroke-width:1;" x1="205.0068" x2="195.0068" y1="311.8359" y2="307.8359"/><line style="stroke:#008000;stroke-width:1;" x1="205.0068" x2="195.0068" y1="311.8359" y2="315.8359"/><line style="stroke:#008000;stroke-width:1;" x1="37.6826" x2="206.0068" y1="311.8359" y2="311.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="44.6826" y="307.0938">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9614" x="84.0454" y="307.0938">GENERATE_PMEK</text><path d="M222.0068,324.8359 L222.0068,491.8359 L886.0068,491.8359 L886.0068,334.8359 L876.0068,324.8359 L222.0068,324.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M876.0068,324.8359 L876.0068,334.8359 L886.0068,334.8359 L876.0068,324.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="228.0068" y="344.4043">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="232.1201" y="344.4043">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="366.1636" y="344.4043">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="370.2769" y="344.4043">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="495.1035" y="344.4043">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="499.2168" y="344.4043">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="232.1201" y="359.7148">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="370.2769" y="359.7148">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="499.2168" y="359.7148">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.459" x="232.1201" y="375.0254">pmek_algorithms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="370.2769" y="375.0254">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="372.2075" x="499.2168" y="375.0254">Indicates the size of PMEKs. Only one bit shall be reported.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.7651" x="507.4434" y="390.3359">* Byte 0 bit 0: 256 bits</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.9302" x="232.1201" y="405.6465">wrapped_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="370.2769" y="405.6465">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="499.2168" y="405.6465">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1768" x="507.4434" y="420.957">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3535" x="507.4434" y="436.2676">* kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.0283" x="507.4434" y="451.5781">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0244" x="507.4434" y="466.8887">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="507.4434" y="482.1992">* encrypted_access_key</text><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="331.8359" y2="331.8359"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="347.1465" y2="347.1465"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="362.457" y2="362.457"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="393.0781" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="484.9414" y2="484.9414"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="228.0068" y1="331.8359" y2="484.9414"/><line style="stroke:#000000;stroke-width:0.5;" x1="366.1636" x2="366.1636" y1="331.8359" y2="484.9414"/><line style="stroke:#000000;stroke-width:0.5;" x1="495.1035" x2="495.1035" y1="331.8359" y2="484.9414"/><line style="stroke:#000000;stroke-width:0.5;" x1="871.4243" x2="871.4243" y1="331.8359" y2="484.9414"/><line style="stroke:#008000;stroke-width:1;" x1="427.002" x2="417.002" y1="518.252" y2="514.252"/><line style="stroke:#008000;stroke-width:1;" x1="427.002" x2="417.002" y1="518.252" y2="522.252"/><line style="stroke:#008000;stroke-width:1;" x1="217.0068" x2="428.002" y1="518.252" y2="518.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="224.0068" y="513.5098">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="263.3696" y="513.5098">Command</text><polygon fill="#FF0000" points="228.0068,543.5625,218.0068,547.5625,228.0068,551.5625,224.0068,547.5625" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="222.0068" x2="428.002" y1="547.5625" y2="547.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="234.0068" y="542.8203">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="273.3696" y="542.8203">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="481.002" y1="576.873" y2="576.873"/><line style="stroke:#FF0000;stroke-width:1;" x1="481.002" x2="481.002" y1="576.873" y2="589.873"/><line style="stroke:#FF0000;stroke-width:1;" x1="440.002" x2="481.002" y1="589.873" y2="589.873"/><polygon fill="#FF0000" points="450.002,585.873,440.002,589.873,450.002,593.873,446.002,589.873" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="572.1309">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="485.3647" y="572.1309">Determine command</text><polygon fill="#FF0000" points="832.019,645.8047,842.019,649.8047,832.019,653.8047,836.019,649.8047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="649.8047" y2="649.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="629.752">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.5308" x="485.3647" y="614.4414">Decaps(KEM Pair : kem_handle (G),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.9976" x="538.8374" y="629.752">KEM ciphertext : kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="538.8374" y="645.0625">Destination : Slot Y)</text><polygon fill="#FF0000" points="1299.8003,675.1152,1309.8003,679.1152,1299.8003,683.1152,1303.8003,679.1152" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1305.8003" y1="679.1152" y2="679.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="674.373">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="900.3818" y="674.373">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="708.4258" y2="708.4258"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="708.4258" y2="721.4258"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="721.4258" y2="721.4258"/><polygon fill="#FF0000" points="865.019,717.4258,855.019,721.4258,865.019,725.4258,861.019,721.4258" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="703.6836">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.3521" x="900.3818" y="703.6836">Decap KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="1411.6182,746.7363,1421.6182,750.7363,1411.6182,754.7363,1415.6182,750.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1417.6182" y1="750.7363" y2="750.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="745.9941">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.6621" x="900.3818" y="745.9941">Put Shared Secret</text><polygon fill="#FF0000" points="450.002,776.0469,440.002,780.0469,450.002,784.0469,446.002,780.0469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="780.0469" y2="780.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="775.3047">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="775.3047">done</text><polygon fill="#FF0000" points="832.019,835.9785,842.019,839.9785,832.019,843.9785,836.019,839.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="839.9785" y2="839.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="819.9258">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.8159" x="485.3647" y="804.6152">Key_Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.3604" x="563.5171" y="819.9258">Data: encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="563.5171" y="835.2363">Destination : Slot Z)</text><polygon fill="#FF0000" points="1411.6182,865.2891,1421.6182,869.2891,1411.6182,873.2891,1415.6182,869.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1417.6182" y1="869.2891" y2="869.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="864.5469">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="900.3818" y="864.5469">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="898.5996" y2="898.5996"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="898.5996" y2="911.5996"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="911.5996" y2="911.5996"/><polygon fill="#FF0000" points="865.019,907.5996,855.019,911.5996,865.019,915.5996,861.019,911.5996" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="893.8574">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.5356" x="900.3818" y="893.8574">Key_Unwrap encrypted_access_key with Key</text><polygon fill="#FF0000" points="1518.3604,936.9102,1528.3604,940.9102,1518.3604,944.9102,1522.3604,940.9102" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1524.3604" y1="940.9102" y2="940.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="936.168">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.647" x="900.3818" y="936.168">Put Access Key</text><polygon fill="#FF0000" points="450.002,966.2207,440.002,970.2207,450.002,974.2207,446.002,970.2207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="970.2207" y2="970.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="965.4785">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="965.4785">done</text><path d="M418.002,982.2207 L480.1406,982.2207 L480.1406,989.5313 L470.1406,999.5313 L418.002,999.5313 L418.002,982.2207 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="246.7949" style="stroke:#000000;stroke-width:1.5;" width="1133.3584" x="418.002" y="982.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="433.002" y="995.7891">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="138.2896" x="495.1406" y="994.8555">[pmek algorith 512 bits]</text><polygon fill="#FF0000" points="832.019,1057.4629,842.019,1061.4629,832.019,1065.4629,836.019,1061.4629" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1061.4629" y2="1061.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1041.4102">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="485.3647" y="1026.0996">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="588.1968" y="1041.4102">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.6479" x="588.1968" y="1056.7207">Destination :  Slot Y)</text><polygon fill="#FF0000" points="1166.9175,1086.7734,1176.9175,1090.7734,1166.9175,1094.7734,1170.9175,1090.7734" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1172.9175" y1="1090.7734" y2="1090.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1086.0313">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1104" x="900.3818" y="1086.0313">Get Storage Root Key</text><polygon fill="#FF0000" points="1518.3604,1116.084,1528.3604,1120.084,1518.3604,1124.084,1522.3604,1120.084" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1524.3604" y1="1120.084" y2="1120.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1115.3418">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.0308" x="900.3818" y="1115.3418">Get Access Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="1149.3945" y2="1149.3945"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="1149.3945" y2="1162.3945"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="1162.3945" y2="1162.3945"/><polygon fill="#FF0000" points="865.019,1158.3945,855.019,1162.3945,865.019,1166.3945,861.019,1162.3945" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1144.6523">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.0376" x="900.3818" y="1144.6523">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1411.6182,1187.7051,1421.6182,1191.7051,1411.6182,1195.7051,1415.6182,1191.7051" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1417.6182" y1="1191.7051" y2="1191.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1186.9629">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.0815" x="900.3818" y="1186.9629">Put HMAC512 result Encryption Key</text><polygon fill="#FF0000" points="450.002,1217.0156,440.002,1221.0156,450.002,1225.0156,446.002,1221.0156" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1221.0156" y2="1221.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1216.2734">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="1216.2734">done</text><polygon fill="#FF0000" points="832.019,1275.6367,842.019,1279.6367,832.019,1283.6367,836.019,1279.6367" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1279.6367" y2="1279.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1267.2393">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.1309" x="485.3647" y="1259.584">new_key(len: pmek_alogorithm length,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.1802" x="542.9507" y="1274.8945">Destination Slot: Z)</text><polygon fill="#FF0000" points="635.4341,1320.2578,625.4341,1324.2578,635.4341,1328.2578,631.4341,1324.2578" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="629.4341" x2="843.019" y1="1324.2578" y2="1324.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="641.4341" y="1311.8604">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.2939" x="680.7969" y="1304.2051">Get random limited</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.2222" x="680.7969" y="1319.5156">to len of PMEK algorithm</text><polygon fill="#FF0000" points="1518.3604,1349.5684,1528.3604,1353.5684,1518.3604,1357.5684,1522.3604,1353.5684" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1524.3604" y1="1353.5684" y2="1353.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1348.8262">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.585" x="900.3818" y="1348.8262">Put new PMEK</text><polygon fill="#FF0000" points="450.002,1378.8789,440.002,1382.8789,450.002,1386.8789,446.002,1382.8789" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1382.8789" y2="1382.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1378.1367">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="1378.1367">done</text><polygon fill="#FF0000" points="832.019,1438.8105,842.019,1442.8105,832.019,1446.8105,836.019,1442.8105" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1442.8105" y2="1442.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1422.7578">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.7104" x="485.3647" y="1407.4473">Wrap(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="526.4976" y="1422.7578">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.7993" x="526.4976" y="1438.0684">Destination : locked_pmek)</text><polygon fill="#FF0000" points="1411.6182,1468.1211,1421.6182,1472.1211,1411.6182,1476.1211,1415.6182,1472.1211" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1417.6182" y1="1472.1211" y2="1472.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1467.3789">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.9868" x="900.3818" y="1467.3789">Get Encryption Key</text><polygon fill="#FF0000" points="1518.3604,1497.4316,1528.3604,1501.4316,1518.3604,1505.4316,1522.3604,1501.4316" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1524.3604" y1="1501.4316" y2="1501.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1496.6895">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.9688" x="900.3818" y="1496.6895">Get new PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="1530.7422" y2="1530.7422"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="1530.7422" y2="1543.7422"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="1543.7422" y2="1543.7422"/><polygon fill="#FF0000" points="865.019,1539.7422,855.019,1543.7422,865.019,1547.7422,861.019,1543.7422" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1526">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.0088" x="900.3818" y="1526">Encrypt Data Key using Key</text><polygon fill="#FF0000" points="450.002,1569.0527,440.002,1573.0527,450.002,1577.0527,446.002,1573.0527" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1573.0527" y2="1573.0527"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1568.3105">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6274" x="495.3647" y="1568.3105">Locked PMEK</text><polygon fill="#FF0000" points="832.019,1613.6738,842.019,1617.6738,832.019,1621.6738,836.019,1617.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1617.6738" y2="1617.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1605.2764">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.9629" x="485.3647" y="1597.6211">Purge_key(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="551.1772" y="1612.9316">Key : Slot Z)</text><polygon fill="#FF0000" points="1411.6182,1642.9844,1421.6182,1646.9844,1411.6182,1650.9844,1415.6182,1646.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1417.6182" y1="1646.9844" y2="1646.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1642.2422">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="900.3818" y="1642.2422">Purge</text><polygon fill="#FF0000" points="1518.3604,1642.9844,1528.3604,1646.9844,1518.3604,1650.9844,1522.3604,1646.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1524.3604" y1="1646.9844" y2="1646.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1642.2422">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="900.3818" y="1642.2422">&#160;</text><polygon fill="#FF0000" points="450.002,1672.2949,440.002,1676.2949,450.002,1680.2949,446.002,1676.2949" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1676.2949" y2="1676.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1671.5527">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="1671.5527">done</text><polygon fill="#FF0000" points="223.0068,1716.916,213.0068,1720.916,223.0068,1724.916,219.0068,1720.916" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="217.0068" x2="428.002" y1="1720.916" y2="1720.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="229.0068" y="1708.5186">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.6323" x="268.3696" y="1700.8633">Command response and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6274" x="268.3696" y="1716.1738">Locked PMEK</text><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="1720.916" y2="1716.916"/><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="1720.916" y2="1724.916"/><line style="stroke:#008000;stroke-width:1;" x1="42.6826" x2="211.0068" y1="1720.916" y2="1720.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="59.6826" y="1708.5186">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="99.0454" y="1700.8633">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="99.0454" y="1716.1738">complete</text><path d="M217.0068,1733.916 L217.0068,1808.916 L833.0068,1808.916 L833.0068,1743.916 L823.0068,1733.916 L217.0068,1733.916 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M823.0068,1733.916 L823.0068,1743.916 L833.0068,1743.916 L823.0068,1733.916 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="223.0068" y="1753.4844">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="227.1201" y="1753.4844">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="367.27" y="1753.4844">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="371.3833" y="1753.4844">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="472.0127" y="1753.4844">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="476.126" y="1753.4844">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="227.1201" y="1768.7949">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="371.3833" y="1768.7949">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="476.126" y="1768.7949">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="227.1201" y="1784.1055">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="371.3833" y="1784.1055">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="476.126" y="1784.1055">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="227.1201" y="1799.416">new_encrypted_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="371.3833" y="1799.416">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="476.126" y="1799.416">PMEK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1740.916" y2="1740.916"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1756.2266" y2="1756.2266"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1771.5371" y2="1771.5371"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1786.8477" y2="1786.8477"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1802.1582" y2="1802.1582"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="223.0068" y1="1740.916" y2="1802.1582"/><line style="stroke:#000000;stroke-width:0.5;" x1="367.27" x2="367.27" y1="1740.916" y2="1802.1582"/><line style="stroke:#000000;stroke-width:0.5;" x1="472.0127" x2="472.0127" y1="1740.916" y2="1802.1582"/><line style="stroke:#000000;stroke-width:0.5;" x1="818.6646" x2="818.6646" y1="1740.916" y2="1802.1582"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="145.8301" x="725.9507" y="1908.291">Filename: generate_pmek.uml</text><!--SRC=[jLTjRzis4FwkNt4EijLPwgpBq7qmsW9kudH1-cBKQOiL0GnQEbk49L4ZgRWkykDtHxtBSZ5ihJuOCk-5TyyzTwG6Cl6ZB41GVhg8bBzPP5P6veoMFMzmR4ArNOWeWkVmazKP3a-yH-tLbOWCBti3kO9X9JhnW9v2DTNegoHeE6a8hRGHzej4Ali5iLalKg6DJDRz2e5AcZu7I44UYAXCe2-a7baHKu-a4rIFHXbLAHfW4iYLryBExPrRtRemZbvXWbfOXDcRwSrHPTImARB9hH95giBNoXZtdvzdonUpN4TQgH8pVlRhyaKb1VW5vbPfiKPuhvI56zo1J430pKSm4IriGzG85oAIgTK2hZv1B19IDoIHVkYKMkvkfc_OIoga_W-Ucd6_fNHwuhqD4Gp-dM7Y8mHIhBM8GHYJnUJAXiBI3_AkMqay9Ko0IAcs81AA9yri5P1L934AbWYPmO1yi8wgDSvSj4Mmqe16anA4SacrMIcTnyyrpnEu-NZXpCYDBbqIqNnoAWAHMg2osP3yk61JBWTxvGXzfQb8zgoJA4chJEbzfNpdbUnCvljep2gB0B-WdpbdQWKgPS9meM6vAu0uWxb30icKSWxKkB5DyOpWsKeb74Yaz7EDmOjBN4dYBBlGc2fjoHgrfhHhChdyGlg920Ndb1ZgQ5XnzH4G_KRuHHhBI1bBTFQCtfoUml7B3rTNq_UBoSNjzSV9xVMxjzu6utM_n5jjuLYONU93l2ILCRoQlfs-dznE5zmSxI6KoaP3QBaEBHbLIJymkQuaHa430BSubr-ni-HWSDd2GyE37sweXYq87o3x_HmwIw-bvKvcC4JRGnhZXiRbMcbfmzWSz71DfZw1Pbmf34T8TUQSpHcyIw8Ty6XPIWicvC6yhEjrTfSu8htS4GnFdCwJCPm__ODVJIkQhHPfYi52E5ejDZG67k1JlZXnQpTkYRfxLEX2hWkaM-nJ6zU95I8gxC8H1HiBVKg-J6bEMFnYYqKYlzwbjXDRFzdYPSaHVxLr9BbGCNLfqA97OrhdDF6PMmMrc5Z8VP3RiJXUZaRkvTXWj1eUaVhHOpYwH8iwvXufb8-QfuqpAkEgDzZSdvwEuH9zaPeXZyePpybn0nyOlZfvx7Al7rQiWIdKEqZLpoLohxafGAfp7dL_dNYR-p84wh4yoSQeReZlY_YS-ABUTKkLsbUt6AUxCSneQiv3cdi1pD7NQ3qdwE_bHYtuNCoBK7aai4OZ2fn53K0tzmr0zn2bk1OV4cRca8bQfjq5iW18M37k9LQ_-ZwUdq_s4610smYq8Aq3x6TqYMxRxzSSsRm3dTYj_Z1OHMJTO8AoDU7fR-TkMdGQ9KVzppUJ2r9OC2Qc2Voa7_WQVcWeV_wMRWlxYiojpEWqAU3lt6JQQWMUhDZ0iwN2XIfoogy84tV2vL7kUojuNrhGzI0Z_APvUJdYSeFUoXokZZEfAbHLALzsbK8UQTrg9BXbAWqZJCRbyQAA2GkqkBRXNbcQ-7AQOwPsAp9D2EIeyPiYJpAMHDwxXEuIvBKyZIhAnBsmCr0Ke5FzCPZiuV6fc0Qzm-2R96opZh-Dg5aPqVwsxrIyZt5LwYsk5OPrC9dxX60d_wwPNxlGSiy7UhgBoYpJQtGyEGHDSUOqiEcc3OC159wydpkb9jdt7V3kJ2xEyV8AZjoNTqap_P-XFltRX_zTGWTq6j5n_TrlYV_pYlYj- -5AfcR1r-NC73QlBuVkswAwYl3NmjNrR0vqKzFgdhyPD7_Sv1VuvZOyDEe3oSt-XvAN6Cpo_ww_AottuLHVzSuFtCPScJtFbPMUVm00]--></g></svg>