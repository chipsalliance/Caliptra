<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1903px" preserveAspectRatio="none" style="width:1570px;height:1903px;background:#FFFFFF;" version="1.1" viewBox="0 0 1570 1903" width="1570px" zoomAndPan="magnify"><title>Generate PMEK</title><defs/><g><rect fill="#DDDDDD" height="1823.0469" style="stroke:#181818;stroke-width:0.5;" width="1384.8345" x="172.231" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="838.2515" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1516.04" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="108.7666" x="729.1494" y="41.3125">Generate PMEK</text><g><title>Storage</title><rect fill="transparent" height="1668.8066" width="8" x="34.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37.6826" x2="37.6826" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="32.6826" y="1705.6055"/></g><g><title>Mail Box</title><rect fill="transparent" height="1668.8066" width="8" x="208.5068" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="212.0068" x2="212.0068" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#FFFFFF" height="235.7266" style="stroke:#181818;stroke-width:1;" width="10" x="207.0068" y="296.5254"/></g><g><title>FW</title><rect fill="transparent" height="1668.8066" width="8" x="430.502" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="434.002" x2="434.002" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#FFFFFF" height="1202.6641" style="stroke:#181818;stroke-width:1;" width="10" x="429.002" y="502.9414"/></g><g><title>DRBG</title><rect fill="transparent" height="1668.8066" width="8" x="620.9341" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="624.4341" x2="624.4341" y1="140.041" y2="1808.8477"/></g><g><title>Key Vault</title><rect fill="transparent" height="1668.8066" width="8" x="845.519" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="849.019" x2="849.019" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="634.4941"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="824.668"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1046.1523"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1264.3262"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1427.5"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="844.019" y="1602.3633"/></g><g><title>Key Vault</title><rect fill="transparent" height="1668.8066" width="8" x="1180.4175" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1183.9175" x2="1183.9175" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#ADD8E6" height="1533.6328" style="stroke:#181818;stroke-width:1;" width="10" x="1178.9175" y="275.2148"/></g><g><title>Key Vault</title><rect fill="transparent" height="1668.8066" width="8" x="1282.6343" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1286.1343" x2="1286.1343" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#ADD8E6" height="1533.6328" style="stroke:#181818;stroke-width:1;" width="10" x="1281.1343" y="275.2148"/></g><g><title>Key Vault</title><rect fill="transparent" height="1668.8066" width="8" x="1394.4521" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1397.9521" x2="1397.9521" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#ADD8E6" height="896.248" style="stroke:#181818;stroke-width:1;" width="10" x="1392.9521" y="735.4258"/></g><line style="stroke:#181818;stroke-width:2;" x1="1388.9521" x2="1406.9521" y1="1622.6738" y2="1640.6738"/><line style="stroke:#181818;stroke-width:2;" x1="1388.9521" x2="1406.9521" y1="1640.6738" y2="1622.6738"/><g><title>Key Vault</title><rect fill="transparent" height="1668.8066" width="8" x="1501.1943" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1504.6943" x2="1504.6943" y1="140.041" y2="1808.8477"/></g><g><title/><rect fill="#ADD8E6" height="706.0742" style="stroke:#181818;stroke-width:1;" width="10" x="1499.6943" y="925.5996"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="176.231" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="183.231" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="417.2607" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="424.2607" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="598.6797" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="605.6797" y="129.0879">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="810.249" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="817.249" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1145.1475" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1152.1475" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1164.1616" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1167.248" y="129.0879">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1232.6875" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1254.3643" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1266.1494" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1239.6875" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1349.5811" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1366.1821" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1378.6646" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1356.5811" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1456.3232" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1472.9243" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1485.5366" y="112.5996">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1463.3232" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="1829.3828">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="1845.8711">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="1862.3594">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="176.231" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="183.231" y="1829.3828">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="417.2607" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="424.2607" y="1829.3828">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="598.6797" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="605.6797" y="1829.3828">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="810.249" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="817.249" y="1829.3828">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1145.1475" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1152.1475" y="1829.3828">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1164.1616" y="1845.8711">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1167.248" y="1862.3594">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1232.6875" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1254.3643" y="1829.3828">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1266.1494" y="1845.8711">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1239.6875" y="1862.3594">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1349.5811" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1366.1821" y="1829.3828">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1378.6646" y="1845.8711">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1356.5811" y="1862.3594">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1456.3232" y="1808.8477"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1472.9243" y="1829.3828">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1485.5366" y="1845.8711">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1463.3232" y="1862.3594">(Temporary)</text><path d="M2.1558,153.041 L2.1558,270.041 L1540.1558,270.041 L1540.1558,163.041 L1530.1558,153.041 L2.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1530.1558,153.041 L1530.1558,163.041 L1540.1558,163.041 L1530.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="59.3596" y="170.6094">Preconditions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.0381" x="67.5862" y="185.9199">* FEK in a firmware-managed KV slot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289.3389" x="67.5862" y="201.2305">* KEM Keypair in a firmware-managed KV slot</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="59.3596" y="216.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.7422" x="59.3596" y="231.8516">Notes:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1406.4312" x="67.5862" y="247.1621">* The sequence diagram assumes that the KV will not allow an input KV slot to also be used as an out KV slot. Caliptra FW is responsible for managing which KV slots are used and can adapt if this assumption is not correct.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.8032" x="67.5862" y="262.4727">* This sequence is focused on successful execution of operations by the KV.</text><line style="stroke:#008000;stroke-width:1;" x1="205.0068" x2="195.0068" y1="296.5254" y2="292.5254"/><line style="stroke:#008000;stroke-width:1;" x1="205.0068" x2="195.0068" y1="296.5254" y2="300.5254"/><line style="stroke:#008000;stroke-width:1;" x1="37.6826" x2="206.0068" y1="296.5254" y2="296.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="44.6826" y="291.7832">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9614" x="84.0454" y="291.7832">GENERATE_PMEK</text><path d="M222.0068,309.5254 L222.0068,476.5254 L886.0068,476.5254 L886.0068,319.5254 L876.0068,309.5254 L222.0068,309.5254 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M876.0068,309.5254 L876.0068,319.5254 L886.0068,319.5254 L876.0068,309.5254 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="228.0068" y="329.0938">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="232.1201" y="329.0938">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="366.1636" y="329.0938">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="370.2769" y="329.0938">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="495.1035" y="329.0938">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="499.2168" y="329.0938">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="232.1201" y="344.4043">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="370.2769" y="344.4043">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="499.2168" y="344.4043">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.459" x="232.1201" y="359.7148">pmek_algorithms</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="370.2769" y="359.7148">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="372.2075" x="499.2168" y="359.7148">Indicates the size of PMEKs. Only one bit shall be reported.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.7651" x="507.4434" y="375.0254">* Byte 0 bit 0: 256 bits</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.9302" x="232.1201" y="390.3359">wrapped_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="370.2769" y="390.3359">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="499.2168" y="390.3359">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1768" x="507.4434" y="405.6465">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3535" x="507.4434" y="420.957">* kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.0283" x="507.4434" y="436.2676">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0244" x="507.4434" y="451.5781">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="507.4434" y="466.8887">* encrypted_access_key</text><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="316.5254" y2="316.5254"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="331.8359" y2="331.8359"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="347.1465" y2="347.1465"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="377.7676" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="871.4243" y1="469.6309" y2="469.6309"/><line style="stroke:#000000;stroke-width:0.5;" x1="228.0068" x2="228.0068" y1="316.5254" y2="469.6309"/><line style="stroke:#000000;stroke-width:0.5;" x1="366.1636" x2="366.1636" y1="316.5254" y2="469.6309"/><line style="stroke:#000000;stroke-width:0.5;" x1="495.1035" x2="495.1035" y1="316.5254" y2="469.6309"/><line style="stroke:#000000;stroke-width:0.5;" x1="871.4243" x2="871.4243" y1="316.5254" y2="469.6309"/><line style="stroke:#008000;stroke-width:1;" x1="427.002" x2="417.002" y1="502.9414" y2="498.9414"/><line style="stroke:#008000;stroke-width:1;" x1="427.002" x2="417.002" y1="502.9414" y2="506.9414"/><line style="stroke:#008000;stroke-width:1;" x1="217.0068" x2="428.002" y1="502.9414" y2="502.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="224.0068" y="498.1992">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="263.3696" y="498.1992">Command</text><polygon fill="#FF0000" points="228.0068,528.252,218.0068,532.252,228.0068,536.252,224.0068,532.252" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="222.0068" x2="428.002" y1="532.252" y2="532.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="234.0068" y="527.5098">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="273.3696" y="527.5098">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="481.002" y1="561.5625" y2="561.5625"/><line style="stroke:#FF0000;stroke-width:1;" x1="481.002" x2="481.002" y1="561.5625" y2="574.5625"/><line style="stroke:#FF0000;stroke-width:1;" x1="440.002" x2="481.002" y1="574.5625" y2="574.5625"/><polygon fill="#FF0000" points="450.002,570.5625,440.002,574.5625,450.002,578.5625,446.002,574.5625" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="556.8203">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="485.3647" y="556.8203">Determine command</text><polygon fill="#FF0000" points="832.019,630.4941,842.019,634.4941,832.019,638.4941,836.019,634.4941" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="634.4941" y2="634.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="614.4414">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.5308" x="485.3647" y="599.1309">Decaps(KEM Pair : kem_handle (G),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.9976" x="538.8374" y="614.4414">KEM ciphertext : kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="538.8374" y="629.752">Destination : Slot Y)</text><polygon fill="#FF0000" points="1269.1343,659.8047,1279.1343,663.8047,1269.1343,667.8047,1273.1343,663.8047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1275.1343" y1="663.8047" y2="663.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="659.0625">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="900.3818" y="659.0625">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="693.1152" y2="693.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="693.1152" y2="706.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="706.1152" y2="706.1152"/><polygon fill="#FF0000" points="865.019,702.1152,855.019,706.1152,865.019,710.1152,861.019,706.1152" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="688.373">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.3521" x="900.3818" y="688.373">Decap KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="1380.9521,731.4258,1390.9521,735.4258,1380.9521,739.4258,1384.9521,735.4258" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1386.9521" y1="735.4258" y2="735.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="730.6836">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.6621" x="900.3818" y="730.6836">Put Shared Secret</text><polygon fill="#FF0000" points="450.002,760.7363,440.002,764.7363,450.002,768.7363,446.002,764.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="764.7363" y2="764.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="759.9941">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="759.9941">done</text><polygon fill="#FF0000" points="832.019,820.668,842.019,824.668,832.019,828.668,836.019,824.668" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="824.668" y2="824.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="804.6152">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="155.8159" x="485.3647" y="789.3047">Key_Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.3604" x="563.5171" y="804.6152">Data: encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="563.5171" y="819.9258">Destination : Slot Z)</text><polygon fill="#FF0000" points="1380.9521,849.9785,1390.9521,853.9785,1380.9521,857.9785,1384.9521,853.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1386.9521" y1="853.9785" y2="853.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="849.2363">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="900.3818" y="849.2363">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="883.2891" y2="883.2891"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="883.2891" y2="896.2891"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="896.2891" y2="896.2891"/><polygon fill="#FF0000" points="865.019,892.2891,855.019,896.2891,865.019,900.2891,861.019,896.2891" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="878.5469">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.5356" x="900.3818" y="878.5469">Key_Unwrap encrypted_access_key with Key</text><polygon fill="#FF0000" points="1487.6943,921.5996,1497.6943,925.5996,1487.6943,929.5996,1491.6943,925.5996" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1493.6943" y1="925.5996" y2="925.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="920.8574">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.647" x="900.3818" y="920.8574">Put Access Key</text><polygon fill="#FF0000" points="450.002,950.9102,440.002,954.9102,450.002,958.9102,446.002,954.9102" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="954.9102" y2="954.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="950.168">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="950.168">done</text><path d="M418.002,966.9102 L480.1406,966.9102 L480.1406,974.2207 L470.1406,984.2207 L418.002,984.2207 L418.002,966.9102 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="246.7949" style="stroke:#000000;stroke-width:1.5;" width="1102.6924" x="418.002" y="966.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="433.002" y="980.4785">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="148.9565" x="495.1406" y="979.5449">[pmek algorithm 256 bits]</text><polygon fill="#FF0000" points="832.019,1042.1523,842.019,1046.1523,832.019,1050.1523,836.019,1046.1523" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1046.1523" y2="1046.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1026.0996">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="485.3647" y="1010.7891">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="588.1968" y="1026.0996">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.6479" x="588.1968" y="1041.4102">Destination :  Slot Y)</text><polygon fill="#FF0000" points="1166.9175,1071.4629,1176.9175,1075.4629,1166.9175,1079.4629,1170.9175,1075.4629" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1172.9175" y1="1075.4629" y2="1075.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1070.7207">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1152" x="900.3818" y="1070.7207">Get FEK</text><polygon fill="#FF0000" points="1487.6943,1100.7734,1497.6943,1104.7734,1487.6943,1108.7734,1491.6943,1104.7734" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1493.6943" y1="1104.7734" y2="1104.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1100.0313">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.0308" x="900.3818" y="1100.0313">Get Access Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="1134.084" y2="1134.084"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="1134.084" y2="1147.084"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="1147.084" y2="1147.084"/><polygon fill="#FF0000" points="865.019,1143.084,855.019,1147.084,865.019,1151.084,861.019,1147.084" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1129.3418">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.0376" x="900.3818" y="1129.3418">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1380.9521,1172.3945,1390.9521,1176.3945,1380.9521,1180.3945,1384.9521,1176.3945" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1386.9521" y1="1176.3945" y2="1176.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1171.6523">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.0815" x="900.3818" y="1171.6523">Put HMAC512 result Encryption Key</text><polygon fill="#FF0000" points="450.002,1201.7051,440.002,1205.7051,450.002,1209.7051,446.002,1205.7051" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1205.7051" y2="1205.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1200.9629">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="1200.9629">done</text><polygon fill="#FF0000" points="832.019,1260.3262,842.019,1264.3262,832.019,1268.3262,836.019,1264.3262" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1264.3262" y2="1264.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1251.9287">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="244.1309" x="485.3647" y="1244.2734">new_key(len: pmek_alogorithm length,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.1802" x="542.9507" y="1259.584">Destination Slot: Z)</text><polygon fill="#FF0000" points="635.4341,1304.9473,625.4341,1308.9473,635.4341,1312.9473,631.4341,1308.9473" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="629.4341" x2="843.019" y1="1308.9473" y2="1308.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="641.4341" y="1296.5498">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.2939" x="680.7969" y="1288.8945">Get random limited</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.2222" x="680.7969" y="1304.2051">to len of PMEK algorithm</text><polygon fill="#FF0000" points="1487.6943,1334.2578,1497.6943,1338.2578,1487.6943,1342.2578,1491.6943,1338.2578" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1493.6943" y1="1338.2578" y2="1338.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1333.5156">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.585" x="900.3818" y="1333.5156">Put new PMEK</text><polygon fill="#FF0000" points="450.002,1363.5684,440.002,1367.5684,450.002,1371.5684,446.002,1367.5684" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1367.5684" y2="1367.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1362.8262">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="1362.8262">done</text><polygon fill="#FF0000" points="832.019,1423.5,842.019,1427.5,832.019,1431.5,836.019,1427.5" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1427.5" y2="1427.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1407.4473">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.7104" x="485.3647" y="1392.1367">Wrap(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="526.4976" y="1407.4473">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.7993" x="526.4976" y="1422.7578">Destination : locked_pmek)</text><polygon fill="#FF0000" points="1380.9521,1452.8105,1390.9521,1456.8105,1380.9521,1460.8105,1384.9521,1456.8105" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1386.9521" y1="1456.8105" y2="1456.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1452.0684">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.9868" x="900.3818" y="1452.0684">Get Encryption Key</text><polygon fill="#FF0000" points="1487.6943,1482.1211,1497.6943,1486.1211,1487.6943,1490.1211,1491.6943,1486.1211" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1493.6943" y1="1486.1211" y2="1486.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1481.3789">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.9688" x="900.3818" y="1481.3789">Get new PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="896.019" y1="1515.4316" y2="1515.4316"/><line style="stroke:#FF0000;stroke-width:1;" x1="896.019" x2="896.019" y1="1515.4316" y2="1528.4316"/><line style="stroke:#FF0000;stroke-width:1;" x1="855.019" x2="896.019" y1="1528.4316" y2="1528.4316"/><polygon fill="#FF0000" points="865.019,1524.4316,855.019,1528.4316,865.019,1532.4316,861.019,1528.4316" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1510.6895">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.0088" x="900.3818" y="1510.6895">Encrypt Data Key using Key</text><polygon fill="#FF0000" points="450.002,1553.7422,440.002,1557.7422,450.002,1561.7422,446.002,1557.7422" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1557.7422" y2="1557.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1553">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6274" x="495.3647" y="1553">Locked PMEK</text><polygon fill="#FF0000" points="832.019,1598.3633,842.019,1602.3633,832.019,1606.3633,836.019,1602.3633" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="439.002" x2="838.019" y1="1602.3633" y2="1602.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="446.002" y="1589.9658">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.9629" x="485.3647" y="1582.3105">Purge_key(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="551.1772" y="1597.6211">Key : Slot Z)</text><polygon fill="#FF0000" points="1380.9521,1627.6738,1390.9521,1631.6738,1380.9521,1635.6738,1384.9521,1631.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1386.9521" y1="1631.6738" y2="1631.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1626.9316">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="900.3818" y="1626.9316">Purge</text><polygon fill="#FF0000" points="1487.6943,1627.6738,1497.6943,1631.6738,1487.6943,1635.6738,1491.6943,1631.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="854.019" x2="1493.6943" y1="1631.6738" y2="1631.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="861.019" y="1626.9316">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="900.3818" y="1626.9316">&#160;</text><polygon fill="#FF0000" points="450.002,1656.9844,440.002,1660.9844,450.002,1664.9844,446.002,1660.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.002" x2="843.019" y1="1660.9844" y2="1660.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="456.002" y="1656.2422">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="495.3647" y="1656.2422">done</text><polygon fill="#FF0000" points="223.0068,1701.6055,213.0068,1705.6055,223.0068,1709.6055,219.0068,1705.6055" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="217.0068" x2="428.002" y1="1705.6055" y2="1705.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="229.0068" y="1693.208">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.6323" x="268.3696" y="1685.5527">Command response and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6274" x="268.3696" y="1700.8633">Locked PMEK</text><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="1705.6055" y2="1701.6055"/><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="1705.6055" y2="1709.6055"/><line style="stroke:#008000;stroke-width:1;" x1="42.6826" x2="211.0068" y1="1705.6055" y2="1705.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="59.6826" y="1693.208">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="99.0454" y="1685.5527">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="99.0454" y="1700.8633">complete</text><path d="M217.0068,1718.6055 L217.0068,1793.6055 L833.0068,1793.6055 L833.0068,1728.6055 L823.0068,1718.6055 L217.0068,1718.6055 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M823.0068,1718.6055 L823.0068,1728.6055 L833.0068,1728.6055 L823.0068,1718.6055 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="223.0068" y="1738.1738">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="227.1201" y="1738.1738">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="367.27" y="1738.1738">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="371.3833" y="1738.1738">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="472.0127" y="1738.1738">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="476.126" y="1738.1738">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="227.1201" y="1753.4844">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="371.3833" y="1753.4844">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="476.126" y="1753.4844">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="227.1201" y="1768.7949">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="371.3833" y="1768.7949">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="476.126" y="1768.7949">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="227.1201" y="1784.1055">new_encrypted_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="371.3833" y="1784.1055">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="476.126" y="1784.1055">PMEK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1725.6055" y2="1725.6055"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1740.916" y2="1740.916"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1756.2266" y2="1756.2266"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1771.5371" y2="1771.5371"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="818.6646" y1="1786.8477" y2="1786.8477"/><line style="stroke:#000000;stroke-width:0.5;" x1="223.0068" x2="223.0068" y1="1725.6055" y2="1786.8477"/><line style="stroke:#000000;stroke-width:0.5;" x1="367.27" x2="367.27" y1="1725.6055" y2="1786.8477"/><line style="stroke:#000000;stroke-width:0.5;" x1="472.0127" x2="472.0127" y1="1725.6055" y2="1786.8477"/><line style="stroke:#000000;stroke-width:0.5;" x1="818.6646" x2="818.6646" y1="1725.6055" y2="1786.8477"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="145.8301" x="710.6177" y="1892.9805">Filename: generate_pmek.uml</text><!--SRC=[jLTjRnit3FxkNy4OGUSiTTPbw3uOHG4tSRh0JMeqQOCL0Gxo7Syd-DugwUAuo8yVgNi_dxC1Q-z384iaHJvyA387CdR3p4D8tDG94tVjP4Q6-eIs1uC3wSFeK0V9nZ7IX7Wq0FfkUGd3znYZ4WPXSJMR3mS767lIR-ca2jqazdAjE25HuQf4Q_kRlpVBjujSHXgPn7hovhVbs-eKu5UucCr1nY30bohQ28NZICHYXHxClu0E4zEIdi-kO8xRL4ZrBrfD5wx9ivwhRmC4ZTyoZ5q4JugL4X48hRC8DPX06Fg3R70Zmv330n66oGP4J7UdcIdl0fFGYKvWYP1fya5ebabgYHCu4w5CZH9mSGTIWqAT4XnoIJZxYGBhlOnNi0ca6vHgP4QL9cCFN38gF94Qe0oOWCnOPrD6besoXswY26zpqWcKJgj8QUqdhhLAUZfpNTJQpqB0HtGpQopn8KavzvmpM6uB87AhH0ERwueGlm3bU8oFKXiEGHlYpC37zV4n7BxxV74n- -HCpsullqnlBpzU3zOOhVfF1lu63eNUnYv4InAPmFlPzUpJz7RcC0DRp1EfRB1EoLLWIAcA-edJVY4nz6eSyiqR-HqxM-VeozZo4vuQ5jnWJUW2j2naVvn2P-k3D5mk38PeMqWZN3iYN2LAcY3IUorSagfBe6cBisOFAGCSipw1Zt6ufKGXBAK17H05cMSAqqGPz4xkOvlYTrk2uPMLUJM1qzT_ybAtlDaeaQReES8ct5dZbZRlyisftPlRBQgnSI4BkIoGR75FhLm7LXnHOfs0U1fYOwDFo9LfWEJyeoasYPPgcvgER_raYvObHrn_OqbobaHKFbwB7f5UEQbGclYOqyHbRXNKOc8XbqgknyVHSZosYqEDeJyQalZm9GpFqQ2A985V20-Fo95GOwrK-bLVi7uuFfx0EReYrID-i1RyMaqQ-C3e_T5B6tlziM0DJ27UGQh-pf5hpTOdYTxm8_JtqM3zKBf0DPO7sNWm6ySFXN_s-Ao-TKEPsXKt6ANR2IpeFRi9w4Nou0PTXMPW3_fhkP4BZyYR9w6oI62Dn-Gu7pK0NJyq0Dr1bFnoFiVCp14JjGox2sG1a31YqakiVl5TFByUxI30WBOHQ45QEzZFw1BTjjtlER9v1TfZk_lJO1MXiGyJLALPFHUTIibX_-jgUlRwzrE7GT5DvAVzoDVuGqFuwtEoBV0hDhT2etQIuq_pGlkam93F6XYsH3WvHHXvmvxQVfexjckju7gfGRqw8yncUKhPoVA2tcpipuXLgR9IPIRVjjb1ViQw2OXnm_GPXHXFofQIbAcZpPK9TZBHX9J3d32TMvufGY17ZLS9MPAH9CBUnpJDaDMo0zKqwOMTWI87hUZFmMG7ZxlY1UXz09xbNPjeF0jJWJAY_QNUoNWVuwhGMrmh56jdCcv4riX_A-0FrhNSyfuwxgAooDGABK_sGLFqcGOstR3Xu00AIuCNdLJJsOzzr6qVBdftEGyZr-Lzt0p_1TGTlztmxsDgocb8BVg7JuR_SonyRYRqPQeT7f4plL-z7WZjf5-D7poxNrmkRe2cCvKyy0Il-5yDL8eMpMluqQYRa7tldqfUehV8VzlwhgJilp7rU7UwPmApQHxOhFu3]--></g></svg>