<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="669px" preserveAspectRatio="none" style="width:767px;height:669px;background:#FFFFFF;" version="1.1" viewBox="0 0 767 669" width="767px" zoomAndPan="magnify"><defs><filter height="300%" id="f1qyztyrxr73i4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="591.6875" style="stroke:#A80036;stroke-width:1.0;" width="353" x="179" y="55.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="330.5" y="68.7139">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="44" x="716" y="15.3809">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="331" x="217" y="43.2637">GET_ALGORITHMS command sequence</text><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="39" x2="39" y1="147.3984" y2="569.0781"/><rect fill="#FFFFFF" filter="url(#f1qyztyrxr73i4)" height="18" style="stroke:#A80036;stroke-width:1.0;" width="10" x="34" y="551.0781"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="218" x2="218" y1="147.3984" y2="569.0781"/><rect fill="#FFFFFF" filter="url(#f1qyztyrxr73i4)" height="43.3516" style="stroke:#A80036;stroke-width:1.0;" width="10" x="213" y="177.75"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="508" x2="508" y1="147.3984" y2="569.0781"/><rect fill="#FFFFFF" filter="url(#f1qyztyrxr73i4)" height="355.9766" style="stroke:#A80036;stroke-width:1.0;" width="10" x="503" y="208.1016"/><rect fill="#FEFECE" filter="url(#f1qyztyrxr73i4)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="64" x="5" y="75.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="12" y="97.1035">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="15.5" y="114.7129">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="26" y="132.3223">FW</text><rect fill="#FEFECE" filter="url(#f1qyztyrxr73i4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="66" x="183" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="190" y="132.3223">Mail Box</text><rect fill="#FEFECE" filter="url(#f1qyztyrxr73i4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="36" x="488" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="495" y="132.3223">FW</text><rect fill="#FEFECE" filter="url(#f1qyztyrxr73i4)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="64" x="5" y="569.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="12" y="590.6113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="43" x="15.5" y="608.2207">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="26" y="625.8301">FW</text><rect fill="#FEFECE" filter="url(#f1qyztyrxr73i4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="66" x="183" y="569.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="52" x="190" y="590.6113">Mail Box</text><rect fill="#FEFECE" filter="url(#f1qyztyrxr73i4)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="36" x="488" y="569.0781"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="495" y="590.6113">FW</text><line style="stroke:#008000;stroke-width:1.0;" x1="211" x2="201" y1="177.75" y2="173.75"/><line style="stroke:#008000;stroke-width:1.0;" x1="211" x2="201" y1="177.75" y2="181.75"/><line style="stroke:#008000;stroke-width:1.0;" x1="39" x2="212" y1="177.75" y2="177.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="46" y="172.8936">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="79" y="172.8936">GET_ALGORITHMS</text><line style="stroke:#008000;stroke-width:1.0;" x1="501" x2="491" y1="208.1016" y2="204.1016"/><line style="stroke:#008000;stroke-width:1.0;" x1="501" x2="491" y1="208.1016" y2="212.1016"/><line style="stroke:#008000;stroke-width:1.0;" x1="223" x2="502" y1="208.1016" y2="208.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="230" y="203.2451">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="263" y="203.2451">Command</text><line style="stroke:#FF0000;stroke-width:1.0;" x1="513" x2="555" y1="238.4531" y2="238.4531"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="555" x2="555" y1="238.4531" y2="251.4531"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="514" x2="555" y1="251.4531" y2="251.4531"/><polygon fill="#FF0000" points="524,247.4531,514,251.4531,524,255.4531,520,251.4531" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="520" y="233.5967">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="200" x="553" y="233.5967">Fill the set of algorithms supported</text><path d="M317.5,264.4531 L317.5,502.4531 L694.5,502.4531 L694.5,274.4531 L684.5,264.4531 L317.5,264.4531 " fill="#FBFB77" filter="url(#f1qyztyrxr73i4)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M684.5,264.4531 L684.5,274.4531 L694.5,274.4531 L684.5,264.4531 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="327.5" y="282.9482"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149" x="323.5" y="299.2998">The Algorithms to support</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="327.5" y="315.6514"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="323.5" y="332.0029">From the HPKE base spec:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="327.5" y="348.3545"/><ellipse cx="329" cy="360.0625" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="336.5" y="364.7061">kem_id = 0x0011: P-384</text><ellipse cx="329" cy="376.4141" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197" x="336.5" y="381.0576">aead_id = 0x0002: AES-256-GCM</text><ellipse cx="329" cy="392.7656" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187" x="336.5" y="397.4092">kdf_id = 0x0002: HKDF-SHA384</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="327.5" y="413.7607"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307" x="323.5" y="430.1123">For post-quantum crypto, from the X-Wing draft spec:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="327.5" y="446.4639"/><ellipse cx="329" cy="458.1719" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242" x="336.5" y="462.8154">kem_id = 0x647a: ML-KEM-768 + X25519</text><ellipse cx="329" cy="474.5234" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="343" x="336.5" y="479.167">aead_id and kdf_id will be the same as from the base spec.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="327.5" y="495.5186"/><polygon fill="#FF0000" points="229,547.0781,219,551.0781,229,555.0781,225,551.0781" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="223" x2="502" y1="551.0781" y2="551.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="235" y="538.0459">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="268" y="529.8701">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="268" y="546.2217">Response/nSet of algorithms supported</text><line style="stroke:#008000;stroke-width:1.0;" x1="44" x2="54" y1="551.0781" y2="547.0781"/><line style="stroke:#008000;stroke-width:1.0;" x1="44" x2="54" y1="551.0781" y2="555.0781"/><line style="stroke:#008000;stroke-width:1.0;" x1="44" x2="217" y1="551.0781" y2="551.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="61" y="538.0459">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59" x="94" y="529.8701">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55" x="94" y="546.2217">Complete</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="142" x="311.5" y="661.2871">Filename: get_algorithms.uml</text><!--MD5=[efba71731244a9b713931218cd083d70]
@startuml

!include ocp_lock_utils.inc

!if ($show_title)
    Title "GET_ALGORITHMS command sequence"
!endif

fw $async mb++ : GET_ALGORITHMS

!if ($show_api)
    note right mb
        | <b>Field | <b>Size | <b>Definition |
        | chksum   | u32     | Checksum over other input arguments, computed by the caller. Little endian. |
    end note
!endif

mb $async cfw++ : Command

!if ($show_msg_parsing)
    cfw $sync mb : Get command
    mb- -
    $self("cfw", "Determine command")
!else
    mb- -
!endif

$self("cfw", "Fill the set of algorithms supported ")
note over cfw

    The Algorithms to support

    From the HPKE base spec:

    *	kem_id = 0x0011: P-384
    *	aead_id = 0x0002: AES-256-GCM
    *	kdf_id = 0x0002: HKDF-SHA384

    For post-quantum crypto, from the X-Wing draft spec:

    *	kem_id = 0x647a: ML-KEM-768 + X25519
    *	aead_id and kdf_id will be the same as from the base spec.

end note

cfw $sync mb : Command\nResponse/nSet of algorithms supported
& mb $async fw++ : Command\nComplete
cfw- -
!if ($show_api)
    ||5||
    note right mb
        | <b>Field               | <b>Size | <b>Definition |
        | chksum                 | u32     | Checksum over other output arguments, computed by Caliptra. Little endian. |
        | endorsement_algorithms | u32     | Identifies the supported endorsement algorithms\n    * Byte 0 bit 0: ecdsa_secp384r1_sha384 |
        | kem_algorithms         | u32     | Identifies the supported KEM algorithms\n    * Byte 0 bit 0: ecdh_secp384r1_aes256_gcm |
        | pmek_algorithms        | u32     | Indicates the size of PMEKs.\n    * Byte 0 bit 0: 256 bits |
        | access_key_algorithm   | u32     | Indicates the size of access keys.\n    * Byte 0 bit 0: 256 bits |
        | Reserved               | u32[4]  | Reserved |
    end note
!endif

@enduml

@startuml









	autonumber 1 1  "<b>[000]"

	!pragma teoz true

    participant "Remote Key\nManagement Service" as rkms


    participant "Host" as host


    participant "Storage\nDevice\nFW" as fw

    box "Caliptra"
    	participant "Mail Box" as mb
    	participant "ROM" as crom
    	participant "FW" as cfw
    	participant "ROM to FW\nHandoff Data" as hoff
        participant "DRBG" as rand
        participant "DMA Engine" as dma
        participant "Key Vault" as kv
        participant "Key Vault\nFuses" as fuses
        participant "Key Vault\nStorage Root Key" as gsrk
        participant "Key Vault\nSlot A\n(Storage Root Key)" as srk
        participant "Key Vault\nSlot B\n(PMEK Secret)" as pmeks
        participant "Key Vault\nSlot F\n(DICE Alias Key)\necdsa_secp384r1_sha384" as dice
        participant "Key Vault\nSlot G\n(KEM Keypair)" as kemg
        participant "Key Vault\nSlot W\n(Temporary)" as tempw
        participant "Key Vault\nSlot X\n(MEK Seed)" as meks
        participant "Key Vault\nSlot Y\n(Temporary)" as tempy
        participant "Key Vault\nSlot Z\n(Temporary)" as tempz
        participant "Key Vault\nTemp Memory" as tempmem
    end box

    box "Encryption Engine"
        participant "SFR\nInterface" as sfr
        participant "Control" as ee
        participant "Key Cache" as kc
    end box

    box "Media"
        participant "Create new\Storage Root Key\non NVM subsystem reset" as csrk
        participant "Destroy all\Storage Root Keys\non NVM subsystem reset" as dsrk
    end box

    hide unlinked
	footer Filename: get_algorithms.uml

	header Version 1


    Title "GET_ALGORITHMS command sequence"

fw -[#green]>> mb++ : GET_ALGORITHMS


mb -[#green]>> cfw++ : Command

    mb- -

	   cfw -[#red]> cfw : Fill the set of algorithms supported 
	   ||0||
note over cfw

    The Algorithms to support

    From the HPKE base spec:

    *	kem_id = 0x0011: P-384
    *	aead_id = 0x0002: AES-256-GCM
    *	kdf_id = 0x0002: HKDF-SHA384

    For post-quantum crypto, from the X-Wing draft spec:

    *	kem_id = 0x647a: ML-KEM-768 + X25519
    *	aead_id and kdf_id will be the same as from the base spec.

end note

cfw -[#red]> mb : Command\nResponse/nSet of algorithms supported
& mb -[#green]>> fw++ : Command\nComplete
cfw- -

@enduml

PlantUML version 1.2021.7(Sun May 23 06:40:07 MDT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>