<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="710px" preserveAspectRatio="none" style="width:888px;height:710px;background:#FFFFFF;" version="1.1" viewBox="0 0 888 710" width="888px" zoomAndPan="magnify"><title>Enumerate KEM Handles</title><defs/><g><rect fill="#DDDDDD" height="630.5195" style="stroke:#181818;stroke-width:0.5;" width="254.9697" x="241.1982" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="342.2864" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="834.9429" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="175.6289" x="355.1697" y="41.3125">Enumerate KEM Handles</text><g><title>Storage</title><rect fill="transparent" height="476.2793" width="8" x="34.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="37.6826" x2="37.6826" y1="140.041" y2="616.3203"/></g><g><title/><rect fill="#FFFFFF" height="118.5527" style="stroke:#181818;stroke-width:1;" width="10" x="32.6826" y="497.7676"/></g><g><title>Mail Box</title><rect fill="transparent" height="476.2793" width="8" x="277.4741" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="280.9741" x2="280.9741" y1="140.041" y2="616.3203"/></g><g><title/><rect fill="#FFFFFF" height="113.2422" style="stroke:#181818;stroke-width:1;" width="10" x="275.9741" y="219.9727"/></g><g><title>FW</title><rect fill="transparent" height="476.2793" width="8" x="471.9268" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="475.4268" x2="475.4268" y1="140.041" y2="616.3203"/></g><g><title/><rect fill="#FFFFFF" height="193.8633" style="stroke:#181818;stroke-width:1;" width="10" x="470.4268" y="303.9043"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="245.1982" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="252.1982" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="458.6855" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="465.6855" y="129.0879">FW</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="5" y="616.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="12" y="636.8555">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="15.4077" y="653.3438">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="27.9414" y="669.832">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="245.1982" y="616.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="252.1982" y="636.8555">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="458.6855" y="616.3203"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="465.6855" y="636.8555">FW</text><path d="M17.9707,153.041 L17.9707,193.041 L494.9707,193.041 L494.9707,163.041 L484.9707,153.041 L17.9707,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M484.9707,153.041 L484.9707,163.041 L494.9707,163.041 L484.9707,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="64.437" y="170.6094">Preconditions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="367.0088" x="72.6636" y="185.9199">* Caliptra FW manages which keys are in which slots in KV</text><line style="stroke:#008000;stroke-width:1;" x1="273.9741" x2="263.9741" y1="219.9727" y2="215.9727"/><line style="stroke:#008000;stroke-width:1;" x1="273.9741" x2="263.9741" y1="219.9727" y2="223.9727"/><line style="stroke:#008000;stroke-width:1;" x1="37.6826" x2="274.9741" y1="219.9727" y2="219.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="44.6826" y="215.2305">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.9287" x="84.0454" y="215.2305">ENUMERATE_KEM_HANDLES</text><path d="M169.9495,232.9727 L169.9495,276.9727 L391.9495,276.9727 L391.9495,242.9727 L381.9495,232.9727 L169.9495,232.9727 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M381.9495,232.9727 L381.9495,242.9727 L391.9495,242.9727 L381.9495,232.9727 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="175.9495" y="252.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="180.0627" y="252.541">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="241.5588" y="252.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="245.6721" y="252.541">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="290.7468" y="252.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="294.8601" y="252.541">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="180.0627" y="267.8516">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="245.6721" y="267.8516">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="294.8601" y="267.8516">Little endian</text><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="376.9988" y1="239.9727" y2="239.9727"/><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="376.9988" y1="255.2832" y2="255.2832"/><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="376.9988" y1="270.5938" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="175.9495" x2="175.9495" y1="239.9727" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="241.5588" x2="241.5588" y1="239.9727" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="290.7468" x2="290.7468" y1="239.9727" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="376.9988" x2="376.9988" y1="239.9727" y2="270.5938"/><line style="stroke:#008000;stroke-width:1;" x1="468.4268" x2="458.4268" y1="303.9043" y2="299.9043"/><line style="stroke:#008000;stroke-width:1;" x1="468.4268" x2="458.4268" y1="303.9043" y2="307.9043"/><line style="stroke:#008000;stroke-width:1;" x1="285.9741" x2="469.4268" y1="303.9043" y2="303.9043"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="292.9741" y="299.1621">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54.2217" x="332.3369" y="299.1621">Message</text><polygon fill="#FF0000" points="296.9741,329.2148,286.9741,333.2148,296.9741,337.2148,292.9741,333.2148" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="290.9741" x2="469.4268" y1="333.2148" y2="333.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="302.9741" y="328.4727">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.7739" x="342.3369" y="328.4727">Get message</text><line style="stroke:#FF0000;stroke-width:1;" x1="480.4268" x2="522.4268" y1="362.5254" y2="362.5254"/><line style="stroke:#FF0000;stroke-width:1;" x1="522.4268" x2="522.4268" y1="362.5254" y2="375.5254"/><line style="stroke:#FF0000;stroke-width:1;" x1="481.4268" x2="522.4268" y1="375.5254" y2="375.5254"/><polygon fill="#FF0000" points="491.4268,371.5254,481.4268,375.5254,491.4268,379.5254,487.4268,375.5254" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="487.4268" y="357.7832">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.8838" x="526.7896" y="357.7832">Determine message</text><line style="stroke:#FF0000;stroke-width:1;" x1="480.4268" x2="522.4268" y1="404.8359" y2="404.8359"/><line style="stroke:#FF0000;stroke-width:1;" x1="522.4268" x2="522.4268" y1="404.8359" y2="417.8359"/><line style="stroke:#FF0000;stroke-width:1;" x1="481.4268" x2="522.4268" y1="417.8359" y2="417.8359"/><polygon fill="#FF0000" points="491.4268,413.8359,481.4268,417.8359,491.4268,421.8359,487.4268,417.8359" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="487.4268" y="400.0938">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.6372" x="526.7896" y="400.0938">Create list of valid KEM handles</text><path d="M485.4268,430.8359 L485.4268,455.8359 L798.4268,455.8359 L798.4268,440.8359 L788.4268,430.8359 L485.4268,430.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M788.4268,430.8359 L788.4268,440.8359 L798.4268,440.8359 L788.4268,430.8359 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.373" x="491.4268" y="448.4043">One handle for each KEM algorithm supported</text><polygon fill="#FF0000" points="291.9741,493.7676,281.9741,497.7676,291.9741,501.7676,287.9741,497.7676" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="285.9741" x2="469.4268" y1="497.7676" y2="497.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="297.9741" y="485.3701">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="337.3369" y="477.7148">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6021" x="337.3369" y="493.0254">kem_handles</text><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="497.7676" y2="493.7676"/><line style="stroke:#008000;stroke-width:1;" x1="43.6826" x2="53.6826" y1="497.7676" y2="501.7676"/><line style="stroke:#008000;stroke-width:1;" x1="42.6826" x2="279.9741" y1="497.7676" y2="497.7676"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="59.6826" y="485.3701">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="99.0454" y="477.7148">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="99.0454" y="493.0254">complete</text><path d="M285.9741,510.7676 L285.9741,600.7676 L875.9741,600.7676 L875.9741,520.7676 L865.9741,510.7676 L285.9741,510.7676 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M865.9741,510.7676 L865.9741,520.7676 L875.9741,520.7676 L865.9741,510.7676 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="291.9741" y="530.3359">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="296.0874" y="530.3359">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="418.3179" y="530.3359">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="422.4312" y="530.3359">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="515.3164" y="530.3359">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="519.4297" y="530.3359">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="296.0874" y="545.6465">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="422.4312" y="545.6465">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="519.4297" y="545.6465">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="296.0874" y="560.957">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="422.4312" y="560.957">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="519.4297" y="560.957">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.1172" x="296.0874" y="576.2676">kem_handle_count</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="422.4312" y="576.2676">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.6846" x="519.4297" y="576.2676">Number of KEM handles (N)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.6021" x="296.0874" y="591.5781">kem_handles</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.772" x="422.4312" y="591.5781">KEMHandle[N]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.1509" x="519.4297" y="591.5781">List of (KEM handle value, KEM algorithm) tuples</text><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="517.7676" y2="517.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="533.0781" y2="533.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="548.3887" y2="548.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="563.6992" y2="563.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="579.0098" y2="579.0098"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="861.9683" y1="594.3203" y2="594.3203"/><line style="stroke:#000000;stroke-width:0.5;" x1="291.9741" x2="291.9741" y1="517.7676" y2="594.3203"/><line style="stroke:#000000;stroke-width:0.5;" x1="418.3179" x2="418.3179" y1="517.7676" y2="594.3203"/><line style="stroke:#000000;stroke-width:0.5;" x1="515.3164" x2="515.3164" y1="517.7676" y2="594.3203"/><line style="stroke:#000000;stroke-width:0.5;" x1="861.9683" x2="861.9683" y1="517.7676" y2="594.3203"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="191.6309" x="347.1687" y="700.4531">Filename: enumerate_kem_handles.uml</text><!--SRC=[XLJRJXj137tVhp1HL2K5MgbzYn0I8g4W8A12suTIhIQptkmeSzDubeYAZwzdTtChqCwJr-DZ7zjdTazPgUi2mKcVQoSNUHsLfW_iph8zLSAWJvLRvb55ZSCC-Dmd4teJMniC8Y9SJgxXNDX28_MoFRI5AdUmFg1qjcZHrZ52oE28ckzqZcR7jssCYifP6Xrzd1slRm7UmwdGoiSWuEm7667570cMbP8LBF29G0G4PJiFQHSfVLv-Rt8meQRgcbgvXBwW9ol1pFRtOGIJwRVhoTUJ-qdEhUJd9zFnrUHkfmNXrHPzzuY1iMk6pwc3CuMwQCqxzHjRQuobiarJyBmLBgi5rQOnwy-VEkULYccmYQHOXR_WRcOhxh9SDkIlaOZdaMKxX0tDSoy2AJjlYSlKTTSqexvW1DCXqxMP7HusHfzGbuCUX_SEe3V6YC4eYwlWtf2fQDe2hPXbcmfiZU0qO1A7LXJ1bV386omQgLIjLB9cb47DgvW0JS8RBjHUG-a2eE1r9eZGSnTKh0nGxRqB4OjiFPhihzPEdM69512GF8i97-m2JRwg-Wus8-mcs04Uh7J6QqmftzvzI_ZrvU-u6X5iFl-dX8rhfOX_oAAzAPMddAA8DRs1lM2Gv2tmSoWXLWYocuqYEBkulGFXVM0r5y3JvkmO0XlRDJQZowMhRNnPOrgR6Jy7Nl7MSc4m7RwHPysLmzk_ni_fhwRFLYY3JPeacXeFTYKmX5ZxbERr5y9YO56cymS0]--></g></svg>