'
' OCP Lock: GET_RANDOM API sequence diagram showing Caliptra FW/HW interactions
'
'
@startuml

!include ocp_lock_utils.inc

!if ($show_title)
    Title "Get Random"
!endif

fw $async mb++ : GET_RANDOM

!if ($show_api)
    note over mb
        | <b>Field | <b>Size | <b>Definition |
        | chksum   | u32     | Little endian |
        | len      | u32     | Size, in bytes, of random number requested |
    end note
!endif

mb $async cfw++ : Command

!if ($show_msg_parsing)
    cfw $sync mb : Get command
    mb--
    $self("cfw", "Determine command")
!else
    mb--
!endif

alt If len requested fits into the response area

    cfw $sync rand: Get random number with a size of len bytes
    cfw $sync mb : random_number
end

cfw $sync mb : Command Response
& mb $async fw++ : Command\nComplete

!if ($show_api)
    note over mb
        | <b>Field      | <b>Size | <b>Definition |
        | chksum        | u32     | Little endian |
        | fips_status   | u32     | Indicates if the command is FIPS approved or an error |
        | len           | u32     | Size (N), in bytes, of the random number when N shall equal len |
        | random_number | u8[N]   | Random number |
    end note
!endif
cfw--


@enduml
