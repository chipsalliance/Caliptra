<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2314px" preserveAspectRatio="none" style="width:1893px;height:2314px;background:#FFFFFF;" version="1.1" viewBox="0 0 1893 2314" width="1893px" zoomAndPan="magnify"><title>Load MEK</title><defs/><g><rect fill="#DDDDDD" height="2234.1523" style="stroke:#181818;stroke-width:0.5;" width="1171.2456" x="154.2368" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="713.4629" y="68.834">Caliptra</text><rect fill="#DDDDDD" height="2234.1523" style="stroke:#181818;stroke-width:0.5;" width="256.395" x="1337.4824" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.291" x="1405.0344" y="68.834">Encryption Engine</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1839.416" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="70.2598" x="919.5908" y="41.3125">Load MEK</text><g><title>Storage</title><rect fill="transparent" height="2079.9121" width="8" x="53.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="56.6826" x2="56.6826" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="51.6826" y="2132.0215"/></g><g><title>Mail Box</title><rect fill="transparent" height="2079.9121" width="8" x="190.5127" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="194.0127" x2="194.0127" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#FFFFFF" height="205.1055" style="stroke:#181818;stroke-width:1;" width="10" x="189.0127" y="296.5254"/></g><g><title>FW</title><rect fill="transparent" height="2079.9121" width="8" x="394.9185" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="398.4185" x2="398.4185" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#FFFFFF" height="1659.7012" style="stroke:#181818;stroke-width:1;" width="10" x="393.4185" y="472.3203"/></g><g><title>DMA Engine</title><rect fill="transparent" height="2079.9121" width="8" x="666.5498" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="670.0498" x2="670.0498" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#FFFFFF" height="138.5527" style="stroke:#181818;stroke-width:1;" width="10" x="665.0498" y="1354.0156"/></g><g><title>Key Vault</title><rect fill="transparent" height="2079.9121" width="8" x="763.4072" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="766.9072" x2="766.9072" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="761.9072" y="708.8047"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="761.9072" y="912.9785"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="761.9072" y="1998.1582"/></g><g><title>Key Vault</title><rect fill="transparent" height="2079.9121" width="8" x="1043.5317" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1047.0317" x2="1047.0317" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#ADD8E6" height="1944.7383" style="stroke:#181818;stroke-width:1;" width="10" x="1042.0317" y="275.2148"/></g><g><title>Key Vault</title><rect fill="transparent" height="2079.9121" width="8" x="1167.104" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1170.604" x2="1170.604" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#ADD8E6" height="1217.7324" style="stroke:#181818;stroke-width:1;" width="10" x="1165.604" y="809.7363"/></g><line style="stroke:#181818;stroke-width:2;" x1="1161.604" x2="1179.604" y1="2018.4688" y2="2036.4688"/><line style="stroke:#181818;stroke-width:2;" x1="1161.604" x2="1179.604" y1="2036.4688" y2="2018.4688"/><g><title>Key Vault</title><rect fill="transparent" height="2079.9121" width="8" x="1269.6113" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1273.1113" x2="1273.1113" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#ADD8E6" height="1013.5586" style="stroke:#181818;stroke-width:1;" width="10" x="1268.1113" y="1013.9102"/></g><g><title>SFR</title><rect fill="transparent" height="2079.9121" width="8" x="1374.6504" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1378.1504" x2="1378.1504" y1="140.041" y2="2219.9531"/></g><g><title/><rect fill="#FFFFFF" height="1553.7695" style="stroke:#181818;stroke-width:1;" width="10" x="1373.1504" y="275.2148"/></g><g><title>Control</title><rect fill="transparent" height="2079.9121" width="8" x="1554.0845" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1557.5845" x2="1557.5845" y1="140.041" y2="2219.9531"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="158.2368" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="165.2368" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="381.6772" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="388.6772" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.1748" x="621.9624" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.1748" x="628.9624" y="129.0879">DMA Engine</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="728.1372" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="735.1372" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="977.5957" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1015.2617" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1027.2759" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="984.5957" y="129.0879">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.2725" x="1126.4678" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1138.834" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.6162" x="1151.2959" y="112.5996">Slot X</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.2725" x="1133.4678" y="129.0879">(MEK Seed)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1224.7402" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1241.3413" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1253.8237" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1231.7402" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="1341.4824" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="1366.2012" y="112.5996">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="1348.4824" y="129.0879">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="1525.2915" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="1532.2915" y="129.0879">Control</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="2240.4883">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="2256.9766">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="2273.4648">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="158.2368" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="165.2368" y="2240.4883">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="381.6772" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="388.6772" y="2240.4883">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.1748" x="621.9624" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.1748" x="628.9624" y="2240.4883">DMA Engine</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="728.1372" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="735.1372" y="2240.4883">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="977.5957" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1015.2617" y="2240.4883">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1027.2759" y="2256.9766">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="984.5957" y="2273.4648">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.2725" x="1126.4678" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1138.834" y="2240.4883">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.6162" x="1151.2959" y="2256.9766">Slot X</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.2725" x="1133.4678" y="2273.4648">(MEK Seed)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1224.7402" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1241.3413" y="2240.4883">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1253.8237" y="2256.9766">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1231.7402" y="2273.4648">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="1341.4824" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="1366.2012" y="2240.4883">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="1348.4824" y="2256.9766">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="1525.2915" y="2219.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="1532.2915" y="2240.4883">Control</text><path d="M29.1948,153.041 L29.1948,270.041 L1584.1948,270.041 L1584.1948,163.041 L1574.1948,153.041 L29.1948,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1574.1948,153.041 L1574.1948,163.041 L1584.1948,163.041 L1574.1948,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="94.8984" y="170.6094">Preconditions:</text><ellipse cx="100.3984" cy="181.1621" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="611.292" x="106.8984" y="185.9199">The following sequence may or may not have occurred prior: Zero or more MIX_PMEK commands</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="94.8984" y="201.2305">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.7422" x="94.8984" y="216.541">Notes:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1407.2437" x="103.125" y="231.8516">* The sequence diagram assumes that the KV will not allow an input KV slot to also be used as an out KV slot. Calitra FW is responsible for managing which KVC slots are used and can adapt if this assumption is not correct.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="579.395" x="103.125" y="247.1621">* This sequence is focused on successful execution of operations by the KV. Sill need to do:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="7.522" x="131.918" y="262.4727">-</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.7705" x="143.5532" y="262.4727">Define the reported error conditions and handling</text><line style="stroke:#008000;stroke-width:1;" x1="187.0127" x2="177.0127" y1="296.5254" y2="292.5254"/><line style="stroke:#008000;stroke-width:1;" x1="187.0127" x2="177.0127" y1="296.5254" y2="300.5254"/><line style="stroke:#008000;stroke-width:1;" x1="56.6826" x2="188.0127" y1="296.5254" y2="296.5254"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="63.6826" y="291.7832">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.9673" x="103.0454" y="291.7832">LOAD_MEK</text><path d="M204.0127,309.5254 L204.0127,445.5254 L869.0127,445.5254 L869.0127,319.5254 L859.0127,309.5254 L204.0127,309.5254 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M859.0127,309.5254 L859.0127,319.5254 L869.0127,319.5254 L859.0127,309.5254 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="210.0127" y="329.0938">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="214.126" y="329.0938">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="306.7827" y="329.0938">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="310.896" y="329.0938">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="360.3062" y="329.0938">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="364.4194" y="329.0938">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="214.126" y="344.4043">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="310.896" y="344.4043">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="364.4194" y="344.4043">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.8237" x="214.126" y="359.7148">metadata</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="310.896" y="359.7148">u8[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="485.9956" x="364.4194" y="359.7148">Metadata for MEK to load into the drive crypto engine (i.e. NSID + LBA range)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.5435" x="214.126" y="375.0254">aux_metadata</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="310.896" y="375.0254">u8[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391.9932" x="364.4194" y="375.0254">Auxiliary metadata for the MEK (optional; i.e. operation mode)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.7085" x="214.126" y="390.3359">rdy_timeout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="310.896" y="390.3359">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="469.6758" x="364.4194" y="390.3359">Timeout in ms for encryption engine to become ready for a new command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.3926" x="214.126" y="405.6465">cmd_timeout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="310.896" y="405.6465">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366.3613" x="364.4194" y="405.6465">Timeout in ms for command to crypto engine to complete</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.0229" x="214.126" y="420.957">dek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="310.896" y="420.957">u8[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262.8374" x="364.4194" y="420.957">Controller-supplied "data encryption key"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.5117" x="376.7593" y="436.2676">* May be a C_PIN-derived secret in Opal or a per-MEK value in KPIO</text><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="316.5254" y2="316.5254"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="331.8359" y2="331.8359"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="347.1465" y2="347.1465"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="362.457" y2="362.457"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="377.7676" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="393.0781" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="408.3887" y2="408.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="439.0098" y2="439.0098"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="210.0127" y1="316.5254" y2="439.0098"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.7827" x2="306.7827" y1="316.5254" y2="439.0098"/><line style="stroke:#000000;stroke-width:0.5;" x1="360.3062" x2="360.3062" y1="316.5254" y2="439.0098"/><line style="stroke:#000000;stroke-width:0.5;" x1="854.5283" x2="854.5283" y1="316.5254" y2="439.0098"/><line style="stroke:#008000;stroke-width:1;" x1="391.4185" x2="381.4185" y1="472.3203" y2="468.3203"/><line style="stroke:#008000;stroke-width:1;" x1="391.4185" x2="381.4185" y1="472.3203" y2="476.3203"/><line style="stroke:#008000;stroke-width:1;" x1="199.0127" x2="392.4185" y1="472.3203" y2="472.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="206.0127" y="467.5781">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="245.3755" y="467.5781">Command</text><polygon fill="#FF0000" points="210.0127,497.6309,200.0127,501.6309,210.0127,505.6309,206.0127,501.6309" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="204.0127" x2="392.4185" y1="501.6309" y2="501.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="216.0127" y="496.8887">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="255.3755" y="496.8887">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="530.9414" y2="530.9414"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="530.9414" y2="543.9414"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="543.9414" y2="543.9414"/><polygon fill="#FF0000" points="414.4185,539.9414,404.4185,543.9414,414.4185,547.9414,410.4185,543.9414" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="526.1992">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="449.7813" y="526.1992">Determine command</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="573.252" y2="573.252"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="573.252" y2="586.252"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="586.252" y2="586.252"/><polygon fill="#FF0000" points="414.4185,582.252,404.4185,586.252,414.4185,590.252,410.4185,586.252" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="568.5098">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.2642" x="449.7813" y="568.5098">Use KV Slot X for deriving MEK</text><path d="M8,598.252 L70.1387,598.252 L70.1387,605.5625 L60.1387,615.5625 L8,615.5625 L8,598.252 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="1349.2852" style="stroke:#000000;stroke-width:1.5;" width="1850.4414" x="8" y="598.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="611.8203">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="372.6948" x="85.1387" y="610.8867">[Storage Root Key exists and Encryption Engin has become ready]</text><path d="M382.4185,629.5625 L444.5571,629.5625 L444.5571,636.873 L434.5571,646.873 L382.4185,646.873 L382.4185,629.5625 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="217.4844" style="stroke:#000000;stroke-width:1.5;" width="809.1855" x="382.4185" y="629.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="397.4185" y="643.1309">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="304.0415" x="459.5571" y="642.1973">[MEK is not initialized (i.e., no PMEK in the final MEK)]</text><polygon fill="#FF0000" points="749.9072,704.8047,759.9072,708.8047,749.9072,712.8047,753.9072,708.8047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="755.9072" y1="708.8047" y2="708.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="688.752">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.1533" x="449.7813" y="673.4414">HMAC512(Key: Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.1567" x="515.5938" y="688.752">Key Data: "MEK Seed",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4595" x="515.5938" y="704.0625">Destination: Slot X)</text><polygon fill="#FF0000" points="1030.0317,734.1152,1040.0317,738.1152,1030.0317,742.1152,1034.0317,738.1152" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1036.0317" y1="738.1152" y2="738.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="733.373">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1104" x="818.27" y="733.373">Get Storage Root Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="813.9072" y1="767.4258" y2="767.4258"/><line style="stroke:#FF0000;stroke-width:1;" x1="813.9072" x2="813.9072" y1="767.4258" y2="780.4258"/><line style="stroke:#FF0000;stroke-width:1;" x1="772.9072" x2="813.9072" y1="780.4258" y2="780.4258"/><polygon fill="#FF0000" points="782.9072,776.4258,772.9072,780.4258,782.9072,784.4258,778.9072,780.4258" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="762.6836">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.6924" x="818.27" y="762.6836">HMAC512 slot A with Data</text><polygon fill="#FF0000" points="1153.604,805.7363,1163.604,809.7363,1153.604,813.7363,1157.604,809.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1159.604" y1="809.7363" y2="809.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="804.9941">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.4194" x="818.27" y="804.9941">HMAC512 result MEK Seed with Storage Root Key</text><polygon fill="#FF0000" points="414.4185,835.0469,404.4185,839.0469,414.4185,843.0469,410.4185,839.0469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="408.4185" x2="760.9072" y1="839.0469" y2="839.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="834.3047">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="459.7813" y="834.3047">done</text><polygon fill="#FF0000" points="749.9072,908.9785,759.9072,912.9785,749.9072,916.9785,753.9072,912.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="755.9072" y1="912.9785" y2="912.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="892.9258">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.5454" x="449.7813" y="877.6152">HMAC512(Key : Slox X,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.4692" x="515.5938" y="892.9258">Data String: "DEK" || dek,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="515.5938" y="908.2363">Destination : Slot Y)</text><polygon fill="#FF0000" points="1153.604,938.2891,1163.604,942.2891,1153.604,946.2891,1157.604,942.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1159.604" y1="942.2891" y2="942.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="937.5469">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.125" x="818.27" y="937.5469">Get MEK Seed</text><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="813.9072" y1="971.5996" y2="971.5996"/><line style="stroke:#FF0000;stroke-width:1;" x1="813.9072" x2="813.9072" y1="971.5996" y2="984.5996"/><line style="stroke:#FF0000;stroke-width:1;" x1="772.9072" x2="813.9072" y1="984.5996" y2="984.5996"/><polygon fill="#FF0000" points="782.9072,980.5996,772.9072,984.5996,782.9072,988.5996,778.9072,984.5996" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="966.8574">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.7617" x="818.27" y="966.8574">HMAC512 Data Key String with Key</text><polygon fill="#FF0000" points="1256.1113,1009.9102,1266.1113,1013.9102,1256.1113,1017.9102,1260.1113,1013.9102" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1262.1113" y1="1013.9102" y2="1013.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="1009.168">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.2085" x="818.27" y="1009.168">HMAC512 result MEK</text><polygon fill="#FF0000" points="414.4185,1039.2207,404.4185,1043.2207,414.4185,1047.2207,410.4185,1043.2207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="408.4185" x2="760.9072" y1="1043.2207" y2="1043.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="1038.4785">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="459.7813" y="1038.4785">done</text><polygon fill="#FF0000" points="1361.1504,1068.5313,1371.1504,1072.5313,1361.1504,1076.5313,1365.1504,1072.5313" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1072.5313" y2="1072.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1067.7891">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1067.7891">Read Control Reg</text><path d="M363.4185,1084.5313 L425.5571,1084.5313 L425.5571,1091.8418 L415.5571,1101.8418 L363.4185,1101.8418 L363.4185,1084.5313 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="202.8633" style="stroke:#000000;stroke-width:1.5;" width="1055.7319" x="363.4185" y="1084.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="378.4185" y="1098.0996">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="225.1777" x="440.5571" y="1097.166">[(DN == 1b || ERR == 1b || EXE == 1b)]</text><polygon fill="#FF0000" points="1361.1504,1129.1523,1371.1504,1133.1523,1361.1504,1137.1523,1365.1504,1133.1523" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1133.1523" y2="1133.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1128.4102">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.9438" x="449.7813" y="1128.4102">Write Control Reg (DN = 1b)</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="1162.4629" y2="1162.4629"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="1162.4629" y2="1175.4629"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="1175.4629" y2="1175.4629"/><polygon fill="#FF0000" points="414.4185,1171.4629,404.4185,1175.4629,414.4185,1179.4629,410.4185,1175.4629" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1157.7207">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2529" x="449.7813" y="1157.7207">Start timeout</text><polygon fill="#FF0000" points="1361.1504,1200.7734,1371.1504,1204.7734,1361.1504,1208.7734,1365.1504,1204.7734" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1204.7734" y2="1204.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1200.0313">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1200.0313">Read Control Reg</text><path d="M382.4185,1216.7734 L879.4097,1216.7734 L879.4097,1224.084 L869.4097,1234.084 L382.4185,1234.084 L382.4185,1216.7734 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="56.6211" style="stroke:#000000;stroke-width:1.5;" width="1011.7319" x="382.4185" y="1216.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="451.9912" x="397.4185" y="1230.3418">loop until (rdy_timeout or (DN == 0b &amp;&amp; ERR == 0b &amp;&amp; EXE == 0b)</text><polygon fill="#FF0000" points="1361.1504,1261.3945,1371.1504,1265.3945,1361.1504,1269.3945,1365.1504,1265.3945" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1265.3945" y2="1265.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1260.6523">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1260.6523">Read Control Reg</text><path d="M382.4185,1305.3945 L508.8652,1305.3945 L508.8652,1312.7051 L498.8652,1322.7051 L382.4185,1322.7051 L382.4185,1305.3945 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="253.7949" style="stroke:#000000;stroke-width:1.5;" width="1011.7319" x="382.4185" y="1305.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.4468" x="397.4185" y="1318.9629">in any order</text><line style="stroke:#008000;stroke-width:1;" x1="663.0498" x2="653.0498" y1="1354.0156" y2="1350.0156"/><line style="stroke:#008000;stroke-width:1;" x1="663.0498" x2="653.0498" y1="1354.0156" y2="1358.0156"/><line style="stroke:#008000;stroke-width:1;" x1="403.4185" x2="664.0498" y1="1354.0156" y2="1354.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1349.2734">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.6479" x="449.7813" y="1349.2734">MEK Write (Slot: Y)</text><polygon fill="#FF0000" points="1256.1113,1379.3262,1266.1113,1383.3262,1256.1113,1387.3262,1260.1113,1383.3262" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="675.0498" x2="1262.1113" y1="1383.3262" y2="1383.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="682.0498" y="1378.584">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.6675" x="721.4126" y="1378.584">Read MEK</text><polygon fill="#FF0000" points="1361.1504,1408.6367,1371.1504,1412.6367,1361.1504,1416.6367,1365.1504,1412.6367" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="675.0498" x2="1367.1504" y1="1412.6367" y2="1412.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="682.0498" y="1407.8945">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.1465" x="721.4126" y="1407.8945">Write MEK</text><path d="M983.0469,1425.6367 L983.0469,1465.6367 L1373.0469,1465.6367 L1373.0469,1435.6367 L1363.0469,1425.6367 L983.0469,1425.6367 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1363.0469,1425.6367 L1363.0469,1435.6367 L1373.0469,1435.6367 L1363.0469,1425.6367 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="369.1035" x="989.0469" y="1443.2051">If Encryption Engine uses a MEK which is smaller then MEK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.8472" x="989.0469" y="1458.5156">than the Encryption Engine truncates the MEK</text><line style="stroke:#008000;stroke-width:1;" x1="404.4185" x2="414.4185" y1="1492.5684" y2="1488.5684"/><line style="stroke:#008000;stroke-width:1;" x1="404.4185" x2="414.4185" y1="1492.5684" y2="1496.5684"/><line style="stroke:#008000;stroke-width:1;" x1="403.4185" x2="664.0498" y1="1492.5684" y2="1492.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="1487.8262">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="459.7813" y="1487.8262">complete</text><polygon fill="#FF0000" points="1361.1504,1517.8789,1371.1504,1521.8789,1361.1504,1525.8789,1365.1504,1521.8789" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1521.8789" y2="1521.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1517.1367">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.4263" x="449.7813" y="1517.1367">Write Aux</text><polygon fill="#FF0000" points="1361.1504,1547.1895,1371.1504,1551.1895,1361.1504,1555.1895,1365.1504,1551.1895" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1551.1895" y2="1551.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1546.4473">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.3008" x="449.7813" y="1546.4473">Write Metadata</text><polygon fill="#FF0000" points="1361.1504,1590.5,1371.1504,1594.5,1361.1504,1598.5,1365.1504,1594.5" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1594.5" y2="1594.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1589.7578">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.2231" x="449.7813" y="1589.7578">Write Control Reg (CMD = Load_MEK, DN = 0, EXE = 1)</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="1623.8105" y2="1623.8105"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="1623.8105" y2="1636.8105"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="1636.8105" y2="1636.8105"/><polygon fill="#FF0000" points="414.4185,1632.8105,404.4185,1636.8105,414.4185,1640.8105,410.4185,1636.8105" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1619.0684">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2529" x="449.7813" y="1619.0684">Start timeout</text><polygon fill="#FF0000" points="1361.1504,1662.1211,1371.1504,1666.1211,1361.1504,1670.1211,1365.1504,1666.1211" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1666.1211" y2="1666.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1661.3789">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1661.3789">Read Control Reg</text><path d="M382.4185,1678.1211 L671.5176,1678.1211 L671.5176,1685.4316 L661.5176,1695.4316 L382.4185,1695.4316 L382.4185,1678.1211 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="131.8633" style="stroke:#000000;stroke-width:1.5;" width="1191.166" x="382.4185" y="1678.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="244.0991" x="397.4185" y="1691.6895">loop until (cmd_timeout or DN = 1b)</text><polygon fill="#FF0000" points="1394.1504,1768.6738,1384.1504,1772.6738,1394.1504,1776.6738,1390.1504,1772.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1388.1504" x2="1556.5845" y1="1772.6738" y2="1772.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1400.1504" y="1744.9658">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0713" x="1439.5132" y="1722">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.645" x="1439.5132" y="1737.3105">(DN = 1b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.5625" x="1443.6265" y="1752.6211">ERR = 0b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.4199" x="1443.6265" y="1767.9316">EXE = 0b)</text><polygon fill="#FF0000" points="1361.1504,1797.9844,1371.1504,1801.9844,1361.1504,1805.9844,1365.1504,1801.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1801.9844" y2="1801.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1797.2422">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1797.2422">Read Control Reg</text><polygon fill="#FF0000" points="1366.1504,1841.2949,1376.1504,1845.2949,1366.1504,1849.2949,1370.1504,1845.2949" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1372.1504" y1="1845.2949" y2="1845.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1840.5527">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.9438" x="449.7813" y="1840.5527">Write Control Reg (DN = 1b)</text><path d="M1383.1504,1828.9844 L1383.1504,1853.9844 L1837.1504,1853.9844 L1837.1504,1838.9844 L1827.1504,1828.9844 L1383.1504,1828.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1827.1504,1828.9844 L1827.1504,1838.9844 L1837.1504,1838.9844 L1827.1504,1828.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="433.291" x="1389.1504" y="1846.5527">Reset the SFR interface for next operation - not waiting for response</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="1926.5371" y2="1926.5371"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="1926.5371" y2="1939.5371"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="1939.5371" y2="1939.5371"/><polygon fill="#FF0000" points="414.4185,1935.5371,404.4185,1939.5371,414.4185,1943.5371,410.4185,1939.5371" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1898.8291">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.1099" x="449.7813" y="1875.8633">Mark that the sequence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.0166" x="449.7813" y="1891.1738">of an Initialize MEK then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.2686" x="449.7813" y="1906.4844">zero or more MIX_PMEK sequence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.7485" x="453.8945" y="1921.7949">is completed</text><polygon fill="#FF0000" points="749.9072,1994.1582,759.9072,1998.1582,749.9072,2002.1582,753.9072,1998.1582" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="755.9072" y1="1998.1582" y2="1998.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1985.7607">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.001" x="449.7813" y="1978.1055">Purge_key(Key: Slot X,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.9087" x="515.5938" y="1993.416">Key : Slot Y)</text><polygon fill="#FF0000" points="1153.604,2023.4688,1163.604,2027.4688,1153.604,2031.4688,1157.604,2027.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1159.604" y1="2027.4688" y2="2027.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="2022.7266">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="818.27" y="2022.7266">Purge</text><polygon fill="#FF0000" points="1256.1113,2023.4688,1266.1113,2027.4688,1256.1113,2031.4688,1260.1113,2027.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1262.1113" y1="2027.4688" y2="2027.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="2022.7266">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="818.27" y="2022.7266">&#160;</text><polygon fill="#FF0000" points="414.4185,2052.7793,404.4185,2056.7793,414.4185,2060.7793,410.4185,2056.7793" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="408.4185" x2="760.9072" y1="2056.7793" y2="2056.7793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="2052.0371">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="459.7813" y="2052.0371">done</text><line style="stroke:#008000;stroke-width:1;" x1="195.0127" x2="205.0127" y1="2132.0215" y2="2128.0215"/><line style="stroke:#008000;stroke-width:1;" x1="195.0127" x2="205.0127" y1="2132.0215" y2="2136.0215"/><line style="stroke:#008000;stroke-width:1;" x1="194.0127" x2="392.4185" y1="2132.0215" y2="2132.0215"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="211.0127" y="2104.3135">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="250.3755" y="2081.3477">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.2939" x="250.3755" y="2096.6582">response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.043" x="250.3755" y="2111.9688">(Status = Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.0503" x="312.0747" y="2127.2793">Error field)</text><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2132.0215" y2="2128.0215"/><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2132.0215" y2="2136.0215"/><line style="stroke:#008000;stroke-width:1;" x1="61.6826" x2="193.0127" y1="2132.0215" y2="2132.0215"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="78.6826" y="2119.624">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="118.0454" y="2111.9688">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="118.0454" y="2127.2793">complete</text><path d="M199.0127,2145.0215 L199.0127,2204.0215 L693.0127,2204.0215 L693.0127,2155.0215 L683.0127,2145.0215 L199.0127,2145.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M683.0127,2145.0215 L683.0127,2155.0215 L693.0127,2155.0215 L683.0127,2145.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="205.0127" y="2164.5898">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="209.126" y="2164.5898">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="282.9619" y="2164.5898">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="287.0752" y="2164.5898">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="332.1499" y="2164.5898">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="336.2632" y="2164.5898">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="209.126" y="2179.9004">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="287.0752" y="2179.9004">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="336.2632" y="2179.9004">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="209.126" y="2195.2109">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="287.0752" y="2195.2109">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="336.2632" y="2195.2109">Indicates if the command is FIPS approved or an error</text><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2152.0215" y2="2152.0215"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2167.332" y2="2167.332"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2182.6426" y2="2182.6426"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2197.9531" y2="2197.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="205.0127" y1="2152.0215" y2="2197.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="282.9619" x2="282.9619" y1="2152.0215" y2="2197.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="332.1499" x2="332.1499" y1="2152.0215" y2="2197.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="678.8018" x2="678.8018" y1="2152.0215" y2="2197.9531"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="117.876" x="895.7827" y="2304.0859">Filename: load_mek.uml</text><!--SRC=[dLVhRzis4F-kl-9YP8Mpn5cQOi3WDGKyEzcCF16dRRPbC6Y9iWbBeaPISLpqZzyTgQSjzp5_I2JntlUx1_T4uaTPm47wwJII_dAQ6H7fO_piUNlxUY5NKnP5S0O_69NnxW5-5I5qovC33_2NKwQA-p89QjIrGoDCnDkFM2hQ3s8zdwPCQP7Csma2cTHbxl58ynqMXGpFTfZKSfRRr7AoOLGBHM5LSRJ7aq24ZT1PrOxfmLhHkP8iWElpoquRUUw7OqYauS1y9RMsx_HxEtjtvsY44JBH_RS_pTwLfp_2mu93AAD8hiXipV_DUE9pYDaQfBB_K2eis3D1mS-KuW6aIaZLXx-uafP8AWxNuyVf7Le9lenZbWJQgvjmWvPjg2wKboe3mUQAnS2qpcAkmIoOmJySBZ_0IY3Mo116bW9BG2HfPkX8H_ZPI3pH4cOSCeqMCaqqig8uXY6BX54CBZw2qA2uJZ4QOXQH- -HemkOKWTL2-0la6bes5ACAaOWM7uMoWAK6C0DcWNAiiIb5bgIIXRx46FdcUCDHF2qznUTG-bOgykdCzxdMOHO1V-5-PeN946JA5RCvWzaw3yGnJ6maEBAYpu7irzJalnwy3ML2XaHIdM6-teruA11u94BnL2g3t5mfTBl2XVLlWNyYZ88LYc2pY2fXvscrF3o4_T_UNroStqy7muVnXy73-FR6qw4wFFIyS0NxJAyJ7-8P4lRXwdOmcY8eciqX5JMuAZ5V6AGl_VXCUBaGF0ggrudunDsJTSLQ39zhBFvYYNaeNxCtf_dJbJ1KHEG1QxB4t60g3IjOVldxzEGVUhek3WWNX6WCT4GrA19yeY06Ic0v-6gTuWUUp2cuNN7CZ-5cCXx18LpzDW35aZa_QAXasSkqL6jLlZcrAWVPYuW4K-lAAb9EkiY0hhG8Oz6lOBMKoC3I2pPqg62DFIJcXFr691xoZmAvj1MFM2GNI4xkXA4AmW8cdB1WRQaOecrLL7Kpw77mhQeATbJG31jza74QSOH2NNR0bnMYww4Q8hGLzYkkUZfBqqWWbZisOZLtbdpTUKfSwLrZ2yEsm60ulHlVz09EoGkm67t5hOctAOl0EefXxL6ydrcKSJgwl1lVvcPjLKCyAy3kXokBzg5piW7ssanmeFUfIF8QGPxVkIc2Ou_ZMQzd7_OrZy9k1yaxHz0PONnKJ07BYJlrcMQP2hkQZE-rxPyJQfAFDXKs0DJfQAJWsFPOP61Yf69p3lSIwIxv6ZkHqCOrXVCghkUKDEmIkW4Jr-b930KlRuEsIh7bVi9OszeumizW9mIA86HZ8MFWySD1cVSgECldmyC-_74z6Fxy-hIB5lMT3uCZbzVwZ-mT8GBwq27n4soEdHQo4TS6LP8ZkR37IlFoELUCFSvbPJCaswJBvz92DuK6EAVCmjgoJHtpfQxeSVvaUS38NiUuKoNnjdVUWg86ELeo3XfZeRG1uzlh8Ug8f68jSLJHvo1qnnPNUGrutbVo13QsB_3ObW4gqubHY3xCrGZn1vzjgNyvMv2dwq_drKP4ALT56BsT-R6goJodtiMx2779ONYShjkIPCdiwUuqx4p1xl0tGr-6lHoupLZZb4NcUooveWlYoxoglkxe1ixEuFMCedf-VrzxUJntBssbviH-L09RS4sk4sTvMfZe2TDYcCBboxNxdQAtB2u8vqfcASvMcKAMuFK2klNfXRqgz-Xa1gzU5HxbBywZaxfrtwMRvmstnBGp1diJIsZrnJRPTCZr-Y1cjjSJubp8keJDVW5E-Y5D7K-55GMCcYJrwDSfx78KyT0GHSF5SRZLaksAYjtQckKsMDetOqPpaffjqf1jmOoxdct3sxBmpfJupDWLl6bKEGGRVh06k8jnxdq5QhZpV8MYMCHszPwTm1rUZn2vT6-YvVC8B91FZXneuFN1fg0sC7z7xMt3kBuP8OpBGYhZo2knDcXRJZmbHVbHRxJGHx3RP-l4oHTAkHNp1Twjnc-EPCFoQbyd7PgxszdaufusOwv2vhkxLC9VJ6r7xTbzOCLm7y36ImJvvIk7I7DXkMPgMLtzYYlJKu8N8WJikDmgt6QEo7vAFhNUGojMgeK2bRGuMIXjZh2xJCtv51V7shBnk6FPgEPHOnR1tXxaWhnN6qC5pxpM0T4-7Ah1O8T2CH3y-WshsZYVaYAY21k4iSaqfgs1fWqlpktjBwHRrW7QMksopLNsAIchsPht_-zntt-D-xPRN2XIFTNEvJh764bT3xCtzN9l9YnSZEycmD9KIRe8qEQVvDVXzbN_Fm00]--></g></svg>