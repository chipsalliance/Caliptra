<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2328px" preserveAspectRatio="none" style="width:1633px;height:2328px;background:#FFFFFF;" version="1.1" viewBox="0 0 1633 2328" width="1633px" zoomAndPan="magnify"><title>Load MEK</title><defs/><g><rect fill="#DDDDDD" height="2248.1523" style="stroke:#181818;stroke-width:0.5;" width="1171.2456" x="154.2368" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="713.4629" y="68.834">Caliptra</text><rect fill="#DDDDDD" height="2248.1523" style="stroke:#181818;stroke-width:0.5;" width="256.395" x="1337.4824" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.291" x="1405.0344" y="68.834">Encryption Engine</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1579.5591" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="70.2598" x="789.6624" y="41.3125">Load MEK</text><g><title>Storage</title><rect fill="transparent" height="2093.9121" width="8" x="53.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="56.6826" x2="56.6826" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="51.6826" y="2146.0215"/></g><g><title>Mail Box</title><rect fill="transparent" height="2093.9121" width="8" x="190.5127" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="194.0127" x2="194.0127" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#FFFFFF" height="205.1055" style="stroke:#181818;stroke-width:1;" width="10" x="189.0127" y="281.2148"/></g><g><title>FW</title><rect fill="transparent" height="2093.9121" width="8" x="394.9185" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="398.4185" x2="398.4185" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#FFFFFF" height="1689.0117" style="stroke:#181818;stroke-width:1;" width="10" x="393.4185" y="457.0098"/></g><g><title>DMA Engine</title><rect fill="transparent" height="2093.9121" width="8" x="666.5498" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="670.0498" x2="670.0498" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#FFFFFF" height="138.5527" style="stroke:#181818;stroke-width:1;" width="10" x="665.0498" y="1338.7051"/></g><g><title>Key Vault</title><rect fill="transparent" height="2093.9121" width="8" x="763.4072" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="766.9072" x2="766.9072" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="761.9072" y="693.4941"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="761.9072" y="897.668"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="761.9072" y="2012.1582"/></g><g><title>Key Vault</title><rect fill="transparent" height="2093.9121" width="8" x="1043.5317" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1047.0317" x2="1047.0317" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#ADD8E6" height="1974.0488" style="stroke:#181818;stroke-width:1;" width="10" x="1042.0317" y="259.9043"/></g><g><title>Key Vault</title><rect fill="transparent" height="2093.9121" width="8" x="1167.104" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1170.604" x2="1170.604" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#ADD8E6" height="1247.043" style="stroke:#181818;stroke-width:1;" width="10" x="1165.604" y="794.4258"/></g><line style="stroke:#181818;stroke-width:2;" x1="1161.604" x2="1179.604" y1="2032.4688" y2="2050.4688"/><line style="stroke:#181818;stroke-width:2;" x1="1161.604" x2="1179.604" y1="2050.4688" y2="2032.4688"/><g><title>Key Vault</title><rect fill="transparent" height="2093.9121" width="8" x="1269.6113" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1273.1113" x2="1273.1113" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#ADD8E6" height="1042.8691" style="stroke:#181818;stroke-width:1;" width="10" x="1268.1113" y="998.5996"/></g><g><title>SFR</title><rect fill="transparent" height="2093.9121" width="8" x="1374.6504" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1378.1504" x2="1378.1504" y1="140.041" y2="2233.9531"/></g><g><title/><rect fill="#FFFFFF" height="1553.7695" style="stroke:#181818;stroke-width:1;" width="10" x="1373.1504" y="259.9043"/></g><g><title>Control</title><rect fill="transparent" height="2093.9121" width="8" x="1554.0845" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1557.5845" x2="1557.5845" y1="140.041" y2="2233.9531"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="158.2368" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="165.2368" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="381.6772" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="388.6772" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.1748" x="621.9624" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.1748" x="628.9624" y="129.0879">DMA Engine</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="728.1372" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="735.1372" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="977.5957" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1015.2617" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1027.2759" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="984.5957" y="129.0879">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.2725" x="1126.4678" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1138.834" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.6162" x="1151.2959" y="112.5996">Slot X</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.2725" x="1133.4678" y="129.0879">(MEK Seed)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1224.7402" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1241.3413" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1253.8237" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1231.7402" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="1341.4824" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="1366.2012" y="112.5996">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="1348.4824" y="129.0879">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="1525.2915" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="1532.2915" y="129.0879">Control</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="2254.4883">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="2270.9766">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="2287.4648">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="158.2368" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="165.2368" y="2254.4883">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="381.6772" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="388.6772" y="2254.4883">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.1748" x="621.9624" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.1748" x="628.9624" y="2254.4883">DMA Engine</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="728.1372" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="735.1372" y="2254.4883">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="977.5957" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1015.2617" y="2254.4883">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1027.2759" y="2270.9766">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="984.5957" y="2287.4648">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.2725" x="1126.4678" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1138.834" y="2254.4883">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.6162" x="1151.2959" y="2270.9766">Slot X</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.2725" x="1133.4678" y="2287.4648">(MEK Seed)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1224.7402" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1241.3413" y="2254.4883">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1253.8237" y="2270.9766">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1231.7402" y="2287.4648">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="1341.4824" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="1366.2012" y="2254.4883">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="1348.4824" y="2270.9766">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="1525.2915" y="2233.9531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="1532.2915" y="2254.4883">Control</text><path d="M29.1948,153.041 L29.1948,254.041 L1584.1948,254.041 L1584.1948,163.041 L1574.1948,153.041 L29.1948,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1574.1948,153.041 L1574.1948,163.041 L1584.1948,163.041 L1574.1948,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="95.3047" y="170.6094">Preconditions:</text><ellipse cx="100.8047" cy="181.1621" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="611.292" x="107.3047" y="185.9199">The following sequence may or may not have occurred prior: Zero or more MIX_PMEK commands</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="95.3047" y="201.2305">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.7422" x="95.3047" y="216.541">Notes:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1406.4312" x="103.5313" y="231.8516">* The sequence diagram assumes that the KV will not allow an input KV slot to also be used as an out KV slot. Caliptra FW is responsible for managing which KV slots are used and can adapt if this assumption is not correct.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="480.8032" x="103.5313" y="247.1621">* This sequence is focused on successful execution of operations by the KV.</text><line style="stroke:#008000;stroke-width:1;" x1="187.0127" x2="177.0127" y1="281.2148" y2="277.2148"/><line style="stroke:#008000;stroke-width:1;" x1="187.0127" x2="177.0127" y1="281.2148" y2="285.2148"/><line style="stroke:#008000;stroke-width:1;" x1="56.6826" x2="188.0127" y1="281.2148" y2="281.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="63.6826" y="276.4727">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.9673" x="103.0454" y="276.4727">LOAD_MEK</text><path d="M204.0127,294.2148 L204.0127,430.2148 L869.0127,430.2148 L869.0127,304.2148 L859.0127,294.2148 L204.0127,294.2148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M859.0127,294.2148 L859.0127,304.2148 L869.0127,304.2148 L859.0127,294.2148 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="210.0127" y="313.7832">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="214.126" y="313.7832">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="306.7827" y="313.7832">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="310.896" y="313.7832">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="360.3062" y="313.7832">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="364.4194" y="313.7832">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="214.126" y="329.0938">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="310.896" y="329.0938">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="364.4194" y="329.0938">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.8237" x="214.126" y="344.4043">metadata</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="310.896" y="344.4043">u8[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="485.9956" x="364.4194" y="344.4043">Metadata for MEK to load into the drive crypto engine (i.e. NSID + LBA range)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.5435" x="214.126" y="359.7148">aux_metadata</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="310.896" y="359.7148">u8[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391.9932" x="364.4194" y="359.7148">Auxiliary metadata for the MEK (optional; i.e. operation mode)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.7085" x="214.126" y="375.0254">rdy_timeout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="310.896" y="375.0254">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="469.6758" x="364.4194" y="375.0254">Timeout in ms for encryption engine to become ready for a new command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.3926" x="214.126" y="390.3359">cmd_timeout</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="310.896" y="390.3359">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="366.3613" x="364.4194" y="390.3359">Timeout in ms for command to crypto engine to complete</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.0229" x="214.126" y="405.6465">dek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="41.1836" x="310.896" y="405.6465">u8[32]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="262.8374" x="364.4194" y="405.6465">Controller-supplied "data encryption key"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.5117" x="376.7593" y="420.957">* May be a C_PIN-derived secret in Opal or a per-MEK value in KPIO</text><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="301.2148" y2="301.2148"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="316.5254" y2="316.5254"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="331.8359" y2="331.8359"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="347.1465" y2="347.1465"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="362.457" y2="362.457"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="377.7676" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="393.0781" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="854.5283" y1="423.6992" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="210.0127" x2="210.0127" y1="301.2148" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="306.7827" x2="306.7827" y1="301.2148" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="360.3062" x2="360.3062" y1="301.2148" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="854.5283" x2="854.5283" y1="301.2148" y2="423.6992"/><line style="stroke:#008000;stroke-width:1;" x1="391.4185" x2="381.4185" y1="457.0098" y2="453.0098"/><line style="stroke:#008000;stroke-width:1;" x1="391.4185" x2="381.4185" y1="457.0098" y2="461.0098"/><line style="stroke:#008000;stroke-width:1;" x1="199.0127" x2="392.4185" y1="457.0098" y2="457.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="206.0127" y="452.2676">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="245.3755" y="452.2676">Command</text><polygon fill="#FF0000" points="210.0127,482.3203,200.0127,486.3203,210.0127,490.3203,206.0127,486.3203" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="204.0127" x2="392.4185" y1="486.3203" y2="486.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="216.0127" y="481.5781">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="255.3755" y="481.5781">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="515.6309" y2="515.6309"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="515.6309" y2="528.6309"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="528.6309" y2="528.6309"/><polygon fill="#FF0000" points="414.4185,524.6309,404.4185,528.6309,414.4185,532.6309,410.4185,528.6309" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="510.8887">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="449.7813" y="510.8887">Determine command</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="557.9414" y2="557.9414"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="557.9414" y2="570.9414"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="570.9414" y2="570.9414"/><polygon fill="#FF0000" points="414.4185,566.9414,404.4185,570.9414,414.4185,574.9414,410.4185,570.9414" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="553.1992">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.2642" x="449.7813" y="553.1992">Use KV Slot X for deriving MEK</text><path d="M8,582.9414 L70.1387,582.9414 L70.1387,590.252 L60.1387,600.252 L8,600.252 L8,582.9414 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="1378.5957" style="stroke:#000000;stroke-width:1.5;" width="1590.5845" x="8" y="582.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="596.5098">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="372.6948" x="85.1387" y="595.5762">[Storage Root Key exists and Encryption Engin has become ready]</text><path d="M382.4185,614.252 L444.5571,614.252 L444.5571,621.5625 L434.5571,631.5625 L382.4185,631.5625 L382.4185,614.252 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="217.4844" style="stroke:#000000;stroke-width:1.5;" width="809.1855" x="382.4185" y="614.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="397.4185" y="627.8203">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="304.0415" x="459.5571" y="626.8867">[MEK is not initialized (i.e., no PMEK in the final MEK)]</text><polygon fill="#FF0000" points="749.9072,689.4941,759.9072,693.4941,749.9072,697.4941,753.9072,693.4941" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="755.9072" y1="693.4941" y2="693.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="673.4414">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.1533" x="449.7813" y="658.1309">HMAC512(Key: Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.1567" x="515.5938" y="673.4414">Key Data: "MEK Seed",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4595" x="515.5938" y="688.752">Destination: Slot X)</text><polygon fill="#FF0000" points="1030.0317,718.8047,1040.0317,722.8047,1030.0317,726.8047,1034.0317,722.8047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1036.0317" y1="722.8047" y2="722.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="718.0625">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1104" x="818.27" y="718.0625">Get Storage Root Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="813.9072" y1="752.1152" y2="752.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="813.9072" x2="813.9072" y1="752.1152" y2="765.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="772.9072" x2="813.9072" y1="765.1152" y2="765.1152"/><polygon fill="#FF0000" points="782.9072,761.1152,772.9072,765.1152,782.9072,769.1152,778.9072,765.1152" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="747.373">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.6924" x="818.27" y="747.373">HMAC512 slot A with Data</text><polygon fill="#FF0000" points="1153.604,790.4258,1163.604,794.4258,1153.604,798.4258,1157.604,794.4258" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1159.604" y1="794.4258" y2="794.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="789.6836">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="310.4194" x="818.27" y="789.6836">HMAC512 result MEK Seed with Storage Root Key</text><polygon fill="#FF0000" points="414.4185,819.7363,404.4185,823.7363,414.4185,827.7363,410.4185,823.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="408.4185" x2="760.9072" y1="823.7363" y2="823.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="818.9941">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="459.7813" y="818.9941">done</text><polygon fill="#FF0000" points="749.9072,893.668,759.9072,897.668,749.9072,901.668,753.9072,897.668" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="755.9072" y1="897.668" y2="897.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="877.6152">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.5454" x="449.7813" y="862.3047">HMAC512(Key : Slox X,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.4692" x="515.5938" y="877.6152">Data String: "DEK" || dek,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="515.5938" y="892.9258">Destination : Slot Y)</text><polygon fill="#FF0000" points="1153.604,922.9785,1163.604,926.9785,1153.604,930.9785,1157.604,926.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1159.604" y1="926.9785" y2="926.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="922.2363">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.125" x="818.27" y="922.2363">Get MEK Seed</text><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="813.9072" y1="956.2891" y2="956.2891"/><line style="stroke:#FF0000;stroke-width:1;" x1="813.9072" x2="813.9072" y1="956.2891" y2="969.2891"/><line style="stroke:#FF0000;stroke-width:1;" x1="772.9072" x2="813.9072" y1="969.2891" y2="969.2891"/><polygon fill="#FF0000" points="782.9072,965.2891,772.9072,969.2891,782.9072,973.2891,778.9072,969.2891" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="951.5469">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.7617" x="818.27" y="951.5469">HMAC512 Data Key String with Key</text><polygon fill="#FF0000" points="1256.1113,994.5996,1266.1113,998.5996,1256.1113,1002.5996,1260.1113,998.5996" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1262.1113" y1="998.5996" y2="998.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="993.8574">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.2085" x="818.27" y="993.8574">HMAC512 result MEK</text><polygon fill="#FF0000" points="414.4185,1023.9102,404.4185,1027.9102,414.4185,1031.9102,410.4185,1027.9102" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="408.4185" x2="760.9072" y1="1027.9102" y2="1027.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="1023.168">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="459.7813" y="1023.168">done</text><polygon fill="#FF0000" points="1361.1504,1053.2207,1371.1504,1057.2207,1361.1504,1061.2207,1365.1504,1057.2207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1057.2207" y2="1057.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1052.4785">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1052.4785">Read Control Reg</text><path d="M363.4185,1069.2207 L425.5571,1069.2207 L425.5571,1076.5313 L415.5571,1086.5313 L363.4185,1086.5313 L363.4185,1069.2207 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="202.8633" style="stroke:#000000;stroke-width:1.5;" width="1055.7319" x="363.4185" y="1069.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="378.4185" y="1082.7891">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="225.1777" x="440.5571" y="1081.8555">[(DN == 1b || ERR == 1b || EXE == 1b)]</text><polygon fill="#FF0000" points="1361.1504,1113.8418,1371.1504,1117.8418,1361.1504,1121.8418,1365.1504,1117.8418" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1117.8418" y2="1117.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1113.0996">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.9438" x="449.7813" y="1113.0996">Write Control Reg (DN = 1b)</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="1147.1523" y2="1147.1523"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="1147.1523" y2="1160.1523"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="1160.1523" y2="1160.1523"/><polygon fill="#FF0000" points="414.4185,1156.1523,404.4185,1160.1523,414.4185,1164.1523,410.4185,1160.1523" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1142.4102">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2529" x="449.7813" y="1142.4102">Start timeout</text><polygon fill="#FF0000" points="1361.1504,1185.4629,1371.1504,1189.4629,1361.1504,1193.4629,1365.1504,1189.4629" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1189.4629" y2="1189.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1184.7207">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1184.7207">Read Control Reg</text><path d="M382.4185,1201.4629 L879.4097,1201.4629 L879.4097,1208.7734 L869.4097,1218.7734 L382.4185,1218.7734 L382.4185,1201.4629 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="56.6211" style="stroke:#000000;stroke-width:1.5;" width="1011.7319" x="382.4185" y="1201.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="451.9912" x="397.4185" y="1215.0313">loop until (rdy_timeout or (DN == 0b &amp;&amp; ERR == 0b &amp;&amp; EXE == 0b)</text><polygon fill="#FF0000" points="1361.1504,1246.084,1371.1504,1250.084,1361.1504,1254.084,1365.1504,1250.084" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1250.084" y2="1250.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1245.3418">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1245.3418">Read Control Reg</text><path d="M382.4185,1290.084 L508.8652,1290.084 L508.8652,1297.3945 L498.8652,1307.3945 L382.4185,1307.3945 L382.4185,1290.084 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="253.7949" style="stroke:#000000;stroke-width:1.5;" width="1011.7319" x="382.4185" y="1290.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.4468" x="397.4185" y="1303.6523">in any order</text><line style="stroke:#008000;stroke-width:1;" x1="663.0498" x2="653.0498" y1="1338.7051" y2="1334.7051"/><line style="stroke:#008000;stroke-width:1;" x1="663.0498" x2="653.0498" y1="1338.7051" y2="1342.7051"/><line style="stroke:#008000;stroke-width:1;" x1="403.4185" x2="664.0498" y1="1338.7051" y2="1338.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1333.9629">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.6479" x="449.7813" y="1333.9629">MEK Write (Slot: Y)</text><polygon fill="#FF0000" points="1256.1113,1364.0156,1266.1113,1368.0156,1256.1113,1372.0156,1260.1113,1368.0156" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="675.0498" x2="1262.1113" y1="1368.0156" y2="1368.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="682.0498" y="1363.2734">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.6675" x="721.4126" y="1363.2734">Read MEK</text><polygon fill="#FF0000" points="1361.1504,1393.3262,1371.1504,1397.3262,1361.1504,1401.3262,1365.1504,1397.3262" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="675.0498" x2="1367.1504" y1="1397.3262" y2="1397.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="682.0498" y="1392.584">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.1465" x="721.4126" y="1392.584">Write MEK</text><path d="M983.0469,1410.3262 L983.0469,1450.3262 L1373.0469,1450.3262 L1373.0469,1420.3262 L1363.0469,1410.3262 L983.0469,1410.3262 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1363.0469,1410.3262 L1363.0469,1420.3262 L1373.0469,1420.3262 L1363.0469,1410.3262 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="369.1035" x="989.0469" y="1427.8945">If Encryption Engine uses a MEK which is smaller then MEK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287.8472" x="989.0469" y="1443.2051">than the Encryption Engine truncates the MEK</text><line style="stroke:#008000;stroke-width:1;" x1="404.4185" x2="414.4185" y1="1477.2578" y2="1473.2578"/><line style="stroke:#008000;stroke-width:1;" x1="404.4185" x2="414.4185" y1="1477.2578" y2="1481.2578"/><line style="stroke:#008000;stroke-width:1;" x1="403.4185" x2="664.0498" y1="1477.2578" y2="1477.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="1472.5156">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="459.7813" y="1472.5156">complete</text><polygon fill="#FF0000" points="1361.1504,1502.5684,1371.1504,1506.5684,1361.1504,1510.5684,1365.1504,1506.5684" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1506.5684" y2="1506.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1501.8262">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.4263" x="449.7813" y="1501.8262">Write Aux</text><polygon fill="#FF0000" points="1361.1504,1531.8789,1371.1504,1535.8789,1361.1504,1539.8789,1365.1504,1535.8789" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1535.8789" y2="1535.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1531.1367">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.3008" x="449.7813" y="1531.1367">Write Metadata</text><polygon fill="#FF0000" points="1361.1504,1575.1895,1371.1504,1579.1895,1361.1504,1583.1895,1365.1504,1579.1895" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1579.1895" y2="1579.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1574.4473">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="347.2231" x="449.7813" y="1574.4473">Write Control Reg (CMD = Load_MEK, DN = 0, EXE = 1)</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="1608.5" y2="1608.5"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="1608.5" y2="1621.5"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="1621.5" y2="1621.5"/><polygon fill="#FF0000" points="414.4185,1617.5,404.4185,1621.5,414.4185,1625.5,410.4185,1621.5" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1603.7578">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.2529" x="449.7813" y="1603.7578">Start timeout</text><polygon fill="#FF0000" points="1361.1504,1646.8105,1371.1504,1650.8105,1361.1504,1654.8105,1365.1504,1650.8105" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1650.8105" y2="1650.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1646.0684">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1646.0684">Read Control Reg</text><path d="M382.4185,1662.8105 L671.5176,1662.8105 L671.5176,1670.1211 L661.5176,1680.1211 L382.4185,1680.1211 L382.4185,1662.8105 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="131.8633" style="stroke:#000000;stroke-width:1.5;" width="1191.166" x="382.4185" y="1662.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="244.0991" x="397.4185" y="1676.3789">loop until (cmd_timeout or DN = 1b)</text><polygon fill="#FF0000" points="1394.1504,1753.3633,1384.1504,1757.3633,1394.1504,1761.3633,1390.1504,1757.3633" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1388.1504" x2="1556.5845" y1="1757.3633" y2="1757.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1400.1504" y="1729.6553">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0713" x="1439.5132" y="1706.6895">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.645" x="1439.5132" y="1722">(DN = 1b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.5625" x="1443.6265" y="1737.3105">ERR = 0b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.4199" x="1443.6265" y="1752.6211">EXE = 0b)</text><polygon fill="#FF0000" points="1361.1504,1782.6738,1371.1504,1786.6738,1361.1504,1790.6738,1365.1504,1786.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1367.1504" y1="1786.6738" y2="1786.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1781.9316">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5923" x="449.7813" y="1781.9316">Read Control Reg</text><polygon fill="#FF0000" points="1366.1504,1825.9844,1376.1504,1829.9844,1366.1504,1833.9844,1370.1504,1829.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="1372.1504" y1="1829.9844" y2="1829.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1825.2422">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.9438" x="449.7813" y="1825.2422">Write Control Reg (DN = 1b)</text><path d="M918.8594,1842.9844 L918.8594,1867.9844 L1372.8594,1867.9844 L1372.8594,1852.9844 L1362.8594,1842.9844 L918.8594,1842.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1362.8594,1842.9844 L1362.8594,1852.9844 L1372.8594,1852.9844 L1362.8594,1842.9844 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="433.291" x="924.8594" y="1860.5527">Reset the SFR interface for next operation - not waiting for response</text><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="445.4185" y1="1940.5371" y2="1940.5371"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.4185" x2="445.4185" y1="1940.5371" y2="1953.5371"/><line style="stroke:#FF0000;stroke-width:1;" x1="404.4185" x2="445.4185" y1="1953.5371" y2="1953.5371"/><polygon fill="#FF0000" points="414.4185,1949.5371,404.4185,1953.5371,414.4185,1957.5371,410.4185,1953.5371" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1912.8291">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.1099" x="449.7813" y="1889.8633">Mark that the sequence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="153.0166" x="449.7813" y="1905.1738">of an Initialize MEK then</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.2686" x="449.7813" y="1920.4844">zero or more MIX_PMEK sequence</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.7485" x="453.8945" y="1935.7949">is completed</text><polygon fill="#FF0000" points="749.9072,2008.1582,759.9072,2012.1582,749.9072,2016.1582,753.9072,2012.1582" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="403.4185" x2="755.9072" y1="2012.1582" y2="2012.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="410.4185" y="1999.7607">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139.001" x="449.7813" y="1992.1055">Purge_key(Key: Slot X,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.9087" x="515.5938" y="2007.416">Key : Slot Y)</text><polygon fill="#FF0000" points="1153.604,2037.4688,1163.604,2041.4688,1153.604,2045.4688,1157.604,2041.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1159.604" y1="2041.4688" y2="2041.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="2036.7266">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="818.27" y="2036.7266">Purge</text><polygon fill="#FF0000" points="1256.1113,2037.4688,1266.1113,2041.4688,1256.1113,2045.4688,1260.1113,2041.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="771.9072" x2="1262.1113" y1="2041.4688" y2="2041.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="778.9072" y="2036.7266">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="818.27" y="2036.7266">&#160;</text><polygon fill="#FF0000" points="414.4185,2066.7793,404.4185,2070.7793,414.4185,2074.7793,410.4185,2070.7793" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="408.4185" x2="760.9072" y1="2070.7793" y2="2070.7793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="420.4185" y="2066.0371">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="459.7813" y="2066.0371">done</text><line style="stroke:#008000;stroke-width:1;" x1="195.0127" x2="205.0127" y1="2146.0215" y2="2142.0215"/><line style="stroke:#008000;stroke-width:1;" x1="195.0127" x2="205.0127" y1="2146.0215" y2="2150.0215"/><line style="stroke:#008000;stroke-width:1;" x1="194.0127" x2="392.4185" y1="2146.0215" y2="2146.0215"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="211.0127" y="2118.3135">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="250.3755" y="2095.3477">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.2939" x="250.3755" y="2110.6582">response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.043" x="250.3755" y="2125.9688">(Status = Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.0503" x="312.0747" y="2141.2793">Error field)</text><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2146.0215" y2="2142.0215"/><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2146.0215" y2="2150.0215"/><line style="stroke:#008000;stroke-width:1;" x1="61.6826" x2="193.0127" y1="2146.0215" y2="2146.0215"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="78.6826" y="2133.624">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="118.0454" y="2125.9688">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="118.0454" y="2141.2793">complete</text><path d="M199.0127,2159.0215 L199.0127,2218.0215 L693.0127,2218.0215 L693.0127,2169.0215 L683.0127,2159.0215 L199.0127,2159.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M683.0127,2159.0215 L683.0127,2169.0215 L693.0127,2169.0215 L683.0127,2159.0215 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="205.0127" y="2178.5898">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="209.126" y="2178.5898">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="282.9619" y="2178.5898">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="287.0752" y="2178.5898">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="332.1499" y="2178.5898">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="336.2632" y="2178.5898">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="209.126" y="2193.9004">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="287.0752" y="2193.9004">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="336.2632" y="2193.9004">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="209.126" y="2209.2109">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="287.0752" y="2209.2109">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="336.2632" y="2209.2109">Indicates if the command is FIPS approved or an error</text><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2166.0215" y2="2166.0215"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2181.332" y2="2181.332"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2196.6426" y2="2196.6426"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="678.8018" y1="2211.9531" y2="2211.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="205.0127" x2="205.0127" y1="2166.0215" y2="2211.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="282.9619" x2="282.9619" y1="2166.0215" y2="2211.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="332.1499" x2="332.1499" y1="2166.0215" y2="2211.9531"/><line style="stroke:#000000;stroke-width:0.5;" x1="678.8018" x2="678.8018" y1="2166.0215" y2="2211.9531"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="117.876" x="765.8542" y="2318.0859">Filename: load_mek.uml</text><!--SRC=[dLVhRzis4F-kl-9Y58Mzn5cQOi2GjGNSEDcCF16dRRPbC6Y9iWbBf4PISLpqZzyTgQSVVSmV4aaytkDtlpiUzuGCappYeC9iagXmCScjICmXVWw2FH53zuMPg-N42flmNW3ukwT7w5mg5i7LsKKdsECo4d5BFDCyL3Bo6wIo75YebJ7kdNvlfkzklOomGabpykRdwRjgzIUudtE8LPAefP0pCFpVdCkGGyfMeBJxXrfXpfx8yp3NcaUGQQ7q2Vp5jN92IdEu6ZrCRj5B25MQCXcPeEd2DNgsPheqNfcC19jfbW8p9a-v0Jjd5lzmkFW8Iv4apX56dWAJ86IMMreo2Nws2bUCWYc7tA27p92CgYKEuPGb8hEQmVad40OqDnd28QO9nK-HIZOZ29Pp4SxBRQX6bofb124gPH7BB606x1pLE6SpGfQKaeUXGen2UxWMAAvMaU9ph4Ad5VUPF0ovCN6U07_cOUwKgHXKnZLpEOFfgW32QqKQk5nNX0YCNkplmult7yxFp-ucWzFxqSV1_UZcEZ2ntjyFWdW9BvXPoH3IAGgUmENDO3Z1TBN8n3BH898Mixb5-IgGBvJ9Sy6Jg7uTYy_SFmrvBAJZ67nfR0dd2qIeUirV7nTFby8IlIa2rjwISeiWMrPk-VNluwD_wEcgNA244TSmxGbLXv3uH0X5MY1HGxtAy0ENc50ENN783-5wF1h2Fbo-7u1cSiPxBPCiVvvKPft9ryVEv21_5ebWUbLxHSR95ZdGLIxtBFaDd9KgPrWKqPeD7QsmkbDEh6mXSLzy5BZBEFN84Wg1z1H1ME8sbXQcXRDevQGOIBuiwwqDUXfzhwboEnfemqOVL9eb7AdGr1tnHSti9bIdIbgDdOJhlicpB158xuv3h17EWgywZz8NnHKs5onO1gUJsz5rF-AKl0ZB9DJSkNYJiGHSe0Xhd_1-OadEQUdYTdHJkBLH3Ucq97iOBntRJtsGBRAdPZR9c3POyvxq8HL9KIEuvtTkIt3SSZhjzzt32yEJkDj1ySu1T8Q8Zqu9i4AuqqD74iFhJQLVxOqVZEjiOsfV3ouL3W1gGTJiUrZLBB4mjagp6OSxXN8NV8KzGXZgInZrMOth6IKDsxHfqSJtO593u1KDobKfDiFFYBMhZGFy3AvtemfYDXOo0eyVUbNUQt0MJ_lx9_37rU3qbrV7NVJenCSmEF1vRVx8to4ou0Gwf7xCUTJP8ZRang992gHGzb1RNZmLXh77-QoiGx8fkdYgFFJdmm1F43jtlcnAftnXQday6F82CFBNRznfalPkxxobH8DoaPAy5pGZhtn0VFjzP1s9r5ih7jNo1GdzikDLKGD1y8qyWSFs6HwsPO3AT6mriWzpDKJ-mHTNwb_F5XJf-jD7jOOevQg4CTYP7sUQtFFcFTubnDKEozDijIr9Jiojxax3pXJiXhyDVGLxTU2siSPJ5ZVVOScLNH1VPdNrTOVNyFOjl9eIgcTtTusNXpF_igtKlDfFMc0BRkZrwjoUBPle2TDYcSQnoBVxdQetF2u5Prhb6PwjAeDSufmAtURfXRsgYEXe2YzVbX4LBpwYewPtFsIR5mstuhHt1diJapIKOfji1-HxVPGor-k9SHwoBd7pf2Gd_L2coQVIYv96RP4c-aq9DnmbFBOaqGfn56-qP3SyOhTsRldHaYR1bD4vISrMjdGxCi-PRyERkgpEPSYi6uxRJbM7O2iErY9tUPm7tw0QpZpVa2W7iLszPoTnJw-6o5owqT3mUG2Eo4S7dZJmghUkQ1kPVw3sDcdSd8oGnbKXLJZoMgq3RIE8HrcM7_L6HtqaktjsGHnzfPItShxakxFutKYsF6zHaimOxgzEu_Cx6ewvZbdexpcIFzl6cDft8y6IuKY0lPS4YejHmPBsp7B5zAA-bvNtcKU9jnNaxAWQBFnmZkH-b9-tNXBhhLGE9J5fTd9iMZ_5RdCzunES7HlpniEEUQC-abh74UpjGQ4eUBbshk1QiFMCs7u-r6U3EnVACo5iNhBgeVDHbeWYSv39DZUOkHQXrg8uqne1Y-cYrKDVwt6sFSq-oggWdNl__ohtupUvxxl8nI8p4-D3RkuOeQXlO-uQNOtEn8NpqUqOM9PfHNS16lxn3kG0sJxj_mS0]--></g></svg>