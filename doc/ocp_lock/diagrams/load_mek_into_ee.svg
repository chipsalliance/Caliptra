<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="810px" preserveAspectRatio="none" style="width:657px;height:810px;background:#FFFFFF;" version="1.1" viewBox="0 0 657 810" width="657px" zoomAndPan="magnify"><title>Load MEK into the Key Cache of the Encryption Engine</title><defs/><g><rect fill="#DDDDDD" height="761.4063" style="stroke:#181818;stroke-width:0.5;" width="415.3242" x="229.0044" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="121.291" x="376.021" y="56.0566">Encryption Engine</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="391.7881" x="131.2703" y="28.5352">Load MEK into the Key Cache of the Encryption Engine</text><g><title>SFR</title><rect fill="transparent" height="640.1426" width="8" x="266.1724" y="110.7754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="269.6724" x2="269.6724" y1="110.7754" y2="750.918"/></g><g><title/><rect fill="#FFFFFF" height="385.6582" style="stroke:#181818;stroke-width:1;" width="10" x="264.6724" y="347.2598"/></g><g><title>Control</title><rect fill="transparent" height="640.1426" width="8" x="472.5396" y="110.7754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="476.0396" x2="476.0396" y1="110.7754" y2="750.918"/></g><g><title/><rect fill="#FFFFFF" height="59.9316" style="stroke:#181818;stroke-width:1;" width="10" x="471.0396" y="183.3965"/></g><g><title/><rect fill="#FFFFFF" height="237.7949" style="stroke:#181818;stroke-width:1;" width="10" x="471.0396" y="495.123"/></g><g><title>Key Cache</title><rect fill="transparent" height="640.1426" width="8" x="594.9482" y="110.7754"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="598.4482" x2="598.4482" y1="110.7754" y2="750.918"/></g><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="233.0044" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="257.7231" y="83.334">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="240.0044" y="99.8223">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="443.7466" y="79.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="450.7466" y="99.8223">Control</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.7607" x="556.5679" y="79.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.7607" x="563.5679" y="99.8223">Key Cache</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.3359" x="233.0044" y="750.918"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="23.8984" x="257.7231" y="771.4531">SFR</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="59.3359" x="240.0044" y="787.9414">Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="64.5859" x="443.7466" y="750.918"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50.5859" x="450.7466" y="771.4531">Control</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="83.7607" x="556.5679" y="750.918"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="69.7607" x="563.5679" y="771.4531">Key Cache</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="645.3286" x="5" y="139.4307"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="650.3286" y1="139.4307" y2="139.4307"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="650.3286" y1="142.4307" y2="142.4307"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="206.5498" x="224.3894" y="128.7754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="188.2651" x="230.3894" y="145.3438">Prepare for a new command</text><polygon fill="#FF0000" points="257.6724,179.3965,267.6724,183.3965,257.6724,187.3965,261.6724,183.3965" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="263.6724" y1="183.3965" y2="183.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="12" y="178.6543">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.3096" x="51.3628" y="178.6543">Write Control Reg(DONE == 1b)</text><line style="stroke:#008000;stroke-width:1;" x1="469.0396" x2="459.0396" y1="183.3965" y2="179.3965"/><line style="stroke:#008000;stroke-width:1;" x1="469.0396" x2="459.0396" y1="183.3965" y2="187.3965"/><line style="stroke:#008000;stroke-width:1;" x1="269.6724" x2="470.0396" y1="183.3965" y2="183.3965"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="276.6724" y="178.6543">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="316.0352" y="178.6543">&#160;</text><polygon fill="#FF0000" points="280.6724,239.3281,270.6724,243.3281,280.6724,247.3281,276.6724,243.3281" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="274.6724" x2="470.0396" y1="243.3281" y2="243.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="286.6724" y="223.2754">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0713" x="326.0352" y="207.9648">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.9272" x="330.1484" y="223.2754">Done = 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.8911" x="330.1484" y="238.5859">EXE = 0, ERROR = 0h</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="645.3286" x="5" y="271.9834"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="650.3286" y1="271.9834" y2="271.9834"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="650.3286" y1="274.9834" y2="274.9834"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="151.1729" x="252.0779" y="261.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="132.8882" x="258.0779" y="277.8965">Execute a command</text><path d="M96.0088,298.6387 L222.4556,298.6387 L222.4556,305.9492 L212.4556,315.9492 L96.0088,315.9492 L96.0088,298.6387 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="115.2422" style="stroke:#000000;stroke-width:1.5;" width="194.6636" x="96.0088" y="298.6387"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="81.4468" x="111.0088" y="312.207">in any order</text><polygon fill="#FF0000" points="252.6724,343.2598,262.6724,347.2598,252.6724,351.2598,256.6724,347.2598" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="258.6724" y1="347.2598" y2="347.2598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="186.5796" y="342.5176">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="26.73" x="225.9424" y="342.5176">MEK</text><polygon fill="#FF0000" points="252.6724,372.5703,262.6724,376.5703,252.6724,380.5703,256.6724,376.5703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="258.6724" y1="376.5703" y2="376.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="151.8833" y="371.8281">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.4263" x="191.2461" y="371.8281">Write Aux</text><polygon fill="#FF0000" points="252.6724,401.8809,262.6724,405.8809,252.6724,409.8809,256.6724,405.8809" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="258.6724" y1="405.8809" y2="405.8809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="119.0088" y="401.1387">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="94.3008" x="158.3716" y="401.1387">Write Metadata</text><polygon fill="#FF0000" points="252.6724,491.123,262.6724,495.123,252.6724,499.123,256.6724,495.123" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="5" x2="258.6724" y1="495.123" y2="495.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="100.6704" y="467.415">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0713" x="140.0332" y="444.4492">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="112.6392" x="140.0332" y="459.7598">(EXE = Load_MEK,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="67.3804" x="144.1465" y="475.0703">DONE = 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.2378" x="144.1465" y="490.3809">EXE = 1)</text><line style="stroke:#008000;stroke-width:1;" x1="469.0396" x2="459.0396" y1="495.123" y2="491.123"/><line style="stroke:#008000;stroke-width:1;" x1="469.0396" x2="459.0396" y1="495.123" y2="499.123"/><line style="stroke:#008000;stroke-width:1;" x1="274.6724" x2="470.0396" y1="495.123" y2="495.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="281.6724" y="490.3809">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="321.0352" y="490.3809">&#160;</text><path d="M253.6724,507.123 L374.2095,507.123 L374.2095,514.4336 L364.2095,524.4336 L253.6724,524.4336 L253.6724,507.123 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="115.2422" style="stroke:#000000;stroke-width:1.5;" width="238.3672" x="253.6724" y="507.123"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="75.5371" x="268.6724" y="520.6914">in any oder</text><polygon fill="#FF0000" points="285.6724,551.7441,275.6724,555.7441,285.6724,559.7441,281.6724,555.7441" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="279.6724" x2="470.0396" y1="555.7441" y2="555.7441"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="291.6724" y="551.002">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.6675" x="331.0352" y="551.002">Read MEK</text><polygon fill="#FF0000" points="285.6724,581.0547,275.6724,585.0547,285.6724,589.0547,281.6724,585.0547" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="279.6724" x2="470.0396" y1="585.0547" y2="585.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="291.6724" y="580.3125">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.0518" x="331.0352" y="580.3125">Read AUX</text><polygon fill="#FF0000" points="285.6724,610.3652,275.6724,614.3652,285.6724,618.3652,281.6724,614.3652" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="279.6724" x2="470.0396" y1="614.3652" y2="614.3652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="291.6724" y="609.623">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.8218" x="331.0352" y="609.623">Read Metadata</text><polygon fill="#FF0000" points="586.4482,653.6758,596.4482,657.6758,586.4482,661.6758,590.4482,657.6758" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="481.0396" x2="592.4482" y1="657.6758" y2="657.6758"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="488.0396" y="652.9336">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.0459" x="527.4023" y="652.9336">Store Key</text><polygon fill="#FF0000" points="285.6724,728.918,275.6724,732.918,285.6724,736.918,281.6724,732.918" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="279.6724" x2="470.0396" y1="732.918" y2="732.918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="291.6724" y="705.21">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0713" x="331.0352" y="682.2441">Write Control Reg</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.3369" x="331.0352" y="697.5547">(Done = 1b,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61.8833" x="335.1484" y="712.8652">Error = 0,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.2378" x="335.1484" y="728.1758">EXE = 0)</text><!--SRC=[ZLBTQy8m47_FNt6AZ4hdcA-3FeZsoJb7jx71X1BJgmPhhgGfslz-Pzpy6CgMfn-Nkzpl8orjL55d2AJAj22rIckdY-gEoqAqT0v1frhI9dNQ5TWLmETr1w7zI3A3IJm6RHo1MoACiO6XL8mezuNOADkKJfDXkD06swA59jEv4544pnPBQH5oiY31u0OKhTVIP115GdnsgiOeg78B3_1kjKCOad6M2aXm4OocJp7tGN_U5JU-goFz068O2e48X_bUxz8BCmCZCWWHtDyoZZzY3o5EaccoWqjFCjwYgdbIdf5RMAfB5WxID40sG-kTEN8EGzx9vlmg7uWCwksrgmawcKad1JlrXmip4-nvxx98UTrEoTwPKrNzYnQTQ_YHS6eShqnm7_BLky7Rn_MvKoN7I5QA6ruSMVzZ_fTLy9rLV-vbMSj_vZovhl3ZuWi0]--></g></svg>