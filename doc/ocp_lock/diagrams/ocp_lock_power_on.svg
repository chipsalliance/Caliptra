<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1567px" preserveAspectRatio="none" style="width:1607px;height:1567px;background:#FFFFFF;" version="1.1" viewBox="0 0 1607 1567" width="1607px" zoomAndPan="magnify"><defs><filter height="300%" id="f1h977oq4ntz15" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1488.9063" style="stroke:#A80036;stroke-width:1.0;" width="1489" x="87" y="55.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="50" x="806.5" y="68.7139">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="44" x="1553" y="15.3809">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacing" textLength="198" x="702" y="43.2637">OCP L.O.C.K. Power On</text><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="58.7031" style="stroke:#000000;stroke-width:2.0;" width="384" x="885" y="370.2109"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="171.2422" style="stroke:#000000;stroke-width:2.0;" width="463" x="885" y="446.9141"/><rect fill="#FFFFFF" height="59.1875" style="stroke:none;stroke-width:1.0;" width="463" x="885" y="558.9688"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="176.1094" style="stroke:#000000;stroke-width:2.0;" width="1488" x="100" y="754.2109"/><line style="stroke:#A80036;stroke-width:1.0;" x1="116" x2="116" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="116" x2="116" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="116" x2="116" y1="1271.8359" y2="1466.2969"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="960.3281" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="111" y="283.5078"/><line style="stroke:#A80036;stroke-width:1.0;" x1="111" x2="111" y1="283.5078" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="121" x2="121" y1="283.5078" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="111" x2="121" y1="283.5078" y2="283.5078"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="30.3516" style="stroke:#FFFFFF;stroke-width:1.0;" width="10" x="111" y="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="111" x2="111" y1="1271.8359" y2="1302.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="121" x2="121" y1="1271.8359" y2="1302.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="111" x2="121" y1="1302.1875" y2="1302.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="351" x2="351" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="351" x2="351" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="351" x2="351" y1="1271.8359" y2="1466.2969"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="167.1094" style="stroke:#A80036;stroke-width:1.0;" width="10" x="346" y="1294.1875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="638" x2="638" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="638" x2="638" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="638" x2="638" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="901" x2="901" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="901" x2="901" y1="1271.8359" y2="1466.2969"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="296.2969" style="stroke:#A80036;stroke-width:1.0;" width="10" x="896" y="358.2109"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="117.4063" style="stroke:#A80036;stroke-width:1.0;" width="10" x="896" y="804.9141"/><rect fill="#FFFFFF" filter="url(#f1h977oq4ntz15)" height="91.0547" style="stroke:#A80036;stroke-width:1.0;" width="10" x="896" y="1144.7813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143" x2="1143" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1143" x2="1143" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1143" x2="1143" y1="1271.8359" y2="1466.2969"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="982.6797" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1138" y="261.1563"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1138" x2="1138" y1="261.1563" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1148" x2="1148" y1="261.1563" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1138" x2="1148" y1="261.1563" y2="261.1563"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="194.4609" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1138" y="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1138" x2="1138" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1148" x2="1148" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1138" x2="1148" y1="1466.2969" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262" x2="1262" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1262" x2="1262" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1262" x2="1262" y1="1271.8359" y2="1466.2969"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="746.2188" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1257" y="497.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1257" x2="1257" y1="497.6172" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1267" x2="1267" y1="497.6172" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1257" x2="1267" y1="497.6172" y2="497.6172"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="194.4609" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1257" y="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1257" x2="1257" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1267" x2="1267" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1257" x2="1267" y1="1466.2969" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1397.5" x2="1397.5" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1397.5" x2="1397.5" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1397.5" x2="1397.5" y1="1271.8359" y2="1466.2969"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="38.3516" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1392.5" y="1205.4844"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1392.5" x2="1392.5" y1="1205.4844" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1402.5" x2="1402.5" y1="1205.4844" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1392.5" x2="1402.5" y1="1205.4844" y2="1205.4844"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="194.4609" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1392.5" y="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1392.5" x2="1392.5" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1402.5" x2="1402.5" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1392.5" x2="1402.5" y1="1466.2969" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1517.5" x2="1517.5" y1="147.3984" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:1.0,4.0;" x1="1517.5" x2="1517.5" y1="1243.8359" y2="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1517.5" x2="1517.5" y1="1271.8359" y2="1466.2969"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="351.8672" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1512.5" y="891.9688"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1512.5" x2="1512.5" y1="891.9688" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1522.5" x2="1522.5" y1="891.9688" y2="1243.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1512.5" x2="1522.5" y1="891.9688" y2="891.9688"/><rect fill="#ADD8E6" filter="url(#f1h977oq4ntz15)" height="194.4609" style="stroke:#ADD8E6;stroke-width:1.0;" width="10" x="1512.5" y="1271.8359"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1512.5" x2="1512.5" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1522.5" x2="1522.5" y1="1271.8359" y2="1466.2969"/><line style="stroke:#A80036;stroke-width:1.0;" x1="1512.5" x2="1522.5" y1="1466.2969" y2="1466.2969"/><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="46" x="91" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="98" y="132.3223">ROM</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="36" x="331" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="338" y="132.3223">FW</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="54" x="609" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="616" y="132.3223">DRBG</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="74" x="862" y="110.7891"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="869" y="132.3223">Key Vault</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="74" x="1104" y="93.1797"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1111" y="114.7129">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1121.5" y="132.3223">Fuses</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="136" x="1192" y="75.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1230" y="97.1035">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="1241.5" y="114.7129">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="1199" y="132.3223">(Storage Root Key)</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="107" x="1342" y="75.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1365.5" y="97.1035">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="1377" y="114.7129">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="1349" y="132.3223">(PMEK Secret)</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="105" x="1463" y="75.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1485.5" y="97.1035">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1496" y="114.7129">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1470" y="132.3223">(KEM Keypair)</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="46" x="91" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="98" y="1487.8301">ROM</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="36" x="331" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="22" x="338" y="1487.8301">FW</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="54" x="609" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40" x="616" y="1487.8301">DRBG</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="31.6094" style="stroke:#A80036;stroke-width:1.5;" width="74" x="862" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="869" y="1487.8301">Key Vault</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="49.2188" style="stroke:#A80036;stroke-width:1.5;" width="74" x="1104" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1111" y="1487.8301">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1121.5" y="1505.4395">Fuses</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="136" x="1192" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1230" y="1487.8301">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="1241.5" y="1505.4395">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="122" x="1199" y="1523.0488">(Storage Root Key)</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="107" x="1342" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1365.5" y="1487.8301">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37" x="1377" y="1505.4395">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="1349" y="1523.0488">(PMEK Secret)</text><rect fill="#FEFECE" filter="url(#f1h977oq4ntz15)" height="66.8281" style="stroke:#A80036;stroke-width:1.5;" width="105" x="1463" y="1466.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="1485.5" y="1487.8301">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39" x="1496" y="1505.4395">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91" x="1470" y="1523.0488">(KEM Keypair)</text><path d="M81.25,160.3984 L81.25,251.3984 L1552.25,251.3984 L1552.25,170.3984 L1542.25,160.3984 L81.25,160.3984 " fill="#FBFB77" filter="url(#f1h977oq4ntz15)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1542.25,160.3984 L1542.25,170.3984 L1552.25,170.3984 L1542.25,160.3984 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="610.25" y="178.8936"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408" x="606.25" y="195.2451">With the recent chnages to the Fuses, these sequence needs updated</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="610.25" y="211.5967"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="610.25" y="227.9482"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="610.25" y="244.2998"/><line style="stroke:#008000;stroke-width:1.0;" x1="109" x2="99" y1="283.5078" y2="279.5078"/><line style="stroke:#008000;stroke-width:1.0;" x1="109" x2="99" y1="283.5078" y2="287.5078"/><line style="stroke:#008000;stroke-width:1.0;" x1="5" x2="110" y1="283.5078" y2="283.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="12" y="278.6514">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="54" x="45" y="278.6514">Power on</text><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1592" x="5" y="312.6836"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="312.6836" y2="312.6836"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="315.6836" y2="315.6836"/><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="260" x="671" y="301.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="238" x="677" y="319.0029">Load a KV slot with Storage Root Key</text><polygon fill="#FF0000" points="884,354.2109,894,358.2109,884,362.2109,888,358.2109" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="121" x2="890" y1="358.2109" y2="358.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="128" y="353.3545">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178" x="161" y="353.3545">load_storage_root(Key: Slot A)</text><path d="M885,370.2109 L958,370.2109 L958,378.2109 L948,388.2109 L885,388.2109 L885,370.2109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="58.7031" style="stroke:#000000;stroke-width:2.0;" width="384" x="885" y="370.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="900" y="384.7061">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="280" x="973" y="383.6299">[through fuses entries until valid fuse entry found]</text><polygon fill="#FF0000" points="1126,416.9141,1136,420.9141,1126,424.9141,1130,420.9141" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="906" x2="1132" y1="420.9141" y2="420.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="913" y="416.0576">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="946" y="416.0576">get next entry</text><path d="M885,446.9141 L946,446.9141 L946,454.9141 L936,464.9141 L885,464.9141 L885,446.9141 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="171.2422" style="stroke:#000000;stroke-width:2.0;" width="463" x="885" y="446.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="900" y="461.4092">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="84" x="961" y="460.333">[if a valid entry]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="885" x2="1348" y1="559.9688" y2="559.9688"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="82" x="890" y="571.3877">[No valid entry]</text><polygon fill="#FF0000" points="1245,493.6172,1255,497.6172,1245,501.6172,1249,497.6172" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="906" x2="1251" y1="497.6172" y2="497.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="913" y="492.7607">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="946" y="492.7607">Put Storage Root Key</text><line style="stroke:#FF0000;stroke-width:1.0;" x1="906" x2="948" y1="527.9688" y2="527.9688"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="948" x2="948" y1="527.9688" y2="540.9688"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="907" x2="948" y1="540.9688" y2="540.9688"/><polygon fill="#FF0000" points="917,536.9688,907,540.9688,917,544.9688,913,540.9688" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="913" y="523.1123">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180" x="946" y="523.1123">storage_root_ket_exists = True</text><line style="stroke:#FF0000;stroke-width:1.0;" x1="906" x2="948" y1="597.1563" y2="597.1563"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="948" x2="948" y1="597.1563" y2="610.1563"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="907" x2="948" y1="610.1563" y2="610.1563"/><polygon fill="#FF0000" points="917,606.1563,907,610.1563,917,614.1563,913,610.1563" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="913" y="592.2998">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="946" y="592.2998">storage_root_key_exists = False</text><polygon fill="#FF0000" points="132,650.5078,122,654.5078,132,658.5078,128,654.5078" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="126" x2="895" y1="654.5078" y2="654.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="138" y="649.6514">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142" x="171" y="649.6514">storage_root_key_exists</text><line style="stroke:#FF0000;stroke-width:1.0;" x1="121" x2="163" y1="684.8594" y2="684.8594"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="163" x2="163" y1="684.8594" y2="697.8594"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="122" x2="163" y1="697.8594" y2="697.8594"/><polygon fill="#FF0000" points="132,693.8594,122,697.8594,132,701.8594,128,697.8594" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="128" y="680.0029">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183" x="161" y="680.0029">Retain storage_root_key_exists</text><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1592" x="5" y="727.0352"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="727.0352" y2="727.0352"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="730.0352" y2="730.0352"/><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="397" x="602.5" y="715.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="375" x="608.5" y="733.3545">Load a KV slot with KEM for each KEM algorithm supported</text><path d="M100,754.2109 L161,754.2109 L161,762.2109 L151,772.2109 L100,772.2109 L100,754.2109 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="176.1094" style="stroke:#000000;stroke-width:2.0;" width="1488" x="100" y="754.2109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="115" y="768.7061">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="245" x="176" y="767.6299">[kem_algorithm ecdh_secp384r1 supported]</text><polygon fill="#FF0000" points="884,800.9141,894,804.9141,884,808.9141,888,804.9141" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="121" x2="890" y1="804.9141" y2="804.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="128" y="800.0576">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228" x="161" y="800.0576">generate_ecdh_secp384r1(Key: Slot G)</text><polygon fill="#FF0000" points="649,831.2656,639,835.2656,649,839.2656,645,835.2656" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="643" x2="895" y1="835.2656" y2="835.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="655" y="830.4092">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="688" y="830.4092">Get random bytes for KEM keypair</text><path d="M911,817.9141 L911,859.9141 L1169,859.9141 L1169,827.9141 L1159,817.9141 L911,817.9141 " fill="#FBFB77" filter="url(#f1h977oq4ntz15)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1159,817.9141 L1159,827.9141 L1169,827.9141 L1159,817.9141 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="70" x="917" y="836.4092">move to FW</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237" x="917" y="852.7607">add note to indiacte would be nice in HW</text><polygon fill="#FF0000" points="1500.5,887.9688,1510.5,891.9688,1500.5,895.9688,1504.5,891.9688" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="906" x2="1506.5" y1="891.9688" y2="891.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="913" y="887.1123">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99" x="946" y="887.1123">Put KEM keypair</text><polygon fill="#FF0000" points="132,918.3203,122,922.3203,132,926.3203,128,922.3203" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="126" x2="895" y1="922.3203" y2="922.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="138" y="917.4639">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="171" y="917.4639">done</text><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1592" x="5" y="965.4961"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="965.4961" y2="965.4961"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="968.4961" y2="968.4961"/><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="425" x="588.5" y="954.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="403" x="594.5" y="971.8154">Load a KV slot with DICE key for each KEM algorithm supported</text><path d="M126,993.6719 L126,1052.6719 L769,1052.6719 L769,1003.6719 L759,993.6719 L126,993.6719 " fill="#FBFB77" filter="url(#f1h977oq4ntz15)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M759,993.6719 L759,1003.6719 L769,1003.6719 L759,993.6719 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="136" y="1012.167"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="622" x="132" y="1028.5186">ROM/FMC code already created DICE keys and loaded them. Caliptra FW knows the key so no work to do.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="136" y="1044.8701"/><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1592" x="5" y="1082.9023"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="1082.9023" y2="1082.9023"/><line style="stroke:#000000;stroke-width:1.0;" x1="5" x2="1597" y1="1085.9023" y2="1085.9023"/><rect fill="#EEEEEE" filter="url(#f1h977oq4ntz15)" height="24.3516" style="stroke:#000000;stroke-width:2.0;" width="272" x="665" y="1071.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="250" x="671" y="1089.2217">Load a KV slot with a PMEK unlock Key</text><polygon fill="#FF0000" points="884,1140.7813,894,1144.7813,884,1148.7813,888,1144.7813" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="121" x2="890" y1="1144.7813" y2="1144.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="128" y="1131.749">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105" x="161" y="1123.5732">new_key(len: 256,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="217" y="1139.9248">Destination: Slot B)</text><polygon fill="#FF0000" points="649,1171.1328,639,1175.1328,649,1179.1328,645,1175.1328" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="643" x2="895" y1="1175.1328" y2="1175.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="655" y="1170.2764">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184" x="688" y="1170.2764">Get new random key of 256 bits</text><polygon fill="#FF0000" points="1380.5,1201.4844,1390.5,1205.4844,1380.5,1209.4844,1384.5,1205.4844" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="906" x2="1386.5" y1="1205.4844" y2="1205.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="913" y="1200.6279">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131" x="946" y="1200.6279">Put PMEK Secret Key</text><polygon fill="#FF0000" points="132,1231.8359,122,1235.8359,132,1239.8359,128,1235.8359" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="126" x2="895" y1="1235.8359" y2="1235.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="138" y="1230.9795">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="28" x="171" y="1230.9795">done</text><polygon fill="#FF0000" points="334,1290.1875,344,1294.1875,334,1298.1875,338,1294.1875" style="stroke:#FF0000;stroke-width:1.0;"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="121" x2="340" y1="1294.1875" y2="1294.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="128" y="1289.3311">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114" x="161" y="1289.3311">Hand-off information</text><path d="M361,1307.1875 L361,1398.1875 L887,1398.1875 L887,1317.1875 L877,1307.1875 L361,1307.1875 " fill="#FBFB77" filter="url(#f1h977oq4ntz15)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M877,1307.1875 L877,1317.1875 L887,1317.1875 L877,1307.1875 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="261" x="367" y="1325.6826">Currently, there is already handoff information</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252" x="367" y="1342.0342">from ROM to run-time FW. Need to include:</text><ellipse cx="372.5" cy="1353.7422" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="492" x="380" y="1358.3857">If the Storage Root Key exists and if so the KV slot containing that Storage Root Key</text><ellipse cx="372.5" cy="1370.0938" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234" x="380" y="1374.7373">The KV Slot containing the KEM keypair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="371" y="1391.0889"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="356" x2="398" y1="1430.2969" y2="1430.2969"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="398" x2="398" y1="1430.2969" y2="1443.2969"/><line style="stroke:#FF0000;stroke-width:1.0;" x1="357" x2="398" y1="1443.2969" y2="1443.2969"/><polygon fill="#FF0000" points="367,1439.2969,357,1443.2969,367,1447.2969,363,1443.2969" style="stroke:#FF0000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29" x="363" y="1425.4404">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="235" x="396" y="1425.4404">Mark that no MEK sequence has started</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="167" x="717.5" y="1558.5059">Filename: ocp_lock_power_on.uml</text><!--MD5=[f8589598a68a78be29318106bc3ab2cf]
@startuml

!include ocp_lock_utils.inc

!$SHOW_LOAD_KEY = 0


!if ($show_title)
    Title "OCP L.O.C.K. Power On"
!endif

!if ($show_precond)
    note across

        <font color = red>With the recent chnages to the Fuses, these sequence needs updated


'        <b>Preconditions:</b>
'        * Storage Root Key exists in the fuses

'        <b>Notes:</b>
'        * <font color=red>Need to add the ability to Purge the existing Storage Root Key and creating a new Storage Root Key to be determined as part of the fuse discussion
'        * <font color=red>Need to discuss Warm Reset cases
'          - <font color=red>NVM subsystem Reset - assume reset of ASIC and ROM code re-executed
'          - <font color=red>PCIe Warm Reset - Discuss : PMEKs maybe unlocked
'             Gamil to investigate
'          - <font color=red>Controller Reset - Discuss
    end note
!endif

fuses++ $BUFFER_ACTIVATION

[-[$ASYNC_COLOR]>> crom++ : Power on

== Load a KV slot with Storage Root Key  ==

crom $sync kv++: load_storage_root(Key: Slot A)
loop through fuses entries until valid fuse entry found
    kv $sync fuses : get next entry
end

alt if a valid entry
    kv $sync srk : Put Storage Root Key
    srk++ $BUFFER_ACTIVATION
    kv $sync kv: storage_root_ket_exists = True
else No valid entry
    kv $sync kv: storage_root_key_exists = False
end
!if ($show_done)
    kv $sync crom- - : storage_root_key_exists
!else
    kv- -
!endif

crom $sync crom : Retain storage_root_key_exists


== Load a KV slot with KEM for each KEM algorithm supported  ==

alt kem_algorithm ecdh_secp384r1 supported
    crom $sync kv++: generate_ecdh_secp384r1(Key: Slot G)
    kv $sync rand: Get random bytes for KEM keypair
    note right
        <font color=red>move to FW
        <font color=red>add note to indiacte would be nice in HW
    end note
    kv $sync kemg : Put KEM keypair
    kemg++ $BUFFER_ACTIVATION
    !if ($show_done)
        kv $sync crom- - : done
    !else
        kv- -
    !endif
end

== Load a KV slot with DICE key for each KEM algorithm supported  ==

note right crom

ROM/FMC code already created DICE keys and loaded them. Caliptra FW knows the key so no work to do.

end note

== Load a KV slot with a PMEK unlock Key  ==

crom $sync kv++: new_key(len: 256,\n              Destination: Slot B)
kv $sync rand: Get new random key of 256 bits
kv $sync pmeks: Put PMEK Secret Key
pmeks++ $BUFFER_ACTIVATION
!if ($show_done)
    kv $sync crom- - : done
!else
    kv- -
!endif

$sometimelater()

crom $sync cfw++ : Hand-off information
destroy crom
note right cfw
    Currently, there is already handoff information
    from ROM to run-time FW. Need to include:
    * If the Storage Root Key exists and if so the KV slot containing that Storage Root Key
    * The KV Slot containing the KEM keypair

end note

cfw $sync cfw: Mark that no MEK sequence has started
||5||
cfw- -


@enduml

@startuml









	autonumber 1 1  "<b>[000]"

	!pragma teoz true

    participant "Remote Key\nManagement Service" as rkms


    participant "Host" as host


    participant "Storage\nDevice\nFW" as fw

    box "Caliptra"
    	participant "Mail Box" as mb
    	participant "ROM" as crom
    	participant "FW" as cfw
    	participant "ROM to FW\nHandoff Data" as hoff
        participant "DRBG" as rand
        participant "DMA Engine" as dma
        participant "Key Vault" as kv
        participant "Key Vault\nFuses" as fuses
        participant "Key Vault\nStorage Root Key" as gsrk
        participant "Key Vault\nSlot A\n(Storage Root Key)" as srk
        participant "Key Vault\nSlot B\n(PMEK Secret)" as pmeks
        participant "Key Vault\nSlot F\n(DICE Alias Key)\necdsa_secp384r1_sha384" as dice
        participant "Key Vault\nSlot G\n(KEM Keypair)" as kemg
        participant "Key Vault\nSlot W\n(Temporary)" as tempw
        participant "Key Vault\nSlot X\n(MEK Seed)" as meks
        participant "Key Vault\nSlot Y\n(Temporary)" as tempy
        participant "Key Vault\nSlot Z\n(Temporary)" as tempz
        participant "Key Vault\nTemp Memory" as tempmem
    end box

    box "Encryption Engine"
        participant "SFR\nInterface" as sfr
        participant "Control" as ee
        participant "Key Cache" as kc
    end box

    box "Media"
        participant "Create new\Storage Root Key\non NVM subsystem reset" as csrk
        participant "Destroy all\Storage Root Keys\non NVM subsystem reset" as dsrk
    end box

    hide unlinked
	footer Filename: ocp_lock_power_on.uml

	header Version 1




    Title "OCP L.O.C.K. Power On"

    note across

        <font color = red>With the recent chnages to the Fuses, these sequence needs updated



    end note

fuses++ #lightblue

[-[#green]>> crom++ : Power on

== Load a KV slot with Storage Root Key  ==

crom -[#red]> kv++: load_storage_root(Key: Slot A)
loop through fuses entries until valid fuse entry found
    kv -[#red]> fuses : get next entry
end

alt if a valid entry
    kv -[#red]> srk : Put Storage Root Key
    srk++ #lightblue
    kv -[#red]> kv: storage_root_ket_exists = True
else No valid entry
    kv -[#red]> kv: storage_root_key_exists = False
end
    kv -[#red]> crom- - : storage_root_key_exists

crom -[#red]> crom : Retain storage_root_key_exists


== Load a KV slot with KEM for each KEM algorithm supported  ==

alt kem_algorithm ecdh_secp384r1 supported
    crom -[#red]> kv++: generate_ecdh_secp384r1(Key: Slot G)
    kv -[#red]> rand: Get random bytes for KEM keypair
    note right
        <font color=red>move to FW
        <font color=red>add note to indiacte would be nice in HW
    end note
    kv -[#red]> kemg : Put KEM keypair
    kemg++ #lightblue
        kv -[#red]> crom- - : done
end

== Load a KV slot with DICE key for each KEM algorithm supported  ==

note right crom

ROM/FMC code already created DICE keys and loaded them. Caliptra FW knows the key so no work to do.

end note

== Load a KV slot with a PMEK unlock Key  ==

crom -[#red]> kv++: new_key(len: 256,\n              Destination: Slot B)
kv -[#red]> rand: Get new random key of 256 bits
kv -[#red]> pmeks: Put PMEK Secret Key
pmeks++ #lightblue
    kv -[#red]> crom- - : done

           ...
	       ||0||

crom -[#red]> cfw++ : Hand-off information
destroy crom
note right cfw
    Currently, there is already handoff information
    from ROM to run-time FW. Need to include:
    * If the Storage Root Key exists and if so the KV slot containing that Storage Root Key
    * The KV Slot containing the KEM keypair

end note

cfw -[#red]> cfw: Mark that no MEK sequence has started
||5||
cfw- -


@enduml

PlantUML version 1.2021.7(Sun May 23 06:40:07 MDT 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>