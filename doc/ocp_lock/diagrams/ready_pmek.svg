<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4279px" preserveAspectRatio="none" style="width:1975px;height:4279px;background:#FFFFFF;" version="1.1" viewBox="0 0 1975 4279" width="1975px" zoomAndPan="magnify"><title>Ready PMEK</title><defs/><g><rect fill="#DDDDDD" height="4229.8906" style="stroke:#181818;stroke-width:0.5;" width="1735.3335" x="205.7573" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="1047.0273" y="56.0566">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="87.7871" x="999.4663" y="28.5352">Ready PMEK</text><g><title>Storage</title><rect fill="transparent" height="4075.6504" width="8" x="91.1826" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="94.6826" x2="94.6826" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#FFFFFF" height="131.2422" style="stroke:#181818;stroke-width:1;" width="10" x="89.6826" y="4071.6719"/></g><g><title>Mail Box</title><rect fill="transparent" height="4075.6504" width="8" x="242.0332" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="245.5332" x2="245.5332" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#FFFFFF" height="205.1055" style="stroke:#181818;stroke-width:1;" width="10" x="240.5332" y="237.8164"/></g><g><title>FW</title><rect fill="transparent" height="4075.6504" width="8" x="436.4858" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="439.9858" x2="439.9858" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#FFFFFF" height="3784.3027" style="stroke:#181818;stroke-width:1;" width="10" x="434.9858" y="413.6113"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1067.8413" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1071.3413" x2="1071.3413" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="724.7168"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="884.2695"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1168.375"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1403.1699"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1732.5859"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1952.0703"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="2171.5547"/></g><g><title/><rect fill="#FFFFFF" height="165.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="2435.6602"/></g><g><title/><rect fill="#FFFFFF" height="165.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="2735.0762"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3049.8027"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3297.2871"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3560.082"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3793.5664"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3968.4297"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1344.8872" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1348.3872" x2="1348.3872" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#ADD8E6" height="3986.4082" style="stroke:#181818;stroke-width:1;" width="10" x="1343.3872" y="216.5059"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1498.4351" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1501.9351" x2="1501.9351" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#ADD8E6" height="3986.4082" style="stroke:#181818;stroke-width:1;" width="10" x="1496.9351" y="216.5059"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1666.6597" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1670.1597" x2="1670.1597" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#ADD8E6" height="3986.4082" style="stroke:#181818;stroke-width:1;" width="10" x="1665.1597" y="216.5059"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1778.4775" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1781.9775" x2="1781.9775" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#ADD8E6" height="2757.7441" style="stroke:#181818;stroke-width:1;" width="10" x="1776.9775" y="1239.9961"/></g><line style="stroke:#181818;stroke-width:2;" x1="1772.9775" x2="1790.9775" y1="3988.7402" y2="4006.7402"/><line style="stroke:#181818;stroke-width:2;" x1="1772.9775" x2="1790.9775" y1="4006.7402" y2="3988.7402"/><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1885.2197" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1888.7197" x2="1888.7197" y1="127.2637" y2="4202.9141"/></g><g><title/><rect fill="#ADD8E6" height="847.0059" style="stroke:#181818;stroke-width:1;" width="10" x="1883.7197" y="3150.7344"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="62" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="69" y="83.334">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="72.4077" y="99.8223">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="84.9414" y="116.3105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="209.7573" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="216.7573" y="116.3105">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="423.2446" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="430.2446" y="116.3105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1032.5713" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1039.5713" y="116.3105">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1309.6172" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1316.6172" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1328.6313" y="99.8223">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1331.7178" y="116.3105">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1397.1572" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1470.165" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1482.9824" y="99.8223">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1404.1572" y="116.3105">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1616.7129" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1638.3896" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1650.1748" y="99.8223">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1623.7129" y="116.3105">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1733.6064" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1750.2075" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1762.6899" y="99.8223">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1740.6064" y="116.3105">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1840.3486" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1856.9497" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1869.562" y="99.8223">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1847.3486" y="116.3105">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="62" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="69" y="4223.4492">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="72.4077" y="4239.9375">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="84.9414" y="4256.4258">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="209.7573" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="216.7573" y="4223.4492">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="423.2446" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="430.2446" y="4223.4492">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1032.5713" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1039.5713" y="4223.4492">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1309.6172" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1316.6172" y="4223.4492">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1328.6313" y="4239.9375">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1331.7178" y="4256.4258">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1397.1572" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1470.165" y="4223.4492">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1482.9824" y="4239.9375">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1404.1572" y="4256.4258">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1616.7129" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1638.3896" y="4223.4492">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1650.1748" y="4239.9375">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1623.7129" y="4256.4258">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1733.6064" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1750.2075" y="4223.4492">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1762.6899" y="4239.9375">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1740.6064" y="4256.4258">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1840.3486" y="4202.9141"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1856.9497" y="4223.4492">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1869.562" y="4239.9375">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1847.3486" y="4256.4258">(Temporary)</text><path d="M59.1558,140.2637 L59.1558,211.2637 L1924.1558,211.2637 L1924.1558,150.2637 L1914.1558,140.2637 L59.1558,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1914.1558,140.2637 L1914.1558,150.2637 L1924.1558,150.2637 L1914.1558,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="750.4956" y="157.832">Preconditions:</text><ellipse cx="755.9956" cy="168.3848" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.6094" x="762.4956" y="173.1426">Access Shared Secret already availble in a slot in KV</text><ellipse cx="755.9956" cy="183.6953" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.4111" x="762.4956" y="188.4531">Ready PMEK Encryption Key already in a slot and generated on each reset</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313.8853" x="750.4956" y="203.7637">Is there a separate Shared Secret per Admin User?</text><line style="stroke:#008000;stroke-width:1;" x1="238.5332" x2="228.5332" y1="237.8164" y2="233.8164"/><line style="stroke:#008000;stroke-width:1;" x1="238.5332" x2="228.5332" y1="237.8164" y2="241.8164"/><line style="stroke:#008000;stroke-width:1;" x1="94.6826" x2="239.5332" y1="237.8164" y2="237.8164"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="101.6826" y="233.0742">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.4878" x="141.0454" y="233.0742">READY_PMEK</text><path d="M255.5332,250.8164 L255.5332,386.8164 L846.5332,386.8164 L846.5332,260.8164 L836.5332,250.8164 L255.5332,250.8164 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M836.5332,250.8164 L836.5332,260.8164 L846.5332,260.8164 L836.5332,250.8164 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="261.5332" y="270.3848">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="265.6465" y="270.3848">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="403.8032" y="270.3848">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="407.9165" y="270.3848">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="532.7432" y="270.3848">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="536.8564" y="270.3848">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="265.6465" y="285.6953">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="407.9165" y="285.6953">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="536.8564" y="285.6953">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.9302" x="265.6465" y="301.0059">wrapped_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="407.9165" y="301.0059">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="536.8564" y="301.0059">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3535" x="532.7432" y="316.3164">* kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.915" x="532.7432" y="331.627">*kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.9111" x="532.7432" y="346.9375">*kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="532.7432" y="362.248">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.0845" x="265.6465" y="377.5586">locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="407.9165" y="377.5586">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.1226" x="536.8564" y="377.5586">PMEK encrypted to the FEK and the access key</text><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="257.8164" y2="257.8164"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="273.127" y2="273.127"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="288.4375" y2="288.4375"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="364.9902" y2="364.9902"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="380.3008" y2="380.3008"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="261.5332" y1="257.8164" y2="380.3008"/><line style="stroke:#000000;stroke-width:0.5;" x1="403.8032" x2="403.8032" y1="257.8164" y2="380.3008"/><line style="stroke:#000000;stroke-width:0.5;" x1="532.7432" x2="532.7432" y1="257.8164" y2="380.3008"/><line style="stroke:#000000;stroke-width:0.5;" x1="832.0923" x2="832.0923" y1="257.8164" y2="380.3008"/><line style="stroke:#008000;stroke-width:1;" x1="432.9858" x2="422.9858" y1="413.6113" y2="409.6113"/><line style="stroke:#008000;stroke-width:1;" x1="432.9858" x2="422.9858" y1="413.6113" y2="417.6113"/><line style="stroke:#008000;stroke-width:1;" x1="250.5332" x2="433.9858" y1="413.6113" y2="413.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="257.5332" y="408.8691">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="296.896" y="408.8691">Command</text><polygon fill="#FF0000" points="261.5332,438.9219,251.5332,442.9219,261.5332,446.9219,257.5332,442.9219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="255.5332" x2="433.9858" y1="442.9219" y2="442.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="267.5332" y="438.1797">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="306.896" y="438.1797">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="486.9858" y1="472.2324" y2="472.2324"/><line style="stroke:#FF0000;stroke-width:1;" x1="486.9858" x2="486.9858" y1="472.2324" y2="485.2324"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.9858" x2="486.9858" y1="485.2324" y2="485.2324"/><polygon fill="#FF0000" points="455.9858,481.2324,445.9858,485.2324,455.9858,489.2324,451.9858,485.2324" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="467.4902">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="491.3486" y="467.4902">Determine command</text><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="486.9858" y1="514.543" y2="514.543"/><line style="stroke:#FF0000;stroke-width:1;" x1="486.9858" x2="486.9858" y1="514.543" y2="527.543"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.9858" x2="486.9858" y1="527.543" y2="527.543"/><polygon fill="#FF0000" points="455.9858,523.543,445.9858,527.543,455.9858,531.543,451.9858,527.543" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="509.8008">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.1201" x="491.3486" y="509.8008">Determine rate of ready commands</text><path d="M8,539.543 L70.1387,539.543 L70.1387,546.8535 L60.1387,556.8535 L8,556.8535 L8,539.543 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="3554.1289" style="stroke:#000000;stroke-width:1.5;" width="1951.7197" x="8" y="539.543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="553.1113">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65.9302" x="85.1387" y="552.1777">[FEK exists]</text><path d="M27,570.8535 L89.1387,570.8535 L89.1387,578.1641 L79.1387,588.1641 L27,588.1641 L27,570.8535 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="3508.8184" style="stroke:#000000;stroke-width:1.5;" width="1907.7197" x="27" y="570.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="42" y="584.4219">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="222.7124" x="104.1387" y="583.4883">[Ready command rate below threshold]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="618.8193"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="618.8193" y2="618.8193"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="621.8193" y2="621.8193"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="357.3574" x="808.1812" y="608.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="339.0728" x="814.1812" y="624.7324">Decapsulate ciphertext and decrypt the access key</text><path d="M46,645.4746 L108.1387,645.4746 L108.1387,652.7852 L98.1387,662.7852 L46,662.7852 L46,645.4746 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="895.9375" style="stroke:#000000;stroke-width:1.5;" width="1756.9775" x="46" y="645.4746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="61" y="659.043">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="294.0889" x="123.1387" y="658.1094">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384))]</text><polygon fill="#FF0000" points="1054.3413,720.7168,1064.3413,724.7168,1054.3413,728.7168,1058.3413,724.7168" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="724.7168" y2="724.7168"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="704.6641">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2349" x="491.3486" y="689.3535">ECDH(KEM Pair : kem_handle (G),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.9976" x="540.708" y="704.6641">KEM ciphertext : kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3276" x="540.708" y="719.9746">Destination : memory)</text><polygon fill="#FF0000" points="1653.1597,750.0273,1663.1597,754.0273,1653.1597,758.0273,1657.1597,754.0273" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1659.1597" y1="754.0273" y2="754.0273"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="749.2852">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="1122.7041" y="749.2852">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="783.3379" y2="783.3379"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="783.3379" y2="796.3379"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="796.3379" y2="796.3379"/><polygon fill="#FF0000" points="1087.3413,792.3379,1077.3413,796.3379,1087.3413,800.3379,1083.3413,796.3379" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="778.5957">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.6831" x="1122.7041" y="778.5957">ECDH KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="455.9858,821.6484,445.9858,825.6484,455.9858,829.6484,451.9858,825.6484" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="825.6484" y2="825.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="820.9063">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.3574" x="501.3486" y="820.9063">Put ECDH shared secret</text><polygon fill="#FF0000" points="455.9858,850.959,445.9858,854.959,455.9858,858.959,451.9858,854.959" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="854.959" y2="854.959"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="850.2168">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="850.2168">done</text><polygon fill="#FF0000" points="1054.3413,880.2695,1064.3413,884.2695,1054.3413,888.2695,1058.3413,884.2695" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="884.2695" y2="884.2695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="879.5273">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.0098" x="491.3486" y="879.5273">ECC_GetPubKey(KEM Pair : kem_handle (G))</text><polygon fill="#FF0000" points="1653.1597,909.5801,1663.1597,913.5801,1653.1597,917.5801,1657.1597,913.5801" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1659.1597" y1="913.5801" y2="913.5801"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="908.8379">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="1122.7041" y="908.8379">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="942.8906" y2="942.8906"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="942.8906" y2="955.8906"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="955.8906" y2="955.8906"/><polygon fill="#FF0000" points="1087.3413,951.8906,1077.3413,955.8906,1087.3413,959.8906,1083.3413,955.8906" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="938.1484">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.3833" x="1122.7041" y="938.1484">derive ECDH public key</text><polygon fill="#FF0000" points="455.9858,981.2012,445.9858,985.2012,455.9858,989.2012,451.9858,985.2012" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="985.2012" y2="985.2012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="980.459">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.1387" x="501.3486" y="980.459">Put kem_pub</text><polygon fill="#FF0000" points="455.9858,1010.5117,445.9858,1014.5117,455.9858,1018.5117,451.9858,1014.5117" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1014.5117" y2="1014.5117"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1009.7695">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1009.7695">done</text><path d="M449.9858,1027.5117 L449.9858,1052.5117 L882.9858,1052.5117 L882.9858,1037.5117 L872.9858,1027.5117 L449.9858,1027.5117 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M872.9858,1027.5117 L872.9858,1037.5117 L882.9858,1037.5117 L872.9858,1027.5117 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412.8896" x="455.9858" y="1045.0801">The next steps come from RFC 9180, section 4.1, Decap function</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1078.4775"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1078.4775" y2="1078.4775"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1081.4775" y2="1081.4775"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="341.5771" x="816.0713" y="1067.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="323.2925" x="822.0713" y="1084.3906">Derive HPKE pseudo-random key material (PRK)</text><polygon fill="#FF0000" points="1054.3413,1164.375,1064.3413,1168.375,1054.3413,1172.375,1058.3413,1168.375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1168.375" y2="1168.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1140.667">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="491.3486" y="1117.7012">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.0225" x="594.1807" y="1133.0117">Key Data : "HPKE-v1" | "KEM" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="364.8315" x="491.3486" y="1148.3223">"                                         eae_prk" | ECDH shared secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="1163.6328">Destination Slot: Y)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1197.6855" y2="1197.6855"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1197.6855" y2="1210.6855"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="1210.6855" y2="1210.6855"/><polygon fill="#FF0000" points="1087.3413,1206.6855,1077.3413,1210.6855,1087.3413,1214.6855,1083.3413,1210.6855" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1192.9434">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1122.7041" y="1192.9434">HMAC384 operation</text><polygon fill="#FF0000" points="1764.9775,1235.9961,1774.9775,1239.9961,1764.9775,1243.9961,1768.9775,1239.9961" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="1239.9961" y2="1239.9961"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1235.2539">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.3711" x="1122.7041" y="1235.2539">HMAC384 result PRK</text><polygon fill="#FF0000" points="455.9858,1265.3066,445.9858,1269.3066,455.9858,1273.3066,451.9858,1269.3066" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1269.3066" y2="1269.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1264.5645">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1264.5645">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1297.9619"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1297.9619" y2="1297.9619"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1300.9619" y2="1300.9619"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="196.0381" x="888.8408" y="1287.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="177.7534" x="894.8408" y="1303.875">Derive HPKE shared secret</text><polygon fill="#FF0000" points="1054.3413,1399.1699,1064.3413,1403.1699,1054.3413,1407.1699,1058.3413,1403.1699" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1403.1699" y2="1403.1699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1367.8066">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="1337.1855">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.6201" x="594.1807" y="1352.4961">Data : 0x0030 (big-endian 48) | "HPKE-v1" | "KEM"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336.6226" x="635.3135" y="1367.8066">0x0011 (kem_id) | "shared_secret" | kem_ciphertext |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.3662" x="635.3135" y="1383.1172">kem_pub | 0x01 (HKDF block number)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="1398.4277">Destination Slot: Y)</text><polygon fill="#FF0000" points="1764.9775,1428.4805,1774.9775,1432.4805,1764.9775,1436.4805,1768.9775,1432.4805" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="1432.4805" y2="1432.4805"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1427.7383">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.8901" x="1122.7041" y="1427.7383">Get HPKE PRK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1461.791" y2="1461.791"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1461.791" y2="1474.791"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="1474.791" y2="1474.791"/><polygon fill="#FF0000" points="1087.3413,1470.791,1077.3413,1474.791,1087.3413,1478.791,1083.3413,1474.791" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1457.0488">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="1457.0488">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1764.9775,1500.1016,1774.9775,1504.1016,1764.9775,1508.1016,1768.9775,1504.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="1504.1016" y2="1504.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1499.3594">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.1626" x="1122.7041" y="1499.3594">HMAC384 result shared secret</text><polygon fill="#FF0000" points="455.9858,1529.4121,445.9858,1533.4121,455.9858,1537.4121,451.9858,1533.4121" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1533.4121" y2="1533.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1528.6699">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1528.6699">done</text><path d="M46,1559.4121 L108.1387,1559.4121 L108.1387,1566.7227 L98.1387,1576.7227 L46,1576.7227 L46,1559.4121 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="1628.6328" style="stroke:#000000;stroke-width:1.5;" width="1863.7197" x="46" y="1559.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="61" y="1572.9805">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="692.1299" x="123.1387" y="1572.0469">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384)), kdf_id = 0x0002 (HKDF-SHA384), aead_id = 0x0002 (AES-256-GCM)]</text><path d="M449.9858,1591.7227 L449.9858,1616.7227 L1222.9858,1616.7227 L1222.9858,1601.7227 L1212.9858,1591.7227 L449.9858,1591.7227 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1212.9858,1591.7227 L1212.9858,1601.7227 L1222.9858,1601.7227 L1212.9858,1591.7227 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="752.7178" x="455.9858" y="1609.291">The next steps come from RFC 9180, sections 5.1 and 5.2, KeyScheduleBase and ContextR.Open functions respectively</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1642.6885"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1642.6885" y2="1642.6885"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1645.6885" y2="1645.6885"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="331.2686" x="821.2256" y="1632.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312.9839" x="827.2256" y="1648.6016">Derive HPKE psk_id_hash and store in memory</text><polygon fill="#FF0000" points="1054.3413,1728.5859,1064.3413,1732.5859,1054.3413,1736.5859,1058.3413,1732.5859" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1732.5859" y2="1732.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1704.8779">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="491.3486" y="1681.9121">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.6538" x="594.1807" y="1697.2227">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.7476" x="635.3135" y="1712.5332">0x0002 (aead_id) | "psk_id_hash" | "" (no PSK ID)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3276" x="594.1807" y="1727.8438">Destination : memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1761.8965" y2="1761.8965"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1761.8965" y2="1774.8965"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="1774.8965" y2="1774.8965"/><polygon fill="#FF0000" points="1087.3413,1770.8965,1077.3413,1774.8965,1087.3413,1778.8965,1083.3413,1774.8965" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1757.1543">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1122.7041" y="1757.1543">HMAC384 operation</text><polygon fill="#FF0000" points="455.9858,1800.207,445.9858,1804.207,455.9858,1808.207,451.9858,1804.207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1804.207" y2="1804.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1799.4648">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.7676" x="501.3486" y="1799.4648">HMAC384 result psk_id_hash</text><polygon fill="#FF0000" points="455.9858,1829.5176,445.9858,1833.5176,455.9858,1837.5176,451.9858,1833.5176" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1833.5176" y2="1833.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1828.7754">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1828.7754">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1862.1729"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1862.1729" y2="1862.1729"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1865.1729" y2="1865.1729"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="314.1934" x="829.7632" y="1851.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="295.9087" x="835.7632" y="1868.0859">Derive HPKE info_hash and store in memory</text><polygon fill="#FF0000" points="1054.3413,1948.0703,1064.3413,1952.0703,1054.3413,1956.0703,1058.3413,1952.0703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1952.0703" y2="1952.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1924.3623">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="491.3486" y="1901.3965">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.6538" x="594.1807" y="1916.707">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.6523" x="635.3135" y="1932.0176">0x0002 (aead_id) | "info_hash" | "enable_access"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2144" x="594.1807" y="1947.3281">Destination: memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1981.3809" y2="1981.3809"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1981.3809" y2="1994.3809"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="1994.3809" y2="1994.3809"/><polygon fill="#FF0000" points="1087.3413,1990.3809,1077.3413,1994.3809,1087.3413,1998.3809,1083.3413,1994.3809" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1976.6387">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1122.7041" y="1976.6387">HMAC384 operation</text><polygon fill="#FF0000" points="455.9858,2019.6914,445.9858,2023.6914,455.9858,2027.6914,451.9858,2023.6914" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2023.6914" y2="2023.6914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2018.9492">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.5112" x="501.3486" y="2018.9492">HMAC384 result info_hash</text><polygon fill="#FF0000" points="455.9858,2049.002,445.9858,2053.002,455.9858,2057.002,451.9858,2053.002" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2053.002" y2="2053.002"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2048.2598">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2048.2598">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2081.6572"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2081.6572" y2="2081.6572"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2084.6572" y2="2084.6572"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="282.9756" x="845.3721" y="2071.002"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.6909" x="851.3721" y="2087.5703">Derive HPKE secret and store in KV slot</text><polygon fill="#FF0000" points="1054.3413,2167.5547,1064.3413,2171.5547,1054.3413,2175.5547,1058.3413,2171.5547" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="2171.5547" y2="2171.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="2143.8467">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="2120.8809">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.6538" x="594.1807" y="2136.1914">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.8154" x="635.3135" y="2151.502">0x0002 (aead_id) | "secret" | "" (no PSK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="2166.8125">Destination Slot: Y)</text><polygon fill="#FF0000" points="1764.9775,2196.8652,1774.9775,2200.8652,1764.9775,2204.8652,1768.9775,2200.8652" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2200.8652" y2="2200.8652"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2196.123">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.6816" x="1122.7041" y="2196.123">Get HPKE shared secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="2230.1758" y2="2230.1758"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="2230.1758" y2="2243.1758"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="2243.1758" y2="2243.1758"/><polygon fill="#FF0000" points="1087.3413,2239.1758,1077.3413,2243.1758,1087.3413,2247.1758,1083.3413,2243.1758" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2225.4336">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="2225.4336">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1764.9775,2268.4863,1774.9775,2272.4863,1764.9775,2276.4863,1768.9775,2272.4863" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2272.4863" y2="2272.4863"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2267.7441">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.4312" x="1122.7041" y="2267.7441">HMAC384 result secret</text><polygon fill="#FF0000" points="455.9858,2297.7969,445.9858,2301.7969,455.9858,2305.7969,451.9858,2301.7969" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2301.7969" y2="2301.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2297.0547">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2297.0547">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2330.4521"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2330.4521" y2="2330.4521"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2333.4521" y2="2333.4521"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="326.8062" x="823.4568" y="2319.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="308.5215" x="829.4568" y="2336.3652">Derive HPKE base_nonce and store in memory</text><polygon fill="#FF0000" points="1054.3413,2431.6602,1064.3413,2435.6602,1054.3413,2439.6602,1058.3413,2435.6602" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="2435.6602" y2="2435.6602"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="2400.2969">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="2369.6758">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="456.0474" x="594.1807" y="2384.9863">Data : 0x000C (big-endian 12) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="329.1069" x="635.3135" y="2400.2969">0x0002 (kdf_id) | 0x0002 (aead_id) | "base_nonce" |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.6201" x="635.3135" y="2415.6074">0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2144" x="594.1807" y="2430.918">Destination: memory)</text><polygon fill="#FF0000" points="1764.9775,2460.9707,1774.9775,2464.9707,1764.9775,2468.9707,1768.9775,2464.9707" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2464.9707" y2="2464.9707"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2460.2285">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9502" x="1122.7041" y="2460.2285">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="2494.2813" y2="2494.2813"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="2494.2813" y2="2507.2813"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="2507.2813" y2="2507.2813"/><polygon fill="#FF0000" points="1087.3413,2503.2813,1077.3413,2507.2813,1087.3413,2511.2813,1083.3413,2507.2813" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2489.5391">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="2489.5391">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="455.9858,2532.5918,445.9858,2536.5918,455.9858,2540.5918,451.9858,2536.5918" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2536.5918" y2="2536.5918"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2531.8496">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.2319" x="501.3486" y="2531.8496">HMAC384 result base_nonce</text><path d="M1081.3413,2549.5918 L1081.3413,2574.5918 L1357.3413,2574.5918 L1357.3413,2559.5918 L1347.3413,2549.5918 L1081.3413,2549.5918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1347.3413,2549.5918 L1347.3413,2559.5918 L1357.3413,2559.5918 L1347.3413,2549.5918 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.7852" x="1087.3413" y="2567.1602">The base_nonce is truncated to 12 bytes</text><polygon fill="#FF0000" points="455.9858,2597.2129,445.9858,2601.2129,455.9858,2605.2129,451.9858,2601.2129" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2601.2129" y2="2601.2129"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2596.4707">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2596.4707">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2629.8682"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2629.8682" y2="2629.8682"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2632.8682" y2="2632.8682"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="265.7163" x="854.0017" y="2619.2129"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="247.4316" x="860.0017" y="2635.7813">Derive HPKE key and store in KV slot</text><polygon fill="#FF0000" points="1054.3413,2731.0762,1064.3413,2735.0762,1054.3413,2739.0762,1058.3413,2735.0762" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="2735.0762" y2="2735.0762"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="2699.7129">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="2669.0918">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="455.2729" x="594.1807" y="2684.4023">Data : 0x0020 (big-endian 32) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.9863" x="635.3135" y="2699.7129">0x0002 (kdf_id) | 0x0002 (aead_id) | "key" |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.6201" x="635.3135" y="2715.0234">0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="2730.334">Destination Slot: Y)</text><polygon fill="#FF0000" points="1764.9775,2760.3867,1774.9775,2764.3867,1764.9775,2768.3867,1768.9775,2764.3867" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2764.3867" y2="2764.3867"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2759.6445">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9502" x="1122.7041" y="2759.6445">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="2793.6973" y2="2793.6973"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="2793.6973" y2="2806.6973"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="2806.6973" y2="2806.6973"/><polygon fill="#FF0000" points="1087.3413,2802.6973,1077.3413,2806.6973,1087.3413,2810.6973,1083.3413,2806.6973" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2788.9551">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="2788.9551">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1764.9775,2832.0078,1774.9775,2836.0078,1764.9775,2840.0078,1768.9775,2836.0078" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2836.0078" y2="2836.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2831.2656">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1113" x="1122.7041" y="2831.2656">HMAC384 result key</text><path d="M1081.3413,2849.0078 L1081.3413,2874.0078 L1513.3413,2874.0078 L1513.3413,2859.0078 L1503.3413,2849.0078 L1081.3413,2849.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1503.3413,2849.0078 L1503.3413,2859.0078 L1513.3413,2859.0078 L1503.3413,2849.0078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3599" x="1087.3413" y="2866.5762">The key is truncated to 32 bytes for use as an AES-256-GCM key</text><polygon fill="#FF0000" points="455.9858,2896.6289,445.9858,2900.6289,455.9858,2904.6289,451.9858,2900.6289" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2900.6289" y2="2900.6289"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2895.8867">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2895.8867">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2929.2842"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2929.2842" y2="2929.2842"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2932.2842" y2="2932.2842"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="283.2612" x="845.2292" y="2918.6289"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.9766" x="851.2292" y="2935.1973">Decrypt access key and store in KV Slot</text><polygon fill="#FF0000" points="1054.3413,3045.8027,1064.3413,3049.8027,1054.3413,3053.8027,1058.3413,3049.8027" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3049.8027" y2="3049.8027"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3006.7842">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3296" x="491.3486" y="2968.5078">AES-256-GCM(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4512" x="540.708" y="2983.8184">IV : base_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.8018" x="540.708" y="2999.1289">Ciphertext : encrypted_access_key_ciphertext,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.7817" x="540.708" y="3014.4395">Tag : encrypted_access_key_tag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8408" x="540.708" y="3029.75">AAD : "",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="540.708" y="3045.0605">Destination : Slot Z)</text><polygon fill="#FF0000" points="1764.9775,3075.1133,1774.9775,3079.1133,1764.9775,3083.1133,1768.9775,3079.1133" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="3079.1133" y2="3079.1133"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3074.3711">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.6304" x="1122.7041" y="3074.3711">Get HPKE key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3108.4238" y2="3108.4238"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3108.4238" y2="3121.4238"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3121.4238" y2="3121.4238"/><polygon fill="#FF0000" points="1087.3413,3117.4238,1077.3413,3121.4238,1087.3413,3125.4238,1083.3413,3121.4238" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3103.6816">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.5127" x="1122.7041" y="3103.6816">AES-256-GCM decrypt access key</text><polygon fill="#FF0000" points="1871.7197,3146.7344,1881.7197,3150.7344,1871.7197,3154.7344,1875.7197,3150.7344" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3150.7344" y2="3150.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3145.9922">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.9683" x="1122.7041" y="3145.9922">Put access key</text><polygon fill="#FF0000" points="455.9858,3176.0449,445.9858,3180.0449,455.9858,3184.0449,451.9858,3180.0449" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3180.0449" y2="3180.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3175.3027">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="3175.3027">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="3222.7002"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3222.7002" y2="3222.7002"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3225.7002" y2="3225.7002"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="192.0073" x="890.8562" y="3212.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="173.7227" x="896.8562" y="3228.6133">Create the Encryption Key</text><polygon fill="#FF0000" points="1054.3413,3293.2871,1064.3413,3297.2871,1054.3413,3301.2871,1058.3413,3297.2871" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3297.2871" y2="3297.2871"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3277.2344">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="491.3486" y="3261.9238">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="594.1807" y="3277.2344">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="3292.5449">Destination Slot: Y)</text><polygon fill="#FF0000" points="1331.3872,3322.5977,1341.3872,3326.5977,1331.3872,3330.5977,1335.3872,3326.5977" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1337.3872" y1="3326.5977" y2="3326.5977"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3321.8555">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1152" x="1122.7041" y="3321.8555">Get FEK</text><polygon fill="#FF0000" points="1871.7197,3351.9082,1881.7197,3355.9082,1871.7197,3359.9082,1875.7197,3355.9082" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3355.9082" y2="3355.9082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3351.166">[055]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.0308" x="1122.7041" y="3351.166">Get Access Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3385.2188" y2="3385.2188"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3385.2188" y2="3398.2188"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3398.2188" y2="3398.2188"/><polygon fill="#FF0000" points="1087.3413,3394.2188,1077.3413,3398.2188,1087.3413,3402.2188,1083.3413,3398.2188" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3380.4766">[056]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.6875" x="1122.7041" y="3380.4766">HMAC512 Slot A with Slot Z</text><polygon fill="#FF0000" points="1764.9775,3423.5293,1774.9775,3427.5293,1764.9775,3431.5293,1768.9775,3427.5293" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="3427.5293" y2="3427.5293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3422.7871">[057]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.7275" x="1122.7041" y="3422.7871">HMAC512 result locked PMEK encryption key</text><polygon fill="#FF0000" points="455.9858,3452.8398,445.9858,3456.8398,455.9858,3460.8398,451.9858,3456.8398" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3456.8398" y2="3456.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3452.0977">[058]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="3452.0977">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="3485.4951"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3485.4951" y2="3485.4951"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3488.4951" y2="3488.4951"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="337.9209" x="817.8994" y="3474.8398"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="319.6362" x="823.8994" y="3491.4082">Decrypt PMEK with locked PMEK encryption key</text><polygon fill="#FF0000" points="1054.3413,3556.082,1064.3413,3560.082,1054.3413,3564.082,1058.3413,3560.082" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3560.082" y2="3560.082"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3540.0293">[059]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.7944" x="491.3486" y="3524.7188">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.269" x="540.708" y="3540.0293">Data: locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.4067" x="540.708" y="3555.3398">Destination :  Slot Z)</text><polygon fill="#FF0000" points="1764.9775,3585.3926,1774.9775,3589.3926,1764.9775,3593.3926,1768.9775,3589.3926" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="3589.3926" y2="3589.3926"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3584.6504">[060]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.8618" x="1122.7041" y="3584.6504">Get locked PMEK encryption key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3618.7031" y2="3618.7031"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3618.7031" y2="3631.7031"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3631.7031" y2="3631.7031"/><polygon fill="#FF0000" points="1087.3413,3627.7031,1077.3413,3631.7031,1087.3413,3635.7031,1083.3413,3631.7031" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3613.9609">[061]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9922" x="1122.7041" y="3613.9609">Decrypt locked_pmek</text><polygon fill="#FF0000" points="1871.7197,3657.0137,1881.7197,3661.0137,1871.7197,3665.0137,1875.7197,3661.0137" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3661.0137" y2="3661.0137"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3656.2715">[062]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.9155" x="1122.7041" y="3656.2715">PMEK</text><polygon fill="#FF0000" points="455.9858,3686.3242,445.9858,3690.3242,455.9858,3694.3242,451.9858,3690.3242" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3690.3242" y2="3690.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3685.582">[063]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="3685.582">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="3718.9795"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3718.9795" y2="3718.9795"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3721.9795" y2="3721.9795"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="334.0488" x="819.8354" y="3708.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="315.7642" x="825.8354" y="3724.8926">Encrypt PMEK with Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="1054.3413,3789.5664,1064.3413,3793.5664,1054.3413,3797.5664,1058.3413,3793.5664" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3793.5664" y2="3793.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3773.5137">[064]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.0884" x="491.3486" y="3758.2031">Wrap(Key: Slot B,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="528.3682" y="3773.5137">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.0898" x="528.3682" y="3788.8242">Destination : ready_pmek)</text><polygon fill="#FF0000" points="1484.9351,3818.877,1494.9351,3822.877,1484.9351,3826.877,1488.9351,3822.877" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1490.9351" y1="3822.877" y2="3822.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3818.1348">[065]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.7451" x="1122.7041" y="3818.1348">Get Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="1871.7197,3848.1875,1881.7197,3852.1875,1871.7197,3856.1875,1875.7197,3852.1875" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3852.1875" y2="3852.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3847.4453">[066]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.5283" x="1122.7041" y="3847.4453">Get PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3881.498" y2="3881.498"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3881.498" y2="3894.498"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3894.498" y2="3894.498"/><polygon fill="#FF0000" points="1087.3413,3890.498,1077.3413,3894.498,1087.3413,3898.498,1083.3413,3894.498" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3876.7559">[067]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.2964" x="1122.7041" y="3876.7559">Encrypt slot Z using Slot B</text><polygon fill="#FF0000" points="455.9858,3919.8086,445.9858,3923.8086,455.9858,3927.8086,451.9858,3923.8086" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3923.8086" y2="3923.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3919.0664">[068]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.645" x="501.3486" y="3919.0664">Ready PMEK</text><polygon fill="#FF0000" points="1054.3413,3964.4297,1064.3413,3968.4297,1054.3413,3972.4297,1058.3413,3968.4297" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3968.4297" y2="3968.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3956.0322">[069]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.9629" x="491.3486" y="3948.377">Purge_key(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="557.1611" y="3963.6875">Key : Slot Z)</text><polygon fill="#FF0000" points="1764.9775,3993.7402,1774.9775,3997.7402,1764.9775,4001.7402,1768.9775,3997.7402" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="3997.7402" y2="3997.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3992.998">[070]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="1122.7041" y="3992.998">Purge</text><polygon fill="#FF0000" points="1871.7197,3993.7402,1881.7197,3997.7402,1871.7197,4001.7402,1875.7197,3997.7402" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3997.7402" y2="3997.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3992.998">[071]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1122.7041" y="3992.998">&#160;</text><polygon fill="#FF0000" points="455.9858,4023.0508,445.9858,4027.0508,455.9858,4031.0508,451.9858,4027.0508" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="4027.0508" y2="4027.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="4022.3086">[072]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="4022.3086">done</text><polygon fill="#FF0000" points="256.5332,4067.6719,246.5332,4071.6719,256.5332,4075.6719,252.5332,4071.6719" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="250.5332" x2="433.9858" y1="4071.6719" y2="4071.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="262.5332" y="4059.2744">[073]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="301.896" y="4051.6191">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0317" x="301.896" y="4066.9297">Ready_PMEK</text><line style="stroke:#008000;stroke-width:1;" x1="100.6826" x2="110.6826" y1="4071.6719" y2="4067.6719"/><line style="stroke:#008000;stroke-width:1;" x1="100.6826" x2="110.6826" y1="4071.6719" y2="4075.6719"/><line style="stroke:#008000;stroke-width:1;" x1="99.6826" x2="244.5332" y1="4071.6719" y2="4071.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="116.6826" y="4059.2744">[074]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="156.0454" y="4051.6191">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="156.0454" y="4066.9297">complete</text><path d="M250.5332,4112.6719 L250.5332,4187.6719 L811.5332,4187.6719 L811.5332,4122.6719 L801.5332,4112.6719 L250.5332,4112.6719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M801.5332,4112.6719 L801.5332,4122.6719 L811.5332,4122.6719 L801.5332,4112.6719 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="256.5332" y="4132.2402">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="260.6465" y="4132.2402">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="345.248" y="4132.2402">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="349.3613" y="4132.2402">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="449.9907" y="4132.2402">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="454.104" y="4132.2402">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="260.6465" y="4147.5508">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="349.3613" y="4147.5508">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="454.104" y="4147.5508">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="260.6465" y="4162.8613">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="349.3613" y="4162.8613">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="454.104" y="4162.8613">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.375" x="260.6465" y="4178.1719">ready_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="349.3613" y="4178.1719">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303.4814" x="454.104" y="4178.1719">PMEK encrypted to a key that is rotated on reset</text><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4119.6719" y2="4119.6719"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4134.9824" y2="4134.9824"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4150.293" y2="4150.293"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4165.6035" y2="4165.6035"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4180.9141" y2="4180.9141"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="256.5332" y1="4119.6719" y2="4180.9141"/><line style="stroke:#000000;stroke-width:0.5;" x1="345.248" x2="345.248" y1="4119.6719" y2="4180.9141"/><line style="stroke:#000000;stroke-width:0.5;" x1="449.9907" x2="449.9907" y1="4119.6719" y2="4180.9141"/><line style="stroke:#000000;stroke-width:0.5;" x1="796.6426" x2="796.6426" y1="4119.6719" y2="4180.9141"/><!--SRC=[tLh_Rzh84l-TlsA2gXDS8HUIzgalQlf4WJGHh-zGI7jg5GaPUm0BVvDt8UMKF_vcTWrU6vkIA6tHyo-OtPdPsPdFp8vtzyWDR6_X88HsDF92UpvQIDSJnzHSgLIEt0dKNeXPU3-IhlImNW5wRlaLgZTeEIiOVEprgvKZ31ntac68OhJ3mD4iGIWHB3iEXL3_-NaxVZVGDAvqmq2Sl_rZ_6xJ-pkqRHk5WE7CYj618TenIh2yM0rhBItN6vCQRW0M22-K_DR_RF2d-a4liEDLnAD07rSR8Icl5JWmnG1ZIz9OH8QMFOCO1SfKtqaOIB13BumlIADtrmBa36Da6HXPp9fJDi8OsevFmtmI6F_dxHyiGK-HxAMCih7S1ESlNyABzvykBtitetRdzlfp-_Rwp_zLvkXFYtiY7-UYkAiokOSNbbW5DlXZ8Zc7crwx-sN4riXuoOfSmqEnEvr9ujZC-O6zTEcYvu3ngDQX-pVccheuSGFbJ7WmHDYpkLZu05aHYxFJVDD_NSd8OejOMH7tiHL5w8miXOdHd9n8hN_fLWqKTkm3z7iVcmanQ68WuhlWT_hnHpFoiuVqZ_zOtZICNJdpa_-s6v4x9NwJJ8uQClan3PquMgYRlM3CeRVc6oJj3ng26taWGyODN58ZmuxVKqsJ4RRWuO_N_hGdzygXdT3tYJ_ZJLzCHuH4uGPJxLMRSP30W7W-80DOyt6tFsusrSiBWTwaLYNoQWEgNPGO4snnJLojaoAUm9GfqIkLJs_da3AgQ0Wde0Cj4ICg5SkJQkRupHLIvm9kkZ79DFCOlV2Uh4D1E0izckVQnXSND8vjHMBXCLtgDcLE1vMTysQzk4W5y83iSDU12pZvTdBIQa6jUqNGgGsQPszUDU2gtxri3g_QzATUhvWWJISyNxvyUGwzJlUgHfmmiDoOB9oY36eVwesxm6HcEaDTJMt2pYJkef1kOAbeEWSV_J1UPNMPBzUgK8hGpkKHA10YKgQ4TAbrLfITL9Tx2eJTdCh1WuNKx48dEg4INOR1WACJ1fXLEI-nsQIvCLbMn0PhMRu4h2cPZetT_kcCo323nPWcL-wevp6iWx6xH6sWQ37sN9Qm-euvMH4YFY0R6ai1YT-ISKkH5J1cXCH8SD0YJEBGXvlB3loxzUQamR1Gk7rrt6heO8N98b1j6N6RD9TfLG6kB7arwFSW4hXmmcPCpg91E9XzYllOjJoe3MxwzKni5s7WwcExGv5SunNY7D2Fv2eNc9c7oRgMj8YsoWeqbwqgPV4gGO1_rmb3Pv0wFDm5LTZtGGkfC9gpdEqmsg6JcGo6LB2SmvTwEGwJ2KCOSK6JD_g6L98fLYar9Te5PKOoQOPSKHLN6OS3sHnaCcPz93xOlF1b5q0IS30GpawWDdQdpQHaUVMcpaZPGiqEOUcp1IoewdcCz3nON7R1e8Qz92SfHeENHk3b3SPSlq2myCSOrvy5UWcUE5qgB-IHL8XHLNv_qUkFGuPz35GFQ14oCjgJ2uq6p9r9IdnogZsrxc-0HLLIjh_T6pPFN_-h-Q7piVvZShY0rySjLLczFZvjS78SsZDq5Xw-jmIgZWvzrP2ic-C_8mmsYLwmbo8MiaHlzPIqFwUvqXejPceK8SDOVUxfKkYvitvHnkVtmfI_iRzsM7tVG5op9OvKCMxCKmrQXLeGmc3OX-lkld7vlVfm_pL1bIMvC3CqFDoKxmQJyFyVB9jPgY4niCOU9X-erVsmycEXij7lW6k3P2F9H4d_irw7Vb2byFDnabOCQJxvCOjy-Hhy_ClzeNrivf0rfWLn58I1ZS-GWnvLXfvqCcLewtIh32r7tQCmbaAp27Mf0QgF4Knb3flF3nraCUR2_v1cb6T9RrleVLRO5cN4r2PbzTbyMLYU6MXo1SYOoYehsJvidS9u9L4K5rK76n_ywVupqovZwpJxWNRsYoA3flxBGkAn2VqdPFByhjZteu6nam-3ioGCO1B6iE2F4K7u0kERQ6kWGmqIlMTjx5VdusIuJvmOCzyLAzUVgITDBxdUZhb1NNGAOcn0v5XlhMaPZxIcEU9skykbKRMnQzjRwVzrJ-IMxhKoR4rKE5lsBX_WRxrBMqAgA0vmSwnmEuAGrecHpqpuS2Ht9cfYgoZ_lcwTZjWRmaHM-xjPs23- -jHqjJ7E1EVQtPUzVgNCMzoV71tt3MzjvJ2QK389dSEqZfLT6OnPaWoc3_yoHtkikucFdKxVxV1jPsSSdKyZHWfH2gdvb6kuqzUV0Zu-tPK-sA_dvkddhW3UYk2YwDt3c1dthIThw50A1tNY_KjSaWIOuPBo6mcxFF9Nue_47UzDT-oAiQmZr46iCbM1BzHD0ksBKXrt1bp6ojd3niGAgbpuIikq6qoJYJpHBQc6JtLEtiA3HJn5NgOCCnSLcAQXon0DHqUGIDnG_9Qp6T7y0aZcxW9qreVjAA8m47WNACEECeRz3TAB1zbx1tU17VgHXqajnGiDvcuZFEfkIVvEoRuNIl8NINRT8fcuaHW9QSc5AE2x9WQkBGNG57Y5N5z7eBhpydem12kAud39zuDYhZCnZkd5b9_6sFPDaA9h89RAnd9cIHuZ3kNwzf6wU5Ho5KH1eV8F]--></g></svg>