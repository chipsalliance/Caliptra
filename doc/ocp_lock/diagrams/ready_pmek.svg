<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4309px" preserveAspectRatio="none" style="width:2032px;height:4309px;background:#FFFFFF;" version="1.1" viewBox="0 0 2032 4309" width="2032px" zoomAndPan="magnify"><title>Ready PMEK</title><defs/><g><rect fill="#DDDDDD" height="4229.8906" style="stroke:#181818;stroke-width:0.5;" width="1735.3335" x="205.7573" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="1047.0273" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1978.6943" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="87.7871" x="999.4663" y="41.3125">Ready PMEK</text><g><title>Storage</title><rect fill="transparent" height="4075.6504" width="8" x="91.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="94.6826" x2="94.6826" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#FFFFFF" height="131.2422" style="stroke:#181818;stroke-width:1;" width="10" x="89.6826" y="4084.4492"/></g><g><title>Mail Box</title><rect fill="transparent" height="4075.6504" width="8" x="242.0332" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="245.5332" x2="245.5332" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#FFFFFF" height="205.1055" style="stroke:#181818;stroke-width:1;" width="10" x="240.5332" y="250.5938"/></g><g><title>FW</title><rect fill="transparent" height="4075.6504" width="8" x="436.4858" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="439.9858" x2="439.9858" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#FFFFFF" height="3784.3027" style="stroke:#181818;stroke-width:1;" width="10" x="434.9858" y="426.3887"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1067.8413" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1071.3413" x2="1071.3413" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="737.4941"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="897.0469"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1181.1523"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1415.9473"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1745.3633"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="1964.8477"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="2184.332"/></g><g><title/><rect fill="#FFFFFF" height="165.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="2448.4375"/></g><g><title/><rect fill="#FFFFFF" height="165.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="2747.8535"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3062.5801"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3310.0645"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3572.8594"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3806.3438"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1066.3413" y="3981.207"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1344.8872" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1348.3872" x2="1348.3872" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#ADD8E6" height="3986.4082" style="stroke:#181818;stroke-width:1;" width="10" x="1343.3872" y="229.2832"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1498.4351" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1501.9351" x2="1501.9351" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#ADD8E6" height="3986.4082" style="stroke:#181818;stroke-width:1;" width="10" x="1496.9351" y="229.2832"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1666.6597" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1670.1597" x2="1670.1597" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#ADD8E6" height="3986.4082" style="stroke:#181818;stroke-width:1;" width="10" x="1665.1597" y="229.2832"/></g><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1778.4775" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1781.9775" x2="1781.9775" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#ADD8E6" height="2757.7441" style="stroke:#181818;stroke-width:1;" width="10" x="1776.9775" y="1252.7734"/></g><line style="stroke:#181818;stroke-width:2;" x1="1772.9775" x2="1790.9775" y1="4001.5176" y2="4019.5176"/><line style="stroke:#181818;stroke-width:2;" x1="1772.9775" x2="1790.9775" y1="4019.5176" y2="4001.5176"/><g><title>Key Vault</title><rect fill="transparent" height="4075.6504" width="8" x="1885.2197" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1888.7197" x2="1888.7197" y1="140.041" y2="4215.6914"/></g><g><title/><rect fill="#ADD8E6" height="847.0059" style="stroke:#181818;stroke-width:1;" width="10" x="1883.7197" y="3163.5117"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="62" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="69" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="72.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="84.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="209.7573" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="216.7573" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="423.2446" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="430.2446" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1032.5713" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1039.5713" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1309.6172" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1316.6172" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1328.6313" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1331.7178" y="129.0879">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1397.1572" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1470.165" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1482.9824" y="112.5996">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1404.1572" y="129.0879">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1616.7129" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1638.3896" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1650.1748" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1623.7129" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1733.6064" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1750.2075" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1762.6899" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1740.6064" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1840.3486" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1856.9497" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1869.562" y="112.5996">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1847.3486" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="62" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="69" y="4236.2266">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="72.4077" y="4252.7148">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="84.9414" y="4269.2031">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="209.7573" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="216.7573" y="4236.2266">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="423.2446" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="430.2446" y="4236.2266">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1032.5713" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1039.5713" y="4236.2266">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1309.6172" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1316.6172" y="4236.2266">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1328.6313" y="4252.7148">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1331.7178" y="4269.2031">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1397.1572" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1470.165" y="4236.2266">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1482.9824" y="4252.7148">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1404.1572" y="4269.2031">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1616.7129" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1638.3896" y="4236.2266">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1650.1748" y="4252.7148">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1623.7129" y="4269.2031">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1733.6064" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1750.2075" y="4236.2266">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1762.6899" y="4252.7148">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1740.6064" y="4269.2031">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1840.3486" y="4215.6914"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1856.9497" y="4236.2266">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1869.562" y="4252.7148">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1847.3486" y="4269.2031">(Temporary)</text><path d="M59.1558,153.041 L59.1558,224.041 L1924.1558,224.041 L1924.1558,163.041 L1914.1558,153.041 L59.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1914.1558,153.041 L1914.1558,163.041 L1924.1558,163.041 L1914.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="750.4956" y="170.6094">Preconditions:</text><ellipse cx="755.9956" cy="181.1621" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.6094" x="762.4956" y="185.9199">Access Shared Secret already availble in a slot in KV</text><ellipse cx="755.9956" cy="196.4727" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="461.4111" x="762.4956" y="201.2305">Ready PMEK Encryption Key already in a slot and generated on each reset</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313.8853" x="750.4956" y="216.541">Is there a separate Shared Secret per Admin User?</text><line style="stroke:#008000;stroke-width:1;" x1="238.5332" x2="228.5332" y1="250.5938" y2="246.5938"/><line style="stroke:#008000;stroke-width:1;" x1="238.5332" x2="228.5332" y1="250.5938" y2="254.5938"/><line style="stroke:#008000;stroke-width:1;" x1="94.6826" x2="239.5332" y1="250.5938" y2="250.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="101.6826" y="245.8516">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.4878" x="141.0454" y="245.8516">READY_PMEK</text><path d="M255.5332,263.5938 L255.5332,399.5938 L846.5332,399.5938 L846.5332,273.5938 L836.5332,263.5938 L255.5332,263.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M836.5332,263.5938 L836.5332,273.5938 L846.5332,273.5938 L836.5332,263.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="261.5332" y="283.1621">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="265.6465" y="283.1621">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="403.8032" y="283.1621">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="407.9165" y="283.1621">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="532.7432" y="283.1621">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="536.8564" y="283.1621">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="265.6465" y="298.4727">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="407.9165" y="298.4727">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="536.8564" y="298.4727">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.9302" x="265.6465" y="313.7832">wrapped_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="407.9165" y="313.7832">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="536.8564" y="313.7832">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="86.3535" x="532.7432" y="329.0938">* kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.915" x="532.7432" y="344.4043">*kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.9111" x="532.7432" y="359.7148">*kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="532.7432" y="375.0254">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.0845" x="265.6465" y="390.3359">locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="407.9165" y="390.3359">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.1226" x="536.8564" y="390.3359">PMEK encrypted to the FEK and the access key</text><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="270.5938" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="285.9043" y2="285.9043"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="301.2148" y2="301.2148"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="377.7676" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="832.0923" y1="393.0781" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="261.5332" x2="261.5332" y1="270.5938" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="403.8032" x2="403.8032" y1="270.5938" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="532.7432" x2="532.7432" y1="270.5938" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="832.0923" x2="832.0923" y1="270.5938" y2="393.0781"/><line style="stroke:#008000;stroke-width:1;" x1="432.9858" x2="422.9858" y1="426.3887" y2="422.3887"/><line style="stroke:#008000;stroke-width:1;" x1="432.9858" x2="422.9858" y1="426.3887" y2="430.3887"/><line style="stroke:#008000;stroke-width:1;" x1="250.5332" x2="433.9858" y1="426.3887" y2="426.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="257.5332" y="421.6465">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="296.896" y="421.6465">Command</text><polygon fill="#FF0000" points="261.5332,451.6992,251.5332,455.6992,261.5332,459.6992,257.5332,455.6992" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="255.5332" x2="433.9858" y1="455.6992" y2="455.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="267.5332" y="450.957">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="306.896" y="450.957">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="486.9858" y1="485.0098" y2="485.0098"/><line style="stroke:#FF0000;stroke-width:1;" x1="486.9858" x2="486.9858" y1="485.0098" y2="498.0098"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.9858" x2="486.9858" y1="498.0098" y2="498.0098"/><polygon fill="#FF0000" points="455.9858,494.0098,445.9858,498.0098,455.9858,502.0098,451.9858,498.0098" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="480.2676">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="491.3486" y="480.2676">Determine command</text><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="486.9858" y1="527.3203" y2="527.3203"/><line style="stroke:#FF0000;stroke-width:1;" x1="486.9858" x2="486.9858" y1="527.3203" y2="540.3203"/><line style="stroke:#FF0000;stroke-width:1;" x1="445.9858" x2="486.9858" y1="540.3203" y2="540.3203"/><polygon fill="#FF0000" points="455.9858,536.3203,445.9858,540.3203,455.9858,544.3203,451.9858,540.3203" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="522.5781">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.1201" x="491.3486" y="522.5781">Determine rate of ready commands</text><path d="M8,552.3203 L70.1387,552.3203 L70.1387,559.6309 L60.1387,569.6309 L8,569.6309 L8,552.3203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="3554.1289" style="stroke:#000000;stroke-width:1.5;" width="1951.7197" x="8" y="552.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="565.8887">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65.9302" x="85.1387" y="564.9551">[FEK exists]</text><path d="M27,583.6309 L89.1387,583.6309 L89.1387,590.9414 L79.1387,600.9414 L27,600.9414 L27,583.6309 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="3508.8184" style="stroke:#000000;stroke-width:1.5;" width="1907.7197" x="27" y="583.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="42" y="597.1992">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="222.7124" x="104.1387" y="596.2656">[Ready command rate below threshold]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="631.5967"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="631.5967" y2="631.5967"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="634.5967" y2="634.5967"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="357.3574" x="808.1812" y="620.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="339.0728" x="814.1812" y="637.5098">Decapsulate ciphertext and decrypt the access key</text><path d="M46,658.252 L108.1387,658.252 L108.1387,665.5625 L98.1387,675.5625 L46,675.5625 L46,658.252 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="895.9375" style="stroke:#000000;stroke-width:1.5;" width="1756.9775" x="46" y="658.252"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="61" y="671.8203">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="294.0889" x="123.1387" y="670.8867">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384))]</text><polygon fill="#FF0000" points="1054.3413,733.4941,1064.3413,737.4941,1054.3413,741.4941,1058.3413,737.4941" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="737.4941" y2="737.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="717.4414">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2349" x="491.3486" y="702.1309">ECDH(KEM Pair : kem_handle (G),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.9976" x="540.708" y="717.4414">KEM ciphertext : kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3276" x="540.708" y="732.752">Destination : memory)</text><polygon fill="#FF0000" points="1653.1597,762.8047,1663.1597,766.8047,1653.1597,770.8047,1657.1597,766.8047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1659.1597" y1="766.8047" y2="766.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="762.0625">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="1122.7041" y="762.0625">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="796.1152" y2="796.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="796.1152" y2="809.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="809.1152" y2="809.1152"/><polygon fill="#FF0000" points="1087.3413,805.1152,1077.3413,809.1152,1087.3413,813.1152,1083.3413,809.1152" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="791.373">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.6831" x="1122.7041" y="791.373">ECDH KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="455.9858,834.4258,445.9858,838.4258,455.9858,842.4258,451.9858,838.4258" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="838.4258" y2="838.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="833.6836">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.3574" x="501.3486" y="833.6836">Put ECDH shared secret</text><polygon fill="#FF0000" points="455.9858,863.7363,445.9858,867.7363,455.9858,871.7363,451.9858,867.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="867.7363" y2="867.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="862.9941">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="862.9941">done</text><polygon fill="#FF0000" points="1054.3413,893.0469,1064.3413,897.0469,1054.3413,901.0469,1058.3413,897.0469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="897.0469" y2="897.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="892.3047">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.0098" x="491.3486" y="892.3047">ECC_GetPubKey(KEM Pair : kem_handle (G))</text><polygon fill="#FF0000" points="1653.1597,922.3574,1663.1597,926.3574,1653.1597,930.3574,1657.1597,926.3574" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1659.1597" y1="926.3574" y2="926.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="921.6152">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="1122.7041" y="921.6152">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="955.668" y2="955.668"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="955.668" y2="968.668"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="968.668" y2="968.668"/><polygon fill="#FF0000" points="1087.3413,964.668,1077.3413,968.668,1087.3413,972.668,1083.3413,968.668" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="950.9258">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.3833" x="1122.7041" y="950.9258">derive ECDH public key</text><polygon fill="#FF0000" points="455.9858,993.9785,445.9858,997.9785,455.9858,1001.9785,451.9858,997.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="997.9785" y2="997.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="993.2363">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.1387" x="501.3486" y="993.2363">Put kem_pub</text><polygon fill="#FF0000" points="455.9858,1023.2891,445.9858,1027.2891,455.9858,1031.2891,451.9858,1027.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1027.2891" y2="1027.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1022.5469">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1022.5469">done</text><path d="M449.9858,1040.2891 L449.9858,1065.2891 L882.9858,1065.2891 L882.9858,1050.2891 L872.9858,1040.2891 L449.9858,1040.2891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M872.9858,1040.2891 L872.9858,1050.2891 L882.9858,1050.2891 L872.9858,1040.2891 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412.8896" x="455.9858" y="1057.8574">The next steps come from RFC 9180, section 4.1, Decap function</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1091.2549"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1091.2549" y2="1091.2549"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1094.2549" y2="1094.2549"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="341.5771" x="816.0713" y="1080.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="323.2925" x="822.0713" y="1097.168">Derive HPKE pseudo-random key material (PRK)</text><polygon fill="#FF0000" points="1054.3413,1177.1523,1064.3413,1181.1523,1054.3413,1185.1523,1058.3413,1181.1523" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1181.1523" y2="1181.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1153.4443">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="491.3486" y="1130.4785">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="311.0225" x="594.1807" y="1145.7891">Key Data : "HPKE-v1" | "KEM" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="364.8315" x="491.3486" y="1161.0996">"                                         eae_prk" | ECDH shared secret</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="1176.4102">Destination Slot: Y)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1210.4629" y2="1210.4629"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1210.4629" y2="1223.4629"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="1223.4629" y2="1223.4629"/><polygon fill="#FF0000" points="1087.3413,1219.4629,1077.3413,1223.4629,1087.3413,1227.4629,1083.3413,1223.4629" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1205.7207">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1122.7041" y="1205.7207">HMAC384 operation</text><polygon fill="#FF0000" points="1764.9775,1248.7734,1774.9775,1252.7734,1764.9775,1256.7734,1768.9775,1252.7734" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="1252.7734" y2="1252.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1248.0313">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.3711" x="1122.7041" y="1248.0313">HMAC384 result PRK</text><polygon fill="#FF0000" points="455.9858,1278.084,445.9858,1282.084,455.9858,1286.084,451.9858,1282.084" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1282.084" y2="1282.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1277.3418">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1277.3418">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1310.7393"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1310.7393" y2="1310.7393"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1313.7393" y2="1313.7393"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="196.0381" x="888.8408" y="1300.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="177.7534" x="894.8408" y="1316.6523">Derive HPKE shared secret</text><polygon fill="#FF0000" points="1054.3413,1411.9473,1064.3413,1415.9473,1054.3413,1419.9473,1058.3413,1415.9473" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1415.9473" y2="1415.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1380.584">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="1349.9629">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="320.6201" x="594.1807" y="1365.2734">Data : 0x0030 (big-endian 48) | "HPKE-v1" | "KEM"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336.6226" x="635.3135" y="1380.584">0x0011 (kem_id) | "shared_secret" | kem_ciphertext |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.3662" x="635.3135" y="1395.8945">kem_pub | 0x01 (HKDF block number)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="1411.2051">Destination Slot: Y)</text><polygon fill="#FF0000" points="1764.9775,1441.2578,1774.9775,1445.2578,1764.9775,1449.2578,1768.9775,1445.2578" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="1445.2578" y2="1445.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1440.5156">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.8901" x="1122.7041" y="1440.5156">Get HPKE PRK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1474.5684" y2="1474.5684"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1474.5684" y2="1487.5684"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="1487.5684" y2="1487.5684"/><polygon fill="#FF0000" points="1087.3413,1483.5684,1077.3413,1487.5684,1087.3413,1491.5684,1083.3413,1487.5684" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1469.8262">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="1469.8262">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1764.9775,1512.8789,1774.9775,1516.8789,1764.9775,1520.8789,1768.9775,1516.8789" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="1516.8789" y2="1516.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1512.1367">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.1626" x="1122.7041" y="1512.1367">HMAC384 result shared secret</text><polygon fill="#FF0000" points="455.9858,1542.1895,445.9858,1546.1895,455.9858,1550.1895,451.9858,1546.1895" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1546.1895" y2="1546.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1541.4473">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1541.4473">done</text><path d="M46,1572.1895 L108.1387,1572.1895 L108.1387,1579.5 L98.1387,1589.5 L46,1589.5 L46,1572.1895 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="1628.6328" style="stroke:#000000;stroke-width:1.5;" width="1863.7197" x="46" y="1572.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="61" y="1585.7578">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="692.1299" x="123.1387" y="1584.8242">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384)), kdf_id = 0x0002 (HKDF-SHA384), aead_id = 0x0002 (AES-256-GCM)]</text><path d="M449.9858,1604.5 L449.9858,1629.5 L1222.9858,1629.5 L1222.9858,1614.5 L1212.9858,1604.5 L449.9858,1604.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1212.9858,1604.5 L1212.9858,1614.5 L1222.9858,1614.5 L1212.9858,1604.5 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="752.7178" x="455.9858" y="1622.0684">The next steps come from RFC 9180, sections 5.1 and 5.2, KeyScheduleBase and ContextR.Open functions respectively</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1655.4658"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1655.4658" y2="1655.4658"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1658.4658" y2="1658.4658"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="331.2686" x="821.2256" y="1644.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312.9839" x="827.2256" y="1661.3789">Derive HPKE psk_id_hash and store in memory</text><polygon fill="#FF0000" points="1054.3413,1741.3633,1064.3413,1745.3633,1054.3413,1749.3633,1058.3413,1745.3633" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1745.3633" y2="1745.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1717.6553">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="491.3486" y="1694.6895">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.6538" x="594.1807" y="1710">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.7476" x="635.3135" y="1725.3105">0x0002 (aead_id) | "psk_id_hash" | "" (no PSK ID)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3276" x="594.1807" y="1740.6211">Destination : memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1774.6738" y2="1774.6738"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1774.6738" y2="1787.6738"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="1787.6738" y2="1787.6738"/><polygon fill="#FF0000" points="1087.3413,1783.6738,1077.3413,1787.6738,1087.3413,1791.6738,1083.3413,1787.6738" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1769.9316">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1122.7041" y="1769.9316">HMAC384 operation</text><polygon fill="#FF0000" points="455.9858,1812.9844,445.9858,1816.9844,455.9858,1820.9844,451.9858,1816.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1816.9844" y2="1816.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1812.2422">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.7676" x="501.3486" y="1812.2422">HMAC384 result psk_id_hash</text><polygon fill="#FF0000" points="455.9858,1842.2949,445.9858,1846.2949,455.9858,1850.2949,451.9858,1846.2949" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="1846.2949" y2="1846.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="1841.5527">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="1841.5527">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="1874.9502"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1874.9502" y2="1874.9502"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="1877.9502" y2="1877.9502"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="314.1934" x="829.7632" y="1864.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="295.9087" x="835.7632" y="1880.8633">Derive HPKE info_hash and store in memory</text><polygon fill="#FF0000" points="1054.3413,1960.8477,1064.3413,1964.8477,1054.3413,1968.8477,1058.3413,1964.8477" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="1964.8477" y2="1964.8477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="1937.1396">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="491.3486" y="1914.1738">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.6538" x="594.1807" y="1929.4844">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="305.6523" x="635.3135" y="1944.7949">0x0002 (aead_id) | "info_hash" | "enable_access"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2144" x="594.1807" y="1960.1055">Destination: memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="1994.1582" y2="1994.1582"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="1994.1582" y2="2007.1582"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="2007.1582" y2="2007.1582"/><polygon fill="#FF0000" points="1087.3413,2003.1582,1077.3413,2007.1582,1087.3413,2011.1582,1083.3413,2007.1582" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="1989.416">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1122.7041" y="1989.416">HMAC384 operation</text><polygon fill="#FF0000" points="455.9858,2032.4688,445.9858,2036.4688,455.9858,2040.4688,451.9858,2036.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2036.4688" y2="2036.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2031.7266">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.5112" x="501.3486" y="2031.7266">HMAC384 result info_hash</text><polygon fill="#FF0000" points="455.9858,2061.7793,445.9858,2065.7793,455.9858,2069.7793,451.9858,2065.7793" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2065.7793" y2="2065.7793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2061.0371">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2061.0371">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2094.4346"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2094.4346" y2="2094.4346"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2097.4346" y2="2097.4346"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="282.9756" x="845.3721" y="2083.7793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.6909" x="851.3721" y="2100.3477">Derive HPKE secret and store in KV slot</text><polygon fill="#FF0000" points="1054.3413,2180.332,1064.3413,2184.332,1054.3413,2188.332,1058.3413,2184.332" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="2184.332" y2="2184.332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="2156.624">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="2133.6582">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="403.6538" x="594.1807" y="2148.9688">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.8154" x="635.3135" y="2164.2793">0x0002 (aead_id) | "secret" | "" (no PSK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="2179.5898">Destination Slot: Y)</text><polygon fill="#FF0000" points="1764.9775,2209.6426,1774.9775,2213.6426,1764.9775,2217.6426,1768.9775,2213.6426" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2213.6426" y2="2213.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2208.9004">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.6816" x="1122.7041" y="2208.9004">Get HPKE shared secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="2242.9531" y2="2242.9531"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="2242.9531" y2="2255.9531"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="2255.9531" y2="2255.9531"/><polygon fill="#FF0000" points="1087.3413,2251.9531,1077.3413,2255.9531,1087.3413,2259.9531,1083.3413,2255.9531" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2238.2109">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="2238.2109">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1764.9775,2281.2637,1774.9775,2285.2637,1764.9775,2289.2637,1768.9775,2285.2637" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2285.2637" y2="2285.2637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2280.5215">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.4312" x="1122.7041" y="2280.5215">HMAC384 result secret</text><polygon fill="#FF0000" points="455.9858,2310.5742,445.9858,2314.5742,455.9858,2318.5742,451.9858,2314.5742" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2314.5742" y2="2314.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2309.832">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2309.832">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2343.2295"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2343.2295" y2="2343.2295"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2346.2295" y2="2346.2295"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="326.8062" x="823.4568" y="2332.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="308.5215" x="829.4568" y="2349.1426">Derive HPKE base_nonce and store in memory</text><polygon fill="#FF0000" points="1054.3413,2444.4375,1064.3413,2448.4375,1054.3413,2452.4375,1058.3413,2448.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="2448.4375" y2="2448.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="2413.0742">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="2382.4531">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="456.0474" x="594.1807" y="2397.7637">Data : 0x000C (big-endian 12) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="329.1069" x="635.3135" y="2413.0742">0x0002 (kdf_id) | 0x0002 (aead_id) | "base_nonce" |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.6201" x="635.3135" y="2428.3848">0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2144" x="594.1807" y="2443.6953">Destination: memory)</text><polygon fill="#FF0000" points="1764.9775,2473.748,1774.9775,2477.748,1764.9775,2481.748,1768.9775,2477.748" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2477.748" y2="2477.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2473.0059">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9502" x="1122.7041" y="2473.0059">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="2507.0586" y2="2507.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="2507.0586" y2="2520.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="2520.0586" y2="2520.0586"/><polygon fill="#FF0000" points="1087.3413,2516.0586,1077.3413,2520.0586,1087.3413,2524.0586,1083.3413,2520.0586" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2502.3164">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="2502.3164">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="455.9858,2545.3691,445.9858,2549.3691,455.9858,2553.3691,451.9858,2549.3691" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2549.3691" y2="2549.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2544.627">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.2319" x="501.3486" y="2544.627">HMAC384 result base_nonce</text><path d="M1081.3413,2562.3691 L1081.3413,2587.3691 L1357.3413,2587.3691 L1357.3413,2572.3691 L1347.3413,2562.3691 L1081.3413,2562.3691 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1347.3413,2562.3691 L1347.3413,2572.3691 L1357.3413,2572.3691 L1347.3413,2562.3691 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.7852" x="1087.3413" y="2579.9375">The base_nonce is truncated to 12 bytes</text><polygon fill="#FF0000" points="455.9858,2609.9902,445.9858,2613.9902,455.9858,2617.9902,451.9858,2613.9902" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2613.9902" y2="2613.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2609.248">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2609.248">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2642.6455"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2642.6455" y2="2642.6455"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2645.6455" y2="2645.6455"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="265.7163" x="854.0017" y="2631.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="247.4316" x="860.0017" y="2648.5586">Derive HPKE key and store in KV slot</text><polygon fill="#FF0000" points="1054.3413,2743.8535,1064.3413,2747.8535,1054.3413,2751.8535,1058.3413,2747.8535" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="2747.8535" y2="2747.8535"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="2712.4902">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="491.3486" y="2681.8691">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="455.2729" x="594.1807" y="2697.1797">Data : 0x0020 (big-endian 32) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="276.9863" x="635.3135" y="2712.4902">0x0002 (kdf_id) | 0x0002 (aead_id) | "key" |</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.6201" x="635.3135" y="2727.8008">0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="2743.1113">Destination Slot: Y)</text><polygon fill="#FF0000" points="1764.9775,2773.1641,1774.9775,2777.1641,1764.9775,2781.1641,1768.9775,2777.1641" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2777.1641" y2="2777.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2772.4219">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9502" x="1122.7041" y="2772.4219">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="2806.4746" y2="2806.4746"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="2806.4746" y2="2819.4746"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="2819.4746" y2="2819.4746"/><polygon fill="#FF0000" points="1087.3413,2815.4746,1077.3413,2819.4746,1087.3413,2823.4746,1083.3413,2819.4746" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2801.7324">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1122.7041" y="2801.7324">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="1764.9775,2844.7852,1774.9775,2848.7852,1764.9775,2852.7852,1768.9775,2848.7852" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="2848.7852" y2="2848.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="2844.043">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1113" x="1122.7041" y="2844.043">HMAC384 result key</text><path d="M1081.3413,2861.7852 L1081.3413,2886.7852 L1513.3413,2886.7852 L1513.3413,2871.7852 L1503.3413,2861.7852 L1081.3413,2861.7852 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1503.3413,2861.7852 L1503.3413,2871.7852 L1513.3413,2871.7852 L1503.3413,2861.7852 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3599" x="1087.3413" y="2879.3535">The key is truncated to 32 bytes for use as an AES-256-GCM key</text><polygon fill="#FF0000" points="455.9858,2909.4063,445.9858,2913.4063,455.9858,2917.4063,451.9858,2913.4063" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="2913.4063" y2="2913.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="2908.6641">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="2908.6641">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="2942.0615"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2942.0615" y2="2942.0615"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="2945.0615" y2="2945.0615"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="283.2612" x="845.2292" y="2931.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.9766" x="851.2292" y="2947.9746">Decrypt access key and store in KV Slot</text><polygon fill="#FF0000" points="1054.3413,3058.5801,1064.3413,3062.5801,1054.3413,3066.5801,1058.3413,3062.5801" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3062.5801" y2="3062.5801"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3019.5615">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3296" x="491.3486" y="2981.2852">AES-256-GCM(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4512" x="540.708" y="2996.5957">IV : base_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.8018" x="540.708" y="3011.9063">Ciphertext : encrypted_access_key_ciphertext,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.7817" x="540.708" y="3027.2168">Tag : encrypted_access_key_tag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8408" x="540.708" y="3042.5273">AAD : "",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="540.708" y="3057.8379">Destination : Slot Z)</text><polygon fill="#FF0000" points="1764.9775,3087.8906,1774.9775,3091.8906,1764.9775,3095.8906,1768.9775,3091.8906" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="3091.8906" y2="3091.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3087.1484">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.6304" x="1122.7041" y="3087.1484">Get HPKE key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3121.2012" y2="3121.2012"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3121.2012" y2="3134.2012"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3134.2012" y2="3134.2012"/><polygon fill="#FF0000" points="1087.3413,3130.2012,1077.3413,3134.2012,1087.3413,3138.2012,1083.3413,3134.2012" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3116.459">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.5127" x="1122.7041" y="3116.459">AES-256-GCM decrypt access key</text><polygon fill="#FF0000" points="1871.7197,3159.5117,1881.7197,3163.5117,1871.7197,3167.5117,1875.7197,3163.5117" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3163.5117" y2="3163.5117"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3158.7695">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.9683" x="1122.7041" y="3158.7695">Put access key</text><polygon fill="#FF0000" points="455.9858,3188.8223,445.9858,3192.8223,455.9858,3196.8223,451.9858,3192.8223" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3192.8223" y2="3192.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3188.0801">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="3188.0801">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="3235.4775"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3235.4775" y2="3235.4775"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3238.4775" y2="3238.4775"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="192.0073" x="890.8562" y="3224.8223"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="173.7227" x="896.8562" y="3241.3906">Create the Encryption Key</text><polygon fill="#FF0000" points="1054.3413,3306.0645,1064.3413,3310.0645,1054.3413,3314.0645,1058.3413,3310.0645" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3310.0645" y2="3310.0645"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3290.0117">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="491.3486" y="3274.7012">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="594.1807" y="3290.0117">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="594.1807" y="3305.3223">Destination Slot: Y)</text><polygon fill="#FF0000" points="1331.3872,3335.375,1341.3872,3339.375,1331.3872,3343.375,1335.3872,3339.375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1337.3872" y1="3339.375" y2="3339.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3334.6328">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1152" x="1122.7041" y="3334.6328">Get FEK</text><polygon fill="#FF0000" points="1871.7197,3364.6855,1881.7197,3368.6855,1871.7197,3372.6855,1875.7197,3368.6855" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3368.6855" y2="3368.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3363.9434">[055]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.0308" x="1122.7041" y="3363.9434">Get Access Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3397.9961" y2="3397.9961"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3397.9961" y2="3410.9961"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3410.9961" y2="3410.9961"/><polygon fill="#FF0000" points="1087.3413,3406.9961,1077.3413,3410.9961,1087.3413,3414.9961,1083.3413,3410.9961" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3393.2539">[056]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.6875" x="1122.7041" y="3393.2539">HMAC512 Slot A with Slot Z</text><polygon fill="#FF0000" points="1764.9775,3436.3066,1774.9775,3440.3066,1764.9775,3444.3066,1768.9775,3440.3066" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="3440.3066" y2="3440.3066"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3435.5645">[057]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="283.7275" x="1122.7041" y="3435.5645">HMAC512 result locked PMEK encryption key</text><polygon fill="#FF0000" points="455.9858,3465.6172,445.9858,3469.6172,455.9858,3473.6172,451.9858,3469.6172" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3469.6172" y2="3469.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3464.875">[058]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="3464.875">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="3498.2725"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3498.2725" y2="3498.2725"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3501.2725" y2="3501.2725"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="337.9209" x="817.8994" y="3487.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="319.6362" x="823.8994" y="3504.1855">Decrypt PMEK with locked PMEK encryption key</text><polygon fill="#FF0000" points="1054.3413,3568.8594,1064.3413,3572.8594,1054.3413,3576.8594,1058.3413,3572.8594" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3572.8594" y2="3572.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3552.8066">[059]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.7944" x="491.3486" y="3537.4961">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.269" x="540.708" y="3552.8066">Data: locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.4067" x="540.708" y="3568.1172">Destination :  Slot Z)</text><polygon fill="#FF0000" points="1764.9775,3598.1699,1774.9775,3602.1699,1764.9775,3606.1699,1768.9775,3602.1699" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="3602.1699" y2="3602.1699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3597.4277">[060]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201.8618" x="1122.7041" y="3597.4277">Get locked PMEK encryption key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3631.4805" y2="3631.4805"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3631.4805" y2="3644.4805"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3644.4805" y2="3644.4805"/><polygon fill="#FF0000" points="1087.3413,3640.4805,1077.3413,3644.4805,1087.3413,3648.4805,1083.3413,3644.4805" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3626.7383">[061]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9922" x="1122.7041" y="3626.7383">Decrypt locked_pmek</text><polygon fill="#FF0000" points="1871.7197,3669.791,1881.7197,3673.791,1871.7197,3677.791,1875.7197,3673.791" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3673.791" y2="3673.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3669.0488">[062]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.9155" x="1122.7041" y="3669.0488">PMEK</text><polygon fill="#FF0000" points="455.9858,3699.1016,445.9858,3703.1016,455.9858,3707.1016,451.9858,3703.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3703.1016" y2="3703.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3698.3594">[063]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="3698.3594">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1963.7197" x="5" y="3731.7568"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3731.7568" y2="3731.7568"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1968.7197" y1="3734.7568" y2="3734.7568"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="334.0488" x="819.8354" y="3721.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="315.7642" x="825.8354" y="3737.6699">Encrypt PMEK with Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="1054.3413,3802.3438,1064.3413,3806.3438,1054.3413,3810.3438,1058.3413,3806.3438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3806.3438" y2="3806.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3786.291">[064]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.0884" x="491.3486" y="3770.9805">Wrap(Key: Slot B,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="528.3682" y="3786.291">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.0898" x="528.3682" y="3801.6016">Destination : ready_pmek)</text><polygon fill="#FF0000" points="1484.9351,3831.6543,1494.9351,3835.6543,1484.9351,3839.6543,1488.9351,3835.6543" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1490.9351" y1="3835.6543" y2="3835.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3830.9121">[065]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.7451" x="1122.7041" y="3830.9121">Get Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="1871.7197,3860.9648,1881.7197,3864.9648,1871.7197,3868.9648,1875.7197,3864.9648" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="3864.9648" y2="3864.9648"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3860.2227">[066]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.5283" x="1122.7041" y="3860.2227">Get PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1118.3413" y1="3894.2754" y2="3894.2754"/><line style="stroke:#FF0000;stroke-width:1;" x1="1118.3413" x2="1118.3413" y1="3894.2754" y2="3907.2754"/><line style="stroke:#FF0000;stroke-width:1;" x1="1077.3413" x2="1118.3413" y1="3907.2754" y2="3907.2754"/><polygon fill="#FF0000" points="1087.3413,3903.2754,1077.3413,3907.2754,1087.3413,3911.2754,1083.3413,3907.2754" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="3889.5332">[067]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.2964" x="1122.7041" y="3889.5332">Encrypt slot Z using Slot B</text><polygon fill="#FF0000" points="455.9858,3932.5859,445.9858,3936.5859,455.9858,3940.5859,451.9858,3936.5859" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="3936.5859" y2="3936.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="3931.8438">[068]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.645" x="501.3486" y="3931.8438">Ready PMEK</text><polygon fill="#FF0000" points="1054.3413,3977.207,1064.3413,3981.207,1054.3413,3985.207,1058.3413,3981.207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="444.9858" x2="1060.3413" y1="3981.207" y2="3981.207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="451.9858" y="3968.8096">[069]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.9629" x="491.3486" y="3961.1543">Purge_key(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="557.1611" y="3976.4648">Key : Slot Z)</text><polygon fill="#FF0000" points="1764.9775,4006.5176,1774.9775,4010.5176,1764.9775,4014.5176,1768.9775,4010.5176" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1770.9775" y1="4010.5176" y2="4010.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="4005.7754">[070]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="1122.7041" y="4005.7754">Purge</text><polygon fill="#FF0000" points="1871.7197,4006.5176,1881.7197,4010.5176,1871.7197,4014.5176,1875.7197,4010.5176" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1076.3413" x2="1877.7197" y1="4010.5176" y2="4010.5176"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1083.3413" y="4005.7754">[071]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1122.7041" y="4005.7754">&#160;</text><polygon fill="#FF0000" points="455.9858,4035.8281,445.9858,4039.8281,455.9858,4043.8281,451.9858,4039.8281" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="449.9858" x2="1065.3413" y1="4039.8281" y2="4039.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="461.9858" y="4035.0859">[072]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="501.3486" y="4035.0859">done</text><polygon fill="#FF0000" points="256.5332,4080.4492,246.5332,4084.4492,256.5332,4088.4492,252.5332,4084.4492" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="250.5332" x2="433.9858" y1="4084.4492" y2="4084.4492"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="262.5332" y="4072.0518">[073]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="301.896" y="4064.3965">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0317" x="301.896" y="4079.707">Ready_PMEK</text><line style="stroke:#008000;stroke-width:1;" x1="100.6826" x2="110.6826" y1="4084.4492" y2="4080.4492"/><line style="stroke:#008000;stroke-width:1;" x1="100.6826" x2="110.6826" y1="4084.4492" y2="4088.4492"/><line style="stroke:#008000;stroke-width:1;" x1="99.6826" x2="244.5332" y1="4084.4492" y2="4084.4492"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="116.6826" y="4072.0518">[074]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="156.0454" y="4064.3965">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="156.0454" y="4079.707">complete</text><path d="M250.5332,4125.4492 L250.5332,4200.4492 L811.5332,4200.4492 L811.5332,4135.4492 L801.5332,4125.4492 L250.5332,4125.4492 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M801.5332,4125.4492 L801.5332,4135.4492 L811.5332,4135.4492 L801.5332,4125.4492 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="256.5332" y="4145.0176">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="260.6465" y="4145.0176">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="345.248" y="4145.0176">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="349.3613" y="4145.0176">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="449.9907" y="4145.0176">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="454.104" y="4145.0176">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="260.6465" y="4160.3281">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="349.3613" y="4160.3281">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="454.104" y="4160.3281">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="260.6465" y="4175.6387">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="349.3613" y="4175.6387">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="454.104" y="4175.6387">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="76.375" x="260.6465" y="4190.9492">ready_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="349.3613" y="4190.9492">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="303.4814" x="454.104" y="4190.9492">PMEK encrypted to a key that is rotated on reset</text><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4132.4492" y2="4132.4492"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4147.7598" y2="4147.7598"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4163.0703" y2="4163.0703"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4178.3809" y2="4178.3809"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="796.6426" y1="4193.6914" y2="4193.6914"/><line style="stroke:#000000;stroke-width:0.5;" x1="256.5332" x2="256.5332" y1="4132.4492" y2="4193.6914"/><line style="stroke:#000000;stroke-width:0.5;" x1="345.248" x2="345.248" y1="4132.4492" y2="4193.6914"/><line style="stroke:#000000;stroke-width:0.5;" x1="449.9907" x2="449.9907" y1="4132.4492" y2="4193.6914"/><line style="stroke:#000000;stroke-width:0.5;" x1="796.6426" x2="796.6426" y1="4132.4492" y2="4193.6914"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="130.0244" x="978.3477" y="4299.8242">Filename: ready_pmek.uml</text><!--SRC=[tLh_Rzh84l-TlsA2gXDS8HUIzgalQlf4WJGHh-zGI7jg5GaPUm0BVvDt8UMKF_vcTWrU6vkIA6tHyo-OtPdPsPdFp8vtzyWDR6_X88HsDF92UpvQIDSJnzHSgLIEt0dKNeXPU3-IhlImNW5wRlaLgZTeEIiOVEprgvKZ31ntac68OhJ3mD4iGIWHB3iEXL3_-NaxVZVGDAvqmq2Sl_rZ_6xJ-pkqRHk5WE7CYj618TenIh2yM0rhBItN6vCQRW0M22-K_DR_RF2d-a4liEDLnAD07rSR8Icl5JWmnG1ZIz9OH8QMFOCO1SfKtqaOIB13BumlIADtrmBa36Da6HXPp9fJDi8OsevFmtmI6F_dxHyiGK-HxAMCih7S1ESlNyABzvykBtitetRdzlfp-_Rwp_zLvkXFYtiY7-UYkAiokOSNbbW5DlXZ8Zc7crwx-sN4riXuoOfSmqEnEvr9ujZC-O6zTEcYvu3ngDQX-pVccheuSGFbJ7WmHDYpkLZu05aHYxFJVDD_NSd8OejOMH7tiHL5w8miXOdHd9n8hN_fLWqKTkm3z7iVcmanQ68WuhlWT_hnHpFoiuVqZ_zOtZICNJdpa_-s6v4x9NwJJ8uQClan3PquMgYRlM3CeRVc6oJj3ng26taWGyODN58ZmuxVKqsJ4RRWuO_N_hGdzygXdT3tYJ_ZJLzCHuH4uGPJxLMRSP30W7W-80DOyt6tFsusrSiBWTwaLYNoQWEgNPGO4snnJLojaoAUm9GfqIkLJs_da3AgQ0Wde0Cj4ICg5SkJQkRupHLIvm9kkZ79DFCOlV2Uh4D1E0izckVQnXSND8vjHMBXCLtgDcLE1vMTysQzk4W5y83iSDU12pZvTdBIQa6jUqNGgGsQPszUDU2gtxri3g_QzATUhvWWJISyNxvyUGwzJlUgHfmmiDoOB9oY36eVwesxm6HcEaDTJMt2pYJkef1kOAbeEWSV_J1UPNMPBzUgK8hGpkKHA10YKgQ4TAbrLfITL9Tx2eJTdCh1WuNKx48dEg4INOR1WACJ1fXLEI-nsQIvCLbMn0PhMRu4h2cPZetT_kcCo323nPWcL-wevp6iWx6xH6sWQ37sN9Qm-euvMH4YFY0R6ai1YT-ISKkH5J1cXCH8SD0YJEBGXvlB3loxzUQamR1Gk7rrt6heO8N98b1j6N6RD9TfLG6kB7arwFSW4hXmmcPCpg91E9XzYllOjJoe3MxwzKni5s7WwcExGv5SunNY7D2Fv2eNc9c7oRgMj8YsoWeqbwqgPV4gGO1_rmb3Pv0wFDm5LTZtGGkfC9gpdEqmsg6JcGo6LB2SmvTwEGwJ2KCOSK6JD_g6L98fLYar9Te5PKOoQOPSKHLN6OS3sHnaCcPz93xOlF1b5q0IS30GpawWDdQdpQHaUVMcpaZPGiqEOUcp1IoewdcCz3nON7R1e8Qz92SfHeENHk3b3SPSlq2myCSOrvy5UWcUE5qgB-IHL8XHLNv_qUkFGuPz35GFQ14oCjgJ2uq6p9r9IdnogZsrxc-0HLLIjh_T6pPFN_-h-Q7piVvZShY0rySjLLczFZvjS78SsZDq5Xw-jmIgZWvzrP2ic-C_8mmsYLwmbo8MiaHlzPIqFwUvqXejPceK8SDOVUxfKkYvitvHnkVtmfI_iRzsM7tVG5op9OvKCMxCKmrQXLeGmc3OX-lkld7vlVfm_pL1bIMvC3CqFDoKxmQJyFyVB9jPgY4niCOU9X-erVsmycEXij7lW6k3P2F9H4d_irw7Vb2byFDnabOCQJxvCOjy-Hhy_ClzeNrivf0rfWLn58I1ZS-GWnvLXfvqCcLewtIh32r7tQCmbaAp27Mf0QgF4Knb3flF3nraCUR2_v1cb6T9RrleVLRO5cN4r2PbzTbyMLYU6MXo1SYOoYehsJvidS9u9L4K5rK76n_ywVupqovZwpJxWNRsYoA3flxBGkAn2VqdPFByhjZteu6nam-3ioGCO1B6iE2F4K7u0kERQ6kWGmqIlMTjx5VdusIuJvmOCzyLAzUVgITDBxdUZhb1NNGAOcn0v5XlhMaPZxIcEU9skykbKRMnQzjRwVzrJ-IMxhKoR4rKE5lsBX_WRxrBMqAgA0vmSwnmEuAGrecHpqpuS2Ht9cfYgoZ_lcwTZjWRmaHM-xjPs23- -jHqjJ7E1EVQtPUzVgNCMzoV71tt3MzjvJ2QK389dSEqZfLT6OnPaWoc3_yoHtkikucFdKxVxV1jPsSSdKyZHWfH2gdvb6kuqzUV0Zu-tPK-sA_dvkddhW3UYk2YwDt3c1dthIThw50A1tNY_KjSaWIOuPBo6mcxFF9Nue_47UzDT-oAiQmZr46iCbM1BzHD0ksBKXrt1bp6ojd3niGAgbpuIikq6qoJYJpHBQc6JtLEtiA3HJn5NgOCCnSLcAQXon0DHqUGIDnG_9Qp6T7y0aZcxW9qreVjAA8m47WNACEECeRz3TAB1zbx1tU17VgHXqajnGiDvcuZFEfkIVvEoRuNIl8NINRT8fcuaHW9QSc5AE2x9WQkBGNG57Y5N5z7eBhpydem12kAud39zuDYhZCnZkd5b9_6sFPDaA9h89RAnd9cIHuZ3kNwzf6wU5Ho5KH1eV8F]--></g></svg>