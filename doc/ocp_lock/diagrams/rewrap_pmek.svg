<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2918px" preserveAspectRatio="none" style="width:1683px;height:2918px;background:#FFFFFF;" version="1.1" viewBox="0 0 1683 2918" width="1683px" zoomAndPan="magnify"><title>Rewrap PMEK</title><defs/><g><rect fill="#DDDDDD" height="2838.2266" style="stroke:#181818;stroke-width:0.5;" width="1475.3335" x="176.4473" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="887.7173" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1629.7554" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98.0684" x="800.8562" y="41.3125">Rewrap PMEK</text><g><title>Storage</title><rect fill="transparent" height="2683.9863" width="8" x="53.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="56.6826" x2="56.6826" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="51.6826" y="2720.7852"/></g><g><title>Mail Box</title><rect fill="transparent" height="2683.9863" width="8" x="212.7231" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="216.2231" x2="216.2231" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#FFFFFF" height="251.0371" style="stroke:#181818;stroke-width:1;" width="10" x="211.2231" y="219.9727"/></g><g><title>FW</title><rect fill="transparent" height="2683.9863" width="8" x="417.1226" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="420.6226" x2="420.6226" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#FFFFFF" height="2279.0859" style="stroke:#181818;stroke-width:1;" width="10" x="415.6226" y="441.6992"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="790.8711" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="794.3711" x2="794.3711" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="663.1836"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="868.668"/></g><g><title/><rect fill="#FFFFFF" height="160.8633" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1132.7734"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1353.5684"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1616.3633"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1835.8477"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2098.6426"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2332.127"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2537.6113"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1046.8555" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1050.3555" x2="1050.3555" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#ADD8E6" height="2625.3652" style="stroke:#181818;stroke-width:1;" width="10" x="1045.3555" y="198.6621"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1149.0723" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1152.5723" x2="1152.5723" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#ADD8E6" height="2625.3652" style="stroke:#181818;stroke-width:1;" width="10" x="1147.5723" y="198.6621"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1260.8901" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1264.3901" x2="1264.3901" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#ADD8E6" height="820.3164" style="stroke:#181818;stroke-width:1;" width="10" x="1259.3901" y="1746.6055"/></g><line style="stroke:#181818;stroke-width:2;" x1="1255.3901" x2="1273.3901" y1="2557.9219" y2="2575.9219"/><line style="stroke:#181818;stroke-width:2;" x1="1255.3901" x2="1273.3901" y1="2575.9219" y2="2557.9219"/><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1367.6323" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1371.1323" x2="1371.1323" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#ADD8E6" height="1787.4961" style="stroke:#181818;stroke-width:1;" width="10" x="1366.1323" y="779.4258"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1474.3745" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1477.8745" x2="1477.8745" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#ADD8E6" height="1582.0117" style="stroke:#181818;stroke-width:1;" width="10" x="1472.8745" y="984.9102"/></g><g><title>Key Vault</title><rect fill="transparent" height="2683.9863" width="8" x="1588.5132" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1592.0132" x2="1592.0132" y1="140.041" y2="2824.0273"/></g><g><title/><rect fill="#ADD8E6" height="1559.7012" style="stroke:#181818;stroke-width:1;" width="10" x="1587.0132" y="1264.3262"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="755.6011" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="762.6011" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1011.5854" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1018.5854" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1030.5996" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1033.686" y="129.0879">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1099.1255" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1120.8022" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1132.5874" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1106.1255" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1216.019" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1232.6201" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1243.4756" y="112.5996">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1223.019" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1322.7612" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1339.3623" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1351.8447" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1329.7612" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1429.5034" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1446.1045" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1458.7168" y="112.5996">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1436.5034" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1536.2456" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1560.2432" y="112.5996">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1543.2456" y="129.0879">Temp Memory</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="2844.5625">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="2861.0508">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="2877.5391">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="2844.5625">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="2844.5625">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="755.6011" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="762.6011" y="2844.5625">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1011.5854" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1018.5854" y="2844.5625">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1030.5996" y="2861.0508">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1033.686" y="2877.5391">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1099.1255" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1120.8022" y="2844.5625">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1132.5874" y="2861.0508">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1106.1255" y="2877.5391">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1216.019" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1232.6201" y="2844.5625">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1243.4756" y="2861.0508">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1223.019" y="2877.5391">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1322.7612" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1339.3623" y="2844.5625">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1351.8447" y="2861.0508">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1329.7612" y="2877.5391">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1429.5034" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1446.1045" y="2844.5625">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1458.7168" y="2861.0508">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1436.5034" y="2877.5391">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1536.2456" y="2824.0273"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1560.2432" y="2844.5625">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1543.2456" y="2861.0508">Temp Memory</text><path d="M17.4575,153.041 L17.4575,193.041 L1630.4575,193.041 L1630.4575,163.041 L1620.4575,153.041 L17.4575,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1620.4575,153.041 L1620.4575,163.041 L1630.4575,163.041 L1620.4575,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="702.0181" y="170.6094">Preconditions:</text><ellipse cx="707.5181" cy="181.1621" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="223.6597" x="714.0181" y="185.9199">FEK in a firmware-managed KV slot</text><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="219.9727" y2="215.9727"/><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="219.9727" y2="223.9727"/><line style="stroke:#008000;stroke-width:1;" x1="56.6826" x2="210.2231" y1="219.9727" y2="219.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="63.6826" y="215.2305">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.1777" x="103.0454" y="215.2305">REWRAP_PMEK</text><path d="M226.2231,232.9727 L226.2231,414.9727 L962.2231,414.9727 L962.2231,242.9727 L952.2231,232.9727 L226.2231,232.9727 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M952.2231,232.9727 L952.2231,242.9727 L962.2231,242.9727 L952.2231,232.9727 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="232.2231" y="252.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="236.3364" y="252.541">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="413.5693" y="252.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="417.6826" y="252.541">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="587.4824" y="252.541">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="591.5957" y="252.541">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="236.3364" y="267.8516">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="417.6826" y="267.8516">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="591.5957" y="267.8516">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="236.3364" y="283.1621">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="417.6826" y="283.1621">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="591.5957" y="283.1621">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1768" x="599.8223" y="298.4727">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0596" x="599.8223" y="313.7832">* kem_handle (X)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.0283" x="599.8223" y="329.0938">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0244" x="599.8223" y="344.4043">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="599.8223" y="359.7148">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.1196" x="236.3364" y="375.0254">wrapped_enc_access_key_2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.6865" x="417.6826" y="375.0254">DoubleWrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.5542" x="591.5957" y="375.0254">KEM-wrapped (access_key_2 encrypted to access_key_1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4722" x="599.8223" y="390.3359">* double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5098" x="236.3364" y="405.6465">old_locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="417.6826" y="405.6465">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="591.5957" y="405.6465">PMEK encrypted to access_key_1</text><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="239.9727" y2="239.9727"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="255.2832" y2="255.2832"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="270.5938" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="362.457" y2="362.457"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="393.0781" y2="393.0781"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="408.3887" y2="408.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="232.2231" y1="239.9727" y2="408.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="413.5693" x2="413.5693" y1="239.9727" y2="408.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="587.4824" x2="587.4824" y1="239.9727" y2="408.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="948.1499" x2="948.1499" y1="239.9727" y2="408.3887"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="441.6992" y2="437.6992"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="441.6992" y2="445.6992"/><line style="stroke:#008000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="441.6992" y2="441.6992"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="228.2231" y="436.957">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="267.5859" y="436.957">Command</text><polygon fill="#FF0000" points="232.2231,467.0098,222.2231,471.0098,232.2231,475.0098,228.2231,471.0098" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="226.2231" x2="414.6226" y1="471.0098" y2="471.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="238.2231" y="466.2676">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="277.5859" y="466.2676">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="467.6226" y1="500.3203" y2="500.3203"/><line style="stroke:#FF0000;stroke-width:1;" x1="467.6226" x2="467.6226" y1="500.3203" y2="513.3203"/><line style="stroke:#FF0000;stroke-width:1;" x1="426.6226" x2="467.6226" y1="513.3203" y2="513.3203"/><polygon fill="#FF0000" points="436.6226,509.3203,426.6226,513.3203,436.6226,517.3203,432.6226,513.3203" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="495.5781">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="471.9854" y="495.5781">Determine command</text><path d="M8,525.3203 L70.1387,525.3203 L70.1387,532.6309 L60.1387,542.6309 L8,542.6309 L8,525.3203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="2078.9121" style="stroke:#000000;stroke-width:1.5;" width="1605.0132" x="8" y="525.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="538.8887">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="65.9302" x="85.1387" y="537.9551">[FEK exists]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="573.2861"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="573.2861" y2="573.2861"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="576.2861" y2="576.2861"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="765.1667" y="562.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="771.1667" y="579.1992">Get Access Key 1</text><polygon fill="#FF0000" points="777.3711,659.1836,787.3711,663.1836,777.3711,667.1836,781.3711,663.1836" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="663.1836" y2="663.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="635.4756">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.2422" x="471.9854" y="612.5098">Decaps(KEM Pair : kem_handle (g),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.332" x="521.3447" y="627.8203">KEM ciphertext : kem_ciphertext from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="628.29" y="643.1309">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="658.4414">Destination : Slot Y)</text><polygon fill="#FF0000" points="1135.5723,688.4941,1145.5723,692.4941,1135.5723,696.4941,1139.5723,692.4941" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1141.5723" y1="692.4941" y2="692.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="687.752">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="845.7339" y="687.752">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="737.1152" y2="737.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="737.1152" y2="750.1152"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="750.1152" y2="750.1152"/><polygon fill="#FF0000" points="810.3711,746.1152,800.3711,750.1152,810.3711,754.1152,806.3711,750.1152" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="724.7178">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.4609" x="845.7339" y="717.0625">Decap KEM Ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.7778" x="845.7339" y="732.373">with Keypair</text><polygon fill="#FF0000" points="1354.1323,775.4258,1364.1323,779.4258,1354.1323,783.4258,1358.1323,779.4258" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="779.4258" y2="779.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="774.6836">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.6621" x="845.7339" y="774.6836">Put Shared Secret</text><polygon fill="#FF0000" points="436.6226,804.7363,426.6226,808.7363,436.6226,812.7363,432.6226,808.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="808.7363" y2="808.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="803.9941">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="803.9941">done</text><polygon fill="#FF0000" points="777.3711,864.668,787.3711,868.668,777.3711,872.668,781.3711,868.668" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="868.668" y2="868.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="848.6152">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6812" x="471.9854" y="833.3047">Unwrap(Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.6963" x="521.3447" y="848.6152">Key Data : wrapped_access_key_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="521.3447" y="863.9258">Destination : Slot Z)</text><polygon fill="#FF0000" points="1354.1323,893.9785,1364.1323,897.9785,1354.1323,901.9785,1358.1323,897.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="897.9785" y2="897.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="893.2363">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="845.7339" y="893.2363">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="942.5996" y2="942.5996"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="942.5996" y2="955.5996"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="955.5996" y2="955.5996"/><polygon fill="#FF0000" points="810.3711,951.5996,800.3711,955.5996,810.3711,959.5996,806.3711,955.5996" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="930.2021">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7725" x="845.7339" y="922.5469">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="845.7339" y="937.8574">wrapped_access_key_1</text><polygon fill="#FF0000" points="1460.8745,980.9102,1470.8745,984.9102,1460.8745,988.9102,1464.8745,984.9102" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="984.9102" y2="984.9102"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="980.168">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="845.7339" y="980.168">Put Access Key 1</text><polygon fill="#FF0000" points="436.6226,1010.2207,426.6226,1014.2207,436.6226,1018.2207,432.6226,1014.2207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1014.2207" y2="1014.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1009.4785">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1009.4785">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="1042.876"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1042.876" y2="1042.876"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1045.876" y2="1045.876"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="765.1667" y="1032.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="771.1667" y="1048.7891">Get Access Key 2</text><polygon fill="#FF0000" points="777.3711,1128.7734,787.3711,1132.7734,777.3711,1136.7734,781.3711,1132.7734" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1132.7734" y2="1132.7734"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1105.0654">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.7944" x="471.9854" y="1082.0996">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.0264" x="521.3447" y="1097.4102">Key Data: double_encrypted_access_key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.0474" x="521.3447" y="1112.7207">Destination Memory:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7808" x="656.5054" y="1112.7207">Put in memory</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.8711" x="471.9854" y="1128.0313">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.1011" x="648.8564" y="1128.0313">as not a key)</text><polygon fill="#FF0000" points="1354.1323,1158.084,1364.1323,1162.084,1354.1323,1166.084,1358.1323,1162.084" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="1162.084" y2="1162.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1157.3418">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="845.7339" y="1157.3418">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1222.0156" y2="1222.0156"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1222.0156" y2="1235.0156"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1235.0156" y2="1235.0156"/><polygon fill="#FF0000" points="810.3711,1231.0156,800.3711,1235.0156,810.3711,1239.0156,806.3711,1235.0156" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1201.9629">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7725" x="845.7339" y="1186.6523">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.0938" x="845.7339" y="1201.9629">double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.6377" x="845.7339" y="1217.2734">with Slot Y</text><polygon fill="#FF0000" points="1575.0132,1260.3262,1585.0132,1264.3262,1575.0132,1268.3262,1579.0132,1264.3262" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1581.0132" y1="1264.3262" y2="1264.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1259.584">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.2178" x="845.7339" y="1259.584">Encrypted Access Key 2</text><polygon fill="#FF0000" points="436.6226,1289.6367,426.6226,1293.6367,436.6226,1297.6367,432.6226,1293.6367" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1293.6367" y2="1293.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1288.8945">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1288.8945">done</text><polygon fill="#FF0000" points="777.3711,1349.5684,787.3711,1353.5684,777.3711,1357.5684,781.3711,1353.5684" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1353.5684" y2="1353.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1333.5156">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.4399" x="471.9854" y="1318.2051">Unwrap(Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6143" x="521.3447" y="1333.5156">Key Data : Temp Memory,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="1348.8262">Destination : Slot Y)</text><polygon fill="#FF0000" points="1460.8745,1378.8789,1470.8745,1382.8789,1460.8745,1386.8789,1464.8745,1382.8789" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="1382.8789" y2="1382.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1378.1367">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1378.1367">Get Access Key 1</text><polygon fill="#FF0000" points="1575.0132,1408.1895,1585.0132,1412.1895,1575.0132,1416.1895,1579.0132,1412.1895" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1581.0132" y1="1412.1895" y2="1412.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1407.4473">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.7886" x="845.7339" y="1407.4473">Get encrypted_access_key</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1441.5" y2="1441.5"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1441.5" y2="1454.5"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1454.5" y2="1454.5"/><polygon fill="#FF0000" points="810.3711,1450.5,800.3711,1454.5,810.3711,1458.5,806.3711,1454.5" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1436.7578">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.6216" x="845.7339" y="1436.7578">Unwrap encrypted access key 2</text><polygon fill="#FF0000" points="1354.1323,1479.8105,1364.1323,1483.8105,1354.1323,1487.8105,1358.1323,1483.8105" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="1483.8105" y2="1483.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1479.0684">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="845.7339" y="1479.0684">Put Access Key 2</text><polygon fill="#FF0000" points="436.6226,1509.1211,426.6226,1513.1211,436.6226,1517.1211,432.6226,1513.1211" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1513.1211" y2="1513.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1508.3789">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1508.3789">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="1541.7764"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1541.7764" y2="1541.7764"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="1544.7764" y2="1544.7764"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="294.1411" x="684.3198" y="1531.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="275.8564" x="690.3198" y="1547.6895">Create PMEK wrapping/unwrapping Keys</text><polygon fill="#FF0000" points="777.3711,1612.3633,787.3711,1616.3633,777.3711,1620.3633,781.3711,1616.3633" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1616.3633" y2="1616.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1596.3105">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1581">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="574.8174" y="1596.3105">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.5562" x="574.8174" y="1611.6211">Destination : Slot W)</text><polygon fill="#FF0000" points="1033.3555,1641.6738,1043.3555,1645.6738,1033.3555,1649.6738,1037.3555,1645.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1039.3555" y1="1645.6738" y2="1645.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1640.9316">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1152" x="845.7339" y="1640.9316">Get FEK</text><polygon fill="#FF0000" points="1460.8745,1670.9844,1470.8745,1674.9844,1460.8745,1678.9844,1464.8745,1674.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="1674.9844" y2="1674.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1670.2422">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1670.2422">Get Access Key 1</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1704.2949" y2="1704.2949"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1704.2949" y2="1717.2949"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1717.2949" y2="1717.2949"/><polygon fill="#FF0000" points="810.3711,1713.2949,800.3711,1717.2949,810.3711,1721.2949,806.3711,1717.2949" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1699.5527">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.0376" x="845.7339" y="1699.5527">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1247.3901,1742.6055,1257.3901,1746.6055,1247.3901,1750.6055,1251.3901,1746.6055" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1253.3901" y1="1746.6055" y2="1746.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1741.8633">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="332.0776" x="845.7339" y="1741.8633">HMAC512 result Old encryption key for locked PMEK</text><polygon fill="#FF0000" points="436.6226,1771.916,426.6226,1775.916,436.6226,1779.916,432.6226,1775.916" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1775.916" y2="1775.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1771.1738">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1771.1738">done</text><polygon fill="#FF0000" points="777.3711,1831.8477,787.3711,1835.8477,777.3711,1839.8477,781.3711,1835.8477" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1835.8477" y2="1835.8477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1815.7949">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1800.4844">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="574.8174" y="1815.7949">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="574.8174" y="1831.1055">Destination : Slot Z)</text><polygon fill="#FF0000" points="1033.3555,1861.1582,1043.3555,1865.1582,1033.3555,1869.1582,1037.3555,1865.1582" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1039.3555" y1="1865.1582" y2="1865.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1860.416">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="48.1152" x="845.7339" y="1860.416">Get FEK</text><polygon fill="#FF0000" points="1354.1323,1890.4688,1364.1323,1894.4688,1354.1323,1898.4688,1358.1323,1894.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="1894.4688" y2="1894.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1889.7266">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1889.7266">Get Access Key 2</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1923.7793" y2="1923.7793"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1923.7793" y2="1936.7793"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1936.7793" y2="1936.7793"/><polygon fill="#FF0000" points="810.3711,1932.7793,800.3711,1936.7793,810.3711,1940.7793,806.3711,1936.7793" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1919.0371">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2788" x="845.7339" y="1919.0371">HMAC512 slot A and Slot Y</text><polygon fill="#FF0000" points="1460.8745,1962.0898,1470.8745,1966.0898,1460.8745,1970.0898,1464.8745,1966.0898" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="1966.0898" y2="1966.0898"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1961.3477">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336.9019" x="845.7339" y="1961.3477">HMAC512 result New encryption key for locked PMEK</text><polygon fill="#FF0000" points="436.6226,1991.4004,426.6226,1995.4004,436.6226,1999.4004,432.6226,1995.4004" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1995.4004" y2="1995.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1990.6582">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1990.6582">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="2024.0557"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2024.0557" y2="2024.0557"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2027.0557" y2="2027.0557"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="81.958" x="790.4114" y="2013.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.6733" x="796.4114" y="2029.9688">Get PMEK</text><polygon fill="#FF0000" points="777.3711,2094.6426,787.3711,2098.6426,777.3711,2102.6426,781.3711,2098.6426" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2098.6426" y2="2098.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2078.5898">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.8159" x="471.9854" y="2063.2793">Unwrap(Key : Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.9038" x="521.3447" y="2078.5898">Key Data: locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="2093.9004">Destination : Slot Y)</text><polygon fill="#FF0000" points="1247.3901,2123.9531,1257.3901,2127.9531,1247.3901,2131.9531,1251.3901,2127.9531" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1253.3901" y1="2127.9531" y2="2127.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2123.2109">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.5991" x="845.7339" y="2123.2109">Old encryption key for locked PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="2157.2637" y2="2157.2637"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="2157.2637" y2="2170.2637"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="2170.2637" y2="2170.2637"/><polygon fill="#FF0000" points="810.3711,2166.2637,800.3711,2170.2637,810.3711,2174.2637,806.3711,2170.2637" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2152.5215">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.9702" x="845.7339" y="2152.5215">Unwrap locked_pmek</text><polygon fill="#FF0000" points="1354.1323,2195.5742,1364.1323,2199.5742,1354.1323,2203.5742,1358.1323,2199.5742" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="2199.5742" y2="2199.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2194.832">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.9155" x="845.7339" y="2194.832">PMEK</text><polygon fill="#FF0000" points="436.6226,2224.8848,426.6226,2228.8848,436.6226,2232.8848,432.6226,2228.8848" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2228.8848" y2="2228.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2224.1426">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2224.1426">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1652.7808" x="5" y="2257.54"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2257.54" y2="2257.54"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1657.7808" y1="2260.54" y2="2260.54"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="176.5952" x="743.0928" y="2246.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.3105" x="749.0928" y="2263.4531">Create the locked PMEK</text><polygon fill="#FF0000" points="777.3711,2328.127,787.3711,2332.127,777.3711,2336.127,781.3711,2332.127" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2332.127" y2="2332.127"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2312.0742">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.4692" x="471.9854" y="2296.7637">Wrap(Key: Slot Z,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="525.458" y="2312.0742">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.6265" x="525.458" y="2327.3848">Destination : new_locked_pmek)</text><polygon fill="#FF0000" points="1460.8745,2357.4375,1470.8745,2361.4375,1460.8745,2365.4375,1464.8745,2361.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="2361.4375" y2="2361.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2356.6953">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.0361" x="845.7339" y="2356.6953">Get New encryption key for locked PMEK</text><polygon fill="#FF0000" points="1354.1323,2386.748,1364.1323,2390.748,1354.1323,2394.748,1358.1323,2390.748" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="2390.748" y2="2390.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2386.0059">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.5283" x="845.7339" y="2386.0059">Get PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="2435.3691" y2="2435.3691"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="2435.3691" y2="2448.3691"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="2448.3691" y2="2448.3691"/><polygon fill="#FF0000" points="810.3711,2444.3691,800.3711,2448.3691,810.3711,2452.3691,806.3711,2448.3691" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2422.9717">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="845.7339" y="2415.3164">Wrap slot Y with Slot Z to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.4126" x="845.7339" y="2430.627">generate new_encrypted_pmek</text><polygon fill="#FF0000" points="436.6226,2473.6797,426.6226,2477.6797,436.6226,2481.6797,432.6226,2477.6797" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2477.6797" y2="2477.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2472.9375">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="481.9854" y="2472.9375">new_encrypted_pmek</text><polygon fill="#FF0000" points="777.3711,2533.6113,787.3711,2537.6113,777.3711,2541.6113,781.3711,2537.6113" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2537.6113" y2="2537.6113"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2517.5586">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.9844" x="471.9854" y="2502.248">Purge_key(Key: Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.7944" x="537.7979" y="2517.5586">Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="537.7979" y="2532.8691">Key : Slot Z)</text><polygon fill="#FF0000" points="1247.3901,2562.9219,1257.3901,2566.9219,1247.3901,2570.9219,1251.3901,2566.9219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1253.3901" y1="2566.9219" y2="2566.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2562.1797">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="845.7339" y="2562.1797">Purge</text><polygon fill="#FF0000" points="1354.1323,2562.9219,1364.1323,2566.9219,1354.1323,2570.9219,1358.1323,2566.9219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1360.1323" y1="2566.9219" y2="2566.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2562.1797">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="845.7339" y="2562.1797">&#160;</text><polygon fill="#FF0000" points="1460.8745,2562.9219,1470.8745,2566.9219,1460.8745,2570.9219,1464.8745,2566.9219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1466.8745" y1="2566.9219" y2="2566.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2562.1797">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="845.7339" y="2562.1797">&#160;</text><polygon fill="#FF0000" points="436.6226,2592.2324,426.6226,2596.2324,436.6226,2600.2324,432.6226,2596.2324" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2596.2324" y2="2596.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2591.4902">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2591.4902">done</text><path d="M1372.4922,2623.2324 L1372.4922,2678.2324 L1586.4922,2678.2324 L1586.4922,2633.2324 L1576.4922,2623.2324 L1372.4922,2623.2324 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1576.4922,2623.2324 L1576.4922,2633.2324 L1586.4922,2633.2324 L1576.4922,2623.2324 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="1378.4922" y="2640.8008">Did not purge temp memory</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.521" x="1378.4922" y="2656.1113">as it contains encrypted object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36.918" x="1378.4922" y="2671.4219">purge</text><polygon fill="#FF0000" points="227.2231,2716.7852,217.2231,2720.7852,227.2231,2724.7852,223.2231,2720.7852" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="2720.7852" y2="2720.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="233.2231" y="2708.3877">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="272.5859" y="2700.7324">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="272.5859" y="2716.043">new_encrypted_pmek</text><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2720.7852" y2="2716.7852"/><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2720.7852" y2="2724.7852"/><line style="stroke:#008000;stroke-width:1;" x1="61.6826" x2="215.2231" y1="2720.7852" y2="2720.7852"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="78.6826" y="2708.3877">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="118.0454" y="2700.7324">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="118.0454" y="2716.043">complete</text><path d="M221.2231,2733.7852 L221.2231,2808.7852 L837.2231,2808.7852 L837.2231,2743.7852 L827.2231,2733.7852 L221.2231,2733.7852 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M827.2231,2733.7852 L827.2231,2743.7852 L837.2231,2743.7852 L827.2231,2733.7852 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="227.2231" y="2753.3535">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="231.3364" y="2753.3535">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="371.4863" y="2753.3535">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="375.5996" y="2753.3535">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="476.229" y="2753.3535">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="480.3423" y="2753.3535">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="231.3364" y="2768.6641">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2768.6641">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="480.3423" y="2768.6641">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="231.3364" y="2783.9746">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2783.9746">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="480.3423" y="2783.9746">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="231.3364" y="2799.2852">new_encrypted_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="375.5996" y="2799.2852">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="480.3423" y="2799.2852">PMEK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2740.7852" y2="2740.7852"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2756.0957" y2="2756.0957"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2771.4063" y2="2771.4063"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2786.7168" y2="2786.7168"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2802.0273" y2="2802.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="227.2231" y1="2740.7852" y2="2802.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="371.4863" x2="371.4863" y1="2740.7852" y2="2802.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="476.229" x2="476.229" y1="2740.7852" y2="2802.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="822.8809" x2="822.8809" y1="2740.7852" y2="2802.0273"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="136.5967" x="781.592" y="2908.1602">Filename: rewrap_pmek.uml</text><!--SRC=[nLXjJzj84FwUNp4Wr8CZQGMd-nArbN8az12bZO0s1qAo77kSxCLUMxiRtA3- -9jTlyHsrX3wTXOVWcTdTkPvPcR7kyEu5ovzXDXBd33s5ivIiL2-fDUTpWuBO7zFpkFKKKo5UD01UgxrJzYzn5Iu2OmlHkUxdHtaFWjg6eb0B-P-fiDZXU1w8fRI_A-VrzEtusmDKopcil_wrVHjAVqTJaVdm3Yu430HfQx0NkHoTuO-d7y66SRAhAMDZVNIXG0NXuUmzzUdqzFHfJCukJxxFBW- -_YXiy1ePfUGKWfxhbnn3w8fhUd3vMXoEHWxEhfQL6x2AX49DfihKYcz_ggZEcKO-j1yZEYAFQ1LCCI0SOC3VArOy-OBkOm0BDQMVno3LV2UAKsGXiEjMzE49UWxhkUXbCu2LyvHBffaee6HdEEgr3aVNVHoFSZqWFJkkA6eOiWDPx5WQXxb8aBRcRlS9q_s_pcelBGjz5WoHw7mYyfV8lV4Ab4rNwsXqC9gECSa6iRBQOWR0TL3sQyfbTk1Ygj17HME-yQcywHRSUYRAg8LIOIBAYsZGdVS4EWSQ_SWDx-Hvj6qo5WlI4tAdiGH5OXVIzT8pfp45PBnMPQsdixqFD59vnqgy78zBOwclPxviISn3FPtQVbk5tQ7g514Z6EnUFU070abhfKAlznGcSh5BqmgsJ4Bthmn6sLSW2RZYDur_5dS7nxsOOYUcyXzeWh6BXFaOZMHPWTTGqZvw7NhvCbNLru48exg6ksFhJhgkaEKYd7NL6aVhgW5mKq6w-A-Y8AQJ0QhTer2JIYAnfBxF4opvAII-YcLXLr7OPIi-Z1UAhYQKolquGezWLaBD49xPzFYIZhuCS-RUCqwaT3hKKHQdAcKt6RhygGeEBOozubh0FSrkmKs3Qv8CdILIs8RrDqdiRuzi8AYmTu4fGPtvjiTj-sxQVCX0xgQhYNE3xyIPtlj7BVLZeM1hfs2_cCDxH4YBZ2A1K7-EeYvRXnXBDuGxcyrN7HKHqQyRRrbGq33aYjrcwD3dnpvRheV2J8ljWobpNqealwwOzVGx_nM7lyX1YhxTpEG2Sqx0ek-JlqNr1mh9oZHg5BcOLUFDxBLZF6oeNa4r0xrImxIp4zGh6gp8ZEyfC7h9Pm5a9BtB68AugMesYxyZNcRhUpydgj8drI3qM3O1Rdqva3C3KPNlNSd5rrjtQFPGs0IkbwhLxJxT4LKwzCfnChMPJnGSvosQ3EbNSz1QI0bwK_67dCrZpxb_ilCHdcW5fLDbF_gsdwwW6zRM-WrkPpNO_VPfrJUvPg7SaiTw6Ms6cehlCemKyttrXEjLbq_ySIYLdeYa18X6xdCOK2fzsh9Yv_Q1zdMNl- -69pyUNJiQ4HbbQH1zv6MP-XgPnIUO6xIO8w-RZ92QCRw1aurINaSvXCA1gPiCiysxQNhrGBbaaQxZ_HbKobKJMmG2yXcNeDhML3f_rrEFuQmc-SHTliimbORX1rlJzYDDG4QX7t0T1l2VkhmOifjww5bqZgqLBwilgdbKJflcR-shbRPtTxAVXwMZVQbJxcAnstGJd9WYyniPlrJcLv7bMDQ_RHjFr6sp3XR7TZnrt5aoNy3wwdjbkQFEpv3Za9ZejrR7r8bITjpqMRW-Nrdl1Gpr0Ta1Vo9fUKyCgWtnBOldnHsTY3Vp4XVD20bkUtzG_7-XwSfwik7SZ0kveUERLuRCZDzGQAzDolpZuTEoqS1q_zpvJ8kA-D5FFqNlUm3m5Zgb5DTfzEuwSXlHtHRJ68kyOvR27y1wskL-gtA7VVYA0bHc_xEwy3cHU0px_-QDt-FNVW5B96ELAvQodRrCzBpg8G8vC2qbloE1vY4qxFn5T1i9E9x3JTzAd108UX7TPjD93VkkvwuvZfkkUOo6TZv3m00]--></g></svg>