<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2933px" preserveAspectRatio="none" style="width:1714px;height:2933px;background:#FFFFFF;" version="1.1" viewBox="0 0 1714 2933" width="1714px" zoomAndPan="magnify"><title>Rewrap PMEK</title><defs/><g><rect fill="#DDDDDD" height="2853.5371" style="stroke:#181818;stroke-width:0.5;" width="1505.9995" x="176.4473" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="903.0503" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1660.4214" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98.0684" x="816.1892" y="41.3125">Rewrap PMEK</text><g><title>Storage</title><rect fill="transparent" height="2699.2969" width="8" x="53.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="56.6826" x2="56.6826" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="51.6826" y="2736.0957"/></g><g><title>Mail Box</title><rect fill="transparent" height="2699.2969" width="8" x="212.7231" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="216.2231" x2="216.2231" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#FFFFFF" height="251.0371" style="stroke:#181818;stroke-width:1;" width="10" x="211.2231" y="235.2832"/></g><g><title>FW</title><rect fill="transparent" height="2699.2969" width="8" x="417.1226" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="420.6226" x2="420.6226" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#FFFFFF" height="2279.0859" style="stroke:#181818;stroke-width:1;" width="10" x="415.6226" y="457.0098"/></g><g><title>Key Vault</title><rect fill="transparent" height="2699.2969" width="8" x="790.8711" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="794.3711" x2="794.3711" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="678.4941"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="883.9785"/></g><g><title/><rect fill="#FFFFFF" height="160.8633" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1148.084"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1368.8789"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1631.6738"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="1851.1582"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2113.9531"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2347.4375"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="789.3711" y="2552.9219"/></g><g><title>Key Vault</title><rect fill="transparent" height="2699.2969" width="8" x="1046.8555" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1050.3555" x2="1050.3555" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#ADD8E6" height="2625.3652" style="stroke:#181818;stroke-width:1;" width="10" x="1045.3555" y="213.9727"/></g><g><title>Key Vault</title><rect fill="transparent" height="2699.2969" width="8" x="1179.7383" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1183.2383" x2="1183.2383" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#ADD8E6" height="2625.3652" style="stroke:#181818;stroke-width:1;" width="10" x="1178.2383" y="213.9727"/></g><g><title>Key Vault</title><rect fill="transparent" height="2699.2969" width="8" x="1291.5562" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1295.0562" x2="1295.0562" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#ADD8E6" height="820.3164" style="stroke:#181818;stroke-width:1;" width="10" x="1290.0562" y="1761.916"/></g><line style="stroke:#181818;stroke-width:2;" x1="1286.0562" x2="1304.0562" y1="2573.2324" y2="2591.2324"/><line style="stroke:#181818;stroke-width:2;" x1="1286.0562" x2="1304.0562" y1="2591.2324" y2="2573.2324"/><g><title>Key Vault</title><rect fill="transparent" height="2699.2969" width="8" x="1398.2983" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1401.7983" x2="1401.7983" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#ADD8E6" height="1787.4961" style="stroke:#181818;stroke-width:1;" width="10" x="1396.7983" y="794.7363"/></g><g><title>Key Vault</title><rect fill="transparent" height="2699.2969" width="8" x="1505.0405" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1508.5405" x2="1508.5405" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#ADD8E6" height="1582.0117" style="stroke:#181818;stroke-width:1;" width="10" x="1503.5405" y="1000.2207"/></g><g><title>Key Vault</title><rect fill="transparent" height="2699.2969" width="8" x="1619.1792" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1622.6792" x2="1622.6792" y1="140.041" y2="2839.3379"/></g><g><title/><rect fill="#ADD8E6" height="1559.7012" style="stroke:#181818;stroke-width:1;" width="10" x="1617.6792" y="1279.6367"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="755.6011" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="762.6011" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="980.9194" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1018.5854" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1030.5996" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="987.9194" y="129.0879">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1129.7915" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1151.4683" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1163.2534" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1136.7915" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1246.6851" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1263.2861" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1274.1416" y="112.5996">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1253.6851" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1353.4272" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1370.0283" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1382.5107" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1360.4272" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1460.1694" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1476.7705" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1489.3828" y="112.5996">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1467.1694" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1566.9116" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1590.9092" y="112.5996">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1573.9116" y="129.0879">Temp Memory</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="2859.873">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="2876.3613">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="2892.8496">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="2859.873">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="2859.873">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="755.6011" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="762.6011" y="2859.873">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="980.9194" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1018.5854" y="2859.873">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1030.5996" y="2876.3613">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="987.9194" y="2892.8496">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1129.7915" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1151.4683" y="2859.873">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1163.2534" y="2876.3613">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1136.7915" y="2892.8496">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1246.6851" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1263.2861" y="2859.873">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1274.1416" y="2876.3613">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1253.6851" y="2892.8496">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1353.4272" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1370.0283" y="2859.873">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1382.5107" y="2876.3613">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1360.4272" y="2892.8496">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1460.1694" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1476.7705" y="2859.873">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1489.3828" y="2876.3613">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1467.1694" y="2892.8496">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1566.9116" y="2839.3379"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1590.9092" y="2859.873">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1573.9116" y="2876.3613">Temp Memory</text><path d="M17.4575,153.041 L17.4575,208.041 L1661.4575,208.041 L1661.4575,163.041 L1651.4575,153.041 L17.4575,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1651.4575,153.041 L1651.4575,163.041 L1661.4575,163.041 L1651.4575,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="641.1348" y="170.6094">Preconditions:</text><ellipse cx="646.6348" cy="181.1621" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.6094" x="653.1348" y="185.9199">Access Shared Secret already availble in a slot in KV</text><ellipse cx="646.6348" cy="196.4727" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.0923" x="653.1348" y="201.2305">unlocking key already in a slot and generated on each reset</text><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="235.2832" y2="231.2832"/><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="235.2832" y2="239.2832"/><line style="stroke:#008000;stroke-width:1;" x1="56.6826" x2="210.2231" y1="235.2832" y2="235.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="63.6826" y="230.541">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.1777" x="103.0454" y="230.541">REWRAP_PMEK</text><path d="M226.2231,248.2832 L226.2231,430.2832 L962.2231,430.2832 L962.2231,258.2832 L952.2231,248.2832 L226.2231,248.2832 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M952.2231,248.2832 L952.2231,258.2832 L962.2231,258.2832 L952.2231,248.2832 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="232.2231" y="267.8516">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="236.3364" y="267.8516">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="413.5693" y="267.8516">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="417.6826" y="267.8516">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="587.4824" y="267.8516">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="591.5957" y="267.8516">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="236.3364" y="283.1621">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="417.6826" y="283.1621">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="591.5957" y="283.1621">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="236.3364" y="298.4727">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="417.6826" y="298.4727">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="591.5957" y="298.4727">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1768" x="599.8223" y="313.7832">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0596" x="599.8223" y="329.0938">* kem_handle (X)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.0283" x="599.8223" y="344.4043">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0244" x="599.8223" y="359.7148">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="599.8223" y="375.0254">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.1196" x="236.3364" y="390.3359">wrapped_enc_access_key_2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.6865" x="417.6826" y="390.3359">DoubleWrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.5542" x="591.5957" y="390.3359">KEM-wrapped (access_key_2 encrypted to access_key_1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4722" x="599.8223" y="405.6465">* double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5098" x="236.3364" y="420.957">old_locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="417.6826" y="420.957">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="591.5957" y="420.957">PMEK encrypted to access_key_1</text><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="255.2832" y2="255.2832"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="270.5938" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="285.9043" y2="285.9043"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="377.7676" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="408.3887" y2="408.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="423.6992" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="232.2231" y1="255.2832" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="413.5693" x2="413.5693" y1="255.2832" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="587.4824" x2="587.4824" y1="255.2832" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="948.1499" x2="948.1499" y1="255.2832" y2="423.6992"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="457.0098" y2="453.0098"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="457.0098" y2="461.0098"/><line style="stroke:#008000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="457.0098" y2="457.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="228.2231" y="452.2676">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="267.5859" y="452.2676">Command</text><polygon fill="#FF0000" points="232.2231,482.3203,222.2231,486.3203,232.2231,490.3203,228.2231,486.3203" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="226.2231" x2="414.6226" y1="486.3203" y2="486.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="238.2231" y="481.5781">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="277.5859" y="481.5781">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="467.6226" y1="515.6309" y2="515.6309"/><line style="stroke:#FF0000;stroke-width:1;" x1="467.6226" x2="467.6226" y1="515.6309" y2="528.6309"/><line style="stroke:#FF0000;stroke-width:1;" x1="426.6226" x2="467.6226" y1="528.6309" y2="528.6309"/><polygon fill="#FF0000" points="436.6226,524.6309,426.6226,528.6309,436.6226,532.6309,432.6226,528.6309" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="510.8887">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="471.9854" y="510.8887">Determine command</text><path d="M8,540.6309 L70.1387,540.6309 L70.1387,547.9414 L60.1387,557.9414 L8,557.9414 L8,540.6309 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="2078.9121" style="stroke:#000000;stroke-width:1.5;" width="1635.6792" x="8" y="540.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="554.1992">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142.1514" x="85.1387" y="553.2656">[Storage Root Key exists]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1683.4468" x="5" y="588.5967"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="588.5967" y2="588.5967"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="591.5967" y2="591.5967"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="780.4998" y="577.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="786.4998" y="594.5098">Get Access Key 1</text><polygon fill="#FF0000" points="777.3711,674.4941,787.3711,678.4941,777.3711,682.4941,781.3711,678.4941" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="678.4941" y2="678.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="650.7861">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.2422" x="471.9854" y="627.8203">Decaps(KEM Pair : kem_handle (g),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.332" x="521.3447" y="643.1309">KEM ciphertext : kem_ciphertext from</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="628.29" y="658.4414">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="673.752">Destination : Slot Y)</text><polygon fill="#FF0000" points="1166.2383,703.8047,1176.2383,707.8047,1166.2383,711.8047,1170.2383,707.8047" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1172.2383" y1="707.8047" y2="707.8047"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="703.0625">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="845.7339" y="703.0625">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="752.4258" y2="752.4258"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="752.4258" y2="765.4258"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="765.4258" y2="765.4258"/><polygon fill="#FF0000" points="810.3711,761.4258,800.3711,765.4258,810.3711,769.4258,806.3711,765.4258" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="740.0283">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.4609" x="845.7339" y="732.373">Decap KEM Ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.7778" x="845.7339" y="747.6836">with Keypair</text><polygon fill="#FF0000" points="1384.7983,790.7363,1394.7983,794.7363,1384.7983,798.7363,1388.7983,794.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="794.7363" y2="794.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="789.9941">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.6621" x="845.7339" y="789.9941">Put Shared Secret</text><polygon fill="#FF0000" points="436.6226,820.0469,426.6226,824.0469,436.6226,828.0469,432.6226,824.0469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="824.0469" y2="824.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="819.3047">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="819.3047">done</text><polygon fill="#FF0000" points="777.3711,879.9785,787.3711,883.9785,777.3711,887.9785,781.3711,883.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="883.9785" y2="883.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="863.9258">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6812" x="471.9854" y="848.6152">Unwrap(Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.6963" x="521.3447" y="863.9258">Key Data : wrapped_access_key_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="521.3447" y="879.2363">Destination : Slot Z)</text><polygon fill="#FF0000" points="1384.7983,909.2891,1394.7983,913.2891,1384.7983,917.2891,1388.7983,913.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="913.2891" y2="913.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="908.5469">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="845.7339" y="908.5469">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="957.9102" y2="957.9102"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="957.9102" y2="970.9102"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="970.9102" y2="970.9102"/><polygon fill="#FF0000" points="810.3711,966.9102,800.3711,970.9102,810.3711,974.9102,806.3711,970.9102" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="945.5127">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7725" x="845.7339" y="937.8574">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="845.7339" y="953.168">wrapped_access_key_1</text><polygon fill="#FF0000" points="1491.5405,996.2207,1501.5405,1000.2207,1491.5405,1004.2207,1495.5405,1000.2207" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1497.5405" y1="1000.2207" y2="1000.2207"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="995.4785">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="845.7339" y="995.4785">Put Access Key 1</text><polygon fill="#FF0000" points="436.6226,1025.5313,426.6226,1029.5313,436.6226,1033.5313,432.6226,1029.5313" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1029.5313" y2="1029.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1024.7891">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1024.7891">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1683.4468" x="5" y="1058.1865"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="1058.1865" y2="1058.1865"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="1061.1865" y2="1061.1865"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="780.4998" y="1047.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="786.4998" y="1064.0996">Get Access Key 2</text><polygon fill="#FF0000" points="777.3711,1144.084,787.3711,1148.084,777.3711,1152.084,781.3711,1148.084" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1148.084" y2="1148.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1120.376">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.7944" x="471.9854" y="1097.4102">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.0264" x="521.3447" y="1112.7207">Key Data: double_encrypted_access_key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.0474" x="521.3447" y="1128.0313">Destination Memory:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.7808" x="656.5054" y="1128.0313">Put in memory</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176.8711" x="471.9854" y="1143.3418">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80.1011" x="648.8564" y="1143.3418">as not a key)</text><polygon fill="#FF0000" points="1384.7983,1173.3945,1394.7983,1177.3945,1384.7983,1181.3945,1388.7983,1177.3945" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="1177.3945" y2="1177.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1172.6523">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="845.7339" y="1172.6523">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1237.3262" y2="1237.3262"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1237.3262" y2="1250.3262"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1250.3262" y2="1250.3262"/><polygon fill="#FF0000" points="810.3711,1246.3262,800.3711,1250.3262,810.3711,1254.3262,806.3711,1250.3262" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1217.2734">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="47.7725" x="845.7339" y="1201.9629">Unwrap</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188.0938" x="845.7339" y="1217.2734">double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.6377" x="845.7339" y="1232.584">with Slot Y</text><polygon fill="#FF0000" points="1605.6792,1275.6367,1615.6792,1279.6367,1605.6792,1283.6367,1609.6792,1279.6367" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1611.6792" y1="1279.6367" y2="1279.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1274.8945">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.2178" x="845.7339" y="1274.8945">Encrypted Access Key 2</text><polygon fill="#FF0000" points="436.6226,1304.9473,426.6226,1308.9473,436.6226,1312.9473,432.6226,1308.9473" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1308.9473" y2="1308.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1304.2051">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1304.2051">done</text><polygon fill="#FF0000" points="777.3711,1364.8789,787.3711,1368.8789,777.3711,1372.8789,781.3711,1368.8789" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1368.8789" y2="1368.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1348.8262">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.4399" x="471.9854" y="1333.5156">Unwrap(Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6143" x="521.3447" y="1348.8262">Key Data : Temp Memory,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="1364.1367">Destination : Slot Y)</text><polygon fill="#FF0000" points="1491.5405,1394.1895,1501.5405,1398.1895,1491.5405,1402.1895,1495.5405,1398.1895" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1497.5405" y1="1398.1895" y2="1398.1895"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1393.4473">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1393.4473">Get Access Key 1</text><polygon fill="#FF0000" points="1605.6792,1423.5,1615.6792,1427.5,1605.6792,1431.5,1609.6792,1427.5" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1611.6792" y1="1427.5" y2="1427.5"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1422.7578">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.7886" x="845.7339" y="1422.7578">Get encrypted_access_key</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1456.8105" y2="1456.8105"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1456.8105" y2="1469.8105"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1469.8105" y2="1469.8105"/><polygon fill="#FF0000" points="810.3711,1465.8105,800.3711,1469.8105,810.3711,1473.8105,806.3711,1469.8105" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1452.0684">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.6216" x="845.7339" y="1452.0684">Unwrap encrypted access key 2</text><polygon fill="#FF0000" points="1384.7983,1495.1211,1394.7983,1499.1211,1384.7983,1503.1211,1388.7983,1499.1211" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="1499.1211" y2="1499.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1494.3789">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="845.7339" y="1494.3789">Put Access Key 2</text><polygon fill="#FF0000" points="436.6226,1524.4316,426.6226,1528.4316,436.6226,1532.4316,432.6226,1528.4316" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1528.4316" y2="1528.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1523.6895">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1523.6895">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1683.4468" x="5" y="1557.0869"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="1557.0869" y2="1557.0869"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="1560.0869" y2="1560.0869"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="294.1411" x="699.6528" y="1546.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="275.8564" x="705.6528" y="1563">Create PMEK wrapping/unwrapping Keys</text><polygon fill="#FF0000" points="777.3711,1627.6738,787.3711,1631.6738,777.3711,1635.6738,781.3711,1631.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1631.6738" y2="1631.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1611.6211">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1596.3105">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="574.8174" y="1611.6211">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.5562" x="574.8174" y="1626.9316">Destination : Slot W)</text><polygon fill="#FF0000" points="1033.3555,1656.9844,1043.3555,1660.9844,1033.3555,1664.9844,1037.3555,1660.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1039.3555" y1="1660.9844" y2="1660.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1656.2422">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1104" x="845.7339" y="1656.2422">Get Storage Root Key</text><polygon fill="#FF0000" points="1491.5405,1686.2949,1501.5405,1690.2949,1491.5405,1694.2949,1495.5405,1690.2949" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1497.5405" y1="1690.2949" y2="1690.2949"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1685.5527">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1685.5527">Get Access Key 1</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1719.6055" y2="1719.6055"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1719.6055" y2="1732.6055"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1732.6055" y2="1732.6055"/><polygon fill="#FF0000" points="810.3711,1728.6055,800.3711,1732.6055,810.3711,1736.6055,806.3711,1732.6055" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1714.8633">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.0376" x="845.7339" y="1714.8633">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1278.0562,1757.916,1288.0562,1761.916,1278.0562,1765.916,1282.0562,1761.916" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1284.0562" y1="1761.916" y2="1761.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1757.1738">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.1177" x="845.7339" y="1757.1738">HMAC512 result Encryption Key for old PMEK</text><polygon fill="#FF0000" points="436.6226,1787.2266,426.6226,1791.2266,436.6226,1795.2266,432.6226,1791.2266" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="1791.2266" y2="1791.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1786.4844">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1786.4844">done</text><polygon fill="#FF0000" points="777.3711,1847.1582,787.3711,1851.1582,777.3711,1855.1582,781.3711,1851.1582" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="1851.1582" y2="1851.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1831.1055">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1815.7949">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="574.8174" y="1831.1055">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="574.8174" y="1846.416">Destination : Slot Z)</text><polygon fill="#FF0000" points="1033.3555,1876.4688,1043.3555,1880.4688,1033.3555,1884.4688,1037.3555,1880.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1039.3555" y1="1880.4688" y2="1880.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1875.7266">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0762" x="845.7339" y="1875.7266">Get System Root Key</text><polygon fill="#FF0000" points="1384.7983,1905.7793,1394.7983,1909.7793,1384.7983,1913.7793,1388.7983,1909.7793" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="1909.7793" y2="1909.7793"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1905.0371">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="845.7339" y="1905.0371">Get Access Key 2</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="1939.0898" y2="1939.0898"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="1939.0898" y2="1952.0898"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="1952.0898" y2="1952.0898"/><polygon fill="#FF0000" points="810.3711,1948.0898,800.3711,1952.0898,810.3711,1956.0898,806.3711,1952.0898" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1934.3477">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2788" x="845.7339" y="1934.3477">HMAC512 slot A and Slot Y</text><polygon fill="#FF0000" points="1491.5405,1977.4004,1501.5405,1981.4004,1491.5405,1985.4004,1495.5405,1981.4004" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1497.5405" y1="1981.4004" y2="1981.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="1976.6582">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.0557" x="845.7339" y="1976.6582">HMAC512 result New Encryption Key for PMEK</text><polygon fill="#FF0000" points="436.6226,2006.7109,426.6226,2010.7109,436.6226,2014.7109,432.6226,2010.7109" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2010.7109" y2="2010.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2005.9688">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2005.9688">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1683.4468" x="5" y="2039.3662"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="2039.3662" y2="2039.3662"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="2042.3662" y2="2042.3662"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="81.958" x="805.7444" y="2028.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.6733" x="811.7444" y="2045.2793">Get PMEK</text><polygon fill="#FF0000" points="777.3711,2109.9531,787.3711,2113.9531,777.3711,2117.9531,781.3711,2113.9531" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2113.9531" y2="2113.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2093.9004">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.8159" x="471.9854" y="2078.5898">Unwrap(Key : Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.9038" x="521.3447" y="2093.9004">Key Data: locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="2109.2109">Destination : Slot Y)</text><polygon fill="#FF0000" points="1278.0562,2139.2637,1288.0562,2143.2637,1278.0562,2147.2637,1282.0562,2143.2637" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1284.0562" y1="2143.2637" y2="2143.2637"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2138.5215">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.6392" x="845.7339" y="2138.5215">Encryption Key for old PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="2172.5742" y2="2172.5742"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="2172.5742" y2="2185.5742"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="2185.5742" y2="2185.5742"/><polygon fill="#FF0000" points="810.3711,2181.5742,800.3711,2185.5742,810.3711,2189.5742,806.3711,2185.5742" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2167.832">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.9702" x="845.7339" y="2167.832">Unwrap locked_pmek</text><polygon fill="#FF0000" points="1384.7983,2210.8848,1394.7983,2214.8848,1384.7983,2218.8848,1388.7983,2214.8848" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="2214.8848" y2="2214.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2210.1426">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.9155" x="845.7339" y="2210.1426">PMEK</text><polygon fill="#FF0000" points="436.6226,2240.1953,426.6226,2244.1953,436.6226,2248.1953,432.6226,2244.1953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2244.1953" y2="2244.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2239.4531">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2239.4531">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1683.4468" x="5" y="2272.8506"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="2272.8506" y2="2272.8506"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1688.4468" y1="2275.8506" y2="2275.8506"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="176.5952" x="758.4258" y="2262.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.3105" x="764.4258" y="2278.7637">Create the locked PMEK</text><polygon fill="#FF0000" points="777.3711,2343.4375,787.3711,2347.4375,777.3711,2351.4375,781.3711,2347.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2347.4375" y2="2347.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2327.3848">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.4692" x="471.9854" y="2312.0742">Wrap(Key: Slot Z,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="525.458" y="2327.3848">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.6265" x="525.458" y="2342.6953">Destination : new_locked_pmek)</text><polygon fill="#FF0000" points="1491.5405,2372.748,1501.5405,2376.748,1491.5405,2380.748,1495.5405,2376.748" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1497.5405" y1="2376.748" y2="2376.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2372.0059">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9634" x="845.7339" y="2372.0059">Get New Encryption Key</text><polygon fill="#FF0000" points="1384.7983,2402.0586,1394.7983,2406.0586,1384.7983,2410.0586,1388.7983,2406.0586" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="2406.0586" y2="2406.0586"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2401.3164">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.5283" x="845.7339" y="2401.3164">Get PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="841.3711" y1="2450.6797" y2="2450.6797"/><line style="stroke:#FF0000;stroke-width:1;" x1="841.3711" x2="841.3711" y1="2450.6797" y2="2463.6797"/><line style="stroke:#FF0000;stroke-width:1;" x1="800.3711" x2="841.3711" y1="2463.6797" y2="2463.6797"/><polygon fill="#FF0000" points="810.3711,2459.6797,800.3711,2463.6797,810.3711,2467.6797,806.3711,2463.6797" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2438.2822">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="845.7339" y="2430.627">Wrap slot Y with Slot Z to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.4126" x="845.7339" y="2445.9375">generate new_encrypted_pmek</text><polygon fill="#FF0000" points="436.6226,2488.9902,426.6226,2492.9902,436.6226,2496.9902,432.6226,2492.9902" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2492.9902" y2="2492.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2488.248">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="481.9854" y="2488.248">new_encrypted_pmek</text><polygon fill="#FF0000" points="777.3711,2548.9219,787.3711,2552.9219,777.3711,2556.9219,781.3711,2552.9219" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="783.3711" y1="2552.9219" y2="2552.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2532.8691">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.9844" x="471.9854" y="2517.5586">Purge_key(Key: Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.7944" x="537.7979" y="2532.8691">Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="537.7979" y="2548.1797">Key : Slot Z)</text><polygon fill="#FF0000" points="1278.0562,2578.2324,1288.0562,2582.2324,1278.0562,2586.2324,1282.0562,2582.2324" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1284.0562" y1="2582.2324" y2="2582.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2577.4902">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="845.7339" y="2577.4902">Purge</text><polygon fill="#FF0000" points="1384.7983,2578.2324,1394.7983,2582.2324,1384.7983,2586.2324,1388.7983,2582.2324" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1390.7983" y1="2582.2324" y2="2582.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2577.4902">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="845.7339" y="2577.4902">&#160;</text><polygon fill="#FF0000" points="1491.5405,2578.2324,1501.5405,2582.2324,1491.5405,2586.2324,1495.5405,2582.2324" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="799.3711" x2="1497.5405" y1="2582.2324" y2="2582.2324"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="806.3711" y="2577.4902">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="845.7339" y="2577.4902">&#160;</text><polygon fill="#FF0000" points="436.6226,2607.543,426.6226,2611.543,436.6226,2615.543,432.6226,2611.543" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="788.3711" y1="2611.543" y2="2611.543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2606.8008">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2606.8008">done</text><path d="M1403.1582,2638.543 L1403.1582,2693.543 L1617.1582,2693.543 L1617.1582,2648.543 L1607.1582,2638.543 L1403.1582,2638.543 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1607.1582,2638.543 L1607.1582,2648.543 L1617.1582,2648.543 L1607.1582,2638.543 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="1409.1582" y="2656.1113">Did not purge temp memory</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.521" x="1409.1582" y="2671.4219">as it contains encrypted object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36.918" x="1409.1582" y="2686.7324">purge</text><polygon fill="#FF0000" points="227.2231,2732.0957,217.2231,2736.0957,227.2231,2740.0957,223.2231,2736.0957" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="2736.0957" y2="2736.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="233.2231" y="2723.6982">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="272.5859" y="2716.043">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="272.5859" y="2731.3535">new_encrypted_pmek</text><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2736.0957" y2="2732.0957"/><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2736.0957" y2="2740.0957"/><line style="stroke:#008000;stroke-width:1;" x1="61.6826" x2="215.2231" y1="2736.0957" y2="2736.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="78.6826" y="2723.6982">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="118.0454" y="2716.043">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="118.0454" y="2731.3535">complete</text><path d="M221.2231,2749.0957 L221.2231,2824.0957 L837.2231,2824.0957 L837.2231,2759.0957 L827.2231,2749.0957 L221.2231,2749.0957 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M827.2231,2749.0957 L827.2231,2759.0957 L837.2231,2759.0957 L827.2231,2749.0957 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="227.2231" y="2768.6641">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="231.3364" y="2768.6641">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="371.4863" y="2768.6641">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="375.5996" y="2768.6641">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="476.229" y="2768.6641">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="480.3423" y="2768.6641">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="231.3364" y="2783.9746">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2783.9746">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="480.3423" y="2783.9746">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="231.3364" y="2799.2852">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2799.2852">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="480.3423" y="2799.2852">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="231.3364" y="2814.5957">new_encrypted_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="375.5996" y="2814.5957">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="480.3423" y="2814.5957">PMEK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2756.0957" y2="2756.0957"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2771.4063" y2="2771.4063"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2786.7168" y2="2786.7168"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2802.0273" y2="2802.0273"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2817.3379" y2="2817.3379"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="227.2231" y1="2756.0957" y2="2817.3379"/><line style="stroke:#000000;stroke-width:0.5;" x1="371.4863" x2="371.4863" y1="2756.0957" y2="2817.3379"/><line style="stroke:#000000;stroke-width:0.5;" x1="476.229" x2="476.229" y1="2756.0957" y2="2817.3379"/><line style="stroke:#000000;stroke-width:0.5;" x1="822.8809" x2="822.8809" y1="2756.0957" y2="2817.3379"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="136.5967" x="796.925" y="2923.4707">Filename: rewrap_pmek.uml</text><!--SRC=[nLXjRzis4FwkNt49WYvPd1J9i2z6Mi2BdIx8qXbnMYz1086MAPkpH0ea7TT1V_oEr8ibcRAJjka4Vv1rlEFnUUwEH-um7aJpCGKH97uaWfa_ronIn_ZPytPO2FjxQYeMlcOweWSUu7DhNc7tXYuaIQ1_tRlQzNOe7xEmef586WW-JdMuq1H888LIzhzvpaRl- -aOffdWgdtsTlI-aFuAdI2WIi5WIYGTmu06aceWaQHal0JoI5WqGZyO1m8g4jgyNNqkwS-vMG_Z4vZHPQ6u6a_u62QKKqaqsXSSA0cc8AcYsbh19Lc_YyKfEJiyXBq_FbrSz6xypldjvUVExUNV7xqPZITkYUU52zWZQia3Y4SufWqtlU5Df-yRt2fuaOILi99iCjMeKgpdgy7hWj5e3FN7YWRiYJe5NHeoRX66hoLhmNIcvZ60mzhyjrDm2lvYsb1lu21LQoOK4ZhsYUNCHy3zaqmqJ4KfcrV8HAvprRi-olGWrJD4FN1BNiaGYIP2CZsDCn6YxK-HFFHa_v-3qaVNm80bKoer_QApZvG7SfdeYg_EfU30yd9EKTGLSmovjGLLbx9VKIgc0otAYph97HzRc_vMjqGqjlc98vAOpigqz7BTVarWOgpPWypyMfZ7epnYWt1XG_PSn342NWdNM4tyX4Y5-PM6RM0YFGjqrFc0oHfaUaOSZuwExCkUeb6ulul3TrkmswMQofXncW_UFK178aLNIhbV9D8mq4AI2OKRWGbiiATVcDBAiwFVlREpPdN3I4_mMysvsUFXOHkwD229saVUe4-OH7_BKJKvQ5bsYiUCMqLIDhhq8PGYhceqFwvKgUfsgTAC4vkoRHYOMdMNOZnxp5U15IV5sBY6Iqrm5RKXZzaoxP3pKXuiC4VSEfh6oR8D_RckbbqxoWhTPSw8Ix4n5ZpRAohMaOIZ8roH4QSg1T7fk2n2SiATp7tY1i1zmswEJOqhb7I99YXsGTtQYlNzWHCK0_OwA1MuKzyUk6lUTPjFAT3bS2rmVlgPEBjpvxGfTnmCjDmKj3TLjmr4NDDOI8JyB1JSL958o7U8-ti35-xViHK_Dz_INgDcYIXJyx0JG4U-c-uDYyoIBKLfVHvSINjLlYleUxyKlK14Gvt-NL_84DigIVCYRveTFQMbxHHfr0iMq1Q4JAf6CzRBckQ9xP3m8mTbspJ8HpLPKIbUok9r39SXBD1x5ZCDOYxBjdD_1M-obMxcKnsRRQlJwtHReEROdo5pdTxWwCFvTSjO3x0HaJI9ID3e5Su-Mfgc3z69Q6dgOZrGSHodQ39b6yaKb1fI2dzA1CpsacEC_UFKHh6xvfcDbF_itDwUmFUD9VGMNSxoiVNYNIghSlLDkI4Fp31N3ZKbNgcpASTxuuvMoQvNtB6mb9xZMGCJr_PVTZF0q7ixv_chyK4rbTS_hpldlv-S-WPHLIQfqzfGyYnTpOp25kQ6DURmg9ELm5h3zGq46yQoHQK7huxDeTJDTNkBrMWyYysnwUkjCjQO3uKqtR15jqYhnV-TL3-6jhkNqNRVIDjI8IeRM5kkiNRwVDRkd55GO-qZNRYOArXxrJx6Pjwp-vTXO_zIEd5zK_LRjBT6hwkobQPrbxFN0x5MminEbtgp4TDXXcWUb_MOtnRdLJWvNPJFkisxodgCDKQw6s_ZTnhUTx3grEwnvtZW-TsGTMUrCHMaF1_x9WClhpBzkPnGiocMm1uw2io6vhmcTfrs5h2p0zbaLlgc1YdANT-Vyky_F2ofkNqeck6yP_1SFLgNsOuB4kEz7PaT6Bo6Wm0p_xacZAjIIo56_z8WRVgj9Q_ev3olTjMHNO-OmfS8hkW3Tn3-1bRtAjLhbGSUY3Y9g37zdVU1zPl05ru0rg_-DjtuXInHlj94prMp-YNg1PX2279eIqbsoGDCmSLbVm3O3qdnQE36um47AYM-bATPHtBjmclBFTTfmpsNZK3lFm00]--></g></svg>