<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="2857px" preserveAspectRatio="none" style="width:1888px;height:2857px;background:#FFFFFF;" version="1.1" viewBox="0 0 1888 2857" width="1888px" zoomAndPan="magnify"><title>Rewrap PMEK</title><defs/><g><rect fill="#DDDDDD" height="2776.9844" style="stroke:#181818;stroke-width:0.5;" width="1680.4268" x="176.4473" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="990.2639" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1834.8486" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="98.0684" x="903.4028" y="41.3125">Rewrap PMEK</text><g><title>Storage</title><rect fill="transparent" height="2622.7441" width="8" x="53.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="56.6826" x2="56.6826" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#FFFFFF" height="103.2422" style="stroke:#181818;stroke-width:1;" width="10" x="51.6826" y="2659.543"/></g><g><title>Mail Box</title><rect fill="transparent" height="2622.7441" width="8" x="212.7231" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="216.2231" x2="216.2231" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#FFFFFF" height="251.0371" style="stroke:#181818;stroke-width:1;" width="10" x="211.2231" y="235.2832"/></g><g><title>FW</title><rect fill="transparent" height="2622.7441" width="8" x="417.1226" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="420.6226" x2="420.6226" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#FFFFFF" height="2202.5332" style="stroke:#181818;stroke-width:1;" width="10" x="415.6226" y="457.0098"/></g><g><title>Key Vault</title><rect fill="transparent" height="2622.7441" width="8" x="922.9404" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="926.4404" x2="926.4404" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="663.1836"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="853.3574"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="1086.8418"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="1292.3262"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="1555.1211"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="1774.6055"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="2037.4004"/></g><g><title/><rect fill="#FFFFFF" height="145.5527" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="2270.8848"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="921.4404" y="2476.3691"/></g><g><title>Key Vault</title><rect fill="transparent" height="2622.7441" width="8" x="1221.2827" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1224.7827" x2="1224.7827" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#ADD8E6" height="2548.8125" style="stroke:#181818;stroke-width:1;" width="10" x="1219.7827" y="213.9727"/></g><g><title>Key Vault</title><rect fill="transparent" height="2622.7441" width="8" x="1354.1655" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1357.6655" x2="1357.6655" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#ADD8E6" height="2548.8125" style="stroke:#181818;stroke-width:1;" width="10" x="1352.6655" y="213.9727"/></g><g><title>Key Vault</title><rect fill="transparent" height="2622.7441" width="8" x="1465.9834" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1469.4834" x2="1469.4834" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#ADD8E6" height="820.3164" style="stroke:#181818;stroke-width:1;" width="10" x="1464.4834" y="1685.3633"/></g><line style="stroke:#181818;stroke-width:2;" x1="1460.4834" x2="1478.4834" y1="2496.6797" y2="2514.6797"/><line style="stroke:#181818;stroke-width:2;" x1="1460.4834" x2="1478.4834" y1="2514.6797" y2="2496.6797"/><g><title>Key Vault</title><rect fill="transparent" height="2622.7441" width="8" x="1572.7256" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1576.2256" x2="1576.2256" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#ADD8E6" height="1741.5645" style="stroke:#181818;stroke-width:1;" width="10" x="1571.2256" y="764.1152"/></g><g><title>Key Vault</title><rect fill="transparent" height="2622.7441" width="8" x="1679.4678" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1682.9678" x2="1682.9678" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#ADD8E6" height="1551.3906" style="stroke:#181818;stroke-width:1;" width="10" x="1677.9678" y="954.2891"/></g><g><title>Key Vault</title><rect fill="transparent" height="2622.7441" width="8" x="1793.6064" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1797.1064" x2="1797.1064" y1="140.041" y2="2762.7852"/></g><g><title/><rect fill="#ADD8E6" height="1559.7012" style="stroke:#181818;stroke-width:1;" width="10" x="1792.1064" y="1203.084"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="887.6704" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="894.6704" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1155.3467" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1193.0127" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1205.0269" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1162.3467" y="129.0879">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1304.2188" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1325.8955" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1337.6807" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1311.2188" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1421.1123" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1437.7134" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1448.5688" y="112.5996">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1428.1123" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1527.8545" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1544.4556" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1556.938" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1534.8545" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1634.5967" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1651.1978" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1663.8101" y="112.5996">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1641.5967" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1741.3389" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1765.3364" y="112.5996">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1748.3389" y="129.0879">Temp Memory</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="24" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="31" y="2783.3203">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="34.4077" y="2799.8086">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="46.9414" y="2816.2969">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="180.4473" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="187.4473" y="2783.3203">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="403.8813" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="410.8813" y="2783.3203">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="887.6704" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="894.6704" y="2783.3203">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1155.3467" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1193.0127" y="2783.3203">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1205.0269" y="2799.8086">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1162.3467" y="2816.2969">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1304.2188" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1325.8955" y="2783.3203">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1337.6807" y="2799.8086">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1311.2188" y="2816.2969">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1421.1123" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1437.7134" y="2783.3203">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41.8291" x="1448.5688" y="2799.8086">Slot W</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1428.1123" y="2816.2969">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1527.8545" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1544.4556" y="2783.3203">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="1556.938" y="2799.8086">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1534.8545" y="2816.2969">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="1634.5967" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1651.1978" y="2783.3203">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="1663.8101" y="2799.8086">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="1641.5967" y="2816.2969">(Temporary)</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.5352" x="1741.3389" y="2762.7852"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1765.3364" y="2783.3203">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="97.5352" x="1748.3389" y="2799.8086">Temp Memory</text><path d="M17.4575,153.041 L17.4575,208.041 L1835.4575,208.041 L1835.4575,163.041 L1825.4575,153.041 L17.4575,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1825.4575,153.041 L1825.4575,163.041 L1835.4575,163.041 L1825.4575,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="728.3484" y="170.6094">Preconditions:</text><ellipse cx="733.8484" cy="181.1621" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.6094" x="740.3484" y="185.9199">Access Shared Secret already availble in a slot in KV</text><ellipse cx="733.8484" cy="196.4727" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.0923" x="740.3484" y="201.2305">unlocking key already in a slot and generated on each reset</text><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="235.2832" y2="231.2832"/><line style="stroke:#008000;stroke-width:1;" x1="209.2231" x2="199.2231" y1="235.2832" y2="239.2832"/><line style="stroke:#008000;stroke-width:1;" x1="56.6826" x2="210.2231" y1="235.2832" y2="235.2832"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="63.6826" y="230.541">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.1777" x="103.0454" y="230.541">REWRAP_PMEK</text><path d="M226.2231,248.2832 L226.2231,430.2832 L962.2231,430.2832 L962.2231,258.2832 L952.2231,248.2832 L226.2231,248.2832 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M952.2231,248.2832 L952.2231,258.2832 L962.2231,258.2832 L952.2231,248.2832 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="232.2231" y="267.8516">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="236.3364" y="267.8516">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="413.5693" y="267.8516">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="417.6826" y="267.8516">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="587.4824" y="267.8516">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="591.5957" y="267.8516">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="236.3364" y="283.1621">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="417.6826" y="283.1621">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="591.5957" y="283.1621">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.6504" x="236.3364" y="298.4727">wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="417.6826" y="298.4727">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.4087" x="591.5957" y="298.4727">KEM-wrapped access key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="147.1768" x="599.8223" y="313.7832">* access_key_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.0596" x="599.8223" y="329.0938">* kem_handle (X)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.0283" x="599.8223" y="344.4043">* kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0244" x="599.8223" y="359.7148">* kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="599.8223" y="375.0254">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.1196" x="236.3364" y="390.3359">wrapped_enc_access_key_2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.6865" x="417.6826" y="390.3359">DoubleWrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="356.5542" x="591.5957" y="390.3359">KEM-wrapped (access_key_2 encrypted to access_key_1)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="198.4722" x="599.8223" y="405.6465">* double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.5098" x="236.3364" y="420.957">old_locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="417.6826" y="420.957">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="591.5957" y="420.957">PMEK encrypted to access_key_1</text><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="255.2832" y2="255.2832"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="270.5938" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="285.9043" y2="285.9043"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="377.7676" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="408.3887" y2="408.3887"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="948.1499" y1="423.6992" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="232.2231" x2="232.2231" y1="255.2832" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="413.5693" x2="413.5693" y1="255.2832" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="587.4824" x2="587.4824" y1="255.2832" y2="423.6992"/><line style="stroke:#000000;stroke-width:0.5;" x1="948.1499" x2="948.1499" y1="255.2832" y2="423.6992"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="457.0098" y2="453.0098"/><line style="stroke:#008000;stroke-width:1;" x1="413.6226" x2="403.6226" y1="457.0098" y2="461.0098"/><line style="stroke:#008000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="457.0098" y2="457.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="228.2231" y="452.2676">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="267.5859" y="452.2676">Command</text><polygon fill="#FF0000" points="232.2231,482.3203,222.2231,486.3203,232.2231,490.3203,228.2231,486.3203" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="226.2231" x2="414.6226" y1="486.3203" y2="486.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="238.2231" y="481.5781">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="277.5859" y="481.5781">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="467.6226" y1="515.6309" y2="515.6309"/><line style="stroke:#FF0000;stroke-width:1;" x1="467.6226" x2="467.6226" y1="515.6309" y2="528.6309"/><line style="stroke:#FF0000;stroke-width:1;" x1="426.6226" x2="467.6226" y1="528.6309" y2="528.6309"/><polygon fill="#FF0000" points="436.6226,524.6309,426.6226,528.6309,436.6226,532.6309,432.6226,528.6309" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="510.8887">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="471.9854" y="510.8887">Determine command</text><path d="M8,540.6309 L70.1387,540.6309 L70.1387,547.9414 L60.1387,557.9414 L8,557.9414 L8,540.6309 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="2002.3594" style="stroke:#000000;stroke-width:1.5;" width="1810.1064" x="8" y="540.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="554.1992">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142.1514" x="85.1387" y="553.2656">[Storage Root Key exists]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1857.874" x="5" y="588.5967"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="588.5967" y2="588.5967"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="591.5967" y2="591.5967"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="867.7134" y="577.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="873.7134" y="594.5098">Get Access Key 1</text><polygon fill="#FF0000" points="909.4404,659.1836,919.4404,663.1836,909.4404,667.1836,913.4404,663.1836" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="663.1836" y2="663.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="643.1309">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="217.2422" x="471.9854" y="627.8203">Decaps(KEM Pair : kem_handle (g),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.0957" x="521.3447" y="643.1309">KEM ciphertext : kem_ciphertext from wrapped_access_key_1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="658.4414">Destination : Slot Y)</text><polygon fill="#FF0000" points="1340.6655,688.4941,1350.6655,692.4941,1340.6655,696.4941,1344.6655,692.4941" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1346.6655" y1="692.4941" y2="692.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="687.752">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="977.8032" y="687.752">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="721.8047" y2="721.8047"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="721.8047" y2="734.8047"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="734.8047" y2="734.8047"/><polygon fill="#FF0000" points="942.4404,730.8047,932.4404,734.8047,942.4404,738.8047,938.4404,734.8047" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="717.0625">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="222.3521" x="977.8032" y="717.0625">Decap KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="1559.2256,760.1152,1569.2256,764.1152,1559.2256,768.1152,1563.2256,764.1152" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="764.1152" y2="764.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="759.373">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.6621" x="977.8032" y="759.373">Put Shared Secret</text><polygon fill="#FF0000" points="436.6226,789.4258,426.6226,793.4258,436.6226,797.4258,432.6226,793.4258" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="793.4258" y2="793.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="788.6836">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="788.6836">done</text><polygon fill="#FF0000" points="909.4404,849.3574,919.4404,853.3574,909.4404,857.3574,913.4404,853.3574" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="853.3574" y2="853.3574"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="833.3047">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.6812" x="471.9854" y="817.9941">Unwrap(Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="216.6963" x="521.3447" y="833.3047">Key Data : wrapped_access_key_1,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="521.3447" y="848.6152">Destination : Slot Z)</text><polygon fill="#FF0000" points="1559.2256,878.668,1569.2256,882.668,1559.2256,886.668,1563.2256,882.668" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="882.668" y2="882.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="877.9258">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="977.8032" y="877.9258">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="911.9785" y2="911.9785"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="911.9785" y2="924.9785"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="924.9785" y2="924.9785"/><polygon fill="#FF0000" points="942.4404,920.9785,932.4404,924.9785,942.4404,928.9785,938.4404,924.9785" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="907.2363">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="196.5361" x="977.8032" y="907.2363">Unwrap wrapped_access_key_1</text><polygon fill="#FF0000" points="1665.9678,950.2891,1675.9678,954.2891,1665.9678,958.2891,1669.9678,954.2891" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1671.9678" y1="954.2891" y2="954.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="949.5469">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="977.8032" y="949.5469">Put Access Key 1</text><polygon fill="#FF0000" points="436.6226,979.5996,426.6226,983.5996,436.6226,987.5996,432.6226,983.5996" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="983.5996" y2="983.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="978.8574">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="978.8574">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1857.874" x="5" y="1012.2549"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="1012.2549" y2="1012.2549"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="1015.2549" y2="1015.2549"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="132.4473" x="867.7134" y="1001.5996"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="114.1626" x="873.7134" y="1018.168">Get Access Key 2</text><polygon fill="#FF0000" points="909.4404,1082.8418,919.4404,1086.8418,909.4404,1090.8418,913.4404,1086.8418" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="1086.8418" y2="1086.8418"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1066.7891">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.7944" x="471.9854" y="1051.4785">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.0264" x="521.3447" y="1066.7891">Key Data: double_encrypted_access_key,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.0474" x="521.3447" y="1082.0996">Destination Memory:</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="175.9951" x="656.5054" y="1082.0996">Put in memory as not a key)</text><polygon fill="#FF0000" points="1559.2256,1112.1523,1569.2256,1116.1523,1559.2256,1120.1523,1563.2256,1116.1523" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="1116.1523" y2="1116.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1111.4102">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111.0459" x="977.8032" y="1111.4102">Get Shared Secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="1160.7734" y2="1160.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="1160.7734" y2="1173.7734"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="1173.7734" y2="1173.7734"/><polygon fill="#FF0000" points="942.4404,1169.7734,932.4404,1173.7734,942.4404,1177.7734,938.4404,1173.7734" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1148.376">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="239.9795" x="977.8032" y="1140.7207">Unwrap double_encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.6377" x="977.8032" y="1156.0313">with Slot Y</text><polygon fill="#FF0000" points="1780.1064,1199.084,1790.1064,1203.084,1780.1064,1207.084,1784.1064,1203.084" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1786.1064" y1="1203.084" y2="1203.084"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1198.3418">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.2178" x="977.8032" y="1198.3418">Encrypted Access Key 2</text><polygon fill="#FF0000" points="436.6226,1228.3945,426.6226,1232.3945,436.6226,1236.3945,432.6226,1232.3945" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="1232.3945" y2="1232.3945"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1227.6523">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1227.6523">done</text><polygon fill="#FF0000" points="909.4404,1288.3262,919.4404,1292.3262,909.4404,1296.3262,913.4404,1292.3262" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="1292.3262" y2="1292.3262"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1272.2734">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.4399" x="471.9854" y="1256.9629">Unwrap(Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="162.6143" x="521.3447" y="1272.2734">Key Data : Temp Memory,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="1287.584">Destination : Slot Y)</text><polygon fill="#FF0000" points="1665.9678,1317.6367,1675.9678,1321.6367,1665.9678,1325.6367,1669.9678,1321.6367" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1671.9678" y1="1321.6367" y2="1321.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1316.8945">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="977.8032" y="1316.8945">Get Access Key 1</text><polygon fill="#FF0000" points="1780.1064,1346.9473,1790.1064,1350.9473,1780.1064,1354.9473,1784.1064,1350.9473" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1786.1064" y1="1350.9473" y2="1350.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1346.2051">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.7886" x="977.8032" y="1346.2051">Get encrypted_access_key</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="1380.2578" y2="1380.2578"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="1380.2578" y2="1393.2578"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="1393.2578" y2="1393.2578"/><polygon fill="#FF0000" points="942.4404,1389.2578,932.4404,1393.2578,942.4404,1397.2578,938.4404,1393.2578" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1375.5156">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.6216" x="977.8032" y="1375.5156">Unwrap encrypted access key 2</text><polygon fill="#FF0000" points="1559.2256,1418.5684,1569.2256,1422.5684,1559.2256,1426.5684,1563.2256,1422.5684" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="1422.5684" y2="1422.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1417.8262">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="105.9805" x="977.8032" y="1417.8262">Put Access Key 2</text><polygon fill="#FF0000" points="436.6226,1447.8789,426.6226,1451.8789,436.6226,1455.8789,432.6226,1451.8789" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="1451.8789" y2="1451.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1447.1367">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1447.1367">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1857.874" x="5" y="1480.5342"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="1480.5342" y2="1480.5342"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="1483.5342" y2="1483.5342"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="294.1411" x="786.8665" y="1469.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="275.8564" x="792.8665" y="1486.4473">Create PMEK wrapping/unwrapping Keys</text><polygon fill="#FF0000" points="909.4404,1551.1211,919.4404,1555.1211,909.4404,1559.1211,913.4404,1555.1211" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="1555.1211" y2="1555.1211"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1535.0684">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1519.7578">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="574.8174" y="1535.0684">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.5562" x="574.8174" y="1550.3789">Destination : Slot W)</text><polygon fill="#FF0000" points="1207.7827,1580.4316,1217.7827,1584.4316,1207.7827,1588.4316,1211.7827,1584.4316" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1213.7827" y1="1584.4316" y2="1584.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1579.6895">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1104" x="977.8032" y="1579.6895">Get Storage Root Key</text><polygon fill="#FF0000" points="1665.9678,1609.7422,1675.9678,1613.7422,1665.9678,1617.7422,1669.9678,1613.7422" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1671.9678" y1="1613.7422" y2="1613.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1609">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="977.8032" y="1609">Get Access Key 1</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="1643.0527" y2="1643.0527"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="1643.0527" y2="1656.0527"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="1656.0527" y2="1656.0527"/><polygon fill="#FF0000" points="942.4404,1652.0527,932.4404,1656.0527,942.4404,1660.0527,938.4404,1656.0527" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1638.3105">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.0376" x="977.8032" y="1638.3105">HMAC512 slot A and Slot Z</text><polygon fill="#FF0000" points="1452.4834,1681.3633,1462.4834,1685.3633,1452.4834,1689.3633,1456.4834,1685.3633" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1458.4834" y1="1685.3633" y2="1685.3633"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1680.6211">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="285.1177" x="977.8032" y="1680.6211">HMAC512 result Encryption Key for old PMEK</text><polygon fill="#FF0000" points="436.6226,1710.6738,426.6226,1714.6738,436.6226,1718.6738,432.6226,1714.6738" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="1714.6738" y2="1714.6738"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1709.9316">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1709.9316">done</text><polygon fill="#FF0000" points="909.4404,1770.6055,919.4404,1774.6055,909.4404,1778.6055,913.4404,1774.6055" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="1774.6055" y2="1774.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="1754.5527">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="471.9854" y="1739.2422">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="574.8174" y="1754.5527">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="574.8174" y="1769.8633">Destination : Slot Z)</text><polygon fill="#FF0000" points="1207.7827,1799.916,1217.7827,1803.916,1207.7827,1807.916,1211.7827,1803.916" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1213.7827" y1="1803.916" y2="1803.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1799.1738">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.0762" x="977.8032" y="1799.1738">Get System Root Key</text><polygon fill="#FF0000" points="1559.2256,1829.2266,1569.2256,1833.2266,1559.2256,1837.2266,1563.2256,1833.2266" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="1833.2266" y2="1833.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1828.4844">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107.3643" x="977.8032" y="1828.4844">Get Access Key 2</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="1862.5371" y2="1862.5371"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="1862.5371" y2="1875.5371"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="1875.5371" y2="1875.5371"/><polygon fill="#FF0000" points="942.4404,1871.5371,932.4404,1875.5371,942.4404,1879.5371,938.4404,1875.5371" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1857.7949">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.2788" x="977.8032" y="1857.7949">HMAC512 slot A and Slot Y</text><polygon fill="#FF0000" points="1665.9678,1900.8477,1675.9678,1904.8477,1665.9678,1908.8477,1669.9678,1904.8477" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1671.9678" y1="1904.8477" y2="1904.8477"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="1900.1055">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="292.0557" x="977.8032" y="1900.1055">HMAC512 result New Encryption Key for PMEK</text><polygon fill="#FF0000" points="436.6226,1930.1582,426.6226,1934.1582,436.6226,1938.1582,432.6226,1934.1582" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="1934.1582" y2="1934.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="1929.416">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="1929.416">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1857.874" x="5" y="1962.8135"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="1962.8135" y2="1962.8135"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="1965.8135" y2="1965.8135"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="81.958" x="892.958" y="1952.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="63.6733" x="898.958" y="1968.7266">Get PMEK</text><polygon fill="#FF0000" points="909.4404,2033.4004,919.4404,2037.4004,909.4404,2041.4004,913.4404,2037.4004" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="2037.4004" y2="2037.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2017.3477">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.8159" x="471.9854" y="2002.0371">Unwrap(Key : Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.9038" x="521.3447" y="2017.3477">Key Data: locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.5347" x="521.3447" y="2032.6582">Destination : Slot Y)</text><polygon fill="#FF0000" points="1452.4834,2062.7109,1462.4834,2066.7109,1452.4834,2070.7109,1456.4834,2066.7109" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1458.4834" y1="2066.7109" y2="2066.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2061.9688">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.6392" x="977.8032" y="2061.9688">Encryption Key for old PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="2096.0215" y2="2096.0215"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="2096.0215" y2="2109.0215"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="2109.0215" y2="2109.0215"/><polygon fill="#FF0000" points="942.4404,2105.0215,932.4404,2109.0215,942.4404,2113.0215,938.4404,2109.0215" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2091.2793">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.9702" x="977.8032" y="2091.2793">Unwrap locked_pmek</text><polygon fill="#FF0000" points="1559.2256,2134.332,1569.2256,2138.332,1559.2256,2142.332,1563.2256,2138.332" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="2138.332" y2="2138.332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2133.5898">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.9155" x="977.8032" y="2133.5898">PMEK</text><polygon fill="#FF0000" points="436.6226,2163.6426,426.6226,2167.6426,436.6226,2171.6426,432.6226,2167.6426" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="2167.6426" y2="2167.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2162.9004">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2162.9004">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1857.874" x="5" y="2196.2979"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="2196.2979" y2="2196.2979"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1862.874" y1="2199.2979" y2="2199.2979"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="176.5952" x="845.6394" y="2185.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.3105" x="851.6394" y="2202.2109">Create the locked PMEK</text><polygon fill="#FF0000" points="909.4404,2266.8848,919.4404,2270.8848,909.4404,2274.8848,913.4404,2270.8848" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="2270.8848" y2="2270.8848"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2250.832">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.4692" x="471.9854" y="2235.5215">Wrap(Key: Slot Z,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.7524" x="525.458" y="2250.832">Data Key : Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="203.6265" x="525.458" y="2266.1426">Destination : new_locked_pmek)</text><polygon fill="#FF0000" points="1665.9678,2296.1953,1675.9678,2300.1953,1665.9678,2304.1953,1669.9678,2300.1953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1671.9678" y1="2300.1953" y2="2300.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2295.4531">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.9634" x="977.8032" y="2295.4531">Get New Encryption Key</text><polygon fill="#FF0000" points="1559.2256,2325.5059,1569.2256,2329.5059,1559.2256,2333.5059,1563.2256,2329.5059" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="2329.5059" y2="2329.5059"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2324.7637">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.5283" x="977.8032" y="2324.7637">Get PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="973.4404" y1="2374.127" y2="2374.127"/><line style="stroke:#FF0000;stroke-width:1;" x1="973.4404" x2="973.4404" y1="2374.127" y2="2387.127"/><line style="stroke:#FF0000;stroke-width:1;" x1="932.4404" x2="973.4404" y1="2387.127" y2="2387.127"/><polygon fill="#FF0000" points="942.4404,2383.127,932.4404,2387.127,942.4404,2391.127,938.4404,2387.127" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2361.7295">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.8311" x="977.8032" y="2354.0742">Wrap slot Y with Slot Z to</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.4126" x="977.8032" y="2369.3848">generate new_encrypted_pmek</text><polygon fill="#FF0000" points="436.6226,2412.4375,426.6226,2416.4375,436.6226,2420.4375,432.6226,2416.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="2416.4375" y2="2416.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2411.6953">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="481.9854" y="2411.6953">new_encrypted_pmek</text><polygon fill="#FF0000" points="909.4404,2472.3691,919.4404,2476.3691,909.4404,2480.3691,913.4404,2476.3691" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.6226" x2="915.4404" y1="2476.3691" y2="2476.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.6226" y="2456.3164">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.9844" x="471.9854" y="2441.0059">Purge_key(Key: Slot W,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.7944" x="537.7979" y="2456.3164">Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="537.7979" y="2471.627">Key : Slot Z)</text><polygon fill="#FF0000" points="1452.4834,2501.6797,1462.4834,2505.6797,1452.4834,2509.6797,1456.4834,2505.6797" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1458.4834" y1="2505.6797" y2="2505.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2500.9375">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="977.8032" y="2500.9375">Purge</text><polygon fill="#FF0000" points="1559.2256,2501.6797,1569.2256,2505.6797,1559.2256,2509.6797,1563.2256,2505.6797" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1565.2256" y1="2505.6797" y2="2505.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2500.9375">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="977.8032" y="2500.9375">&#160;</text><polygon fill="#FF0000" points="1665.9678,2501.6797,1675.9678,2505.6797,1665.9678,2509.6797,1669.9678,2505.6797" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="931.4404" x2="1671.9678" y1="2505.6797" y2="2505.6797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="938.4404" y="2500.9375">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="977.8032" y="2500.9375">&#160;</text><polygon fill="#FF0000" points="436.6226,2530.9902,426.6226,2534.9902,436.6226,2538.9902,432.6226,2534.9902" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.6226" x2="920.4404" y1="2534.9902" y2="2534.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.6226" y="2530.248">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="481.9854" y="2530.248">done</text><path d="M1577.5854,2561.9902 L1577.5854,2616.9902 L1791.5854,2616.9902 L1791.5854,2571.9902 L1781.5854,2561.9902 L1577.5854,2561.9902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1781.5854,2561.9902 L1781.5854,2571.9902 L1791.5854,2571.9902 L1781.5854,2561.9902 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="1583.5854" y="2579.5586">Did not purge temp memory</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.521" x="1583.5854" y="2594.8691">as it contains encrypted object</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="36.918" x="1583.5854" y="2610.1797">purge</text><polygon fill="#FF0000" points="227.2231,2655.543,217.2231,2659.543,227.2231,2663.543,223.2231,2659.543" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="221.2231" x2="414.6226" y1="2659.543" y2="2659.543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="233.2231" y="2647.1455">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="272.5859" y="2639.4902">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="272.5859" y="2654.8008">new_encrypted_pmek</text><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2659.543" y2="2655.543"/><line style="stroke:#008000;stroke-width:1;" x1="62.6826" x2="72.6826" y1="2659.543" y2="2663.543"/><line style="stroke:#008000;stroke-width:1;" x1="61.6826" x2="215.2231" y1="2659.543" y2="2659.543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="78.6826" y="2647.1455">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="118.0454" y="2639.4902">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="118.0454" y="2654.8008">complete</text><path d="M221.2231,2672.543 L221.2231,2747.543 L837.2231,2747.543 L837.2231,2682.543 L827.2231,2672.543 L221.2231,2672.543 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M827.2231,2672.543 L827.2231,2682.543 L837.2231,2682.543 L827.2231,2672.543 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="227.2231" y="2692.1113">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="231.3364" y="2692.1113">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="371.4863" y="2692.1113">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="375.5996" y="2692.1113">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="476.229" y="2692.1113">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="480.3423" y="2692.1113">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="231.3364" y="2707.4219">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2707.4219">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="480.3423" y="2707.4219">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="231.3364" y="2722.7324">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="375.5996" y="2722.7324">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="480.3423" y="2722.7324">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0366" x="231.3364" y="2738.043">new_encrypted_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="375.5996" y="2738.043">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.499" x="480.3423" y="2738.043">PMEK encrypted to access_key_2</text><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2679.543" y2="2679.543"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2694.8535" y2="2694.8535"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2710.1641" y2="2710.1641"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2725.4746" y2="2725.4746"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="822.8809" y1="2740.7852" y2="2740.7852"/><line style="stroke:#000000;stroke-width:0.5;" x1="227.2231" x2="227.2231" y1="2679.543" y2="2740.7852"/><line style="stroke:#000000;stroke-width:0.5;" x1="371.4863" x2="371.4863" y1="2679.543" y2="2740.7852"/><line style="stroke:#000000;stroke-width:0.5;" x1="476.229" x2="476.229" y1="2679.543" y2="2740.7852"/><line style="stroke:#000000;stroke-width:0.5;" x1="822.8809" x2="822.8809" y1="2679.543" y2="2740.7852"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="136.5967" x="884.1387" y="2846.918">Filename: rewrap_pmek.uml</text><!--SRC=[nLXjRzis4FwkNq47MUiiJejas1UZ2U35JXTawOmuhPSWW47BbCrP8WMIYkgWFtv7wiMKJDbDstH2FZYw5nwVv-vuOeioFqnc174_deJSNquIHKFv1bvxNcjVBdWwmM68Jj4lIYIaVU2zhhuDS2ZrQwz50zGkHGSUWYTNZGNnEPjPJYoXeYeaRX6EgLiGoVaana9IDdShp3YpVRO81DaGKR41LqWEMHwJGr8Bog5HH5M8MeJDQ521pYoT6TsQAFPkI2fmZ8RNWwizbqM-bSo6SKKGzWMNqloldtVJis6cGnNbJ7RVlPsUbT9VKS_tYPHejC22pD28-88eX4D1y6o5y2EcuHJYe0nX94EkzA-hJvPzmdJUw5qloQeqNEjZm7bE615OWN_E4C7-0WaYYJ9UO4icxd9pKYmF3z7-7nylBWOtazxvxUMdtktbtn-y9OdcRedd1IdQntB5V1HDGQUBRWRZczvmed6h9cTCBQm4dIyKc9Jx-QBnkg0adA7wOqGZ-aISWZu9A3C8eo-MDt-nb4c4aCDRyji9SWh-eafJh-70LMyw5M8ocs33sGG0dnpded4cojYy0YOAcwl1zL5kXp8xJTG3C-HPZd0uvuAgHPIB0Et90iY3IDh_75WlNOe-ZHT4AF9PvIy9yyKgLfLOdLi1HNix9o3gymHIRcD3rQsqAqRbSaXnUrF7HU0putEoComUpamV18qu8akRba5XEwm9T8urHv2xtqZpQ5fah1-a9cNFUHG1u9LqjRfAbhQ-plGyqS7cFHIhdzjfSJGzEZ8_zYK9W_OUgEzrq5wVA28Y2lqdLzwpkw8nAkB2eK8ZnGMU4tJ3eO0rzkGpbKfwHllqrAoQzmqjFOPtjU2MZuU7NTGdFevb6tX3Gqm5n6jdrVoWOzWf7wstpgHSsteH21uvQw3gfa-aeWoRMkoYaMv2TnbuoySYF6Wb6NXwJTX33E7LL1xp-8tA-JgA57BVRQ985A-wQ9YeQZirMaReRb_cZ5Xphi-9Wp8dI-y0xj4HR4YBCvEIm4mlPxuWqid8HwRnQslM2cXg782aZnK6iGlfpawexm-Se6YiDq6fe9t5vbnsq-LJXhETXINCJpyJPdT9d3ILX8E0Zfk1xhQcjOM7Qn9n0OY_2pZJpI7auXHWFzDmmR4S6J72KhSZEAJ1sVSojYNE1sRA9TlevZ8GJ7VTM2i0Ug_BKpeaWSh-HHkx6iF08qZHVlKOeXR4EkY02PLIdtHGG8LiT6EYh5aUcza5NZ8aitcnq6ho8ZEuf87h3ReCK0hHquWgn1DX-oxYvQp9LtRCBbIa3vJUeDVl89d0v0J4zGQZe_VdrntjtOSHGP0un7vZLB3wTAN7CK0d9DRIvNvG9N1OeicL6V4oK6f8IVYJtATcofj1-hx9V9JdNb6SGFdFBi_TDNZVs0Hl8UIyf3hFFcRoHbK_BXlgGAkvQgYnxjOpXvtlZMTIfRfUyCo1RdWENm5Gk6OoClqSKkzjmegVEWRPr27_lEwT_tvyCj68IfkaNes0ocFeQcOKxM1kN6CEFaBo3bWRXRw1OCrOlgdiawXdQYWBSzDVkjQ6hwG4nh71kcAr-u0BFQSQTCkoIl_lelenjDqzZxRxHjfM4b3PmjfgWxMJhsVjpfa5DTO-aDJ5NCdQYuuYflA-UWGPDuuWrhVGDtM_jBipUrsTpLhMtSvU3iHQ2zCdNHRDLap7EQ95NjPpVbUUL-5a9BM_GfjFbSqSQynqDzuwxYozxz1wKhk7cUE15RSs9fprmLIIylNODpbuVfSP9c9EzA5eWJrsD9WjytLDxFfUIL6hXVB5ZFHL3LAGkzu_5Uz_U5eIVIzG3iF5pE2vPhG-DHCNYdNqHZEV-PtQCBXH_JzJc39fZHHy-Y_nivdVUFBAISxpQfSG-SM5RdmnPv8yC0VXhz3wngDwuV70V1x58T6kl_Echdv7zyohkVgbtBQxk836SY8LLebiDhy4EnzA240EJ2l9hryGbUZYSZX2C0y9_gZXXiy3XeWGyCDUPXF9ZQke7JTG9mqtK2O3WKplFm00]--></g></svg>