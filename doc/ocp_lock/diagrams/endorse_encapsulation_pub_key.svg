<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1392px" preserveAspectRatio="none" style="width:1540px;height:1392px;background:#FFFFFF;" version="1.1" viewBox="0 0 1540 1392" width="1540px" zoomAndPan="magnify"><title>Endorse Encapsulation Pub Key</title><defs/><g><rect fill="#DDDDDD" height="1312.8809" style="stroke:#181818;stroke-width:0.5;" width="1011.873" x="380.3762" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="859.916" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1486.8049" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="226.3242" x="697.3394" y="41.3125">Endorse Encapsulation Pub Key</text><g><title>Storage</title><rect fill="transparent" height="1125.6641" width="8" x="117.3552" y="156.5293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="120.8552" x2="120.8552" y1="156.5293" y2="1282.1934"/></g><g><title/><rect fill="#FFFFFF" height="149.1738" style="stroke:#181818;stroke-width:1;" width="10" x="115.8552" y="1133.0195"/></g><g><title>Mail Box</title><rect fill="transparent" height="1125.6641" width="8" x="416.6521" y="156.5293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="420.1521" x2="420.1521" y1="156.5293" y2="1282.1934"/></g><g><title/><rect fill="#FFFFFF" height="159.1738" style="stroke:#181818;stroke-width:1;" width="10" x="415.1521" y="358.9453"/></g><g><title>FW</title><rect fill="transparent" height="1125.6641" width="8" x="614.0881" y="156.5293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="617.5881" x2="617.5881" y1="156.5293" y2="1282.1934"/></g><g><title/><rect fill="#FFFFFF" height="644.2109" style="stroke:#181818;stroke-width:1;" width="10" x="612.5881" y="488.8086"/></g><g><title>Key Vault</title><rect fill="transparent" height="1125.6641" width="8" x="988.907" y="156.5293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="992.407" x2="992.407" y1="156.5293" y2="1282.1934"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="987.407" y="652.3613"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="987.407" y="887.8457"/></g><g><title>Key Vault</title><rect fill="transparent" height="1125.6641" width="8" x="1173.4446" y="156.5293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1176.9446" x2="1176.9446" y1="156.5293" y2="1282.1934"/></g><g><title/><rect fill="#ADD8E6" height="944.5586" style="stroke:#181818;stroke-width:1;" width="10" x="1171.9446" y="337.6348"/></g><g><title>Key Vault</title><rect fill="transparent" height="1125.6641" width="8" x="1331.3025" y="156.5293"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1334.8025" x2="1334.8025" y1="156.5293" y2="1282.1934"/></g><g><title/><rect fill="#ADD8E6" height="944.5586" style="stroke:#181818;stroke-width:1;" width="10" x="1329.8025" y="337.6348"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="88.1726" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="95.1726" y="112.5996">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="98.5803" y="129.0879">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="111.114" y="145.5762">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="384.3762" y="125.041"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="391.3762" y="145.5762">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="600.8469" y="125.041"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="607.8469" y="145.5762">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="953.637" y="125.041"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="960.637" y="145.5762">Key Vault</text><rect fill="#E2E2F0" height="79.9531" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188.8223" x="1082.5334" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1145.1746" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.3584" x="1158.2654" y="112.5996">Slot F</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.6338" x="1123.6277" y="129.0879">(DICE Alias Key)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.8223" x="1089.5334" y="145.5762">ecdsa_secp384r1_sha384</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1281.3557" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1303.0325" y="112.5996">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1314.8176" y="129.0879">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1288.3557" y="145.5762">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="88.1726" y="1282.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="95.1726" y="1302.7285">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="98.5803" y="1319.2168">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="111.114" y="1335.7051">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="384.3762" y="1282.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="391.3762" y="1302.7285">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="600.8469" y="1282.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="607.8469" y="1302.7285">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="953.637" y="1282.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="960.637" y="1302.7285">Key Vault</text><rect fill="#E2E2F0" height="79.9531" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="188.8223" x="1082.5334" y="1282.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1145.1746" y="1302.7285">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.3584" x="1158.2654" y="1319.2168">Slot F</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="106.6338" x="1123.6277" y="1335.7051">(DICE Alias Key)</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="174.8223" x="1089.5334" y="1352.1934">ecdsa_secp384r1_sha384</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1281.3557" y="1282.1934"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1303.0325" y="1302.7285">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1314.8176" y="1319.2168">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1288.3557" y="1335.7051">(KEM Keypair)</text><path d="M10,169.5293 L10,332.5293 L1445,332.5293 L1445,179.5293 L1435,169.5293 L10,169.5293 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1435,169.5293 L1435,179.5293 L1445,179.5293 L1435,169.5293 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="16" y="187.0977">Preconditions:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="424.5566" x="24.2266" y="202.4082">* DICE Alias Key is available in a KV slot and FW manages the slot #</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="453.9844" x="32.4531" y="217.7188">The DICE Alias Key in already defined by Caliptra and is not the DPE Key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402.8413" x="24.2266" y="233.0293">* HPKE Keypair available in a KV slot and FW manages the slot #</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="16" y="248.3398">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="41.7422" x="16" y="263.6504">Notes:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1406.4312" x="24.2266" y="278.9609">* The sequence diagram assumes that the KV will not allow an input KV slot to also be used as an out KV slot. Caliptra FW is responsible for managing which KV slots are used and can adapt if this assumption is not correct.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="579.395" x="24.2266" y="294.2715">* This sequence is focused on successful execution of operations by the KV. Sill need to do:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="16" y="309.582">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="12.3398" x="16" y="324.8926">&#160;&#160;&#160;</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="185.5991" x="32.4531" y="324.8926">Need to add more algorithms</text><line style="stroke:#008000;stroke-width:1;" x1="413.1521" x2="403.1521" y1="358.9453" y2="354.9453"/><line style="stroke:#008000;stroke-width:1;" x1="413.1521" x2="403.1521" y1="358.9453" y2="362.9453"/><line style="stroke:#008000;stroke-width:1;" x1="120.8552" x2="414.1521" y1="358.9453" y2="358.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="127.8552" y="354.2031">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.9341" x="167.218" y="354.2031">ENDORSE_ENCAPSULATION_PUB_KEY</text><path d="M430.1521,371.9453 L430.1521,461.9453 L948.1521,461.9453 L948.1521,381.9453 L938.1521,371.9453 L430.1521,371.9453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M938.1521,371.9453 L938.1521,381.9453 L948.1521,381.9453 L938.1521,371.9453 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="436.1521" y="391.5137">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="440.2654" y="391.5137">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="595.0276" y="391.5137">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="599.1409" y="391.5137">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="644.2156" y="391.5137">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="648.3289" y="391.5137">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="440.2654" y="406.8242">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="599.1409" y="406.8242">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="648.3289" y="406.8242">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75.9751" x="440.2654" y="422.1348">kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="599.1409" y="422.1348">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281.5122" x="648.3289" y="422.1348">Handle for KEM keypair held in KMB memory</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="150.6489" x="440.2654" y="437.4453">endorsement_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="599.1409" y="437.4453">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="209.1489" x="648.3289" y="437.4453">Endorsement algorithm identifier</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.2305" x="648.3289" y="452.7559">* If 0h, then return public key</text><line style="stroke:#000000;stroke-width:0.5;" x1="436.1521" x2="933.9543" y1="378.9453" y2="378.9453"/><line style="stroke:#000000;stroke-width:0.5;" x1="436.1521" x2="933.9543" y1="394.2559" y2="394.2559"/><line style="stroke:#000000;stroke-width:0.5;" x1="436.1521" x2="933.9543" y1="409.5664" y2="409.5664"/><line style="stroke:#000000;stroke-width:0.5;" x1="436.1521" x2="933.9543" y1="424.877" y2="424.877"/><line style="stroke:#000000;stroke-width:0.5;" x1="436.1521" x2="933.9543" y1="455.498" y2="455.498"/><line style="stroke:#000000;stroke-width:0.5;" x1="436.1521" x2="436.1521" y1="378.9453" y2="455.498"/><line style="stroke:#000000;stroke-width:0.5;" x1="595.0276" x2="595.0276" y1="378.9453" y2="455.498"/><line style="stroke:#000000;stroke-width:0.5;" x1="644.2156" x2="644.2156" y1="378.9453" y2="455.498"/><line style="stroke:#000000;stroke-width:0.5;" x1="933.9543" x2="933.9543" y1="378.9453" y2="455.498"/><line style="stroke:#008000;stroke-width:1;" x1="610.5881" x2="600.5881" y1="488.8086" y2="484.8086"/><line style="stroke:#008000;stroke-width:1;" x1="610.5881" x2="600.5881" y1="488.8086" y2="492.8086"/><line style="stroke:#008000;stroke-width:1;" x1="425.1521" x2="611.5881" y1="488.8086" y2="488.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="432.1521" y="484.0664">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="471.5149" y="484.0664">Command</text><polygon fill="#FF0000" points="436.1521,514.1191,426.1521,518.1191,436.1521,522.1191,432.1521,518.1191" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="430.1521" x2="611.5881" y1="518.1191" y2="518.1191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="442.1521" y="513.377">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="481.5149" y="513.377">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="622.5881" x2="664.5881" y1="547.4297" y2="547.4297"/><line style="stroke:#FF0000;stroke-width:1;" x1="664.5881" x2="664.5881" y1="547.4297" y2="560.4297"/><line style="stroke:#FF0000;stroke-width:1;" x1="623.5881" x2="664.5881" y1="560.4297" y2="560.4297"/><polygon fill="#FF0000" points="633.5881,556.4297,623.5881,560.4297,633.5881,564.4297,629.5881,560.4297" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="629.5881" y="542.6875">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="668.9509" y="542.6875">Determine command</text><path d="M385.1521,572.4297 L447.2908,572.4297 L447.2908,579.7402 L437.2908,589.7402 L385.1521,589.7402 L385.1521,572.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="509.9688" style="stroke:#000000;stroke-width:1.5;" width="990.6504" x="385.1521" y="572.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="400.1521" y="585.998">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="249.5518" x="462.2908" y="585.0645">[kem_handle (G) has a Key Pair in KV slot G]</text><path d="M404.1521,603.7402 L466.2908,603.7402 L466.2908,611.0508 L456.2908,621.0508 L404.1521,621.0508 L404.1521,603.7402 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="144.5527" style="stroke:#000000;stroke-width:1.5;" width="946.6504" x="404.1521" y="603.7402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="419.1521" y="617.3086">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="127.5688" x="481.2908" y="616.375">[Slot X algorithm type]</text><polygon fill="#FF0000" points="975.407,648.3613,985.407,652.3613,975.407,656.3613,979.407,652.3613" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="622.5881" x2="981.407" y1="652.3613" y2="652.3613"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="629.5881" y="647.6191">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237.8149" x="668.9509" y="647.6191">Get_Pub_ecdh_secp384r1(Key: Slot G)</text><polygon fill="#FF0000" points="1317.8025,677.6719,1327.8025,681.6719,1317.8025,685.6719,1321.8025,681.6719" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="997.407" x2="1323.8025" y1="681.6719" y2="681.6719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1004.407" y="676.9297">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="89.8574" x="1043.7698" y="676.9297">Get Public Key</text><polygon fill="#FF0000" points="633.5881,706.9824,623.5881,710.9824,633.5881,714.9824,629.5881,710.9824" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="627.5881" x2="986.407" y1="710.9824" y2="710.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="639.5881" y="706.2402">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.5649" x="678.9509" y="706.2402">pub_key</text><polygon fill="#FF0000" points="431.1521,736.293,421.1521,740.293,431.1521,744.293,427.1521,740.293" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.1521" x2="611.5881" y1="740.293" y2="740.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="437.1521" y="735.5508">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.5649" x="476.5149" y="735.5508">pub_key</text><path d="M404.1521,766.293 L466.2908,766.293 L466.2908,773.6035 L456.2908,783.6035 L404.1521,783.6035 L404.1521,766.293 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="302.1055" style="stroke:#000000;stroke-width:1.5;" width="788.7925" x="404.1521" y="766.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="419.1521" y="779.8613">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="230.8066" x="481.2908" y="778.9277">[endorsement algorithm Byte 0 bit 0 set]</text><line style="stroke:#FF0000;stroke-width:1;" x1="622.5881" x2="664.5881" y1="814.9141" y2="814.9141"/><line style="stroke:#FF0000;stroke-width:1;" x1="664.5881" x2="664.5881" y1="814.9141" y2="827.9141"/><line style="stroke:#FF0000;stroke-width:1;" x1="623.5881" x2="664.5881" y1="827.9141" y2="827.9141"/><polygon fill="#FF0000" points="633.5881,823.9141,623.5881,827.9141,633.5881,831.9141,629.5881,827.9141" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="629.5881" y="810.1719">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.7764" x="668.9509" y="810.1719">Build the certificate TBS</text><polygon fill="#FF0000" points="975.407,883.8457,985.407,887.8457,975.407,891.8457,979.407,887.8457" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="622.5881" x2="981.407" y1="887.8457" y2="887.8457"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="629.5881" y="867.793">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="236.1138" x="668.9509" y="852.4824">ecdsa_secp384r1_sha384(Key: Slot F,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130.4316" x="829.3689" y="867.793">Data : certificate TBS</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.8257" x="829.3689" y="883.1035">Output: signature)</text><polygon fill="#FF0000" points="1159.9446,913.1563,1169.9446,917.1563,1159.9446,921.1563,1163.9446,917.1563" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="997.407" x2="1165.9446" y1="917.1563" y2="917.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1004.407" y="912.4141">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.1748" x="1043.7698" y="912.4141">Get DICE Alias Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="997.407" x2="1039.407" y1="946.4668" y2="946.4668"/><line style="stroke:#FF0000;stroke-width:1;" x1="1039.407" x2="1039.407" y1="946.4668" y2="959.4668"/><line style="stroke:#FF0000;stroke-width:1;" x1="998.407" x2="1039.407" y1="959.4668" y2="959.4668"/><polygon fill="#FF0000" points="1008.407,955.4668,998.407,959.4668,1008.407,963.4668,1004.407,959.4668" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1004.407" y="941.7246">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.606" x="1043.7698" y="941.7246">generate signature</text><polygon fill="#FF0000" points="633.5881,984.7773,623.5881,988.7773,633.5881,992.7773,629.5881,988.7773" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="627.5881" x2="986.407" y1="988.7773" y2="988.7773"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="639.5881" y="984.0352">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.23" x="678.9509" y="984.0352">signature</text><line style="stroke:#FF0000;stroke-width:1;" x1="622.5881" x2="664.5881" y1="1018.0879" y2="1018.0879"/><line style="stroke:#FF0000;stroke-width:1;" x1="664.5881" x2="664.5881" y1="1018.0879" y2="1031.0879"/><line style="stroke:#FF0000;stroke-width:1;" x1="623.5881" x2="664.5881" y1="1031.0879" y2="1031.0879"/><polygon fill="#FF0000" points="633.5881,1027.0879,623.5881,1031.0879,633.5881,1035.0879,629.5881,1031.0879" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="629.5881" y="1013.3457">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="316.4561" x="668.9509" y="1013.3457">Append signature to certificate To Be Signed (TBS)</text><polygon fill="#FF0000" points="431.1521,1056.3984,421.1521,1060.3984,431.1521,1064.3984,427.1521,1060.3984" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.1521" x2="611.5881" y1="1060.3984" y2="1060.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="437.1521" y="1055.6563">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.0732" x="476.5149" y="1055.6563">signed endorsement</text><polygon fill="#FF0000" points="431.1521,1129.0195,421.1521,1133.0195,431.1521,1137.0195,427.1521,1133.0195" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="425.1521" x2="611.5881" y1="1133.0195" y2="1133.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="437.1521" y="1128.2773">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="476.5149" y="1128.2773">Command response</text><line style="stroke:#008000;stroke-width:1;" x1="126.8552" x2="136.8552" y1="1133.0195" y2="1129.0195"/><line style="stroke:#008000;stroke-width:1;" x1="126.8552" x2="136.8552" y1="1133.0195" y2="1137.0195"/><line style="stroke:#008000;stroke-width:1;" x1="125.8552" x2="419.1521" y1="1133.0195" y2="1133.0195"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="142.8552" y="1120.6221">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="182.218" y="1112.9668">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="182.218" y="1128.2773">complete</text><path d="M425.1521,1146.0195 L425.1521,1267.0195 L1050.1521,1267.0195 L1050.1521,1156.0195 L1040.1521,1146.0195 L425.1521,1146.0195 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1040.1521,1146.0195 L1040.1521,1156.0195 L1050.1521,1156.0195 L1040.1521,1146.0195 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="431.1521" y="1165.5879">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="435.2654" y="1165.5879">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="547.9236" y="1165.5879">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="552.0369" y="1165.5879">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="689.4382" y="1165.5879">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="693.5515" y="1165.5879">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="435.2654" y="1180.8984">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="552.0369" y="1180.8984">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="693.5515" y="1180.8984">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="435.2654" y="1196.209">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="552.0369" y="1196.209">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="693.5515" y="1196.209">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.1333" x="435.2654" y="1211.5195">pub_key_len</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="552.0369" y="1211.5195">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="300.1616" x="693.5515" y="1211.5195">Length of HPKE public key (`Npk` in RFC 9180)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.5449" x="435.2654" y="1226.8301">endorsement_len</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="552.0369" y="1226.8301">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.7627" x="693.5515" y="1226.8301">Length of endorsement data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52.5649" x="435.2654" y="1242.1406">pub_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.8765" x="552.0369" y="1242.1406">u8[pub_key_len]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.1958" x="693.5515" y="1242.1406">KEM public key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.9766" x="435.2654" y="1257.4512">endorsement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.2881" x="552.0369" y="1257.4512">u8[endorsement_len]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193.5464" x="693.5515" y="1257.4512">DER-encoded X.509 certificate</text><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1153.0195" y2="1153.0195"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1168.3301" y2="1168.3301"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1183.6406" y2="1183.6406"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1198.9512" y2="1198.9512"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1214.2617" y2="1214.2617"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1229.5723" y2="1229.5723"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1244.8828" y2="1244.8828"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="1036.0901" y1="1260.1934" y2="1260.1934"/><line style="stroke:#000000;stroke-width:0.5;" x1="431.1521" x2="431.1521" y1="1153.0195" y2="1260.1934"/><line style="stroke:#000000;stroke-width:0.5;" x1="547.9236" x2="547.9236" y1="1153.0195" y2="1260.1934"/><line style="stroke:#000000;stroke-width:0.5;" x1="689.4382" x2="689.4382" y1="1153.0195" y2="1260.1934"/><line style="stroke:#000000;stroke-width:0.5;" x1="1036.0901" x2="1036.0901" y1="1153.0195" y2="1260.1934"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="228.0957" x="696.4536" y="1382.8145">Filename: endorse_encapsulation_pub_key.uml</text><!--SRC=[fLPjSnet4FxEhrXJJmkrSPscdN4OrpF6WCEGOCROQJfDvYBkzZWDTz9LqfdGoO_lIWVtWd7gflU14P9sjVliiuzqm8KVPm62z5ClblxIomoFzGbDDne7F8JMeOxaoZFSnDXk07rtTWZDWGYaqWW3uRDKPp4pN0gOPdCOuxhPE40HyB3c8rNeIn7aNeGq2CnNKcltttxdyujfleTRPxfx_jFyebW5-17wewi1NCQSQNiAS0tiWV6OpIaYBe31-1teM1fW8e3Xxv0mmHQemKIOptzNSKUfqFIkI_8IAsJ16W8CkS00vckuOZ5FZMBEBvrAqJkV_Ud0MjLYV3qTkycKSVNVmwk2CI6Cze1WezRuLuR2HmWuMoYM0DCwIvmhbeT6Hwru7BjGMHpB5HrAGQIPAQ8mabQqX3b2fYbHWe3so7B7IPauHKjvAzGf5ORRX4AfyWIuMC0gudwqDICtQkkI4lN9AGjOQe2uO29RD1jiwWYp0TENYYflJdOIfTKYKng7qdTUoKvdlezQXraC-1dzp3cJ8SWKbQEYjdNBWJY1cKC2oPHo3cItKQN1UIY5ZI2MwZU5mGLCDXjP440YAHKMBwJY9afohXAr7NyBaly0nDiEVkRQM32qORGOS1-FZk2mTpyS3cwzowkxqRlBkz7DfB74PB5_fT48Lt38z5huaCnfJnS6a_xDxMpW3IPNbzFP_HktqPlUzxpnu8zQVx6KLtfByKLao4cHwHTBgI77E83Qv-Pd_6_CHttBUjT_yALYwqTBgXd0hctsykVDw0qtLXWi9AnkI_bw4J61Lf-mVPslMagD1s_98E-Uo0PBZJD-suC4gHJhcb_C9IX1ORoYH3M_Wt97MKJW0Vtd8KVrGH3DHY6SHiUMAu88RZ8b8CtcCVTj79i37vKycM_hv8ShLwWhcL0x1BMI97hXfKnfOaLU6j_MTrDUihb6IxpSpYudyqx73Gurnc6hITkRnz3ieq6La1XjDpVR54YiiJJQniLYKyMxTTs6oFQr4xUf1TNYkH60wxmFhCtC_dzV0SciKopRf8nx-N1qv0BtIEizz8F8q-YdByz-KIzQT4WtTtNTBcoN3rjJudsUypJ7jogT5TG2AR1T4-h21SNHwH1mL21lMRKkq2XDDb3comwTnzcuAbITeQtW5XJSIv_Ucjhh5ERSqAz6imyb6dMXbt7YhzKW7vKbd4-w07UzsTEu4fwQbO1wEc8qgE0wF2REFk_hCyCekvspdsr-ancwBBgW-K8mwWhSKr6hSHiQr-_HFSL_wC82XLLdB7r-O_dts7yZ0LoXBjFKDdZXrOf_3JO9FQHBP66V0oq2iVqKbNI-fqASWbMEMOsT_HlHs5wisFWUIcMf2yi7GSsVnYG5_q_rIxr_T0iyK_jBXQrxUFe627cgFNijPlgh7aPaQX7N-LEXq3jx-Gz7qncmD5NomJu1b7she58qg9wqwMKlHl7rM54iJ6HV3EwzLX7yrgT9klnaPV9sU0MlNfoTjf-yTUmf_tv2LKO2svHx0gw2U_Pd9OkFcrbxBpwwbXv5LBhO2VCZpVO7jnrwIic0y7j_yklfgnh9zrzqhkCQ_m00]--></g></svg>