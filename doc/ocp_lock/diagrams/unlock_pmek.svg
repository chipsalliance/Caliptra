<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="4141px" preserveAspectRatio="none" style="width:2585px;height:4141px;background:#FFFFFF;" version="1.1" viewBox="0 0 2585 4141" width="2585px" zoomAndPan="magnify"><title>Unlock PMEK</title><defs/><g><rect fill="#DDDDDD" height="4061.4746" style="stroke:#181818;stroke-width:0.5;" width="2276.6191" x="216.8086" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="1328.7214" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="2531.0313" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="93.5635" x="1272.7466" y="41.3125">Unlock PMEK</text><g><title>Storage</title><rect fill="transparent" height="3907.2344" width="8" x="91.1826" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="94.6826" x2="94.6826" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#FFFFFF" height="131.2422" style="stroke:#181818;stroke-width:1;" width="10" x="89.6826" y="3916.0332"/></g><g><title>Mail Box</title><rect fill="transparent" height="3907.2344" width="8" x="253.0845" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="256.5845" x2="256.5845" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#FFFFFF" height="189.7949" style="stroke:#181818;stroke-width:1;" width="10" x="251.5845" y="250.5938"/></g><g><title>FW</title><rect fill="transparent" height="3907.2344" width="8" x="447.5371" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="451.0371" x2="451.0371" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#FFFFFF" height="3631.1973" style="stroke:#181818;stroke-width:1;" width="10" x="446.0371" y="411.0781"/></g><g><title>Key Vault</title><rect fill="transparent" height="3907.2344" width="8" x="1693.7329" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1697.2329" x2="1697.2329" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="722.1836"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="881.7363"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="1150.5313"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="1354.7051"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="1668.8105"/></g><g><title/><rect fill="#FFFFFF" height="100.9316" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="1872.9844"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="2077.1582"/></g><g><title/><rect fill="#FFFFFF" height="165.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="2310.6426"/></g><g><title/><rect fill="#FFFFFF" height="165.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="2579.4375"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="2894.1641"/></g><g><title/><rect fill="#FFFFFF" height="159.5527" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="3141.6484"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="3404.4434"/></g><g><title/><rect fill="#FFFFFF" height="130.2422" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="3637.9277"/></g><g><title/><rect fill="#FFFFFF" height="58.6211" style="stroke:#181818;stroke-width:1;" width="10" x="1692.2329" y="3812.791"/></g><g><title>Key Vault</title><rect fill="transparent" height="3907.2344" width="8" x="1970.7788" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1974.2788" x2="1974.2788" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#ADD8E6" height="3817.9922" style="stroke:#181818;stroke-width:1;" width="10" x="1969.2788" y="229.2832"/></g><g><title>Key Vault</title><rect fill="transparent" height="3907.2344" width="8" x="2102.8823" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2106.3823" x2="2106.3823" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#ADD8E6" height="3817.9922" style="stroke:#181818;stroke-width:1;" width="10" x="2101.3823" y="229.2832"/></g><g><title>Key Vault</title><rect fill="transparent" height="3907.2344" width="8" x="2218.9966" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2222.4966" x2="2222.4966" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#ADD8E6" height="3817.9922" style="stroke:#181818;stroke-width:1;" width="10" x="2217.4966" y="229.2832"/></g><g><title>Key Vault</title><rect fill="transparent" height="3907.2344" width="8" x="2330.8145" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2334.3145" x2="2334.3145" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#ADD8E6" height="2619.9492" style="stroke:#181818;stroke-width:1;" width="10" x="2329.3145" y="1222.1523"/></g><line style="stroke:#181818;stroke-width:2;" x1="2325.3145" x2="2343.3145" y1="3833.1016" y2="3851.1016"/><line style="stroke:#181818;stroke-width:2;" x1="2325.3145" x2="2343.3145" y1="3851.1016" y2="3833.1016"/><g><title>Key Vault</title><rect fill="transparent" height="3907.2344" width="8" x="2437.5566" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="2441.0566" x2="2441.0566" y1="140.041" y2="4047.2754"/></g><g><title/><rect fill="#ADD8E6" height="847.0059" style="stroke:#181818;stroke-width:1;" width="10" x="2436.0566" y="2995.0957"/></g><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="62" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="69" y="96.1113">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="72.4077" y="112.5996">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="84.9414" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="220.8086" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="227.8086" y="129.0879">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="434.2959" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="441.2959" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1658.4629" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1665.4629" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1904.8428" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1942.5088" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1954.5229" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1911.8428" y="129.0879">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105.335" x="2053.7148" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2074.6123" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="2087.4297" y="112.5996">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.335" x="2060.7148" y="129.0879">(PMEK Secret)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="2169.0498" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2190.7266" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="2202.5117" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="2176.0498" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="2285.9434" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2302.5444" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="2315.0269" y="112.5996">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="2292.9434" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="2392.6855" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2409.2866" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="2421.8989" y="112.5996">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="2399.6855" y="129.0879">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="65.3652" x="62" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="51.3652" x="69" y="4067.8105">Storage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.5498" x="72.4077" y="4084.2988">Device</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="84.9414" y="4100.7871">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71.5518" x="220.8086" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57.5518" x="227.8086" y="4067.8105">Mail Box</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="434.2959" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="441.2959" y="4067.8105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1658.4629" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1665.4629" y="4067.8105">Key Vault</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1904.8428" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1942.5088" y="4067.8105">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1954.5229" y="4084.2988">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1911.8428" y="4100.7871">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105.335" x="2053.7148" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2074.6123" y="4067.8105">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="2087.4297" y="4084.2988">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.335" x="2060.7148" y="4100.7871">(PMEK Secret)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="2169.0498" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2190.7266" y="4067.8105">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="2202.5117" y="4084.2988">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="2176.0498" y="4100.7871">(KEM Keypair)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="2285.9434" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2302.5444" y="4067.8105">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.5752" x="2315.0269" y="4084.2988">Slot Y</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="2292.9434" y="4100.7871">(Temporary)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="96.7422" x="2392.6855" y="4047.2754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="2409.2866" y="4067.8105">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.3154" x="2421.8989" y="4084.2988">Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.7422" x="2399.6855" y="4100.7871">(Temporary)</text><path d="M59.1558,153.041 L59.1558,224.041 L2476.1558,224.041 L2476.1558,163.041 L2466.1558,153.041 L59.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2466.1558,153.041 L2466.1558,163.041 L2476.1558,163.041 L2466.1558,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="94.999" x="1069.3235" y="170.6094">Preconditions:</text><ellipse cx="1074.8235" cy="181.1621" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.6094" x="1081.3235" y="185.9199">Access Shared Secret already availble in a slot in KV</text><ellipse cx="1074.8235" cy="196.4727" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="376.0923" x="1081.3235" y="201.2305">unlocking key already in a slot and generated on each reset</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313.8853" x="1069.3235" y="216.541">Is there a separate Shared Secret per Admin User?</text><line style="stroke:#008000;stroke-width:1;" x1="249.5845" x2="239.5845" y1="250.5938" y2="246.5938"/><line style="stroke:#008000;stroke-width:1;" x1="249.5845" x2="239.5845" y1="250.5938" y2="254.5938"/><line style="stroke:#008000;stroke-width:1;" x1="94.6826" x2="250.5845" y1="250.5938" y2="250.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="101.6826" y="245.8516">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="93.5391" x="141.0454" y="245.8516">UNLOCK_PMEK</text><path d="M266.5845,263.5938 L266.5845,384.5938 L889.5845,384.5938 L889.5845,273.5938 L879.5845,263.5938 L266.5845,263.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M879.5845,263.5938 L879.5845,273.5938 L889.5845,273.5938 L879.5845,263.5938 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="272.5845" y="283.1621">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="276.6978" y="283.1621">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="414.8545" y="283.1621">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="418.9678" y="283.1621">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="543.7944" y="283.1621">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="547.9077" y="283.1621">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="276.6978" y="298.4727">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="418.9678" y="298.4727">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="547.9077" y="298.4727">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.9302" x="276.6978" y="313.7832">wrapped_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.7134" x="418.9678" y="313.7832">WrappedAccessKey</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="253.8301" x="547.9077" y="313.7832">KEM-wrapped access keyn* kem_handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.915" x="543.7944" y="329.0938">*kem_algorithm</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.9111" x="543.7944" y="344.4043">*kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="148.5542" x="543.7944" y="359.7148">* encrypted_access_key</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.0845" x="276.6978" y="375.0254">locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="418.9678" y="375.0254">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="323.3813" x="547.9077" y="375.0254">PMEK encrypted to storage root key and access key</text><line style="stroke:#000000;stroke-width:0.5;" x1="272.5845" x2="875.4023" y1="270.5938" y2="270.5938"/><line style="stroke:#000000;stroke-width:0.5;" x1="272.5845" x2="875.4023" y1="285.9043" y2="285.9043"/><line style="stroke:#000000;stroke-width:0.5;" x1="272.5845" x2="875.4023" y1="301.2148" y2="301.2148"/><line style="stroke:#000000;stroke-width:0.5;" x1="272.5845" x2="875.4023" y1="362.457" y2="362.457"/><line style="stroke:#000000;stroke-width:0.5;" x1="272.5845" x2="875.4023" y1="377.7676" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="272.5845" x2="272.5845" y1="270.5938" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="414.8545" x2="414.8545" y1="270.5938" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="543.7944" x2="543.7944" y1="270.5938" y2="377.7676"/><line style="stroke:#000000;stroke-width:0.5;" x1="875.4023" x2="875.4023" y1="270.5938" y2="377.7676"/><line style="stroke:#008000;stroke-width:1;" x1="444.0371" x2="434.0371" y1="411.0781" y2="407.0781"/><line style="stroke:#008000;stroke-width:1;" x1="444.0371" x2="434.0371" y1="411.0781" y2="415.0781"/><line style="stroke:#008000;stroke-width:1;" x1="261.5845" x2="445.0371" y1="411.0781" y2="411.0781"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="268.5845" y="406.3359">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="307.9473" y="406.3359">Command</text><polygon fill="#FF0000" points="272.5845,436.3887,262.5845,440.3887,272.5845,444.3887,268.5845,440.3887" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="266.5845" x2="445.0371" y1="440.3887" y2="440.3887"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="278.5845" y="435.6465">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87.9595" x="317.9473" y="435.6465">Get command</text><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="498.0371" y1="469.6992" y2="469.6992"/><line style="stroke:#FF0000;stroke-width:1;" x1="498.0371" x2="498.0371" y1="469.6992" y2="482.6992"/><line style="stroke:#FF0000;stroke-width:1;" x1="457.0371" x2="498.0371" y1="482.6992" y2="482.6992"/><polygon fill="#FF0000" points="467.0371,478.6992,457.0371,482.6992,467.0371,486.6992,463.0371,482.6992" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="464.957">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="132.0693" x="502.3999" y="464.957">Determine command</text><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="498.0371" y1="512.0098" y2="512.0098"/><line style="stroke:#FF0000;stroke-width:1;" x1="498.0371" x2="498.0371" y1="512.0098" y2="525.0098"/><line style="stroke:#FF0000;stroke-width:1;" x1="457.0371" x2="498.0371" y1="525.0098" y2="525.0098"/><polygon fill="#FF0000" points="467.0371,521.0098,457.0371,525.0098,467.0371,529.0098,463.0371,525.0098" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="507.2676">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.3853" x="502.3999" y="507.2676">Determine rate of unlocking</text><path d="M8,537.0098 L70.1387,537.0098 L70.1387,544.3203 L60.1387,554.3203 L8,554.3203 L8,537.0098 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="3401.0234" style="stroke:#000000;stroke-width:1.5;" width="2504.0566" x="8" y="537.0098"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="23" y="550.5781">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="142.1514" x="85.1387" y="549.6445">[Storage Root Key exists]</text><path d="M27,568.3203 L89.1387,568.3203 L89.1387,575.6309 L79.1387,585.6309 L27,585.6309 L27,568.3203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="3355.7129" style="stroke:#000000;stroke-width:1.5;" width="2460.0566" x="27" y="568.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="42" y="581.8887">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="186.4897" x="104.1387" y="580.9551">[Unlocking rate below threshold]</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="616.2861"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="616.2861" y2="616.2861"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="619.2861" y2="619.2861"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="145.2949" x="1190.3809" y="605.6309"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="127.0103" x="1196.3809" y="622.1992">Get the Access Key</text><path d="M46,642.9414 L108.1387,642.9414 L108.1387,650.252 L98.1387,660.252 L46,660.252 L46,642.9414 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="850.0059" style="stroke:#000000;stroke-width:1.5;" width="2309.3145" x="46" y="642.9414"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="61" y="656.5098">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="294.0889" x="123.1387" y="655.5762">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384))]</text><polygon fill="#FF0000" points="1680.2329,718.1836,1690.2329,722.1836,1680.2329,726.1836,1684.2329,722.1836" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="722.1836" y2="722.1836"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="702.1309">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.2349" x="502.3999" y="686.8203">ECDH(KEM Pair : kem_handle (G),</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.9976" x="551.7593" y="702.1309">KEM ciphertext : kem_ciphertext</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3276" x="551.7593" y="717.4414">Destination : memory)</text><polygon fill="#FF0000" points="2205.4966,747.4941,2215.4966,751.4941,2205.4966,755.4941,2209.4966,751.4941" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2211.4966" y1="751.4941" y2="751.4941"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="746.752">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="1748.5957" y="746.752">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="780.8047" y2="780.8047"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="780.8047" y2="793.8047"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="793.8047" y2="793.8047"/><polygon fill="#FF0000" points="1713.2329,789.8047,1703.2329,793.8047,1713.2329,797.8047,1709.2329,793.8047" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="776.0625">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.6831" x="1748.5957" y="776.0625">ECDH KEM Ciphertext with Keypair</text><polygon fill="#FF0000" points="467.0371,819.1152,457.0371,823.1152,467.0371,827.1152,463.0371,823.1152" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="823.1152" y2="823.1152"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="818.373">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.5098" x="512.3999" y="818.373">Put DH result</text><polygon fill="#FF0000" points="467.0371,848.4258,457.0371,852.4258,467.0371,856.4258,463.0371,852.4258" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="852.4258" y2="852.4258"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="847.6836">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="847.6836">done</text><polygon fill="#FF0000" points="1680.2329,877.7363,1690.2329,881.7363,1680.2329,885.7363,1684.2329,881.7363" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="881.7363" y2="881.7363"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="876.9941">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="272.0098" x="502.3999" y="876.9941">ECC_GetPubKey(KEM Pair : kem_handle (G))</text><polygon fill="#FF0000" points="2205.4966,907.0469,2215.4966,911.0469,2205.4966,915.0469,2209.4966,911.0469" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2211.4966" y1="911.0469" y2="911.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="906.3047">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.416" x="1748.5957" y="906.3047">Get KEM Keypair</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="940.3574" y2="940.3574"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="940.3574" y2="953.3574"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="953.3574" y2="953.3574"/><polygon fill="#FF0000" points="1713.2329,949.3574,1703.2329,953.3574,1713.2329,957.3574,1709.2329,953.3574" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="935.6152">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.0874" x="1748.5957" y="935.6152">ECC derive public key</text><polygon fill="#FF0000" points="467.0371,978.668,457.0371,982.668,467.0371,986.668,463.0371,982.668" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="982.668" y2="982.668"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="977.9258">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82.1387" x="512.3999" y="977.9258">Put kem_pub</text><polygon fill="#FF0000" points="467.0371,1007.9785,457.0371,1011.9785,467.0371,1015.9785,463.0371,1011.9785" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="1011.9785" y2="1011.9785"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="1007.2363">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="1007.2363">done</text><path d="M461.0371,1024.9785 L461.0371,1049.9785 L894.0371,1049.9785 L894.0371,1034.9785 L884.0371,1024.9785 L461.0371,1024.9785 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M884.0371,1024.9785 L884.0371,1034.9785 L894.0371,1034.9785 L884.0371,1024.9785 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="412.8896" x="467.0371" y="1042.5469">The next steps come from RFC 9180, section 4.1, Decap function</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="1075.9443"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1075.9443" y2="1075.9443"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1078.9443" y2="1078.9443"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="341.5771" x="1092.2397" y="1065.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="323.2925" x="1098.2397" y="1081.8574">Derive HPKE pseudo-random key material (PRK)</text><polygon fill="#FF0000" points="1680.2329,1146.5313,1690.2329,1150.5313,1680.2329,1154.5313,1684.2329,1150.5313" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="1150.5313" y2="1150.5313"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="1130.4785">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="502.3999" y="1115.168">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="446.4751" x="605.2319" y="1130.4785">Key Data : "HPKE-v1" | "KEM" | 0x0011 (kem_id) | "eae_prk" | DH result</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="605.2319" y="1145.7891">Destination Slot: Y)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="1179.8418" y2="1179.8418"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="1179.8418" y2="1192.8418"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="1192.8418" y2="1192.8418"/><polygon fill="#FF0000" points="1713.2329,1188.8418,1703.2329,1192.8418,1713.2329,1196.8418,1709.2329,1192.8418" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="1175.0996">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1748.5957" y="1175.0996">HMAC384 operation</text><polygon fill="#FF0000" points="2317.3145,1218.1523,2327.3145,1222.1523,2317.3145,1226.1523,2321.3145,1222.1523" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="1222.1523" y2="1222.1523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="1217.4102">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.3711" x="1748.5957" y="1217.4102">HMAC384 result PRK</text><polygon fill="#FF0000" points="467.0371,1247.4629,457.0371,1251.4629,467.0371,1255.4629,463.0371,1251.4629" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="1251.4629" y2="1251.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="1246.7207">[019]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="1246.7207">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="1280.1182"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1280.1182" y2="1280.1182"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1283.1182" y2="1283.1182"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="196.0381" x="1165.0093" y="1269.4629"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="177.7534" x="1171.0093" y="1286.0313">Derive HPKE shared secret</text><polygon fill="#FF0000" points="1680.2329,1350.7051,1690.2329,1354.7051,1680.2329,1358.7051,1684.2329,1354.7051" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="1354.7051" y2="1354.7051"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="1334.6523">[020]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="502.3999" y="1319.3418">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="916.8047" x="605.2319" y="1334.6523">Data : 0x0030 (big-endian 48) | "HPKE-v1" | "KEM" | 0x0011 (kem_id) | "shared_secret" | kem_ciphertext | kem_pub | 0x01 (HKDF block number)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="605.2319" y="1349.9629">Destination Slot: Y)</text><polygon fill="#FF0000" points="2317.3145,1380.0156,2327.3145,1384.0156,2317.3145,1388.0156,2321.3145,1384.0156" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="1384.0156" y2="1384.0156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="1379.2734">[021]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.8901" x="1748.5957" y="1379.2734">Get HPKE PRK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="1413.3262" y2="1413.3262"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="1413.3262" y2="1426.3262"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="1426.3262" y2="1426.3262"/><polygon fill="#FF0000" points="1713.2329,1422.3262,1703.2329,1426.3262,1713.2329,1430.3262,1709.2329,1426.3262" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="1408.584">[022]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1748.5957" y="1408.584">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="2317.3145,1451.6367,2327.3145,1455.6367,2317.3145,1459.6367,2321.3145,1455.6367" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="1455.6367" y2="1455.6367"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="1450.8945">[023]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.1626" x="1748.5957" y="1450.8945">HMAC384 result shared secret</text><polygon fill="#FF0000" points="467.0371,1480.9473,457.0371,1484.9473,467.0371,1488.9473,463.0371,1484.9473" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="1484.9473" y2="1484.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="1480.2051">[024]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="1480.2051">done</text><path d="M46,1510.9473 L108.1387,1510.9473 L108.1387,1518.2578 L98.1387,1528.2578 L46,1528.2578 L46,1510.9473 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="1521.459" style="stroke:#000000;stroke-width:1.5;" width="2416.0566" x="46" y="1510.9473"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="61" y="1524.5156">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="692.1299" x="123.1387" y="1523.582">[kem_id = 0x0011 (DHKEM(P-384, HKDF-SHA384)), kdf_id = 0x0002 (HKDF-SHA384), aead_id = 0x0002 (AES-256-GCM)]</text><path d="M461.0371,1543.2578 L461.0371,1568.2578 L1234.0371,1568.2578 L1234.0371,1553.2578 L1224.0371,1543.2578 L461.0371,1543.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1224.0371,1543.2578 L1224.0371,1553.2578 L1234.0371,1553.2578 L1224.0371,1543.2578 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="752.7178" x="467.0371" y="1560.8262">The next steps come from RFC 9180, sections 5.1 and 5.2, KeyScheduleBase and ContextR.Open functions respectively</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="1594.2236"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1594.2236" y2="1594.2236"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1597.2236" y2="1597.2236"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="331.2686" x="1097.394" y="1583.5684"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="312.9839" x="1103.394" y="1600.1367">Derive HPKE psk_id_hash and store in memory</text><polygon fill="#FF0000" points="1680.2329,1664.8105,1690.2329,1668.8105,1680.2329,1672.8105,1684.2329,1668.8105" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="1668.8105" y2="1668.8105"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="1648.7578">[025]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="502.3999" y="1633.4473">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="713.5146" x="605.2319" y="1648.7578">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) | 0x0002 (aead_id) | "psk_id_hash" | "" (no PSK ID)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140.3276" x="605.2319" y="1664.0684">Destination : memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="1698.1211" y2="1698.1211"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="1698.1211" y2="1711.1211"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="1711.1211" y2="1711.1211"/><polygon fill="#FF0000" points="1713.2329,1707.1211,1703.2329,1711.1211,1713.2329,1715.1211,1709.2329,1711.1211" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="1693.3789">[026]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1748.5957" y="1693.3789">HMAC384 operation</text><polygon fill="#FF0000" points="467.0371,1736.4316,457.0371,1740.4316,467.0371,1744.4316,463.0371,1740.4316" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="1740.4316" y2="1740.4316"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="1735.6895">[027]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.7676" x="512.3999" y="1735.6895">HMAC384 result psk_id_hash</text><polygon fill="#FF0000" points="467.0371,1765.7422,457.0371,1769.7422,467.0371,1773.7422,463.0371,1769.7422" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="1769.7422" y2="1769.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="1765">[028]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="1765">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="1798.3975"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1798.3975" y2="1798.3975"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="1801.3975" y2="1801.3975"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="314.1934" x="1105.9316" y="1787.7422"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="295.9087" x="1111.9316" y="1804.3105">Derive HPKE info_hash and store in memory</text><polygon fill="#FF0000" points="1680.2329,1868.9844,1690.2329,1872.9844,1680.2329,1876.9844,1684.2329,1872.9844" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="1872.9844" y2="1872.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="1852.9316">[029]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.793" x="502.3999" y="1837.6211">HMAC384(Key : empty,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="713.4194" x="605.2319" y="1852.9316">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) | 0x0002 (aead_id) | "info_hash" | "enable_access"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2144" x="605.2319" y="1868.2422">Destination: memory)</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="1902.2949" y2="1902.2949"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="1902.2949" y2="1915.2949"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="1915.2949" y2="1915.2949"/><polygon fill="#FF0000" points="1713.2329,1911.2949,1703.2329,1915.2949,1713.2329,1919.2949,1709.2329,1915.2949" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="1897.5527">[030]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.0703" x="1748.5957" y="1897.5527">HMAC384 operation</text><polygon fill="#FF0000" points="467.0371,1940.6055,457.0371,1944.6055,467.0371,1948.6055,463.0371,1944.6055" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="1944.6055" y2="1944.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="1939.8633">[031]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.5112" x="512.3999" y="1939.8633">HMAC384 result info_hash</text><polygon fill="#FF0000" points="467.0371,1969.916,457.0371,1973.916,467.0371,1977.916,463.0371,1973.916" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="1973.916" y2="1973.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="1969.1738">[032]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="1969.1738">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="2002.5713"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2002.5713" y2="2002.5713"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2005.5713" y2="2005.5713"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="282.9756" x="1121.5405" y="1991.916"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.6909" x="1127.5405" y="2008.4844">Derive HPKE secret and store in KV slot</text><polygon fill="#FF0000" points="1680.2329,2073.1582,1690.2329,2077.1582,1680.2329,2081.1582,1684.2329,2077.1582" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="2077.1582" y2="2077.1582"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="2057.1055">[033]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="502.3999" y="2041.7949">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="656.5825" x="605.2319" y="2057.1055">Data : "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) | 0x0002 (aead_id) | "secret" | "" (no PSK)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="605.2319" y="2072.416">Destination Slot: Y)</text><polygon fill="#FF0000" points="2317.3145,2102.4688,2327.3145,2106.4688,2317.3145,2110.4688,2321.3145,2106.4688" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="2106.4688" y2="2106.4688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2101.7266">[034]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146.6816" x="1748.5957" y="2101.7266">Get HPKE shared secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="2135.7793" y2="2135.7793"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="2135.7793" y2="2148.7793"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="2148.7793" y2="2148.7793"/><polygon fill="#FF0000" points="1713.2329,2144.7793,1703.2329,2148.7793,1713.2329,2152.7793,1709.2329,2148.7793" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2131.0371">[035]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1748.5957" y="2131.0371">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="2317.3145,2174.0898,2327.3145,2178.0898,2317.3145,2182.0898,2321.3145,2178.0898" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="2178.0898" y2="2178.0898"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2173.3477">[036]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="145.4312" x="1748.5957" y="2173.3477">HMAC384 result secret</text><polygon fill="#FF0000" points="467.0371,2203.4004,457.0371,2207.4004,467.0371,2211.4004,463.0371,2207.4004" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="2207.4004" y2="2207.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="2202.6582">[037]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="2202.6582">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="2236.0557"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2236.0557" y2="2236.0557"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2239.0557" y2="2239.0557"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="326.8062" x="1099.6252" y="2225.4004"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="308.5215" x="1105.6252" y="2241.9688">Derive HPKE base_nonce and store in memory</text><polygon fill="#FF0000" points="1680.2329,2306.6426,1690.2329,2310.6426,1680.2329,2314.6426,1684.2329,2310.6426" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="2310.6426" y2="2310.6426"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="2290.5898">[038]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="502.3999" y="2275.2793">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1075.001" x="605.2319" y="2290.5898">Data : 0x000C (big-endian 12) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) | 0x0002 (aead_id) | "base_nonce" | 0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2144" x="605.2319" y="2305.9004">Destination: memory)</text><polygon fill="#FF0000" points="2317.3145,2335.9531,2327.3145,2339.9531,2317.3145,2343.9531,2321.3145,2339.9531" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="2339.9531" y2="2339.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2335.2109">[039]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9502" x="1748.5957" y="2335.2109">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="2369.2637" y2="2369.2637"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="2369.2637" y2="2382.2637"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="2382.2637" y2="2382.2637"/><polygon fill="#FF0000" points="1713.2329,2378.2637,1703.2329,2382.2637,1713.2329,2386.2637,1709.2329,2382.2637" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2364.5215">[040]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1748.5957" y="2364.5215">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="467.0371,2407.5742,457.0371,2411.5742,467.0371,2415.5742,463.0371,2411.5742" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="2411.5742" y2="2411.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="2406.832">[041]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181.2319" x="512.3999" y="2406.832">HMAC384 result base_nonce</text><path d="M1707.2329,2424.5742 L1707.2329,2449.5742 L1983.2329,2449.5742 L1983.2329,2434.5742 L1973.2329,2424.5742 L1707.2329,2424.5742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1973.2329,2424.5742 L1973.2329,2434.5742 L1983.2329,2434.5742 L1973.2329,2424.5742 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255.7852" x="1713.2329" y="2442.1426">The base_nonce is truncated to 12 bytes</text><polygon fill="#FF0000" points="467.0371,2472.1953,457.0371,2476.1953,467.0371,2480.1953,463.0371,2476.1953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="2476.1953" y2="2476.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="2471.4531">[042]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="2471.4531">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="2504.8506"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2504.8506" y2="2504.8506"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2507.8506" y2="2507.8506"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="265.7163" x="1130.1702" y="2494.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="247.4316" x="1136.1702" y="2510.7637">Derive HPKE key and store in KV slot</text><polygon fill="#FF0000" points="1680.2329,2575.4375,1690.2329,2579.4375,1680.2329,2583.4375,1684.2329,2579.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="2579.4375" y2="2579.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="2559.3848">[043]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="142.397" x="502.3999" y="2544.0742">HMAC384(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="1022.106" x="605.2319" y="2559.3848">Data : 0x0020 (big-endian 32) | "HPKE-v1" | "HPKE" | 0x0011 (kem_id) | 0x0002 (kdf_id) | 0x0002 (aead_id) | "key" | 0x00 (HPKE mode) | psk_id_hash | info_hash</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="605.2319" y="2574.6953">Destination Slot: Y)</text><polygon fill="#FF0000" points="2317.3145,2604.748,2327.3145,2608.748,2317.3145,2612.748,2321.3145,2608.748" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="2608.748" y2="2608.748"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2604.0059">[044]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.9502" x="1748.5957" y="2604.0059">Get HPKE secret</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="2638.0586" y2="2638.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="2638.0586" y2="2651.0586"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="2651.0586" y2="2651.0586"/><polygon fill="#FF0000" points="1713.2329,2647.0586,1703.2329,2651.0586,1713.2329,2655.0586,1709.2329,2651.0586" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2633.3164">[045]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="165.2676" x="1748.5957" y="2633.3164">HMAC384 slot Y with data</text><polygon fill="#FF0000" points="2317.3145,2676.3691,2327.3145,2680.3691,2317.3145,2684.3691,2321.3145,2680.3691" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="2680.3691" y2="2680.3691"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2675.627">[046]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1113" x="1748.5957" y="2675.627">HMAC384 result key</text><path d="M1707.2329,2693.3691 L1707.2329,2718.3691 L2139.2329,2718.3691 L2139.2329,2703.3691 L2129.2329,2693.3691 L1707.2329,2693.3691 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M2129.2329,2693.3691 L2129.2329,2703.3691 L2139.2329,2703.3691 L2129.2329,2693.3691 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="411.3599" x="1713.2329" y="2710.9375">The key is truncated to 32 bytes for use as an AES-256-GCM key</text><polygon fill="#FF0000" points="467.0371,2740.9902,457.0371,2744.9902,467.0371,2748.9902,463.0371,2744.9902" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="2744.9902" y2="2744.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="2740.248">[047]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="2740.248">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="2773.6455"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2773.6455" y2="2773.6455"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="2776.6455" y2="2776.6455"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="283.2612" x="1121.3977" y="2762.9902"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="264.9766" x="1127.3977" y="2779.5586">Decrypt access key and store in KV Slot</text><polygon fill="#FF0000" points="1680.2329,2890.1641,1690.2329,2894.1641,1680.2329,2898.1641,1684.2329,2894.1641" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="2894.1641" y2="2894.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="2851.1455">[048]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="171.3296" x="502.3999" y="2812.8691">AES-256-GCM(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102.4512" x="551.7593" y="2828.1797">IV : base_nonce,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="291.8018" x="551.7593" y="2843.4902">Ciphertext : encrypted_access_key_ciphertext,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204.7817" x="551.7593" y="2858.8008">Tag : encrypted_access_key_tag,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="53.8408" x="551.7593" y="2874.1113">AAD : "",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.2935" x="551.7593" y="2889.4219">Destination : Slot Z)</text><polygon fill="#FF0000" points="2317.3145,2919.4746,2327.3145,2923.4746,2317.3145,2927.4746,2321.3145,2923.4746" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="2923.4746" y2="2923.4746"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2918.7324">[049]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="83.6304" x="1748.5957" y="2918.7324">Get HPKE key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="2952.7852" y2="2952.7852"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="2952.7852" y2="2965.7852"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="2965.7852" y2="2965.7852"/><polygon fill="#FF0000" points="1713.2329,2961.7852,1703.2329,2965.7852,1713.2329,2969.7852,1709.2329,2965.7852" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2948.043">[050]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="214.5127" x="1748.5957" y="2948.043">AES-256-GCM decrypt access key</text><polygon fill="#FF0000" points="2424.0566,2991.0957,2434.0566,2995.0957,2424.0566,2999.0957,2428.0566,2995.0957" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2430.0566" y1="2995.0957" y2="2995.0957"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="2990.3535">[051]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="90.9683" x="1748.5957" y="2990.3535">Put access key</text><polygon fill="#FF0000" points="467.0371,3020.4063,457.0371,3024.4063,467.0371,3028.4063,463.0371,3024.4063" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="3024.4063" y2="3024.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="3019.6641">[052]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="3019.6641">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="3067.0615"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="3067.0615" y2="3067.0615"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="3070.0615" y2="3070.0615"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="192.0073" x="1167.0247" y="3056.4063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="173.7227" x="1173.0247" y="3072.9746">Create the Encryption Key</text><polygon fill="#FF0000" points="1680.2329,3137.6484,1690.2329,3141.6484,1680.2329,3145.6484,1684.2329,3141.6484" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="3141.6484" y2="3141.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="3121.5957">[053]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="180.0005" x="502.3999" y="3106.2852">HMAC512_Slots(Key : Slot A,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="605.2319" y="3121.5957">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.4214" x="605.2319" y="3136.9063">Destination Slot: Y)</text><polygon fill="#FF0000" points="1957.2788,3166.959,1967.2788,3170.959,1957.2788,3174.959,1961.2788,3170.959" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1963.2788" y1="3170.959" y2="3170.959"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3166.2168">[054]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.1104" x="1748.5957" y="3166.2168">Get Storage Root Key</text><polygon fill="#FF0000" points="2424.0566,3196.2695,2434.0566,3200.2695,2424.0566,3204.2695,2428.0566,3200.2695" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2430.0566" y1="3200.2695" y2="3200.2695"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3195.5273">[055]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="95.0308" x="1748.5957" y="3195.5273">Get Access Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="3229.5801" y2="3229.5801"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="3229.5801" y2="3242.5801"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="3242.5801" y2="3242.5801"/><polygon fill="#FF0000" points="1713.2329,3238.5801,1703.2329,3242.5801,1713.2329,3246.5801,1709.2329,3242.5801" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3224.8379">[056]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="174.6875" x="1748.5957" y="3224.8379">HMAC512 Slot A with Slot Z</text><polygon fill="#FF0000" points="2317.3145,3267.8906,2327.3145,3271.8906,2317.3145,3275.8906,2321.3145,3271.8906" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="3271.8906" y2="3271.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3267.1484">[057]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141.394" x="1748.5957" y="3267.1484">HMAC512 result PMEK</text><polygon fill="#FF0000" points="467.0371,3297.2012,457.0371,3301.2012,467.0371,3305.2012,463.0371,3301.2012" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="3301.2012" y2="3301.2012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="3296.459">[058]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="3296.459">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="3329.8564"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="3329.8564" y2="3329.8564"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="3332.8564" y2="3332.8564"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="244.1089" x="1140.9739" y="3319.2012"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="225.8242" x="1146.9739" y="3335.7695">Extract PMEK with Encryption Key</text><polygon fill="#FF0000" points="1680.2329,3400.4434,1690.2329,3404.4434,1680.2329,3408.4434,1684.2329,3404.4434" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="3404.4434" y2="3404.4434"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="3384.3906">[059]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.7944" x="502.3999" y="3369.0801">Unwrap(Key : Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="120.269" x="551.7593" y="3384.3906">Data: locked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="128.4067" x="551.7593" y="3399.7012">Destination :  Slot Z)</text><polygon fill="#FF0000" points="2317.3145,3429.7539,2327.3145,3433.7539,2317.3145,3437.7539,2321.3145,3433.7539" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="3433.7539" y2="3433.7539"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3429.0117">[060]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.9868" x="1748.5957" y="3429.0117">Get Encryption Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="3463.0645" y2="3463.0645"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="3463.0645" y2="3476.0645"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="3476.0645" y2="3476.0645"/><polygon fill="#FF0000" points="1713.2329,3472.0645,1703.2329,3476.0645,1713.2329,3480.0645,1709.2329,3476.0645" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3458.3223">[061]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135.9922" x="1748.5957" y="3458.3223">Decrypt locked_pmek</text><polygon fill="#FF0000" points="2424.0566,3501.375,2434.0566,3505.375,2424.0566,3509.375,2428.0566,3505.375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2430.0566" y1="3505.375" y2="3505.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3500.6328">[062]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="33.9155" x="1748.5957" y="3500.6328">PMEK</text><polygon fill="#FF0000" points="467.0371,3530.6855,457.0371,3534.6855,467.0371,3538.6855,463.0371,3534.6855" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="3534.6855" y2="3534.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="3529.9434">[063]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="3529.9434">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="2516.0566" x="5" y="3563.3408"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="3563.3408" y2="3563.3408"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="2521.0566" y1="3566.3408" y2="3566.3408"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="313.5142" x="1106.2712" y="3552.6855"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="295.2295" x="1112.2712" y="3569.2539">Encrypt PMEK with unlocked Encryption Key</text><polygon fill="#FF0000" points="1680.2329,3633.9277,1690.2329,3637.9277,1680.2329,3641.9277,1684.2329,3637.9277" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="3637.9277" y2="3637.9277"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="3617.875">[064]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.0884" x="502.3999" y="3602.5645">Wrap(Key: Slot B,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5112" x="539.4194" y="3617.875">Data Key : Slot Z</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="187.9351" x="539.4194" y="3633.1855">Destination : unlocked_pmek)</text><polygon fill="#FF0000" points="2089.3823,3663.2383,2099.3823,3667.2383,2089.3823,3671.2383,2093.3823,3667.2383" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2095.3823" y1="3667.2383" y2="3667.2383"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3662.4961">[065]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.9868" x="1748.5957" y="3662.4961">Get Encryption Key</text><polygon fill="#FF0000" points="2424.0566,3692.5488,2434.0566,3696.5488,2424.0566,3700.5488,2428.0566,3696.5488" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2430.0566" y1="3696.5488" y2="3696.5488"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3691.8066">[066]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="59.5283" x="1748.5957" y="3691.8066">Get PMEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="1744.2329" y1="3725.8594" y2="3725.8594"/><line style="stroke:#FF0000;stroke-width:1;" x1="1744.2329" x2="1744.2329" y1="3725.8594" y2="3738.8594"/><line style="stroke:#FF0000;stroke-width:1;" x1="1703.2329" x2="1744.2329" y1="3738.8594" y2="3738.8594"/><polygon fill="#FF0000" points="1713.2329,3734.8594,1703.2329,3738.8594,1713.2329,3742.8594,1709.2329,3738.8594" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3721.1172">[067]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="164.2964" x="1748.5957" y="3721.1172">Encrypt slot Z using Slot B</text><polygon fill="#FF0000" points="467.0371,3764.1699,457.0371,3768.1699,467.0371,3772.1699,463.0371,3768.1699" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="3768.1699" y2="3768.1699"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="3763.4277">[068]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="92.771" x="512.3999" y="3763.4277">Unocked PMEK</text><polygon fill="#FF0000" points="1680.2329,3808.791,1690.2329,3812.791,1680.2329,3816.791,1684.2329,3812.791" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="456.0371" x2="1686.2329" y1="3812.791" y2="3812.791"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="463.0371" y="3800.3936">[069]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="138.9629" x="502.3999" y="3792.7383">Purge_key(Key: Slot Y,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="74.6675" x="568.2124" y="3808.0488">Key : Slot Z)</text><polygon fill="#FF0000" points="2317.3145,3838.1016,2327.3145,3842.1016,2317.3145,3846.1016,2321.3145,3842.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2323.3145" y1="3842.1016" y2="3842.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3837.3594">[070]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="35.9214" x="1748.5957" y="3837.3594">Purge</text><polygon fill="#FF0000" points="2424.0566,3838.1016,2434.0566,3842.1016,2424.0566,3846.1016,2428.0566,3842.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="1702.2329" x2="2430.0566" y1="3842.1016" y2="3842.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="1709.2329" y="3837.3594">[071]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="1748.5957" y="3837.3594">&#160;</text><polygon fill="#FF0000" points="467.0371,3867.4121,457.0371,3871.4121,467.0371,3875.4121,463.0371,3871.4121" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="461.0371" x2="1691.2329" y1="3871.4121" y2="3871.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="473.0371" y="3866.6699">[072]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="512.3999" y="3866.6699">done</text><polygon fill="#FF0000" points="267.5845,3912.0332,257.5845,3916.0332,267.5845,3920.0332,263.5845,3916.0332" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="261.5845" x2="445.0371" y1="3916.0332" y2="3916.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="273.5845" y="3903.6357">[073]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="126.0898" x="312.9473" y="3895.9805">Command response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98.9155" x="312.9473" y="3911.291">Unlocked_PMEK</text><line style="stroke:#008000;stroke-width:1;" x1="100.6826" x2="110.6826" y1="3916.0332" y2="3912.0332"/><line style="stroke:#008000;stroke-width:1;" x1="100.6826" x2="110.6826" y1="3916.0332" y2="3920.0332"/><line style="stroke:#008000;stroke-width:1;" x1="99.6826" x2="255.5845" y1="3916.0332" y2="3916.0332"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="116.6826" y="3903.6357">[074]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.6826" x="156.0454" y="3895.9805">Command</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="58.0684" x="156.0454" y="3911.291">complete</text><path d="M261.5845,3957.0332 L261.5845,4032.0332 L880.5845,4032.0332 L880.5845,3967.0332 L870.5845,3957.0332 L261.5845,3957.0332 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M870.5845,3957.0332 L870.5845,3967.0332 L880.5845,3967.0332 L870.5845,3957.0332 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="267.5845" y="3976.6016">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32.1509" x="271.6978" y="3976.6016">Field</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="375.0313" y="3976.6016">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="26.9521" x="379.1445" y="3976.6016">Size</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="479.7739" y="3976.6016">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="66.644" x="483.8872" y="3976.6016">Definition</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.1563" x="271.6978" y="3991.9121">chksum</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="379.1445" y="3991.9121">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.0254" x="483.8872" y="3991.9121">Little endian</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="68.0723" x="271.6978" y="4007.2227">fips_status</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="24.5083" x="379.1445" y="4007.2227">u32</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.4253" x="483.8872" y="4007.2227">Indicates if the command is FIPS approved or an error</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.2202" x="271.6978" y="4022.5332">unlocked_pmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.5161" x="379.1445" y="4022.5332">EncryptedPmek</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.6602" x="483.8872" y="4022.5332">PMEK encrypted to an export secret that is rotated  on reset</text><line style="stroke:#000000;stroke-width:0.5;" x1="267.5845" x2="865.6606" y1="3964.0332" y2="3964.0332"/><line style="stroke:#000000;stroke-width:0.5;" x1="267.5845" x2="865.6606" y1="3979.3438" y2="3979.3438"/><line style="stroke:#000000;stroke-width:0.5;" x1="267.5845" x2="865.6606" y1="3994.6543" y2="3994.6543"/><line style="stroke:#000000;stroke-width:0.5;" x1="267.5845" x2="865.6606" y1="4009.9648" y2="4009.9648"/><line style="stroke:#000000;stroke-width:0.5;" x1="267.5845" x2="865.6606" y1="4025.2754" y2="4025.2754"/><line style="stroke:#000000;stroke-width:0.5;" x1="267.5845" x2="267.5845" y1="3964.0332" y2="4025.2754"/><line style="stroke:#000000;stroke-width:0.5;" x1="375.0313" x2="375.0313" y1="3964.0332" y2="4025.2754"/><line style="stroke:#000000;stroke-width:0.5;" x1="479.7739" x2="479.7739" y1="3964.0332" y2="4025.2754"/><line style="stroke:#000000;stroke-width:0.5;" x1="865.6606" x2="865.6606" y1="3964.0332" y2="4025.2754"/><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="135.7324" x="1251.6621" y="4131.4082">Filename: unlock_pmek.uml</text><!--SRC=[tLfHSzeu47xdLsoOtXsqa8QalUbbcjvGI9eCroiJajwqqnb6604URCiZ2H9kykDlLxQnR0o1NdfDZuS4f9Mqkz-tgxNaFJTmlDcGWt32lYUSQN-cNK_jOtEfjFT4JSHDdtaUdC1FMivufLhw9TiwOfwYvjAUEuBAigjQ0lp4eg7aZWY6rYHMftQrnukxMEWMT_Xgt0-PL6umBXOOYi2USu-ZaciqIWmeKgcWBzQfe2UdL854ebNIjSU3eJlAkCui7GswCbgKhmE21RhlJplbeX6nAT6OG6WEp952AVERFgy7RxgHZAjT4QZZryy7RvQzJw7fE5mfw4sOv4FeSKTo3SoJd0qNmERCzGQeXni00-K9JTyw7wtnCwCWMJtbY-N0L9wXdySyu99fd5y4m9ap0SaLrwcE8n5eS8Gdv0bgyUP2WPvmoMaEZax5eJa5GowXEVHncMl5vU-ldzCCaLde8-E8fRUKd3vx1a_UNf-TdLxscwshYu_DguiFVvQct1yNzuG-dwhYhjBe1fumjGWSy0SeSWpNV_xneTNf4qJPE0XT2nRfZYSQXooDlYDepbpk3S7wcDQU-pVFDRNvo0qCWd1dJU5Cfchc0sIdc1qTvfl-S3NnYLp2ibFSI1Q6VDXdXWXzGX5R_ufQ8tPqiEqEEgVlwx4mHC84UV0K__hz2UBiyI_1K_h1lB6GhfxuyM_73H5EpMyrDg0EZbo4Eh-afH8n2hi91Sk4qsHSDsw_Cs6HpWTQWD92iZ6wMo3t32C3MzjucHME-8C4L6TqOr1j2T_7iHb4hHYFa7M8334NSCmxJYoEnb6tFwZNpPSdYdkZIXd5opKejxdc4hdB4-6odQFCe5YlT7xyTWpfG1CIOfH6Nwd4F0szsFfBifvGuxUkqb4oeFxhPR2Q2GRS4pSOQXYD4-6XhOcpJqwCBHY4INwWoKvEbW8q6I7hKX8zk3quQ3IWqZv7YbIwzQDNBsfmtccVrNldJVnHhPPiCgP6JUVFdXt3QQjzNi6Hq6MkH2-cT8BAkshjIs0F9hcKJh6qpIzRkCsLTWDcekOOVEuBkSZgCfqdgc0kY02a5T3Q49LP8pgFT3QIhLIN6sJyvf46nEvC0mv6dyyydP6pc4PxHLRJ_4JrEff4OjafbZJAZejvc8ePUjbDzq3KwgDlkhC1shSUguVoRGk6NBfp3k5iuBaqmU8UXv8UAFn8tMbj0BZKodnN66O1CKXf7YfA2Xn6KlXmUTQ2tngl3cgu3Jg6nI_s6pMajSD26Cq2qvQPRfdOrkg2eTsEd7lUxPn2gFXiAEeICSG5AKFwc1caopoeT2yxLGhwZTGuVzziOOnNA44S0_T3lSY5REP3Ocsc6SgMIO7wl576H5v6Pj3_99L4kQLAFPnnh7AcrBiCcmqBs37VmmBa63vLrtCjrXv4I0LAtfjBKOrsBLBfI0b0_sJ4ZLHnrV0uUPdZWefAB1MLMBi1Jww6JvkGZr4dX8yEe39mn_Mu6ddnoW2z7HqY9VkHaYIJtG3Y1im5qN0SJ3iH34mP7Spy0PVL1w5Fp0bAQyPxUJOKyioKn9-YhMA83jc5RXbu7WUZU5peP9YrOsrGW-bmb0eV74Q89VqrOFX4aUrldlRgXoz_hRzhlQz-cqIhuEL-mzIEB_SFQvIrUiw43sSUVyiKDnqjVEB0kIxtFuGyM6PZHMY5DCcSUuj_cvkdQ3VkhsfYLgJQrZoAHPMCNO_TkuFlcAQBKZHzBmxA19S8IBibniv4hcMEcQyCbK10jzU1Y_Qs8NbV5RTzIZUbGox2B0r_Z8pj1YFnl-77qXWp6m_OmEFn8s9vEtfyMtOizVj1TlFuACScHkTZj0DzFJEstkSVb1hfRfzcZM-pYw_VP1z-Ftz46_bzP1hWhjSFHE3m1yuqEzMD1wrCtTWuNAaR_otHKZkJMR0Q8GVuOiX9mjwJxzAKy23vQOMB3qh2efIMchkkZ9hE2wieYm-k0Ysn-c7n2LpZ40OBpTNzjS-ZPNjoRlWzyYPnxZ3xV7Jqy3n72xy5mNTDjlz1bisV7TtFRK8_J-gZcDGm4X9cz0IWa25WFOYiBFGZKDuSdDl7utdMztPblUMHJSo_-8WzQHB9zRRi0zwYwmBhWJytz8gDrutHR9mJRZRRLAcKQvkEZOt-dxTazDgJIgAppPRXYk_NB_1tTCQvHjH8FE9J9peZi2yMMfBJtGFTBSGtEkJd-7wXj2cRlcmSzWaDPJEhUMzEjOG_VsqQMpf7oMa4T_wgfRGEEX9EBr5AQnCTMXTR52MwIE7IfZH7GvApIBfzt0hhpJYlOfp1Dxali_0ylTMIEP46aUOxm7eTq8tYfan141xRDuAROdKbM8i2DQjUCI19QhJMNGlmTtHzP8db-kW-4FUi7J3uAqOW1k2j3S2c0CgwFbdP-Ae007EblXq0Lk1aV9kz9OfjDxN1PzoJwLOpCk0hmRWE8jTbyTmDbBnlkpCvvhJxM0ukgW9j5wzZB-pjGJpZKkBddDTGvZjGCNSD7b-TcvDG4IZ-9RXEo97nxS-GNhjdRzs_18xmGu_7rHDj8Jnt5x_ZsnNvzogsVwaY_ph5fdSfHcwe-aepFLE58ozm2DMK2j0GsW7Z5m2etZoxwFQ0XQ4KStfHHb9zoQN4B_OAcJ1RUIcYw8q8ckOs538vSC1rcQO5fT2clAMNSipxE6jUZZ0CAVq3]--></g></svg>