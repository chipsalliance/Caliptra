<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1424px" preserveAspectRatio="none" style="width:1668px;height:1424px;background:#FFFFFF;" version="1.1" viewBox="0 0 1668 1424" width="1668px" zoomAndPan="magnify"><title>OCP L.O.C.K. Power On</title><defs/><g><rect fill="#DDDDDD" height="1344.0645" style="stroke:#181818;stroke-width:0.5;" width="1556.1255" x="99.3853" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="851.0513" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1614.4854" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="162.2373" x="751.6367" y="41.3125">OCP L.O.C.K. Power On</text><g><title>ROM</title><rect fill="transparent" height="978.6504" width="8" x="122.7788" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126.2788" x2="126.2788" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="126.2788" x2="126.2788" y1="1118.6914" y2="1146.6914"/><g><title>ROM</title><rect fill="transparent" height="183.1738" width="8" x="122.7788" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126.2788" x2="126.2788" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#FFFFFF" height="929.3398" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="121.2788" y="189.3516"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="121.2788" y1="189.3516" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="131.2788" x2="131.2788" y1="189.3516" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="131.2788" y1="189.3516" y2="189.3516"/></g><g><title/><rect fill="#FFFFFF" height="21.3105" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="121.2788" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="121.2788" y1="1146.6914" y2="1168.002"/><line style="stroke:#181818;stroke-width:1;" x1="131.2788" x2="131.2788" y1="1146.6914" y2="1168.002"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="131.2788" y1="1168.002" y2="1168.002"/></g><g><title>FW</title><rect fill="transparent" height="978.6504" width="8" x="376.2813" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="379.7813" x2="379.7813" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="379.7813" x2="379.7813" y1="1118.6914" y2="1146.6914"/><g><title>FW</title><rect fill="transparent" height="183.1738" width="8" x="376.2813" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="379.7813" x2="379.7813" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#FFFFFF" height="156.8633" style="stroke:#181818;stroke-width:1;" width="10" x="374.7813" y="1168.002"/></g><g><title>DRBG</title><rect fill="transparent" height="978.6504" width="8" x="683.853" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="687.353" x2="687.353" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="687.353" x2="687.353" y1="1118.6914" y2="1146.6914"/><g><title>DRBG</title><rect fill="transparent" height="183.1738" width="8" x="683.853" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="687.353" x2="687.353" y1="1146.6914" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="967.7441" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="971.2441" x2="971.2441" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="971.2441" x2="971.2441" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="967.7441" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="971.2441" x2="971.2441" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#FFFFFF" height="294.1289" style="stroke:#181818;stroke-width:1;" width="10" x="966.2441" y="261.9727"/></g><g><title/><rect fill="#FFFFFF" height="109.2422" style="stroke:#181818;stroke-width:1;" width="10" x="966.2441" y="702.3438"/></g><g><title/><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="966.2441" y="1022.7598"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1228.1401" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1231.6401" x2="1231.6401" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1231.6401" x2="1231.6401" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1228.1401" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1231.6401" x2="1231.6401" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="950.6504" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1226.6401" y="168.041"/><line style="stroke:#181818;stroke-width:1;" x1="1226.6401" x2="1226.6401" y1="168.041" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1236.6401" x2="1236.6401" y1="168.041" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1226.6401" x2="1236.6401" y1="168.041" y2="168.041"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1226.6401" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1226.6401" x2="1226.6401" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1236.6401" x2="1236.6401" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1226.6401" x2="1236.6401" y1="1329.8652" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1346.3462" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1349.8462" x2="1349.8462" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1349.8462" x2="1349.8462" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1346.3462" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1349.8462" x2="1349.8462" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="721.4766" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1344.8462" y="397.2148"/><line style="stroke:#181818;stroke-width:1;" x1="1344.8462" x2="1344.8462" y1="397.2148" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1354.8462" x2="1354.8462" y1="397.2148" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1344.8462" x2="1354.8462" y1="397.2148" y2="397.2148"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1344.8462" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1344.8462" x2="1344.8462" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1354.8462" x2="1354.8462" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1344.8462" x2="1354.8462" y1="1329.8652" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1478.4497" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1481.9497" x2="1481.9497" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1481.9497" x2="1481.9497" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1478.4497" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1481.9497" x2="1481.9497" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="37.3105" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1476.9497" y="1081.3809"/><line style="stroke:#181818;stroke-width:1;" x1="1476.9497" x2="1476.9497" y1="1081.3809" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1486.9497" x2="1486.9497" y1="1081.3809" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1476.9497" x2="1486.9497" y1="1081.3809" y2="1081.3809"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1476.9497" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1476.9497" x2="1476.9497" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1486.9497" x2="1486.9497" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1476.9497" x2="1486.9497" y1="1329.8652" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1594.564" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1598.064" x2="1598.064" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1598.064" x2="1598.064" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1594.564" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1598.064" x2="1598.064" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="336.416" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1593.064" y="782.2754"/><line style="stroke:#181818;stroke-width:1;" x1="1593.064" x2="1593.064" y1="782.2754" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1603.064" x2="1603.064" y1="782.2754" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1593.064" x2="1603.064" y1="782.2754" y2="782.2754"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1593.064" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1593.064" x2="1593.064" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1603.064" x2="1603.064" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1593.064" x2="1603.064" y1="1329.8652" y2="1329.8652"/></g><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45.7871" x="103.3853" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7871" x="110.3853" y="129.0879">ROM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="363.04" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="370.04" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="661.5986" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="668.5986" y="129.0879">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="932.4741" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="939.4741" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1192.8701" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1199.8701" y="112.5996">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.2676" x="1212.5063" y="129.0879">Fuses</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1280.4102" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1318.0762" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1330.0903" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1287.4102" y="129.0879">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105.335" x="1429.2822" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1450.1797" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1462.9971" y="112.5996">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.335" x="1436.2822" y="129.0879">(PMEK Secret)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1544.6172" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1566.2939" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1578.0791" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1551.6172" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45.7871" x="103.3853" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7871" x="110.3853" y="1350.4004">ROM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="363.04" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="370.04" y="1350.4004">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="661.5986" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="668.5986" y="1350.4004">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="932.4741" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="939.4741" y="1350.4004">Key Vault</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1192.8701" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1199.8701" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.2676" x="1212.5063" y="1366.8887">Fuses</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="138.8721" x="1280.4102" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1318.0762" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1330.0903" y="1366.8887">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="124.8721" x="1287.4102" y="1383.377">(Storage Root Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105.335" x="1429.2822" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1450.1797" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1462.9971" y="1366.8887">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.335" x="1436.2822" y="1383.377">(PMEK Secret)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1544.6172" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1566.2939" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1578.0791" y="1366.8887">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1551.6172" y="1383.377">(KEM Keypair)</text><path d="M93.1086,153.041 L93.1086,163.041 L1631.1086,163.041 L1631.1086,163.041 L1621.1086,153.041 L93.1086,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1621.1086,153.041 L1621.1086,163.041 L1631.1086,163.041 L1621.1086,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#008000;stroke-width:1;" x1="119.2788" x2="109.2788" y1="189.3516" y2="185.3516"/><line style="stroke:#008000;stroke-width:1;" x1="119.2788" x2="109.2788" y1="189.3516" y2="193.3516"/><line style="stroke:#008000;stroke-width:1;" x1="5" x2="120.2788" y1="189.3516" y2="189.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="12" y="184.6094">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.916" x="51.3628" y="184.6094">Power on</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1656.5107" x="5" y="218.0068"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="218.0068" y2="218.0068"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="221.0068" y2="221.0068"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="271.0483" x="697.7312" y="207.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="248.479" x="703.7312" y="223.9199">Load a KV slot with Storage Root Key</text><polygon fill="#FF0000" points="954.2441,257.9727,964.2441,261.9727,954.2441,265.9727,958.2441,261.9727" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="960.2441" y1="261.9727" y2="261.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="257.2305">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189.4712" x="177.6416" y="257.2305">load_storage_root(Key: Slot A)</text><path d="M955.2441,273.9727 L1029.6909,273.9727 L1029.6909,281.2832 L1019.6909,291.2832 L955.2441,291.2832 L955.2441,273.9727 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="56.6211" style="stroke:#000000;stroke-width:1.5;" width="395.2388" x="955.2441" y="273.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="970.2441" y="287.541">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="289.792" x="1044.6909" y="286.6074">[through fuses entries until valid fuse entry found]</text><polygon fill="#FF0000" points="1214.6401,318.5938,1224.6401,322.5938,1214.6401,326.5938,1218.6401,322.5938" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="976.2441" x2="1220.6401" y1="322.5938" y2="322.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="983.2441" y="317.8516">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8672" x="1022.6069" y="317.8516">get next entry</text><path d="M955.2441,348.5938 L1017.3828,348.5938 L1017.3828,355.9043 L1007.3828,365.9043 L955.2441,365.9043 L955.2441,348.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="172.1973" style="stroke:#000000;stroke-width:1.5;" width="415.6021" x="955.2441" y="348.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="970.2441" y="362.1621">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="90.6104" x="1032.3828" y="361.2285">[if a valid entry]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="955.2441" x2="1370.8462" y1="458.5254" y2="458.5254"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87.8604" x="960.2441" y="471.1602">[No valid entry]</text><polygon fill="#FF0000" points="1332.8462,393.2148,1342.8462,397.2148,1332.8462,401.2148,1336.8462,397.2148" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="976.2441" x2="1338.8462" y1="397.2148" y2="397.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="983.2441" y="392.4727">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.7266" x="1022.6069" y="392.4727">Put Storage Root Key</text><line style="stroke:#FF0000;stroke-width:1;" x1="976.2441" x2="1018.2441" y1="426.5254" y2="426.5254"/><line style="stroke:#FF0000;stroke-width:1;" x1="1018.2441" x2="1018.2441" y1="426.5254" y2="439.5254"/><line style="stroke:#FF0000;stroke-width:1;" x1="977.2441" x2="1018.2441" y1="439.5254" y2="439.5254"/><polygon fill="#FF0000" points="987.2441,435.5254,977.2441,439.5254,987.2441,443.5254,983.2441,439.5254" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="983.2441" y="421.7832">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.1772" x="1022.6069" y="421.7832">storage_root_ket_exists = True</text><line style="stroke:#FF0000;stroke-width:1;" x1="976.2441" x2="1018.2441" y1="499.791" y2="499.791"/><line style="stroke:#FF0000;stroke-width:1;" x1="1018.2441" x2="1018.2441" y1="499.791" y2="512.791"/><line style="stroke:#FF0000;stroke-width:1;" x1="977.2441" x2="1018.2441" y1="512.791" y2="512.791"/><polygon fill="#FF0000" points="987.2441,508.791,977.2441,512.791,987.2441,516.791,983.2441,512.791" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="983.2441" y="495.0488">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.0332" x="1022.6069" y="495.0488">storage_root_key_exists = False</text><polygon fill="#FF0000" points="142.2788,552.1016,132.2788,556.1016,142.2788,560.1016,138.2788,556.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="965.2441" y1="556.1016" y2="556.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="551.3594">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="151.6963" x="187.6416" y="551.3594">storage_root_key_exists</text><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="173.2788" y1="585.4121" y2="585.4121"/><line style="stroke:#FF0000;stroke-width:1;" x1="173.2788" x2="173.2788" y1="585.4121" y2="598.4121"/><line style="stroke:#FF0000;stroke-width:1;" x1="132.2788" x2="173.2788" y1="598.4121" y2="598.4121"/><polygon fill="#FF0000" points="142.2788,594.4121,132.2788,598.4121,142.2788,602.4121,138.2788,598.4121" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="580.6699">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195.1396" x="177.6416" y="580.6699">Retain storage_root_key_exists</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1656.5107" x="5" y="627.0674"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="627.0674" y2="627.0674"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="630.0674" y2="630.0674"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="420.0088" x="623.251" y="616.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="397.4395" x="629.251" y="632.9805">Load a KV slot with KEM for each KEM algorithm supported</text><path d="M110.2788,653.7227 L172.4175,653.7227 L172.4175,661.0332 L162.4175,671.0332 L110.2788,671.0332 L110.2788,653.7227 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="165.8633" style="stroke:#000000;stroke-width:1.5;" width="1508.7852" x="110.2788" y="653.7227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="125.2788" y="667.291">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="250.6152" x="187.4175" y="666.3574">[kem_algorithm ecdh_secp384r1 supported]</text><polygon fill="#FF0000" points="954.2441,698.3438,964.2441,702.3438,954.2441,706.3438,958.2441,702.3438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="960.2441" y1="702.3438" y2="702.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="697.6016">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.6426" x="177.6416" y="697.6016">generate_ecdh_secp384r1(Key: Slot G)</text><polygon fill="#FF0000" points="698.353,727.6543,688.353,731.6543,698.353,735.6543,694.353,731.6543" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="692.353" x2="965.2441" y1="731.6543" y2="731.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="704.353" y="726.9121">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.5283" x="743.7158" y="726.9121">Get random bytes for KEM keypair</text><path d="M981.2441,715.3438 L981.2441,755.3438 L1260.2441,755.3438 L1260.2441,725.3438 L1250.2441,715.3438 L981.2441,715.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1250.2441,715.3438 L1250.2441,725.3438 L1260.2441,725.3438 L1250.2441,715.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.2583" x="987.2441" y="732.9121">move to FW</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.8257" x="987.2441" y="748.2227">add note to indiacte would be nice in HW</text><polygon fill="#FF0000" points="1581.064,778.2754,1591.064,782.2754,1581.064,786.2754,1585.064,782.2754" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="976.2441" x2="1587.064" y1="782.2754" y2="782.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="983.2441" y="777.5332">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.1436" x="1022.6069" y="777.5332">Put KEM keypair</text><polygon fill="#FF0000" points="142.2788,807.5859,132.2788,811.5859,142.2788,815.5859,138.2788,811.5859" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="965.2441" y1="811.5859" y2="811.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="806.8438">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="187.6416" y="806.8438">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1656.5107" x="5" y="854.2412"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="854.2412" y2="854.2412"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="857.2412" y2="857.2412"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="450.5664" x="607.9722" y="843.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="427.9971" x="613.9722" y="860.1543">Load a KV slot with DICE key for each KEM algorithm supported</text><path d="M136.2788,881.8965 L136.2788,936.8965 L821.2788,936.8965 L821.2788,891.8965 L811.2788,881.8965 L136.2788,881.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M811.2788,881.8965 L811.2788,891.8965 L821.2788,891.8965 L811.2788,881.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="142.2788" y="899.4648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.2441" x="142.2788" y="914.7754">ROM/FMC code already created DICE keys and loaded them. Caliptra FW knows the key so no work to do.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="142.2788" y="930.0859">&#160;</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1656.5107" x="5" y="963.4834"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="963.4834" y2="963.4834"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1661.5107" y1="966.4834" y2="966.4834"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="282.9502" x="691.7803" y="952.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="260.3809" x="697.7803" y="969.3965">Load a KV slot with a PMEK unlock Key</text><polygon fill="#FF0000" points="954.2441,1018.7598,964.2441,1022.7598,954.2441,1026.7598,958.2441,1022.7598" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="960.2441" y1="1022.7598" y2="1022.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="1010.3623">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.7563" x="177.6416" y="1002.707">new_key(len: 256,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.7993" x="235.2275" y="1018.0176">Destination: Slot B)</text><polygon fill="#FF0000" points="698.353,1048.0703,688.353,1052.0703,698.353,1056.0703,694.353,1052.0703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="692.353" x2="965.2441" y1="1052.0703" y2="1052.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="704.353" y="1047.3281">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.8647" x="743.7158" y="1047.3281">Get new random key of 256 bits</text><polygon fill="#FF0000" points="1464.9497,1077.3809,1474.9497,1081.3809,1464.9497,1085.3809,1468.9497,1081.3809" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="976.2441" x2="1470.9497" y1="1081.3809" y2="1081.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="983.2441" y="1076.6387">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127.2197" x="1022.6069" y="1076.6387">Put PMEK Secret Key</text><polygon fill="#FF0000" points="142.2788,1106.6914,132.2788,1110.6914,142.2788,1114.6914,138.2788,1110.6914" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="965.2441" y1="1110.6914" y2="1110.6914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="1105.9492">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="187.6416" y="1105.9492">done</text><polygon fill="#FF0000" points="362.7813,1164.002,372.7813,1168.002,362.7813,1172.002,366.7813,1168.002" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="368.7813" y1="1168.002" y2="1168.002"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="1163.2598">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.062" x="177.6416" y="1163.2598">Hand-off information</text><path d="M389.7813,1181.002 L389.7813,1267.002 L950.7813,1267.002 L950.7813,1191.002 L940.7813,1181.002 L389.7813,1181.002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M940.7813,1181.002 L940.7813,1191.002 L950.7813,1191.002 L940.7813,1181.002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.8169" x="395.7813" y="1198.5703">Currently, there is already handoff information</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.5264" x="395.7813" y="1213.8809">from ROM to run-time FW. Need to include:</text><ellipse cx="401.2813" cy="1224.4336" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="528.5947" x="407.7813" y="1229.1914">If the Storage Root Key exists and if so the KV slot containing that Storage Root Key</text><ellipse cx="401.2813" cy="1239.7441" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.2886" x="407.7813" y="1244.502">The KV Slot containing the KEM keypair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="395.7813" y="1259.8125">&#160;</text><line style="stroke:#FF0000;stroke-width:1;" x1="384.7813" x2="426.7813" y1="1293.8652" y2="1293.8652"/><line style="stroke:#FF0000;stroke-width:1;" x1="426.7813" x2="426.7813" y1="1293.8652" y2="1306.8652"/><line style="stroke:#FF0000;stroke-width:1;" x1="385.7813" x2="426.7813" y1="1306.8652" y2="1306.8652"/><polygon fill="#FF0000" points="395.7813,1302.8652,385.7813,1306.8652,395.7813,1310.8652,391.7813,1306.8652" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="391.7813" y="1289.123">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.209" x="431.144" y="1289.123">Mark that no MEK sequence has started</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="118.4277" x="773.5415" y="1413.998">Filename: power_on.uml</text><!--SRC=[ZLPjR-8u4FxkNp5T8LsxtR2tTxUdKrGgiUaRefIgSArMUwV891EmI6pETg18_V4tTi9R2zNoXSIU6S_CyypZ70cPv6MAe99PdAja6fTMvAP9oumTDGOt_QVujj- -YBkNtw45lp9Q5HaSDyn4BM8hR8ud3EWtT8_meH_TmssptuoQtIRSgmLgwCiFx0XbAh8Ttvd6HCcqyfRA8l14AsCO-mNgtzde_8usJ7ZsUNI-MVu8PvcI5XALAztIc9xV8QPW5QJ29AKnyCHr0Gzea8ouGRFn1GZUUZ_sm9GZipGMLsu1S6FA0a7xLvL1Uz29WCiK7lezSaxTLe3Fc9GMq_SFk8ywk9rJ01TreY7Szowx1Wg-726KqY6m6ur-rxmGkIjFo3aQAyRSuli7HlIgLPvJzr-TwBjDOFYEhs79IchIwIaqllrzTNNv4BUZOUUnFUpqxnZx4Vnej0VVxw8uwj_s7_uzFmV2gI3hi0POISPQBRXLF0KEtKSmkRAm47O20wiq7oCyA5hfuXAWrMBC-KF3B6K2q_dfQGWvkSQcieqrsHwJRGW35wTzmdAbPc0dMfNZ2VXSgGIh1VsNakWASvwBrE_uZILagfIfhtKwhq-g_48OKpiaFjlAab476EEv1M8chmDLEplUHazTlQLzKvAte-tzxTi9Cfs7i5rbF4KRuxCmrj1i3NM937EguKuTJcHFZEKcnXKdVr_JrgIbIjP3kexY40W2E1YAcE42LJv1i2RA5dB-CIH-MIxamJW7cT6zx15A6f0drGlFnqhJJa6pE9ifJLDLiSM1CyKYtXXWaavYWydizx_-q5yszZxVD-GQeqHD8nFlkcrHxFfLTpIDUGZNH1JtHE56Ir8XdwxBbCgRSQ4tmgN5U6BPMhLU3MEXvkYcz-hfe0bFgu6iXZmLFA7dXIhp54WMf4YGbk7cQNTwTtc1nRXcwEiStTPXTkubodwokFtAPysEDKEgPSyIFr87OB_eH9SkkP_4VjDUdmLZ9BwVhtfH9S0yryZJ9MqXTowhuCRhj1CLTorCi6X2HFCqiveJ2Z2LQc7Ska_4AEecDPi6tDqWgidOkiE7gk1UjckzVaVN92xSC1pdA4FuxUkVd_wHEyeE5qxF9RT2oPgBtqxO7XvIe1KNNSvq7L4q60cQiBNrhC2fgHZWiniWzQMIAB-rdm8_gHCU-WEYq32gG2iAp0a5VNooAnFPmbyLDvHzeBACY4pG5xvabbBvMYqhRBUnpXR-cAZKcZGmNtvoS6cQ0hC6VUBQyIgUyydSsUwE9ZHrAGEN6A7UXDL7Glt54xBgMwAJUIgykQbgJNLCeXOHIvpLYWNqvU9aJyWnBVC3by9765OkWpSkk3EaMuIZoZUD2w777ItT2SHH1wh1_qgKf0SJRaXqkPUzbvUlBo_EbK1X_mC0]--></g></svg>