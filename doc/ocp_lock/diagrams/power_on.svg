<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1393px" preserveAspectRatio="none" style="width:1573px;height:1393px;background:#FFFFFF;" version="1.1" viewBox="0 0 1573 1393" width="1573px" zoomAndPan="magnify"><title>OCP L.O.C.K. Power On</title><defs/><g><rect fill="#DDDDDD" height="1344.0645" style="stroke:#181818;stroke-width:0.5;" width="1461.4502" x="99.3853" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="803.7136" y="56.0566">Caliptra</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="162.2373" x="704.2991" y="28.5352">OCP L.O.C.K. Power On</text><g><title>ROM</title><rect fill="transparent" height="978.6504" width="8" x="122.7788" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126.2788" x2="126.2788" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="126.2788" x2="126.2788" y1="1105.9141" y2="1133.9141"/><g><title>ROM</title><rect fill="transparent" height="183.1738" width="8" x="122.7788" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126.2788" x2="126.2788" y1="1133.9141" y2="1317.0879"/></g><g><title/><rect fill="#FFFFFF" height="929.3398" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="121.2788" y="176.5742"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="121.2788" y1="176.5742" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="131.2788" x2="131.2788" y1="176.5742" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="131.2788" y1="176.5742" y2="176.5742"/></g><g><title/><rect fill="#FFFFFF" height="21.3105" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="121.2788" y="1133.9141"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="121.2788" y1="1133.9141" y2="1155.2246"/><line style="stroke:#181818;stroke-width:1;" x1="131.2788" x2="131.2788" y1="1133.9141" y2="1155.2246"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="131.2788" y1="1155.2246" y2="1155.2246"/></g><g><title>FW</title><rect fill="transparent" height="978.6504" width="8" x="327.2036" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="330.7036" x2="330.7036" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="330.7036" x2="330.7036" y1="1105.9141" y2="1133.9141"/><g><title>FW</title><rect fill="transparent" height="183.1738" width="8" x="327.2036" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="330.7036" x2="330.7036" y1="1133.9141" y2="1317.0879"/></g><g><title/><rect fill="#FFFFFF" height="156.8633" style="stroke:#181818;stroke-width:1;" width="10" x="325.7036" y="1155.2246"/></g><g><title>DRBG</title><rect fill="transparent" height="978.6504" width="8" x="634.7754" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="638.2754" x2="638.2754" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="638.2754" x2="638.2754" y1="1105.9141" y2="1133.9141"/><g><title>DRBG</title><rect fill="transparent" height="183.1738" width="8" x="634.7754" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="638.2754" x2="638.2754" y1="1133.9141" y2="1317.0879"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="918.6665" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="922.1665" x2="922.1665" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="922.1665" x2="922.1665" y1="1105.9141" y2="1133.9141"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="918.6665" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="922.1665" x2="922.1665" y1="1133.9141" y2="1317.0879"/></g><g><title/><rect fill="#FFFFFF" height="294.1289" style="stroke:#181818;stroke-width:1;" width="10" x="917.1665" y="249.1953"/></g><g><title/><rect fill="#FFFFFF" height="109.2422" style="stroke:#181818;stroke-width:1;" width="10" x="917.1665" y="689.5664"/></g><g><title/><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="917.1665" y="1009.9824"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1090.5762" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1094.0762" x2="1094.0762" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1094.0762" x2="1094.0762" y1="1105.9141" y2="1133.9141"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1090.5762" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1094.0762" x2="1094.0762" y1="1133.9141" y2="1317.0879"/></g><g><title/><rect fill="#ADD8E6" height="950.6504" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1089.0762" y="155.2637"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1089.0762" y1="155.2637" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1099.0762" x2="1099.0762" y1="155.2637" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1099.0762" y1="155.2637" y2="155.2637"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1089.0762" y="1133.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1089.0762" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1099.0762" x2="1099.0762" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1099.0762" y1="1317.0879" y2="1317.0879"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1178.1162" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1181.6162" x2="1181.6162" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1181.6162" x2="1181.6162" y1="1105.9141" y2="1133.9141"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1178.1162" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1181.6162" x2="1181.6162" y1="1133.9141" y2="1317.0879"/></g><g><title/><rect fill="#ADD8E6" height="721.4766" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1176.6162" y="384.4375"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1176.6162" y1="384.4375" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1186.6162" x2="1186.6162" y1="384.4375" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1186.6162" y1="384.4375" y2="384.4375"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1176.6162" y="1133.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1176.6162" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1186.6162" x2="1186.6162" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1186.6162" y1="1317.0879" y2="1317.0879"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1331.6641" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1335.1641" x2="1335.1641" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1335.1641" x2="1335.1641" y1="1105.9141" y2="1133.9141"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1331.6641" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1335.1641" x2="1335.1641" y1="1133.9141" y2="1317.0879"/></g><g><title/><rect fill="#ADD8E6" height="37.3105" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1330.1641" y="1068.6035"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1330.1641" y1="1068.6035" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1340.1641" x2="1340.1641" y1="1068.6035" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1340.1641" y1="1068.6035" y2="1068.6035"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1330.1641" y="1133.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1330.1641" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1340.1641" x2="1340.1641" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1340.1641" y1="1317.0879" y2="1317.0879"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1499.8887" y="127.2637"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1503.3887" x2="1503.3887" y1="127.2637" y2="1105.9141"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1503.3887" x2="1503.3887" y1="1105.9141" y2="1133.9141"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1499.8887" y="1133.9141"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1503.3887" x2="1503.3887" y1="1133.9141" y2="1317.0879"/></g><g><title/><rect fill="#ADD8E6" height="336.416" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1498.3887" y="769.498"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1498.3887" y1="769.498" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1508.3887" x2="1508.3887" y1="769.498" y2="1105.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1508.3887" y1="769.498" y2="769.498"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1498.3887" y="1133.9141"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1498.3887" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1508.3887" x2="1508.3887" y1="1133.9141" y2="1317.0879"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1508.3887" y1="1317.0879" y2="1317.0879"/></g><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45.7871" x="103.3853" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7871" x="110.3853" y="116.3105">ROM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="313.9624" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="320.9624" y="116.3105">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="612.521" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="619.521" y="116.3105">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="883.3965" y="95.7754"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="890.3965" y="116.3105">Key Vault</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1055.3062" y="79.2871"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1062.3062" y="99.8223">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.2676" x="1074.9424" y="116.3105">Fuses</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1142.8462" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1149.8462" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1161.8604" y="99.8223">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1164.9468" y="116.3105">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1230.3862" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1303.394" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1316.2114" y="99.8223">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1237.3862" y="116.3105">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1449.9419" y="62.7988"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1471.6187" y="83.334">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1483.4038" y="99.8223">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1456.9419" y="116.3105">(KEM Keypair)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45.7871" x="103.3853" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7871" x="110.3853" y="1337.623">ROM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="313.9624" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="320.9624" y="1337.623">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="612.521" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="619.521" y="1337.623">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="883.3965" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="890.3965" y="1337.623">Key Vault</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1055.3062" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1062.3062" y="1337.623">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.2676" x="1074.9424" y="1354.1113">Fuses</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1142.8462" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1149.8462" y="1337.623">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1161.8604" y="1354.1113">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1164.9468" y="1370.5996">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1230.3862" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1303.394" y="1337.623">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1316.2114" y="1354.1113">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1237.3862" y="1370.5996">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1449.9419" y="1317.0879"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1471.6187" y="1337.623">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1483.4038" y="1354.1113">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1456.9419" y="1370.5996">(KEM Keypair)</text><path d="M93.1086,140.2637 L93.1086,150.2637 L1536.1086,150.2637 L1536.1086,150.2637 L1526.1086,140.2637 L93.1086,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1526.1086,140.2637 L1526.1086,150.2637 L1536.1086,150.2637 L1526.1086,140.2637 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#008000;stroke-width:1;" x1="119.2788" x2="109.2788" y1="176.5742" y2="172.5742"/><line style="stroke:#008000;stroke-width:1;" x1="119.2788" x2="109.2788" y1="176.5742" y2="180.5742"/><line style="stroke:#008000;stroke-width:1;" x1="5" x2="120.2788" y1="176.5742" y2="176.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="12" y="171.832">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.916" x="51.3628" y="171.832">Power on</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="205.2295"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="205.2295" y2="205.2295"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="208.2295" y2="208.2295"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="180.9688" x="695.4333" y="194.5742"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.3994" x="701.4333" y="211.1426">Load a KV slot with FEK</text><polygon fill="#FF0000" points="905.1665,245.1953,915.1665,249.1953,905.1665,253.1953,909.1665,249.1953" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="911.1665" y1="249.1953" y2="249.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="244.4531">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1177" x="177.6416" y="244.4531">load_fek(Key: Slot A)</text><path d="M906.1665,261.1953 L980.6133,261.1953 L980.6133,268.5059 L970.6133,278.5059 L906.1665,278.5059 L906.1665,261.1953 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="56.6211" style="stroke:#000000;stroke-width:1.5;" width="395.2388" x="906.1665" y="261.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="921.1665" y="274.7637">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="289.792" x="995.6133" y="273.8301">[through fuses entries until valid fuse entry found]</text><polygon fill="#FF0000" points="1077.0762,305.8164,1087.0762,309.8164,1077.0762,313.8164,1081.0762,309.8164" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1083.0762" y1="309.8164" y2="309.8164"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="305.0742">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8672" x="973.5293" y="305.0742">get next entry</text><path d="M906.1665,335.8164 L968.3052,335.8164 L968.3052,343.127 L958.3052,353.127 L906.1665,353.127 L906.1665,335.8164 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="172.1973" style="stroke:#000000;stroke-width:1.5;" width="296.4497" x="906.1665" y="335.8164"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="921.1665" y="349.3848">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="90.6104" x="983.3052" y="348.4512">[if a valid entry]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="906.1665" x2="1202.6162" y1="445.748" y2="445.748"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87.8604" x="911.1665" y="458.3828">[No valid entry]</text><polygon fill="#FF0000" points="1164.6162,380.4375,1174.6162,384.4375,1164.6162,388.4375,1168.6162,384.4375" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1170.6162" y1="384.4375" y2="384.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="379.6953">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.7314" x="973.5293" y="379.6953">Put FEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="969.1665" y1="413.748" y2="413.748"/><line style="stroke:#FF0000;stroke-width:1;" x1="969.1665" x2="969.1665" y1="413.748" y2="426.748"/><line style="stroke:#FF0000;stroke-width:1;" x1="928.1665" x2="969.1665" y1="426.748" y2="426.748"/><polygon fill="#FF0000" points="938.1665,422.748,928.1665,426.748,938.1665,430.748,934.1665,426.748" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="409.0059">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6206" x="973.5293" y="409.0059">fek_exists = True</text><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="969.1665" y1="487.0137" y2="487.0137"/><line style="stroke:#FF0000;stroke-width:1;" x1="969.1665" x2="969.1665" y1="487.0137" y2="500.0137"/><line style="stroke:#FF0000;stroke-width:1;" x1="928.1665" x2="969.1665" y1="500.0137" y2="500.0137"/><polygon fill="#FF0000" points="938.1665,496.0137,928.1665,500.0137,938.1665,504.0137,934.1665,500.0137" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="482.2715">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.5469" x="973.5293" y="482.2715">fek_exists = False</text><polygon fill="#FF0000" points="142.2788,539.3242,132.2788,543.3242,142.2788,547.3242,138.2788,543.3242" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="916.1665" y1="543.3242" y2="543.3242"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="538.582">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.21" x="187.6416" y="538.582">fek_exists</text><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="173.2788" y1="572.6348" y2="572.6348"/><line style="stroke:#FF0000;stroke-width:1;" x1="173.2788" x2="173.2788" y1="572.6348" y2="585.6348"/><line style="stroke:#FF0000;stroke-width:1;" x1="132.2788" x2="173.2788" y1="585.6348" y2="585.6348"/><polygon fill="#FF0000" points="142.2788,581.6348,132.2788,585.6348,142.2788,589.6348,138.2788,585.6348" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="567.8926">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.6533" x="177.6416" y="567.8926">Retain fek_exists</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="614.29"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="614.29" y2="614.29"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="617.29" y2="617.29"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="420.0088" x="575.9133" y="603.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="397.4395" x="581.9133" y="620.2031">Load a KV slot with KEM for each KEM algorithm supported</text><path d="M110.2788,640.9453 L172.4175,640.9453 L172.4175,648.2559 L162.4175,658.2559 L110.2788,658.2559 L110.2788,640.9453 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="165.8633" style="stroke:#000000;stroke-width:1.5;" width="1414.1099" x="110.2788" y="640.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="125.2788" y="654.5137">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="250.6152" x="187.4175" y="653.5801">[kem_algorithm ecdh_secp384r1 supported]</text><polygon fill="#FF0000" points="905.1665,685.5664,915.1665,689.5664,905.1665,693.5664,909.1665,689.5664" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="911.1665" y1="689.5664" y2="689.5664"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="684.8242">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.6426" x="177.6416" y="684.8242">generate_ecdh_secp384r1(Key: Slot G)</text><polygon fill="#FF0000" points="649.2754,714.877,639.2754,718.877,649.2754,722.877,645.2754,718.877" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="643.2754" x2="916.1665" y1="718.877" y2="718.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="655.2754" y="714.1348">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.5283" x="694.6382" y="714.1348">Get random bytes for KEM keypair</text><path d="M932.1665,702.5664 L932.1665,742.5664 L1211.1665,742.5664 L1211.1665,712.5664 L1201.1665,702.5664 L932.1665,702.5664 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1201.1665,702.5664 L1201.1665,712.5664 L1211.1665,712.5664 L1201.1665,702.5664 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.2583" x="938.1665" y="720.1348">move to FW</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.8257" x="938.1665" y="735.4453">add note to indiacte would be nice in HW</text><polygon fill="#FF0000" points="1486.3887,765.498,1496.3887,769.498,1486.3887,773.498,1490.3887,769.498" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1492.3887" y1="769.498" y2="769.498"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="764.7559">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.1436" x="973.5293" y="764.7559">Put KEM keypair</text><polygon fill="#FF0000" points="142.2788,794.8086,132.2788,798.8086,142.2788,802.8086,138.2788,798.8086" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="916.1665" y1="798.8086" y2="798.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="794.0664">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="187.6416" y="794.0664">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="841.4639"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="841.4639" y2="841.4639"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="844.4639" y2="844.4639"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="450.5664" x="560.6345" y="830.8086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="427.9971" x="566.6345" y="847.377">Load a KV slot with DICE key for each KEM algorithm supported</text><path d="M136.2788,869.1191 L136.2788,924.1191 L821.2788,924.1191 L821.2788,879.1191 L811.2788,869.1191 L136.2788,869.1191 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M811.2788,869.1191 L811.2788,879.1191 L821.2788,879.1191 L811.2788,869.1191 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="142.2788" y="886.6875">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.2441" x="142.2788" y="901.998">ROM/FMC code already created DICE keys and loaded them. Caliptra FW knows the key so no work to do.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="142.2788" y="917.3086">&#160;</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="950.7061"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="950.7061" y2="950.7061"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="953.7061" y2="953.7061"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="354.6089" x="608.6133" y="940.0508"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="332.0396" x="614.6133" y="956.6191">Load a KV slot with a Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="905.1665,1005.9824,915.1665,1009.9824,905.1665,1013.9824,909.1665,1009.9824" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="911.1665" y1="1009.9824" y2="1009.9824"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="997.585">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.7563" x="177.6416" y="989.9297">new_key(len: 256,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.7993" x="235.2275" y="1005.2402">Destination: Slot B)</text><polygon fill="#FF0000" points="649.2754,1035.293,639.2754,1039.293,649.2754,1043.293,645.2754,1039.293" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="643.2754" x2="916.1665" y1="1039.293" y2="1039.293"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="655.2754" y="1034.5508">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.8647" x="694.6382" y="1034.5508">Get new random key of 256 bits</text><polygon fill="#FF0000" points="1318.1641,1064.6035,1328.1641,1068.6035,1318.1641,1072.6035,1322.1641,1068.6035" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1324.1641" y1="1068.6035" y2="1068.6035"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="1063.8613">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.3613" x="973.5293" y="1063.8613">Put Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="142.2788,1093.9141,132.2788,1097.9141,142.2788,1101.9141,138.2788,1097.9141" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="916.1665" y1="1097.9141" y2="1097.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="1093.1719">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="187.6416" y="1093.1719">done</text><polygon fill="#FF0000" points="313.7036,1151.2246,323.7036,1155.2246,313.7036,1159.2246,317.7036,1155.2246" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="319.7036" y1="1155.2246" y2="1155.2246"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="1150.4824">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.062" x="177.6416" y="1150.4824">Hand-off information</text><path d="M340.7036,1168.2246 L340.7036,1254.2246 L731.7036,1254.2246 L731.7036,1178.2246 L721.7036,1168.2246 L340.7036,1168.2246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M721.7036,1168.2246 L721.7036,1178.2246 L731.7036,1178.2246 L721.7036,1168.2246 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.8169" x="346.7036" y="1185.793">Currently, there is already handoff information</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.5264" x="346.7036" y="1201.1035">from ROM to run-time FW. Need to include:</text><ellipse cx="352.2036" cy="1211.6563" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.6045" x="358.7036" y="1216.4141">If the FEK exists and if so the KV slot containing that FEK</text><ellipse cx="352.2036" cy="1226.9668" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.2886" x="358.7036" y="1231.7246">The KV Slot containing the KEM keypair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="346.7036" y="1247.0352">&#160;</text><line style="stroke:#FF0000;stroke-width:1;" x1="335.7036" x2="377.7036" y1="1281.0879" y2="1281.0879"/><line style="stroke:#FF0000;stroke-width:1;" x1="377.7036" x2="377.7036" y1="1281.0879" y2="1294.0879"/><line style="stroke:#FF0000;stroke-width:1;" x1="336.7036" x2="377.7036" y1="1294.0879" y2="1294.0879"/><polygon fill="#FF0000" points="346.7036,1290.0879,336.7036,1294.0879,346.7036,1298.0879,342.7036,1294.0879" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="342.7036" y="1276.3457">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.209" x="382.0664" y="1276.3457">Mark that no MEK sequence has started</text><!--SRC=[ZLPjRzis4FxENt4f32nfAdVTsc8GuW2kOYU6upX8iWH5DmYqTB89IQH7KdO4vCVlI3b-IUAY-YA9Ty_nUFVS8nq8cHHLYg2IULoe98yhAmhJfcN63bgt5-E7-7BSFOk7lU_GWTyPhOeC3bjcffQn5RR08mPqtRb7U3UEhk6oFMv7xM4RhjKIDOpbEtQ0CXNP3dQkCL4oRT1IMGIUQ6KCOx_1wZgPd5wHmOGd7oUdc-NtS98fQI5HXT8TZUdf5M8ALa4gJ58P0mzSbt231ic96pGRB43m6dq_0bDDJ6qiFiC2uCPK9OBshog3xkqW0YvJk1cF29mwKu2Fc5GMqvzlS1qDS3kd0CvMYOPmFUeD3PIydhY0FAstGz5rpajHkBC9kK1ZnPHR_Fbk4RrgLHHK-XVR-L9J9tovrpt9AghGyJ6qlltTx_TkucvqDxZltWt6Lupz27wqkhVVhw8u6b-ER_uzFGLgKadUuQgxIZBMwS2buYbm6Dw3API5fR0pwFU609qEOmu2BLFB1FB5yN481Nd76UQ7Gwn3k7M8xX4hb9g3dMbLJMVWiw9ahHPqhoIn4XQy4ActU4CDcQfawa-LBrORDBWGfdHmYO-syMHqLiPuOO48o5U16iik6dDtiigwvBs9LjwkpGukNuJECyP7OQoXGRdJ5J8iADChjN-xLx0-9uXFTcjIKYLNGxO6kee60MoZgPyEsxW5mRgzMyNtZo6nmd8Xjw5xMpZiZQZ86f0dpGilfagJfQI9cS-L9kutFNQrpR6CDmwOfBFOO3B_yw_F-jF6twVuYX9JbAY9s_4kR8iXvozge6aOGpYdFhid2ZUfIIjykYxJ7Eiv5teZBrfCPvQjjUN5r9HgWMxC-WzxNNZQJ4upZQdW2JqlLLMaGCChHOAq31SFksEsst0ifok2lSpHcVOpxKqwl4q9PsymQqAiIT4iUsBuYTZJzhD1r7F9_MBlD-NrMJ164lcnFueQcUI5rpKo8NUGv-36gwcJ0YVUCopR4D6WpAtcr0N8fLeQj-uJCOggISNMkTTvrMPiNU5zf-34TBUnarZeoKJNSokK1ABK7bsIk8nfjyC2PGX_VFdwuH-v8yPmvYHOSXTcnSflH-mDHbAWPrQwxEdpGT5W8cZMrjxp4dFJS65ldimxlKsBNrG8JuSzsj0ogaGhIYoeC_hmQ5SjigNN-GiwHw2oZCXDT2ZzuLbAXT2gRlgztVziwRU9Agr9y8hwWskXfiamQoBCN65UnFDIw_PsNrVgiAvau18Z9hJX-VE- -bS9MVCNCCWyFTndPYMWZb1K5IABCpoJWNupdE09EQLblf7szt3NUDs-yiATyToY6frlKvuGHjmHqWKbThhs6VolGabACEC6ZELUy9wUlZmzEIYLdlqF]--></g></svg>