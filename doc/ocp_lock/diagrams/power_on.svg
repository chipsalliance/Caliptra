<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="1424px" preserveAspectRatio="none" style="width:1573px;height:1424px;background:#FFFFFF;" version="1.1" viewBox="0 0 1573 1424" width="1573px" zoomAndPan="magnify"><title>OCP L.O.C.K. Power On</title><defs/><g><rect fill="#DDDDDD" height="1344.0645" style="stroke:#181818;stroke-width:0.5;" width="1461.4502" x="99.3853" y="56.2656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="52.7935" x="803.7136" y="68.834">Caliptra</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="46.0254" x="1519.8101" y="14.668">Version 1</text><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="162.2373" x="704.2991" y="41.3125">OCP L.O.C.K. Power On</text><g><title>ROM</title><rect fill="transparent" height="978.6504" width="8" x="122.7788" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126.2788" x2="126.2788" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="126.2788" x2="126.2788" y1="1118.6914" y2="1146.6914"/><g><title>ROM</title><rect fill="transparent" height="183.1738" width="8" x="122.7788" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="126.2788" x2="126.2788" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#FFFFFF" height="929.3398" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="121.2788" y="189.3516"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="121.2788" y1="189.3516" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="131.2788" x2="131.2788" y1="189.3516" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="131.2788" y1="189.3516" y2="189.3516"/></g><g><title/><rect fill="#FFFFFF" height="21.3105" style="stroke:#FFFFFF;stroke-width:1;" width="10" x="121.2788" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="121.2788" y1="1146.6914" y2="1168.002"/><line style="stroke:#181818;stroke-width:1;" x1="131.2788" x2="131.2788" y1="1146.6914" y2="1168.002"/><line style="stroke:#181818;stroke-width:1;" x1="121.2788" x2="131.2788" y1="1168.002" y2="1168.002"/></g><g><title>FW</title><rect fill="transparent" height="978.6504" width="8" x="327.2036" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="330.7036" x2="330.7036" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="330.7036" x2="330.7036" y1="1118.6914" y2="1146.6914"/><g><title>FW</title><rect fill="transparent" height="183.1738" width="8" x="327.2036" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="330.7036" x2="330.7036" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#FFFFFF" height="156.8633" style="stroke:#181818;stroke-width:1;" width="10" x="325.7036" y="1168.002"/></g><g><title>DRBG</title><rect fill="transparent" height="978.6504" width="8" x="634.7754" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="638.2754" x2="638.2754" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="638.2754" x2="638.2754" y1="1118.6914" y2="1146.6914"/><g><title>DRBG</title><rect fill="transparent" height="183.1738" width="8" x="634.7754" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="638.2754" x2="638.2754" y1="1146.6914" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="918.6665" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="922.1665" x2="922.1665" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="922.1665" x2="922.1665" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="918.6665" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="922.1665" x2="922.1665" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#FFFFFF" height="294.1289" style="stroke:#181818;stroke-width:1;" width="10" x="917.1665" y="261.9727"/></g><g><title/><rect fill="#FFFFFF" height="109.2422" style="stroke:#181818;stroke-width:1;" width="10" x="917.1665" y="702.3438"/></g><g><title/><rect fill="#FFFFFF" height="87.9316" style="stroke:#181818;stroke-width:1;" width="10" x="917.1665" y="1022.7598"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1090.5762" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1094.0762" x2="1094.0762" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1094.0762" x2="1094.0762" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1090.5762" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1094.0762" x2="1094.0762" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="950.6504" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1089.0762" y="168.041"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1089.0762" y1="168.041" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1099.0762" x2="1099.0762" y1="168.041" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1099.0762" y1="168.041" y2="168.041"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1089.0762" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1089.0762" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1099.0762" x2="1099.0762" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1089.0762" x2="1099.0762" y1="1329.8652" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1178.1162" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1181.6162" x2="1181.6162" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1181.6162" x2="1181.6162" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1178.1162" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1181.6162" x2="1181.6162" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="721.4766" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1176.6162" y="397.2148"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1176.6162" y1="397.2148" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1186.6162" x2="1186.6162" y1="397.2148" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1186.6162" y1="397.2148" y2="397.2148"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1176.6162" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1176.6162" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1186.6162" x2="1186.6162" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1176.6162" x2="1186.6162" y1="1329.8652" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1331.6641" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1335.1641" x2="1335.1641" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1335.1641" x2="1335.1641" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1331.6641" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1335.1641" x2="1335.1641" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="37.3105" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1330.1641" y="1081.3809"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1330.1641" y1="1081.3809" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1340.1641" x2="1340.1641" y1="1081.3809" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1340.1641" y1="1081.3809" y2="1081.3809"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1330.1641" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1330.1641" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1340.1641" x2="1340.1641" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1330.1641" x2="1340.1641" y1="1329.8652" y2="1329.8652"/></g><g><title>Key Vault</title><rect fill="transparent" height="978.6504" width="8" x="1499.8887" y="140.041"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1503.3887" x2="1503.3887" y1="140.041" y2="1118.6914"/></g><line style="stroke:#A80036;stroke-width:1;stroke-dasharray:1.0,4.0;" x1="1503.3887" x2="1503.3887" y1="1118.6914" y2="1146.6914"/><g><title>Key Vault</title><rect fill="transparent" height="183.1738" width="8" x="1499.8887" y="1146.6914"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1503.3887" x2="1503.3887" y1="1146.6914" y2="1329.8652"/></g><g><title/><rect fill="#ADD8E6" height="336.416" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1498.3887" y="782.2754"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1498.3887" y1="782.2754" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1508.3887" x2="1508.3887" y1="782.2754" y2="1118.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1508.3887" y1="782.2754" y2="782.2754"/></g><g><title/><rect fill="#ADD8E6" height="183.1738" style="stroke:#ADD8E6;stroke-width:1;" width="10" x="1498.3887" y="1146.6914"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1498.3887" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1508.3887" x2="1508.3887" y1="1146.6914" y2="1329.8652"/><line style="stroke:#181818;stroke-width:1;" x1="1498.3887" x2="1508.3887" y1="1329.8652" y2="1329.8652"/></g><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45.7871" x="103.3853" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7871" x="110.3853" y="129.0879">ROM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="313.9624" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="320.9624" y="129.0879">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="612.521" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="619.521" y="129.0879">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="883.3965" y="108.5527"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="890.3965" y="129.0879">Key Vault</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1055.3062" y="92.0645"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1062.3062" y="112.5996">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.2676" x="1074.9424" y="129.0879">Fuses</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1142.8462" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1149.8462" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1161.8604" y="112.5996">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1164.9468" y="129.0879">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1230.3862" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1303.394" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1316.2114" y="112.5996">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1237.3862" y="129.0879">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1449.9419" y="75.5762"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1471.6187" y="96.1113">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1483.4038" y="112.5996">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1456.9419" y="129.0879">(KEM Keypair)</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="45.7871" x="103.3853" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.7871" x="110.3853" y="1350.4004">ROM</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="33.4824" x="313.9624" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="19.4824" x="320.9624" y="1350.4004">FW</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="51.5088" x="612.521" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.5088" x="619.521" y="1350.4004">DRBG</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="883.3965" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="890.3965" y="1350.4004">Key Vault</text><rect fill="#E2E2F0" height="46.9766" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1055.3062" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1062.3062" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="38.2676" x="1074.9424" y="1366.8887">Fuses</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="77.54" x="1142.8462" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1149.8462" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.5117" x="1161.8604" y="1366.8887">Slot A</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="33.3389" x="1164.9468" y="1383.377">(FEK)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="209.5557" x="1230.3862" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1303.394" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="37.9053" x="1316.2114" y="1366.8887">Slot B</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="195.5557" x="1237.3862" y="1383.377">(Ready PMEK Encryption Key)</text><rect fill="#E2E2F0" height="63.4648" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106.8936" x="1449.9419" y="1329.8652"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.54" x="1471.6187" y="1350.4004">Key Vault</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="39.9697" x="1483.4038" y="1366.8887">Slot G</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92.8936" x="1456.9419" y="1383.377">(KEM Keypair)</text><path d="M93.1086,153.041 L93.1086,163.041 L1536.1086,163.041 L1536.1086,163.041 L1526.1086,153.041 L93.1086,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1526.1086,153.041 L1526.1086,163.041 L1536.1086,163.041 L1526.1086,153.041 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><line style="stroke:#008000;stroke-width:1;" x1="119.2788" x2="109.2788" y1="189.3516" y2="185.3516"/><line style="stroke:#008000;stroke-width:1;" x1="119.2788" x2="109.2788" y1="189.3516" y2="193.3516"/><line style="stroke:#008000;stroke-width:1;" x1="5" x2="120.2788" y1="189.3516" y2="189.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="12" y="184.6094">[001]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="57.916" x="51.3628" y="184.6094">Power on</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="218.0068"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="218.0068" y2="218.0068"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="221.0068" y2="221.0068"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="180.9688" x="695.4333" y="207.3516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="158.3994" x="701.4333" y="223.9199">Load a KV slot with FEK</text><polygon fill="#FF0000" points="905.1665,257.9727,915.1665,261.9727,905.1665,265.9727,909.1665,261.9727" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="911.1665" y1="261.9727" y2="261.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="257.2305">[002]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1177" x="177.6416" y="257.2305">load_fek(Key: Slot A)</text><path d="M906.1665,273.9727 L980.6133,273.9727 L980.6133,281.2832 L970.6133,291.2832 L906.1665,291.2832 L906.1665,273.9727 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="56.6211" style="stroke:#000000;stroke-width:1.5;" width="395.2388" x="906.1665" y="273.9727"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.4468" x="921.1665" y="287.541">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="289.792" x="995.6133" y="286.6074">[through fuses entries until valid fuse entry found]</text><polygon fill="#FF0000" points="1077.0762,318.5938,1087.0762,322.5938,1077.0762,326.5938,1081.0762,322.5938" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1083.0762" y1="322.5938" y2="322.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="317.8516">[003]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="88.8672" x="973.5293" y="317.8516">get next entry</text><path d="M906.1665,348.5938 L968.3052,348.5938 L968.3052,355.9043 L958.3052,365.9043 L906.1665,365.9043 L906.1665,348.5938 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="172.1973" style="stroke:#000000;stroke-width:1.5;" width="296.4497" x="906.1665" y="348.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="921.1665" y="362.1621">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="90.6104" x="983.3052" y="361.2285">[if a valid entry]</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="906.1665" x2="1202.6162" y1="458.5254" y2="458.5254"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87.8604" x="911.1665" y="471.1602">[No valid entry]</text><polygon fill="#FF0000" points="1164.6162,393.2148,1174.6162,397.2148,1164.6162,401.2148,1168.6162,397.2148" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1170.6162" y1="397.2148" y2="397.2148"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="392.4727">[004]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="46.7314" x="973.5293" y="392.4727">Put FEK</text><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="969.1665" y1="426.5254" y2="426.5254"/><line style="stroke:#FF0000;stroke-width:1;" x1="969.1665" x2="969.1665" y1="426.5254" y2="439.5254"/><line style="stroke:#FF0000;stroke-width:1;" x1="928.1665" x2="969.1665" y1="439.5254" y2="439.5254"/><polygon fill="#FF0000" points="938.1665,435.5254,928.1665,439.5254,938.1665,443.5254,934.1665,439.5254" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="421.7832">[005]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.6206" x="973.5293" y="421.7832">fek_exists = True</text><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="969.1665" y1="499.791" y2="499.791"/><line style="stroke:#FF0000;stroke-width:1;" x1="969.1665" x2="969.1665" y1="499.791" y2="512.791"/><line style="stroke:#FF0000;stroke-width:1;" x1="928.1665" x2="969.1665" y1="512.791" y2="512.791"/><polygon fill="#FF0000" points="938.1665,508.791,928.1665,512.791,938.1665,516.791,934.1665,512.791" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="495.0488">[006]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.5469" x="973.5293" y="495.0488">fek_exists = False</text><polygon fill="#FF0000" points="142.2788,552.1016,132.2788,556.1016,142.2788,560.1016,138.2788,556.1016" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="916.1665" y1="556.1016" y2="556.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="551.3594">[007]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="63.21" x="187.6416" y="551.3594">fek_exists</text><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="173.2788" y1="585.4121" y2="585.4121"/><line style="stroke:#FF0000;stroke-width:1;" x1="173.2788" x2="173.2788" y1="585.4121" y2="598.4121"/><line style="stroke:#FF0000;stroke-width:1;" x1="132.2788" x2="173.2788" y1="598.4121" y2="598.4121"/><polygon fill="#FF0000" points="142.2788,594.4121,132.2788,598.4121,142.2788,602.4121,138.2788,598.4121" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="580.6699">[008]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.6533" x="177.6416" y="580.6699">Retain fek_exists</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="627.0674"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="627.0674" y2="627.0674"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="630.0674" y2="630.0674"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="420.0088" x="575.9133" y="616.4121"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="397.4395" x="581.9133" y="632.9805">Load a KV slot with KEM for each KEM algorithm supported</text><path d="M110.2788,653.7227 L172.4175,653.7227 L172.4175,661.0332 L162.4175,671.0332 L110.2788,671.0332 L110.2788,653.7227 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="transparent" height="165.8633" style="stroke:#000000;stroke-width:1.5;" width="1414.1099" x="110.2788" y="653.7227"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17.1387" x="125.2788" y="667.291">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="250.6152" x="187.4175" y="666.3574">[kem_algorithm ecdh_secp384r1 supported]</text><polygon fill="#FF0000" points="905.1665,698.3438,915.1665,702.3438,905.1665,706.3438,909.1665,702.3438" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="911.1665" y1="702.3438" y2="702.3438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="697.6016">[009]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.6426" x="177.6416" y="697.6016">generate_ecdh_secp384r1(Key: Slot G)</text><polygon fill="#FF0000" points="649.2754,727.6543,639.2754,731.6543,649.2754,735.6543,645.2754,731.6543" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="643.2754" x2="916.1665" y1="731.6543" y2="731.6543"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="655.2754" y="726.9121">[010]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="215.5283" x="694.6382" y="726.9121">Get random bytes for KEM keypair</text><path d="M932.1665,715.3438 L932.1665,755.3438 L1211.1665,755.3438 L1211.1665,725.3438 L1201.1665,715.3438 L932.1665,715.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1201.1665,715.3438 L1201.1665,725.3438 L1211.1665,725.3438 L1201.1665,715.3438 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="73.2583" x="938.1665" y="732.9121">move to FW</text><text fill="#FF0000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="258.8257" x="938.1665" y="748.2227">add note to indiacte would be nice in HW</text><polygon fill="#FF0000" points="1486.3887,778.2754,1496.3887,782.2754,1486.3887,786.2754,1490.3887,782.2754" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1492.3887" y1="782.2754" y2="782.2754"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="777.5332">[011]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.1436" x="973.5293" y="777.5332">Put KEM keypair</text><polygon fill="#FF0000" points="142.2788,807.5859,132.2788,811.5859,142.2788,815.5859,138.2788,811.5859" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="916.1665" y1="811.5859" y2="811.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="806.8438">[012]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="187.6416" y="806.8438">done</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="854.2412"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="854.2412" y2="854.2412"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="857.2412" y2="857.2412"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="450.5664" x="560.6345" y="843.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="427.9971" x="566.6345" y="860.1543">Load a KV slot with DICE key for each KEM algorithm supported</text><path d="M136.2788,881.8965 L136.2788,936.8965 L821.2788,936.8965 L821.2788,891.8965 L811.2788,881.8965 L136.2788,881.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M811.2788,881.8965 L811.2788,891.8965 L821.2788,891.8965 L811.2788,881.8965 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="142.2788" y="899.4648">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="664.2441" x="142.2788" y="914.7754">ROM/FMC code already created DICE keys and loaded them. Caliptra FW knows the key so no work to do.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="142.2788" y="930.0859">&#160;</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1561.8354" x="5" y="963.4834"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="963.4834" y2="963.4834"/><line style="stroke:#000000;stroke-width:1;" x1="5" x2="1566.8354" y1="966.4834" y2="966.4834"/><rect fill="#EEEEEE" height="23.3105" style="stroke:#000000;stroke-width:2;" width="354.6089" x="608.6133" y="952.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="332.0396" x="614.6133" y="969.3965">Load a KV slot with a Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="905.1665,1018.7598,915.1665,1022.7598,905.1665,1026.7598,909.1665,1022.7598" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="911.1665" y1="1022.7598" y2="1022.7598"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="1010.3623">[013]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113.7563" x="177.6416" y="1002.707">new_key(len: 256,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.7993" x="235.2275" y="1018.0176">Destination: Slot B)</text><polygon fill="#FF0000" points="649.2754,1048.0703,639.2754,1052.0703,649.2754,1056.0703,645.2754,1052.0703" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="643.2754" x2="916.1665" y1="1052.0703" y2="1052.0703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="655.2754" y="1047.3281">[014]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.8647" x="694.6382" y="1047.3281">Get new random key of 256 bits</text><polygon fill="#FF0000" points="1318.1641,1077.3809,1328.1641,1081.3809,1318.1641,1085.3809,1322.1641,1081.3809" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="927.1665" x2="1324.1641" y1="1081.3809" y2="1081.3809"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="934.1665" y="1076.6387">[015]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="197.3613" x="973.5293" y="1076.6387">Put Ready PMEK Encryption Key</text><polygon fill="#FF0000" points="142.2788,1106.6914,132.2788,1110.6914,142.2788,1114.6914,138.2788,1110.6914" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="136.2788" x2="916.1665" y1="1110.6914" y2="1110.6914"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="148.2788" y="1105.9492">[016]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="31.478" x="187.6416" y="1105.9492">done</text><polygon fill="#FF0000" points="313.7036,1164.002,323.7036,1168.002,313.7036,1172.002,317.7036,1168.002" style="stroke:#FF0000;stroke-width:1;"/><line style="stroke:#FF0000;stroke-width:1;" x1="131.2788" x2="319.7036" y1="1168.002" y2="1168.002"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="138.2788" y="1163.2598">[017]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.062" x="177.6416" y="1163.2598">Hand-off information</text><path d="M340.7036,1181.002 L340.7036,1267.002 L731.7036,1267.002 L731.7036,1191.002 L721.7036,1181.002 L340.7036,1181.002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M721.7036,1181.002 L721.7036,1191.002 L731.7036,1191.002 L721.7036,1181.002 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="294.8169" x="346.7036" y="1198.5703">Currently, there is already handoff information</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="275.5264" x="346.7036" y="1213.8809">from ROM to run-time FW. Need to include:</text><ellipse cx="352.2036" cy="1224.4336" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="358.6045" x="358.7036" y="1229.1914">If the FEK exists and if so the KV slot containing that FEK</text><ellipse cx="352.2036" cy="1239.7441" fill="#000000" rx="2.5" ry="2.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.2886" x="358.7036" y="1244.502">The KV Slot containing the KEM keypair</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="4.1133" x="346.7036" y="1259.8125">&#160;</text><line style="stroke:#FF0000;stroke-width:1;" x1="335.7036" x2="377.7036" y1="1293.8652" y2="1293.8652"/><line style="stroke:#FF0000;stroke-width:1;" x1="377.7036" x2="377.7036" y1="1293.8652" y2="1306.8652"/><line style="stroke:#FF0000;stroke-width:1;" x1="336.7036" x2="377.7036" y1="1306.8652" y2="1306.8652"/><polygon fill="#FF0000" points="346.7036,1302.8652,336.7036,1306.8652,346.7036,1310.8652,342.7036,1306.8652" style="stroke:#FF0000;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="35.3628" x="342.7036" y="1289.123">[018]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.209" x="382.0664" y="1289.123">Mark that no MEK sequence has started</text><text fill="#888888" font-family="sans-serif" font-size="10" lengthAdjust="spacing" textLength="118.4277" x="726.2039" y="1413.998">Filename: power_on.uml</text><!--SRC=[ZLPjRzis4FxENt4f32nfAdVTsc8GuW2kOYU6upX8iWH5DmYqTB89IQH7KdO4vCVlI3b-IUAY-YA9Ty_nUFVS8nq8cHHLYg2IULoe98yhAmhJfcN63bgt5-E7-7BSFOk7lU_GWTyPhOeC3bjcffQn5RR08mPqtRb7U3UEhk6oFMv7xM4RhjKIDOpbEtQ0CXNP3dQkCL4oRT1IMGIUQ6KCOx_1wZgPd5wHmOGd7oUdc-NtS98fQI5HXT8TZUdf5M8ALa4gJ58P0mzSbt231ic96pGRB43m6dq_0bDDJ6qiFiC2uCPK9OBshog3xkqW0YvJk1cF29mwKu2Fc5GMqvzlS1qDS3kd0CvMYOPmFUeD3PIydhY0FAstGz5rpajHkBC9kK1ZnPHR_Fbk4RrgLHHK-XVR-L9J9tovrpt9AghGyJ6qlltTx_TkucvqDxZltWt6Lupz27wqkhVVhw8u6b-ER_uzFGLgKadUuQgxIZBMwS2buYbm6Dw3API5fR0pwFU609qEOmu2BLFB1FB5yN481Nd76UQ7Gwn3k7M8xX4hb9g3dMbLJMVWiw9ahHPqhoIn4XQy4ActU4CDcQfawa-LBrORDBWGfdHmYO-syMHqLiPuOO48o5U16iik6dDtiigwvBs9LjwkpGukNuJECyP7OQoXGRdJ5J8iADChjN-xLx0-9uXFTcjIKYLNGxO6kee60MoZgPyEsxW5mRgzMyNtZo6nmd8Xjw5xMpZiZQZ86f0dpGilfagJfQI9cS-L9kutFNQrpR6CDmwOfBFOO3B_yw_F-jF6twVuYX9JbAY9s_4kR8iXvozge6aOGpYdFhid2ZUfIIjykYxJ7Eiv5teZBrfCPvQjjUN5r9HgWMxC-WzxNNZQJ4upZQdW2JqlLLMaGCChHOAq31SFksEsst0ifok2lSpHcVOpxKqwl4q9PsymQqAiIT4iUsBuYTZJzhD1r7F9_MBlD-NrMJ164lcnFueQcUI5rpKo8NUGv-36gwcJ0YVUCopR4D6WpAtcr0N8fLeQj-uJCOggISNMkTTvrMPiNU5zf-34TBUnarZeoKJNSokK1ABK7bsIk8nfjyC2PGX_VFdwuH-v8yPmvYHOSXTcnSflH-mDHbAWPrQwxEdpGT5W8cZMrjxp4dFJS65ldimxlKsBNrG8JuSzsj0ogaGhIYoeC_hmQ5SjigNN-GiwHw2oZCXDT2ZzuLbAXT2gRlgztVziwRU9Agr9y8hwWskXfiamQoBCN65UnFDIw_PsNrVgiAvau18Z9hJX-VE- -bS9MVCNCCWyFTndPYMWZb1K5IABCpoJWNupdE09EQLblf7szt3NUDs-yiATyToY6frlKvuGHjmHqWKbThhs6VolGabACEC6ZELUy9wUlZmzEIYLdlqF]--></g></svg>